{"version":3,"sources":["../../../../../src/cli/simple-commands/init/executable-wrapper.js"],"sourcesContent":["// executable-wrapper.js - Create local executable wrapper\r\n\r\nimport { writeFile, chmod } from 'fs/promises';\r\nimport { platform } from 'os';\r\n\r\nexport async function createLocalExecutable(workingDir, dryRun = false) {\r\n  try {\r\n    if (platform() === 'win32') {\r\n      // Create Windows batch file\r\n      const wrapperScript = `@echo off\r\nREM Claude-Flow local wrapper\r\nREM This script ensures claude-flow runs from your project directory\r\n\r\nset PROJECT_DIR=%CD%\r\nset PWD=%PROJECT_DIR%\r\nset CLAUDE_WORKING_DIR=%PROJECT_DIR%\r\n\r\nREM Try to find claude-flow binary\r\nREM Check common locations for npm/npx installations\r\n\r\nREM 1. Local node_modules (npm install claude-flow)\r\nif exist \"%PROJECT_DIR%\\\\node_modules\\\\.bin\\\\claude-flow.cmd\" (\r\n  cd /d \"%PROJECT_DIR%\"\r\n  \"%PROJECT_DIR%\\\\node_modules\\\\.bin\\\\claude-flow.cmd\" %*\r\n  exit /b %ERRORLEVEL%\r\n)\r\n\r\nREM 2. Parent directory node_modules (monorepo setup)\r\nif exist \"%PROJECT_DIR%\\\\..\\\\node_modules\\\\.bin\\\\claude-flow.cmd\" (\r\n  cd /d \"%PROJECT_DIR%\"\r\n  \"%PROJECT_DIR%\\\\..\\\\node_modules\\\\.bin\\\\claude-flow.cmd\" %*\r\n  exit /b %ERRORLEVEL%\r\n)\r\n\r\nREM 3. Global installation (npm install -g claude-flow)\r\nwhere claude-flow >nul 2>nul\r\nif %ERRORLEVEL% EQU 0 (\r\n  cd /d \"%PROJECT_DIR%\"\r\n  claude-flow %*\r\n  exit /b %ERRORLEVEL%\r\n)\r\n\r\nREM 4. Fallback to npx (will download if needed)\r\ncd /d \"%PROJECT_DIR%\"\r\nnpx claude-flow@latest %*\r\n`;\r\n\r\n      // Write the Windows batch file\r\n      if (!dryRun) {\r\n        await writeFile(`${workingDir}/claude-flow.cmd`, wrapperScript, 'utf8');\r\n        console.log('  ✓ Created local claude-flow.cmd executable wrapper');\r\n        console.log('    You can now use: claude-flow instead of npx claude-flow');\r\n      }\r\n    } else {\r\n      // Check if we're in development mode (claude-code-flow repo)\r\n      const isDevelopment = workingDir.includes('claude-code-flow');\r\n      const devBinPath = isDevelopment\r\n        ? workingDir.split('claude-code-flow')[0] + 'claude-code-flow/bin/claude-flow'\r\n        : '';\r\n\r\n      // Create Unix/Linux/Mac shell script\r\n      const wrapperScript = `#!/usr/bin/env bash\r\n# Claude-Flow local wrapper\r\n# This script ensures claude-flow runs from your project directory\r\n\r\n# Save the current directory\r\nPROJECT_DIR=\"\\${PWD}\"\r\n\r\n# Set environment to ensure correct working directory\r\nexport PWD=\"\\${PROJECT_DIR}\"\r\nexport CLAUDE_WORKING_DIR=\"\\${PROJECT_DIR}\"\r\n\r\n# Try to find claude-flow binary\r\n# Check common locations for npm/npx installations\r\n\r\n${\r\n  isDevelopment\r\n    ? `# Development mode - use local bin\r\nif [ -f \"${devBinPath}\" ]; then\r\n  cd \"\\${PROJECT_DIR}\"\r\n  exec \"${devBinPath}\" \"$@\"\r\nfi\r\n\r\n`\r\n    : ''\r\n}# 1. Local node_modules (npm install claude-flow)\r\nif [ -f \"\\${PROJECT_DIR}/node_modules/.bin/claude-flow\" ]; then\r\n  cd \"\\${PROJECT_DIR}\"\r\n  exec \"\\${PROJECT_DIR}/node_modules/.bin/claude-flow\" \"$@\"\r\n\r\n# 2. Parent directory node_modules (monorepo setup)\r\nelif [ -f \"\\${PROJECT_DIR}/../node_modules/.bin/claude-flow\" ]; then\r\n  cd \"\\${PROJECT_DIR}\"\r\n  exec \"\\${PROJECT_DIR}/../node_modules/.bin/claude-flow\" \"$@\"\r\n\r\n# 3. Global installation (npm install -g claude-flow)\r\nelif command -v claude-flow &> /dev/null; then\r\n  cd \"\\${PROJECT_DIR}\"\r\n  exec claude-flow \"$@\"\r\n\r\n# 4. Fallback to npx (will download if needed)\r\nelse\r\n  cd \"\\${PROJECT_DIR}\"\r\n  exec npx claude-flow@latest \"$@\"\r\nfi\r\n`;\r\n\r\n      // Write the wrapper script\r\n      if (!dryRun) {\r\n        await writeFile(`${workingDir}/claude-flow`, wrapperScript, 'utf8');\r\n\r\n        // Make it executable\r\n        await chmod(`${workingDir}/claude-flow`, 0o755);\r\n\r\n        console.log('  ✓ Created local claude-flow executable wrapper');\r\n        console.log('    You can now use: ./claude-flow instead of npx claude-flow');\r\n      }\r\n    }\r\n  } catch (err) {\r\n    console.log(`  ⚠️  Could not create local executable: ${err.message}`);\r\n  }\r\n}\r\n"],"names":["writeFile","chmod","platform","createLocalExecutable","workingDir","dryRun","wrapperScript","console","log","isDevelopment","includes","devBinPath","split","err","message"],"mappings":"AAEA,SAASA,SAAS,EAAEC,KAAK,QAAQ,cAAc;AAC/C,SAASC,QAAQ,QAAQ,KAAK;AAE9B,OAAO,eAAeC,sBAAsBC,UAAU,EAAEC,SAAS,KAAK;IACpE,IAAI;QACF,IAAIH,eAAe,SAAS;YAE1B,MAAMI,gBAAgB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoC7B,CAAC;YAGK,IAAI,CAACD,QAAQ;gBACX,MAAML,UAAU,GAAGI,WAAW,gBAAgB,CAAC,EAAEE,eAAe;gBAChEC,QAAQC,GAAG,CAAC;gBACZD,QAAQC,GAAG,CAAC;YACd;QACF,OAAO;YAEL,MAAMC,gBAAgBL,WAAWM,QAAQ,CAAC;YAC1C,MAAMC,aAAaF,gBACfL,WAAWQ,KAAK,CAAC,mBAAmB,CAAC,EAAE,GAAG,qCAC1C;YAGJ,MAAMN,gBAAgB,CAAC;;;;;;;;;;;;;;AAc7B,EACEG,gBACI,CAAC;SACE,EAAEE,WAAW;;QAEd,EAAEA,WAAW;;;AAGrB,CAAC,GACK,GACL;;;;;;;;;;;;;;;;;;;;AAoBD,CAAC;YAGK,IAAI,CAACN,QAAQ;gBACX,MAAML,UAAU,GAAGI,WAAW,YAAY,CAAC,EAAEE,eAAe;gBAG5D,MAAML,MAAM,GAAGG,WAAW,YAAY,CAAC,EAAE;gBAEzCG,QAAQC,GAAG,CAAC;gBACZD,QAAQC,GAAG,CAAC;YACd;QACF;IACF,EAAE,OAAOK,KAAK;QACZN,QAAQC,GAAG,CAAC,CAAC,yCAAyC,EAAEK,IAAIC,OAAO,EAAE;IACvE;AACF"}