{
  "version": 3,
  "sources": ["../../src/swarm/prompt-cli.ts"],
  "sourcesContent": ["#!/usr/bin/env node\n\nimport { Command } from 'commander';\nimport * as path from 'path';\nimport { copyPrompts, copyPromptsEnhanced } from './prompt-copier-enhanced.js';\nimport {\n  PromptConfigManager,\n  PromptPathResolver,\n  PromptValidator,\n  createProgressBar,\n  formatFileSize,\n  formatDuration,\n} from './prompt-utils.js';\nimport { logger } from '../core/logger.js';\n\nconst program = new Command();\n\nprogram\n  .name('prompt-copier')\n  .description('Robust prompt copying mechanism for Claude-Flow')\n  .version('1.0.0');\n\nprogram\n  .command('copy')\n  .description('Copy prompts from source to destination')\n  .option('-s, --source <path>', 'Source directory')\n  .option('-d, --destination <path>', 'Destination directory')\n  .option('-p, --profile <name>', 'Configuration profile to use')\n  .option('--no-backup', 'Disable backup creation')\n  .option('--no-verify', 'Disable file verification')\n  .option('--no-parallel', 'Disable parallel processing')\n  .option('--workers <number>', 'Number of worker threads', parseInt)\n  .option(\n    '--conflict <strategy>',\n    'Conflict resolution strategy',\n    /^(skip|overwrite|backup|merge)$/,\n  )\n  .option('--include <patterns>', 'Include patterns (comma-separated)')\n  .option('--exclude <patterns>', 'Exclude patterns (comma-separated)')\n  .option('--dry-run', 'Show what would be copied without actually copying')\n  .option('--enhanced', 'Use enhanced copier with worker threads')\n  .action(async (options) => {\n    try {\n      const configManager = new PromptConfigManager();\n      const config = await configManager.loadConfig();\n\n      let copyOptions;\n\n      if (options.profile) {\n        const profileOptions = configManager.getProfile(options.profile);\n        copyOptions = {\n          source: options.source || config.sourceDirectories[0],\n          destination: options.destination || config.destinationDirectory,\n          ...profileOptions,\n        };\n      } else {\n        copyOptions = {\n          source: options.source || config.sourceDirectories[0],\n          destination: options.destination || config.destinationDirectory,\n          backup: options.backup,\n          verify: options.verify,\n          parallel: options.parallel,\n          maxWorkers: options.workers || config.defaultOptions.maxWorkers,\n          conflictResolution: options.conflict || config.defaultOptions.conflictResolution,\n          includePatterns: options.include\n            ? options.include.split(',')\n            : config.defaultOptions.includePatterns,\n          excludePatterns: options.exclude\n            ? options.exclude.split(',')\n            : config.defaultOptions.excludePatterns,\n          dryRun: options.dryRun,\n        };\n      }\n\n      // Create progress bar\n      let progressBar: ReturnType<typeof createProgressBar> | null = null;\n\n      copyOptions.progressCallback = (progress) => {\n        if (!progressBar) {\n          progressBar = createProgressBar(progress.total);\n        }\n        progressBar.update(progress.completed);\n\n        if (progress.completed === progress.total) {\n          progressBar.complete();\n        }\n      };\n\n      console.log('Starting prompt copy operation...');\n      console.log(`Source: ${copyOptions.source}`);\n      console.log(`Destination: ${copyOptions.destination}`);\n      console.log(`Options: ${JSON.stringify(copyOptions, null, 2)}`);\n\n      const copyFunction = options.enhanced ? copyPromptsEnhanced : copyPrompts;\n      const result = await copyFunction(copyOptions);\n\n      console.log('\\n=== Copy Results ===');\n      console.log(`Success: ${result.success ? '\u2705' : '\u274C'}`);\n      console.log(`Total files: ${result.totalFiles}`);\n      console.log(`Copied: ${result.copiedFiles}`);\n      console.log(`Failed: ${result.failedFiles}`);\n      console.log(`Skipped: ${result.skippedFiles}`);\n      console.log(`Duration: ${formatDuration(result.duration)}`);\n\n      if (result.backupLocation) {\n        console.log(`Backup manifest: ${result.backupLocation}`);\n      }\n\n      if (result.errors.length > 0) {\n        console.log('\\n=== Errors ===');\n        result.errors.forEach((error) => {\n          console.log(`\u274C ${error.file}: ${error.error} (${error.phase})`);\n        });\n      }\n    } catch (error) {\n      console.error('Copy operation failed:', error);\n      process.exit(1);\n    }\n  });\n\nprogram\n  .command('discover')\n  .description('Discover prompt directories in the current project')\n  .option('-b, --base <path>', 'Base path to search from', process.cwd())\n  .action(async (options) => {\n    try {\n      const resolver = new PromptPathResolver(options.base);\n      const directories = await resolver.discoverPromptDirectories();\n\n      console.log('Discovered prompt directories:');\n      directories.forEach((dir) => {\n        console.log(`  \uD83D\uDCC1 ${dir}`);\n      });\n\n      if (directories.length === 0) {\n        console.log('  No prompt directories found');\n      }\n    } catch (error) {\n      console.error('Discovery failed:', error);\n      process.exit(1);\n    }\n  });\n\nprogram\n  .command('validate <path>')\n  .description('Validate prompt files')\n  .option('--recursive', 'Validate recursively')\n  .action(async (filePath, options) => {\n    try {\n      const stats = await (await import('fs')).promises.stat(filePath);\n      const files: string[] = [];\n\n      if (stats.isFile()) {\n        files.push(filePath);\n      } else if (stats.isDirectory()) {\n        // Scan directory for prompt files\n        const scanDir = async (dir: string) => {\n          const entries = await (await import('fs')).promises.readdir(dir, { withFileTypes: true });\n\n          for (const entry of entries) {\n            const fullPath = path.join(dir, entry.name);\n\n            if (\n              entry.isFile() &&\n              (entry.name.endsWith('.md') ||\n                entry.name.endsWith('.txt') ||\n                entry.name.endsWith('.prompt'))\n            ) {\n              files.push(fullPath);\n            } else if (entry.isDirectory() && options.recursive) {\n              await scanDir(fullPath);\n            }\n          }\n        };\n\n        await scanDir(filePath);\n      }\n\n      console.log(`Validating ${files.length} files...`);\n\n      let validFiles = 0;\n      let invalidFiles = 0;\n\n      for (const file of files) {\n        const result = await PromptValidator.validatePromptFile(file);\n\n        if (result.valid) {\n          validFiles++;\n          console.log(`\u2705 ${file}`);\n        } else {\n          invalidFiles++;\n          console.log(`\u274C ${file}`);\n          result.issues.forEach((issue) => {\n            console.log(`   - ${issue}`);\n          });\n        }\n\n        if (result.metadata && Object.keys(result.metadata).length > 0) {\n          console.log(`   Metadata: ${JSON.stringify(result.metadata)}`);\n        }\n      }\n\n      console.log(`\\nValidation complete: ${validFiles} valid, ${invalidFiles} invalid`);\n    } catch (error) {\n      console.error('Validation failed:', error);\n      process.exit(1);\n    }\n  });\n\nprogram\n  .command('config')\n  .description('Manage configuration')\n  .option('--init', 'Initialize default configuration')\n  .option('--show', 'Show current configuration')\n  .option('--profiles', 'List available profiles')\n  .action(async (options) => {\n    try {\n      const configManager = new PromptConfigManager();\n\n      if (options.init) {\n        await configManager.saveConfig();\n        console.log('\u2705 Configuration initialized');\n      } else if (options.show) {\n        const config = await configManager.loadConfig();\n        console.log(JSON.stringify(config, null, 2));\n      } else if (options.profiles) {\n        const config = await configManager.loadConfig();\n        const profiles = configManager.listProfiles();\n\n        console.log('Available profiles:');\n        profiles.forEach((profile) => {\n          console.log(`  \uD83D\uDCCB ${profile}`);\n          const profileOptions = configManager.getProfile(profile);\n          Object.entries(profileOptions).forEach(([key, value]) => {\n            console.log(`     ${key}: ${JSON.stringify(value)}`);\n          });\n        });\n      } else {\n        console.log('Use --init, --show, or --profiles');\n      }\n    } catch (error) {\n      console.error('Configuration operation failed:', error);\n      process.exit(1);\n    }\n  });\n\nprogram\n  .command('rollback <manifest>')\n  .description('Rollback from backup')\n  .action(async (manifestPath) => {\n    try {\n      const { PromptCopier } = await import('./prompt-copier.js');\n      const copier = new PromptCopier({\n        source: '',\n        destination: '',\n      });\n\n      await copier.restoreFromBackup(manifestPath);\n      console.log('\u2705 Rollback completed');\n    } catch (error) {\n      console.error('Rollback failed:', error);\n      process.exit(1);\n    }\n  });\n\nprogram\n  .command('sync')\n  .description('Synchronize prompts between directories')\n  .option('-s, --source <path>', 'Source directory')\n  .option('-d, --destination <path>', 'Destination directory')\n  .option('--bidirectional', 'Enable bidirectional sync')\n  .option('--delete', 'Delete files not present in source')\n  .action(async (options) => {\n    try {\n      // This would implement incremental sync functionality\n      console.log('Sync functionality not yet implemented');\n      console.log('Options:', options);\n    } catch (error) {\n      console.error('Sync failed:', error);\n      process.exit(1);\n    }\n  });\n\n// Handle uncaught errors\nprocess.on('uncaughtException', (error) => {\n  console.error('Uncaught exception:', error);\n  process.exit(1);\n});\n\nprocess.on('unhandledRejection', (reason) => {\n  console.error('Unhandled rejection:', reason);\n  process.exit(1);\n});\n\nif (require.main === module) {\n  program.parse();\n}\n\nexport { program };\n"],
  "mappings": "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",
  "names": []
}
