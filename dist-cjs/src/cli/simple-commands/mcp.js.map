{"version":3,"sources":["../../../../src/cli/simple-commands/mcp.js"],"sourcesContent":["// mcp.js - MCP server management commands\r\nimport { printSuccess, printError, printWarning } from '../utils.js';\r\n\r\n// Module-level state to track stdio mode\r\nlet isStdioMode = false;\r\n\r\n// Smart logging helpers that respect stdio mode\r\n// In stdio mode: route to stderr to keep stdout clean for JSON-RPC\r\n// In HTTP mode: route to stdout for normal behavior\r\nconst log = (...args) => (isStdioMode ? console.error(...args) : console.log(...args));\r\nconst success = (msg) => (isStdioMode ? console.error(`‚úÖ ${msg}`) : printSuccess(msg));\r\nconst error = (msg) => (isStdioMode ? console.error(`‚ùå ${msg}`) : printError(msg));\r\nconst warning = (msg) => (isStdioMode ? console.error(`‚ö†Ô∏è  ${msg}`) : printWarning(msg));\r\n\r\nexport async function mcpCommand(subArgs, flags) {\r\n  const mcpCmd = subArgs[0];\r\n\r\n  switch (mcpCmd) {\r\n    case 'status':\r\n      await showMcpStatus(subArgs, flags);\r\n      break;\r\n\r\n    case 'start':\r\n      await startMcpServer(subArgs, flags);\r\n      break;\r\n\r\n    case 'stop':\r\n      await stopMcpServer(subArgs, flags);\r\n      break;\r\n\r\n    case 'tools':\r\n      await listMcpTools(subArgs, flags);\r\n      break;\r\n\r\n    case 'auth':\r\n      await manageMcpAuth(subArgs, flags);\r\n      break;\r\n\r\n    case 'config':\r\n      await showMcpConfig(subArgs, flags);\r\n      break;\r\n\r\n    default:\r\n      showMcpHelp();\r\n  }\r\n}\r\n\r\nasync function showMcpStatus(subArgs, flags) {\r\n  success('MCP Server Status:');\r\n  log('üåê Status: Stopped (orchestrator not running)');\r\n  log('üîß Configuration: Default settings');\r\n  log('üîå Connections: 0 active');\r\n  log('üì° Tools: Ready to load');\r\n  log('üîê Authentication: Not configured');\r\n}\r\n\r\nasync function startMcpServer(subArgs, flags) {\r\n  const autoOrchestrator = subArgs.includes('--auto-orchestrator') || flags.autoOrchestrator;\r\n  const daemon = subArgs.includes('--daemon') || flags.daemon;\r\n  const stdio = subArgs.includes('--stdio') || flags.stdio || true; // Default to stdio mode\r\n\r\n  // Set module-level stdio flag for all helper functions\r\n  isStdioMode = stdio;\r\n\r\n  if (stdio) {\r\n    // In stdio mode, don't output ANY messages before spawning the server\r\n    // The MCP server will handle all output (stderr for logs, stdout for JSON-RPC)\r\n    // Any output here would corrupt the JSON-RPC protocol stream\r\n\r\n    // Import and start the MCP server\r\n    try {\r\n      const { fileURLToPath } = await import('url');\r\n      const path = await import('path');\r\n      const { spawn } = await import('child_process');\r\n\r\n      const __filename = fileURLToPath(import.meta.url);\r\n      const __dirname = path.dirname(__filename);\r\n      // TODO: Switch to new TypeScript server (server-standalone.js) after fixing import resolution\r\n      // For now, using old mcp-server.js for local testing\r\n      // Phase 4 tools will be available after NPM publish\r\n      const mcpServerPath = path.join(__dirname, '../../mcp/mcp-server.js');\r\n\r\n      // Check if the file exists, and log the path for debugging\r\n      const fs = await import('fs');\r\n      if (!fs.existsSync(mcpServerPath)) {\r\n        error(`MCP server file not found at: ${mcpServerPath}`);\r\n        error(`Current directory: ${process.cwd()}`);\r\n        error(`Script directory: ${__dirname}`);\r\n        throw new Error(`MCP server file not found: ${mcpServerPath}`);\r\n      }\r\n\r\n      // Start the MCP server process\r\n      const serverProcess = spawn('node', [mcpServerPath], {\r\n        stdio: 'inherit',\r\n        env: {\r\n          ...process.env,\r\n          CLAUDE_FLOW_AUTO_ORCHESTRATOR: autoOrchestrator ? 'true' : 'false',\r\n          CLAUDE_FLOW_NEURAL_ENABLED: 'true',\r\n          CLAUDE_FLOW_WASM_ENABLED: 'true',\r\n        },\r\n      });\r\n\r\n      serverProcess.on('exit', (code) => {\r\n        if (code !== 0) {\r\n          error(`MCP server exited with code ${code}`);\r\n        }\r\n      });\r\n\r\n      // Keep the process alive\r\n      await new Promise(() => {}); // Never resolves, keeps server running\r\n    } catch (err) {\r\n      error('Failed to start MCP server: ' + err.message);\r\n\r\n      // Fallback to status display\r\n      log('üöÄ MCP server would start with:');\r\n      log('   Protocol: stdio');\r\n      log('   Tools: 87 Claude-Flow integration tools');\r\n      log('   Orchestrator: ' + (autoOrchestrator ? 'AUTO-STARTED' : 'Manual'));\r\n      log('   Mode: ' + (daemon ? 'DAEMON' : 'Interactive'));\r\n    }\r\n  } else {\r\n    // HTTP mode (for future implementation)\r\n    const port = getFlag(subArgs, '--port') || flags.port || 3000;\r\n    const host = getFlag(subArgs, '--host') || flags.host || 'localhost';\r\n\r\n    success(`Starting Claude Flow MCP server on ${host}:${port}...`);\r\n    log('üöÄ HTTP mode not yet implemented, use --stdio for full functionality');\r\n  }\r\n}\r\n\r\nasync function stopMcpServer(subArgs, flags) {\r\n  success('Stopping MCP server...');\r\n  log('üõë Server would be gracefully shut down');\r\n  log('üìù Active connections would be closed');\r\n  log('üíæ State would be persisted');\r\n}\r\n\r\nasync function listMcpTools(subArgs, flags) {\r\n  const verbose = subArgs.includes('--verbose') || subArgs.includes('-v') || flags.verbose;\r\n  const category = getFlag(subArgs, '--category') || flags.category;\r\n\r\n  success('Claude-Flow MCP Tools & Resources (87 total):');\r\n\r\n  if (!category || category === 'swarm') {\r\n    log('\\nüêù SWARM COORDINATION (12 tools):');\r\n    log('  ‚Ä¢ swarm_init            Initialize swarm with topology');\r\n    log('  ‚Ä¢ agent_spawn           Create specialized AI agents');\r\n    log('  ‚Ä¢ task_orchestrate      Orchestrate complex workflows');\r\n    log('  ‚Ä¢ swarm_status          Monitor swarm health/performance');\r\n    log('  ‚Ä¢ agent_list            List active agents & capabilities');\r\n    log('  ‚Ä¢ agent_metrics         Agent performance metrics');\r\n    log('  ‚Ä¢ swarm_monitor         Real-time swarm monitoring');\r\n    log('  ‚Ä¢ topology_optimize     Auto-optimize swarm topology');\r\n    log('  ‚Ä¢ load_balance          Distribute tasks efficiently');\r\n    log('  ‚Ä¢ coordination_sync     Sync agent coordination');\r\n    log('  ‚Ä¢ swarm_scale           Auto-scale agent count');\r\n    log('  ‚Ä¢ swarm_destroy         Gracefully shutdown swarm');\r\n  }\r\n\r\n  if (!category || category === 'neural') {\r\n    log('\\nüß† NEURAL NETWORKS & AI (15 tools):');\r\n    log('  ‚Ä¢ neural_status         Check neural network status');\r\n    log('  ‚Ä¢ neural_train          Train neural patterns');\r\n    log('  ‚Ä¢ neural_patterns       Analyze cognitive patterns');\r\n    log('  ‚Ä¢ neural_predict        Make AI predictions');\r\n    log('  ‚Ä¢ model_load            Load pre-trained models');\r\n    log('  ‚Ä¢ model_save            Save trained models');\r\n    log('  ‚Ä¢ wasm_optimize         WASM SIMD optimization');\r\n    log('  ‚Ä¢ inference_run         Run neural inference');\r\n    log('  ‚Ä¢ pattern_recognize     Pattern recognition');\r\n    log('  ‚Ä¢ cognitive_analyze     Cognitive behavior analysis');\r\n    log('  ‚Ä¢ learning_adapt        Adaptive learning');\r\n    log('  ‚Ä¢ neural_compress       Compress neural models');\r\n    log('  ‚Ä¢ ensemble_create       Create model ensembles');\r\n    log('  ‚Ä¢ transfer_learn        Transfer learning');\r\n    log('  ‚Ä¢ neural_explain        AI explainability');\r\n  }\r\n\r\n  if (!category || category === 'memory') {\r\n    log('\\nüíæ MEMORY & PERSISTENCE (12 tools):');\r\n    log('  ‚Ä¢ memory_usage          Store/retrieve persistent data');\r\n    log('  ‚Ä¢ memory_search         Search memory with patterns');\r\n    log('  ‚Ä¢ memory_persist        Cross-session persistence');\r\n    log('  ‚Ä¢ memory_namespace      Namespace management');\r\n    log('  ‚Ä¢ memory_backup         Backup memory stores');\r\n    log('  ‚Ä¢ memory_restore        Restore from backups');\r\n    log('  ‚Ä¢ memory_compress       Compress memory data');\r\n    log('  ‚Ä¢ memory_sync           Sync across instances');\r\n    log('  ‚Ä¢ cache_manage          Manage coordination cache');\r\n    log('  ‚Ä¢ state_snapshot        Create state snapshots');\r\n    log('  ‚Ä¢ context_restore       Restore execution context');\r\n    log('  ‚Ä¢ memory_analytics      Analyze memory usage');\r\n  }\r\n\r\n  if (!category || category === 'analysis') {\r\n    log('\\nüìä ANALYSIS & MONITORING (13 tools):');\r\n    log('  ‚Ä¢ task_status           Check task execution status');\r\n    log('  ‚Ä¢ task_results          Get task completion results');\r\n    log('  ‚Ä¢ benchmark_run         Performance benchmarks');\r\n    log('  ‚Ä¢ bottleneck_analyze    Identify bottlenecks');\r\n    log('  ‚Ä¢ performance_report    Generate performance reports');\r\n    log('  ‚Ä¢ token_usage           Analyze token consumption');\r\n    log('  ‚Ä¢ metrics_collect       Collect system metrics');\r\n    log('  ‚Ä¢ trend_analysis        Analyze performance trends');\r\n    log('  ‚Ä¢ cost_analysis         Cost and resource analysis');\r\n    log('  ‚Ä¢ quality_assess        Quality assessment');\r\n    log('  ‚Ä¢ error_analysis        Error pattern analysis');\r\n    log('  ‚Ä¢ usage_stats           Usage statistics');\r\n    log('  ‚Ä¢ health_check          System health monitoring');\r\n  }\r\n\r\n  if (!category || category === 'workflow') {\r\n    log('\\nüîß WORKFLOW & AUTOMATION (11 tools):');\r\n    log('  ‚Ä¢ workflow_create       Create custom workflows');\r\n    log('  ‚Ä¢ workflow_execute      Execute predefined workflows');\r\n    log('  ‚Ä¢ workflow_export       Export workflow definitions');\r\n    log('  ‚Ä¢ sparc_mode            Run SPARC development modes');\r\n    log('  ‚Ä¢ automation_setup      Setup automation rules');\r\n    log('  ‚Ä¢ pipeline_create       Create CI/CD pipelines');\r\n    log('  ‚Ä¢ scheduler_manage      Manage task scheduling');\r\n    log('  ‚Ä¢ trigger_setup         Setup event triggers');\r\n    log('  ‚Ä¢ workflow_template     Manage workflow templates');\r\n    log('  ‚Ä¢ batch_process         Batch processing');\r\n    log('  ‚Ä¢ parallel_execute      Execute tasks in parallel');\r\n  }\r\n\r\n  if (!category || category === 'github') {\r\n    log('\\nüêô GITHUB INTEGRATION (8 tools):');\r\n    log('  ‚Ä¢ github_repo_analyze   Repository analysis');\r\n    log('  ‚Ä¢ github_pr_manage      Pull request management');\r\n    log('  ‚Ä¢ github_issue_track    Issue tracking & triage');\r\n    log('  ‚Ä¢ github_release_coord  Release coordination');\r\n    log('  ‚Ä¢ github_workflow_auto  Workflow automation');\r\n    log('  ‚Ä¢ github_code_review    Automated code review');\r\n    log('  ‚Ä¢ github_sync_coord     Multi-repo sync coordination');\r\n    log('  ‚Ä¢ github_metrics        Repository metrics');\r\n  }\r\n\r\n  if (!category || category === 'daa') {\r\n    log('\\nü§ñ DAA (Dynamic Agent Architecture) (8 tools):');\r\n    log('  ‚Ä¢ daa_agent_create      Create dynamic agents');\r\n    log('  ‚Ä¢ daa_capability_match  Match capabilities to tasks');\r\n    log('  ‚Ä¢ daa_resource_alloc    Resource allocation');\r\n    log('  ‚Ä¢ daa_lifecycle_manage  Agent lifecycle management');\r\n    log('  ‚Ä¢ daa_communication     Inter-agent communication');\r\n    log('  ‚Ä¢ daa_consensus         Consensus mechanisms');\r\n    log('  ‚Ä¢ daa_fault_tolerance   Fault tolerance & recovery');\r\n    log('  ‚Ä¢ daa_optimization      Performance optimization');\r\n  }\r\n\r\n  if (!category || category === 'system') {\r\n    log('\\n‚öôÔ∏è SYSTEM & UTILITIES (8 tools):');\r\n    log('  ‚Ä¢ terminal_execute      Execute terminal commands');\r\n    log('  ‚Ä¢ config_manage         Configuration management');\r\n    log('  ‚Ä¢ features_detect       Feature detection');\r\n    log('  ‚Ä¢ security_scan         Security scanning');\r\n    log('  ‚Ä¢ backup_create         Create system backups');\r\n    log('  ‚Ä¢ restore_system        System restoration');\r\n    log('  ‚Ä¢ log_analysis          Log analysis & insights');\r\n    log('  ‚Ä¢ diagnostic_run        System diagnostics');\r\n  }\r\n\r\n  if (verbose) {\r\n    log('\\nüìã DETAILED TOOL INFORMATION:');\r\n    log('  üî• HIGH-PRIORITY TOOLS:');\r\n    log(\r\n      '    swarm_init: Initialize coordination with 4 topologies (hierarchical, mesh, ring, star)',\r\n    );\r\n    log(\r\n      '    agent_spawn: 8 agent types (researcher, coder, analyst, architect, tester, coordinator, reviewer, optimizer)',\r\n    );\r\n    log('    neural_train: Train 27 neural models with WASM SIMD acceleration');\r\n    log(\r\n      '    memory_usage: 5 operations (store, retrieve, list, delete, search) with TTL & namespacing',\r\n    );\r\n    log('    performance_report: Real-time metrics with 24h/7d/30d timeframes');\r\n\r\n    log('\\n  ‚ö° PERFORMANCE FEATURES:');\r\n    log('    ‚Ä¢ 2.8-4.4x speed improvement with parallel execution');\r\n    log('    ‚Ä¢ 32.3% token reduction through optimization');\r\n    log('    ‚Ä¢ 84.8% SWE-Bench solve rate with swarm coordination');\r\n    log('    ‚Ä¢ WASM neural processing with SIMD optimization');\r\n    log('    ‚Ä¢ Cross-session memory persistence');\r\n\r\n    log('\\n  üîó INTEGRATION CAPABILITIES:');\r\n    log('    ‚Ä¢ Full ruv-swarm feature parity (rebranded)');\r\n    log('    ‚Ä¢ Claude Code native tool integration');\r\n    log('    ‚Ä¢ GitHub Actions workflow automation');\r\n    log('    ‚Ä¢ SPARC methodology with 17 modes');\r\n    log('    ‚Ä¢ MCP protocol compatibility');\r\n  }\r\n\r\n  log('\\nüì° Status: 87 tools & resources available when server is running');\r\n  log('üéØ Categories: swarm, neural, memory, analysis, workflow, github, daa, system');\r\n  log('üîó Compatibility: ruv-swarm + DAA + Claude-Flow unified platform');\r\n  log('\\nüí° Usage: claude-flow mcp tools --category=<category> --verbose');\r\n}\r\n\r\nasync function manageMcpAuth(subArgs, flags) {\r\n  const authCmd = subArgs[1];\r\n\r\n  switch (authCmd) {\r\n    case 'setup':\r\n      success('Setting up MCP authentication...');\r\n      log('üîê Authentication configuration:');\r\n      log('   Type: API Key based');\r\n      log('   Scope: Claude-Flow tools');\r\n      log('   Security: TLS encrypted');\r\n      break;\r\n\r\n    case 'status':\r\n      success('MCP Authentication Status:');\r\n      log('üîê Status: Not configured');\r\n      log('üîë API Keys: 0 active');\r\n      log('üõ°Ô∏è  Security: Default settings');\r\n      break;\r\n\r\n    case 'rotate':\r\n      success('Rotating MCP authentication keys...');\r\n      log('üîÑ New API keys would be generated');\r\n      log('‚ôªÔ∏è  Old keys would be deprecated gracefully');\r\n      break;\r\n\r\n    default:\r\n      log('Auth commands: setup, status, rotate');\r\n      log('Examples:');\r\n      log('  claude-flow mcp auth setup');\r\n      log('  claude-flow mcp auth status');\r\n  }\r\n}\r\n\r\nasync function showMcpConfig(subArgs, flags) {\r\n  success('Claude-Flow MCP Server Configuration:');\r\n  log('\\nüìã Server Settings:');\r\n  log('   Host: localhost');\r\n  log('   Port: 3000');\r\n  log('   Protocol: HTTP/STDIO');\r\n  log('   Timeout: 30000ms');\r\n  log('   Auto-Orchestrator: Enabled');\r\n\r\n  log('\\nüîß Tool Configuration:');\r\n  log('   Available Tools: 87 total');\r\n  log('   Categories: 8 (swarm, neural, memory, analysis, workflow, github, daa, system)');\r\n  log('   Authentication: API Key + OAuth');\r\n  log('   Rate Limiting: 1000 req/min');\r\n  log('   WASM Support: Enabled with SIMD');\r\n\r\n  log('\\nüß† Neural Network Settings:');\r\n  log('   Models: 27 pre-trained models available');\r\n  log('   Training: Real-time adaptive learning');\r\n  log('   Inference: WASM optimized');\r\n  log('   Pattern Recognition: Enabled');\r\n\r\n  log('\\nüêù Swarm Configuration:');\r\n  log('   Max Agents: 10 per swarm');\r\n  log('   Topologies: hierarchical, mesh, ring, star');\r\n  log('   Coordination: Real-time with hooks');\r\n  log('   Memory: Cross-session persistence');\r\n\r\n  log('\\nüîê Security Settings:');\r\n  log('   TLS: Enabled in production');\r\n  log('   CORS: Configured for Claude Code');\r\n  log('   API Key Rotation: 30 days');\r\n  log('   Audit Logging: Enabled');\r\n\r\n  log('\\nüîó Integration Settings:');\r\n  log('   ruv-swarm Compatibility: 100%');\r\n  log('   DAA Integration: Enabled');\r\n  log('   GitHub Actions: Connected');\r\n  log('   SPARC Modes: 17 available');\r\n\r\n  log('\\nüìÅ Configuration Files:');\r\n  log('   Main Config: ./mcp_config/claude-flow.json');\r\n  log('   Neural Models: ./models/');\r\n  log('   Memory Store: ./memory/');\r\n  log('   Logs: ./logs/mcp/');\r\n}\r\n\r\nfunction getFlag(args, flagName) {\r\n  const index = args.indexOf(flagName);\r\n  return index !== -1 && index + 1 < args.length ? args[index + 1] : null;\r\n}\r\n\r\nfunction showMcpHelp() {\r\n  log('üîß Claude-Flow MCP Server Commands:');\r\n  log();\r\n  log('COMMANDS:');\r\n  log('  status                           Show MCP server status');\r\n  log('  start [options]                  Start MCP server with orchestrator');\r\n  log('  stop                             Stop MCP server gracefully');\r\n  log('  tools [options]                  List available tools & resources');\r\n  log('  auth <setup|status|rotate>       Manage authentication');\r\n  log('  config                           Show comprehensive configuration');\r\n  log();\r\n  log('START OPTIONS:');\r\n  log('  --port <port>                    Server port (default: 3000)');\r\n  log('  --host <host>                    Server host (default: localhost)');\r\n  log('  --auto-orchestrator              Auto-start orchestrator with neural/WASM');\r\n  log('  --daemon                         Run in background daemon mode');\r\n  log('  --enable-neural                  Enable neural network features');\r\n  log('  --enable-wasm                    Enable WASM SIMD optimization');\r\n  log();\r\n  log('TOOLS OPTIONS:');\r\n  log('  --category <cat>                 Filter by category (swarm, neural, memory, etc.)');\r\n  log('  --verbose, -v                    Show detailed tool information');\r\n  log('  --examples                       Show usage examples');\r\n  log();\r\n  log('CATEGORIES:');\r\n  log('  swarm        üêù Swarm coordination (12 tools)');\r\n  log('  neural       üß† Neural networks & AI (15 tools)');\r\n  log('  memory       üíæ Memory & persistence (12 tools)');\r\n  log('  analysis     üìä Analysis & monitoring (13 tools)');\r\n  log('  workflow     üîß Workflow & automation (11 tools)');\r\n  log('  github       üêô GitHub integration (8 tools)');\r\n  log('  daa          ü§ñ Dynamic Agent Architecture (8 tools)');\r\n  log('  system       ‚öôÔ∏è System & utilities (8 tools)');\r\n  log();\r\n  log('EXAMPLES:');\r\n  log('  claude-flow mcp status');\r\n  log('  claude-flow mcp start --auto-orchestrator --daemon');\r\n  log('  claude-flow mcp tools --category=neural --verbose');\r\n  log('  claude-flow mcp tools --category=swarm');\r\n  log('  claude-flow mcp config');\r\n  log('  claude-flow mcp auth setup');\r\n  log();\r\n  log('üéØ Total: 87 tools & resources available');\r\n  log('üîó Full ruv-swarm + DAA + Claude-Flow integration');\r\n}\r\n"],"names":["printSuccess","printError","printWarning","isStdioMode","log","args","console","error","success","msg","warning","mcpCommand","subArgs","flags","mcpCmd","showMcpStatus","startMcpServer","stopMcpServer","listMcpTools","manageMcpAuth","showMcpConfig","showMcpHelp","autoOrchestrator","includes","daemon","stdio","fileURLToPath","path","spawn","__filename","url","__dirname","dirname","mcpServerPath","join","fs","existsSync","process","cwd","Error","serverProcess","env","CLAUDE_FLOW_AUTO_ORCHESTRATOR","CLAUDE_FLOW_NEURAL_ENABLED","CLAUDE_FLOW_WASM_ENABLED","on","code","Promise","err","message","port","getFlag","host","verbose","category","authCmd","flagName","index","indexOf","length"],"mappings":"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"}