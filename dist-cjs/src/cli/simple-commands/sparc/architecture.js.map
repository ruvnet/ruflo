{"version":3,"sources":["../../../../../src/cli/simple-commands/sparc/architecture.js"],"sourcesContent":["// SPARC Architecture Phase\r\n// Design system architecture and component planning\r\n\r\nimport { SparcPhase } from './phase-base.js';\r\n\r\nexport class SparcArchitecture extends SparcPhase {\r\n  constructor(taskDescription, options) {\r\n    super('architecture', taskDescription, options);\r\n    this.components = [];\r\n    this.designPatterns = [];\r\n    this.systemDesign = null;\r\n    this.dataModel = null;\r\n    this.apiDesign = null;\r\n  }\r\n\r\n  /**\r\n   * Execute architecture phase\r\n   */\r\n  async execute() {\r\n    console.log('ðŸ—ï¸ Starting Architecture Phase');\r\n\r\n    await this.initializePhase();\r\n\r\n    const result = {\r\n      systemDesign: null,\r\n      components: [],\r\n      designPatterns: [],\r\n      dataModel: null,\r\n      apiDesign: null,\r\n      deploymentArchitecture: null,\r\n      securityArchitecture: null,\r\n      scalabilityPlan: null,\r\n      integrationPoints: [],\r\n      qualityAttributes: {},\r\n      architecturalDecisions: [],\r\n      riskAssessment: [],\r\n    };\r\n\r\n    try {\r\n      // Load previous phases\r\n      const specification = await this.retrieveFromMemory('specification_complete');\r\n      const pseudocode = await this.retrieveFromMemory('pseudocode_complete');\r\n\r\n      if (!specification || !pseudocode) {\r\n        throw new Error('Specification and Pseudocode phases must be completed first');\r\n      }\r\n\r\n      // Design system architecture\r\n      result.systemDesign = await this.designSystemArchitecture(specification, pseudocode);\r\n\r\n      // Define components\r\n      result.components = await this.defineComponents(specification, pseudocode);\r\n\r\n      // Select design patterns\r\n      result.designPatterns = await this.selectDesignPatterns(specification, pseudocode);\r\n\r\n      // Design data model\r\n      result.dataModel = await this.designDataModel(specification);\r\n\r\n      // Design API structure\r\n      result.apiDesign = await this.designApiStructure(specification);\r\n\r\n      // Plan deployment architecture\r\n      result.deploymentArchitecture = await this.planDeploymentArchitecture(specification);\r\n\r\n      // Design security architecture\r\n      result.securityArchitecture = await this.designSecurityArchitecture(specification);\r\n\r\n      // Plan scalability\r\n      result.scalabilityPlan = await this.planScalability(specification);\r\n\r\n      // Identify integration points\r\n      result.integrationPoints = await this.identifyIntegrationPoints(specification);\r\n\r\n      // Define quality attributes\r\n      result.qualityAttributes = await this.defineQualityAttributes(specification);\r\n\r\n      // Document architectural decisions\r\n      result.architecturalDecisions = await this.documentArchitecturalDecisions(result);\r\n\r\n      // Assess risks\r\n      result.riskAssessment = await this.assessArchitecturalRisks(result);\r\n\r\n      // Generate architecture document\r\n      await this.generateArchitectureDocument(result);\r\n\r\n      // Store in memory\r\n      await this.storeInMemory('architecture_complete', result);\r\n\r\n      console.log('âœ… Architecture phase completed');\r\n      return result;\r\n    } catch (error) {\r\n      console.error('âŒ Architecture phase failed:', error.message);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Design system architecture\r\n   */\r\n  async designSystemArchitecture(specification, pseudocode) {\r\n    const architecture = {\r\n      style: 'layered',\r\n      layers: [],\r\n      components: [],\r\n      dataFlow: [],\r\n      controlFlow: [],\r\n      boundaries: [],\r\n    };\r\n\r\n    // Determine architecture style based on requirements\r\n    const requirements = specification.requirements || [];\r\n    const hasApiRequirements = requirements.some((req) => req.toLowerCase().includes('api'));\r\n    const hasUiRequirements = requirements.some((req) => req.toLowerCase().includes('ui'));\r\n    const hasDataRequirements = requirements.some((req) => req.toLowerCase().includes('data'));\r\n    const hasDistributedRequirements = requirements.some(\r\n      (req) =>\r\n        req.toLowerCase().includes('distributed') || req.toLowerCase().includes('microservice'),\r\n    );\r\n\r\n    if (hasDistributedRequirements) {\r\n      architecture.style = 'microservices';\r\n      architecture.layers = [\r\n        { name: 'API Gateway', responsibility: 'Request routing and authentication' },\r\n        { name: 'Service Layer', responsibility: 'Business logic microservices' },\r\n        { name: 'Data Layer', responsibility: 'Database and storage services' },\r\n        { name: 'Infrastructure Layer', responsibility: 'Monitoring and deployment' },\r\n      ];\r\n    } else if (hasApiRequirements && hasUiRequirements) {\r\n      architecture.style = 'mvc';\r\n      architecture.layers = [\r\n        { name: 'Presentation Layer', responsibility: 'User interface and user experience' },\r\n        { name: 'Controller Layer', responsibility: 'Request handling and routing' },\r\n        { name: 'Service Layer', responsibility: 'Business logic and processing' },\r\n        { name: 'Data Access Layer', responsibility: 'Database operations' },\r\n        { name: 'Infrastructure Layer', responsibility: 'Cross-cutting concerns' },\r\n      ];\r\n    } else if (hasApiRequirements) {\r\n      architecture.style = 'layered';\r\n      architecture.layers = [\r\n        { name: 'API Layer', responsibility: 'External interface and contracts' },\r\n        { name: 'Business Layer', responsibility: 'Core business logic' },\r\n        { name: 'Data Layer', responsibility: 'Data persistence and retrieval' },\r\n        { name: 'Infrastructure Layer', responsibility: 'Logging, monitoring, security' },\r\n      ];\r\n    } else {\r\n      architecture.style = 'modular';\r\n      architecture.layers = [\r\n        { name: 'Interface Layer', responsibility: 'External interactions' },\r\n        { name: 'Processing Layer', responsibility: 'Core processing logic' },\r\n        { name: 'Storage Layer', responsibility: 'Data management' },\r\n        { name: 'Utility Layer', responsibility: 'Common utilities and helpers' },\r\n      ];\r\n    }\r\n\r\n    // Define data flow\r\n    architecture.dataFlow = this.defineDataFlow(architecture.layers);\r\n\r\n    // Define control flow\r\n    architecture.controlFlow = this.defineControlFlow(architecture.layers);\r\n\r\n    // Define boundaries\r\n    architecture.boundaries = this.defineBoundaries(architecture.layers);\r\n\r\n    return architecture;\r\n  }\r\n\r\n  /**\r\n   * Define data flow\r\n   */\r\n  defineDataFlow(layers) {\r\n    const dataFlow = [];\r\n\r\n    for (let i = 0; i < layers.length - 1; i++) {\r\n      dataFlow.push({\r\n        from: layers[i].name,\r\n        to: layers[i + 1].name,\r\n        direction: 'downstream',\r\n        dataType: 'processed data',\r\n      });\r\n\r\n      dataFlow.push({\r\n        from: layers[i + 1].name,\r\n        to: layers[i].name,\r\n        direction: 'upstream',\r\n        dataType: 'results/responses',\r\n      });\r\n    }\r\n\r\n    return dataFlow;\r\n  }\r\n\r\n  /**\r\n   * Define control flow\r\n   */\r\n  defineControlFlow(layers) {\r\n    return layers.map((layer, index) => ({\r\n      layer: layer.name,\r\n      order: index + 1,\r\n      triggers: index === 0 ? ['external request'] : [`${layers[index - 1].name} completion`],\r\n      actions: ['process', 'validate', 'transform', 'forward'],\r\n      outcomes:\r\n        index === layers.length - 1 ? ['final response'] : [`trigger ${layers[index + 1].name}`],\r\n    }));\r\n  }\r\n\r\n  /**\r\n   * Define boundaries\r\n   */\r\n  defineBoundaries(layers) {\r\n    return layers.map((layer) => ({\r\n      layer: layer.name,\r\n      type: 'logical',\r\n      encapsulation: 'interface-based',\r\n      dependencies: 'unidirectional',\r\n      contracts: 'well-defined APIs',\r\n    }));\r\n  }\r\n\r\n  /**\r\n   * Define components\r\n   */\r\n  async defineComponents(specification, pseudocode) {\r\n    const components = [];\r\n    const requirements = specification.requirements || [];\r\n    const functions = pseudocode.pseudocode || [];\r\n\r\n    // Create components based on functional requirements\r\n    for (const requirement of requirements) {\r\n      const component = this.createComponentFromRequirement(requirement);\r\n      components.push(component);\r\n    }\r\n\r\n    // Create components based on pseudocode functions\r\n    for (const func of functions) {\r\n      const component = this.createComponentFromFunction(func);\r\n      components.push(component);\r\n    }\r\n\r\n    // Add infrastructure components\r\n    components.push(...this.createInfrastructureComponents());\r\n\r\n    // Remove duplicates and merge similar components\r\n    const uniqueComponents = this.mergeComponents(components);\r\n\r\n    return uniqueComponents;\r\n  }\r\n\r\n  /**\r\n   * Create component from requirement\r\n   */\r\n  createComponentFromRequirement(requirement) {\r\n    const reqLower = requirement.toLowerCase();\r\n\r\n    if (reqLower.includes('api')) {\r\n      return {\r\n        name: 'APIController',\r\n        type: 'controller',\r\n        responsibility: 'Handle API requests and responses',\r\n        interfaces: ['HTTP', 'REST'],\r\n        dependencies: ['AuthenticationService', 'ValidationService'],\r\n        patterns: ['Controller', 'Facade'],\r\n        complexity: 'medium',\r\n      };\r\n    } else if (reqLower.includes('authenticate')) {\r\n      return {\r\n        name: 'AuthenticationService',\r\n        type: 'service',\r\n        responsibility: 'Manage user authentication and authorization',\r\n        interfaces: ['IAuthenticationService'],\r\n        dependencies: ['UserRepository', 'TokenManager'],\r\n        patterns: ['Service', 'Strategy'],\r\n        complexity: 'high',\r\n      };\r\n    } else if (reqLower.includes('data')) {\r\n      return {\r\n        name: 'DataRepository',\r\n        type: 'repository',\r\n        responsibility: 'Manage data persistence and retrieval',\r\n        interfaces: ['IRepository'],\r\n        dependencies: ['DatabaseConnection', 'DataMapper'],\r\n        patterns: ['Repository', 'Unit of Work'],\r\n        complexity: 'medium',\r\n      };\r\n    } else if (reqLower.includes('validate')) {\r\n      return {\r\n        name: 'ValidationService',\r\n        type: 'service',\r\n        responsibility: 'Validate input data and business rules',\r\n        interfaces: ['IValidationService'],\r\n        dependencies: ['ValidationRules', 'ErrorHandler'],\r\n        patterns: ['Strategy', 'Chain of Responsibility'],\r\n        complexity: 'low',\r\n      };\r\n    } else {\r\n      return {\r\n        name: 'GenericService',\r\n        type: 'service',\r\n        responsibility: 'Handle general business logic',\r\n        interfaces: ['IService'],\r\n        dependencies: ['CommonUtilities'],\r\n        patterns: ['Service'],\r\n        complexity: 'low',\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create component from function\r\n   */\r\n  createComponentFromFunction(func) {\r\n    return {\r\n      name: this.toPascalCase(func.function) + 'Component',\r\n      type: 'component',\r\n      responsibility: func.description,\r\n      interfaces: [`I${this.toPascalCase(func.function)}`],\r\n      dependencies: this.extractDependencies(func.steps),\r\n      patterns: this.inferPatterns(func.steps),\r\n      complexity: func.complexity ? func.complexity.level : 'medium',\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Create infrastructure components\r\n   */\r\n  createInfrastructureComponents() {\r\n    return [\r\n      {\r\n        name: 'Logger',\r\n        type: 'utility',\r\n        responsibility: 'Centralized logging and monitoring',\r\n        interfaces: ['ILogger'],\r\n        dependencies: ['LoggingProvider'],\r\n        patterns: ['Singleton', 'Factory'],\r\n        complexity: 'low',\r\n      },\r\n      {\r\n        name: 'ConfigurationManager',\r\n        type: 'utility',\r\n        responsibility: 'Manage application configuration',\r\n        interfaces: ['IConfigurationManager'],\r\n        dependencies: ['EnvironmentProvider'],\r\n        patterns: ['Singleton'],\r\n        complexity: 'low',\r\n      },\r\n      {\r\n        name: 'ErrorHandler',\r\n        type: 'utility',\r\n        responsibility: 'Global error handling and reporting',\r\n        interfaces: ['IErrorHandler'],\r\n        dependencies: ['Logger'],\r\n        patterns: ['Strategy', 'Chain of Responsibility'],\r\n        complexity: 'medium',\r\n      },\r\n      {\r\n        name: 'CacheManager',\r\n        type: 'utility',\r\n        responsibility: 'Caching and performance optimization',\r\n        interfaces: ['ICacheManager'],\r\n        dependencies: ['CacheProvider'],\r\n        patterns: ['Proxy', 'Decorator'],\r\n        complexity: 'medium',\r\n      },\r\n    ];\r\n  }\r\n\r\n  /**\r\n   * Merge similar components\r\n   */\r\n  mergeComponents(components) {\r\n    const componentMap = new Map();\r\n\r\n    for (const component of components) {\r\n      const key = component.name;\r\n\r\n      if (componentMap.has(key)) {\r\n        const existing = componentMap.get(key);\r\n        // Merge dependencies and interfaces\r\n        existing.dependencies = [...new Set([...existing.dependencies, ...component.dependencies])];\r\n        existing.interfaces = [...new Set([...existing.interfaces, ...component.interfaces])];\r\n        existing.patterns = [...new Set([...existing.patterns, ...component.patterns])];\r\n      } else {\r\n        componentMap.set(key, component);\r\n      }\r\n    }\r\n\r\n    return Array.from(componentMap.values());\r\n  }\r\n\r\n  /**\r\n   * Convert to PascalCase\r\n   */\r\n  toPascalCase(str) {\r\n    return str\r\n      .replace(/_([a-z])/g, (match, letter) => letter.toUpperCase())\r\n      .replace(/^([a-z])/, (match, letter) => letter.toUpperCase());\r\n  }\r\n\r\n  /**\r\n   * Extract dependencies from steps\r\n   */\r\n  extractDependencies(steps) {\r\n    const dependencies = [];\r\n\r\n    for (const step of steps) {\r\n      if (step.includes('database')) dependencies.push('DatabaseConnection');\r\n      if (step.includes('authenticate')) dependencies.push('AuthenticationService');\r\n      if (step.includes('validate')) dependencies.push('ValidationService');\r\n      if (step.includes('log')) dependencies.push('Logger');\r\n      if (step.includes('cache')) dependencies.push('CacheManager');\r\n    }\r\n\r\n    return [...new Set(dependencies)];\r\n  }\r\n\r\n  /**\r\n   * Infer patterns from steps\r\n   */\r\n  inferPatterns(steps) {\r\n    const patterns = [];\r\n\r\n    if (steps.some((step) => step.includes('CALL'))) patterns.push('Command');\r\n    if (steps.some((step) => step.includes('IF'))) patterns.push('Strategy');\r\n    if (steps.some((step) => step.includes('VALIDATE'))) patterns.push('Chain of Responsibility');\r\n    if (steps.some((step) => step.includes('RETURN'))) patterns.push('Factory');\r\n\r\n    return patterns.length > 0 ? patterns : ['Service'];\r\n  }\r\n\r\n  /**\r\n   * Select design patterns\r\n   */\r\n  async selectDesignPatterns(specification, pseudocode) {\r\n    const patterns = [];\r\n    const requirements = specification.requirements || [];\r\n\r\n    // Creational patterns\r\n    if (\r\n      requirements.some(\r\n        (req) => req.toLowerCase().includes('create') || req.toLowerCase().includes('instantiate'),\r\n      )\r\n    ) {\r\n      patterns.push({\r\n        name: 'Factory Pattern',\r\n        type: 'creational',\r\n        purpose: 'Create objects without specifying exact classes',\r\n        applicability: 'Object creation with varying configurations',\r\n        implementation: 'Factory classes with creation methods',\r\n        benefits: ['Loose coupling', 'Easy extensibility', 'Centralized creation logic'],\r\n      });\r\n    }\r\n\r\n    // Structural patterns\r\n    if (\r\n      requirements.some(\r\n        (req) => req.toLowerCase().includes('interface') || req.toLowerCase().includes('adapt'),\r\n      )\r\n    ) {\r\n      patterns.push({\r\n        name: 'Adapter Pattern',\r\n        type: 'structural',\r\n        purpose: 'Allow incompatible interfaces to work together',\r\n        applicability: 'Integration with external systems',\r\n        implementation: 'Wrapper classes implementing target interfaces',\r\n        benefits: ['Code reuse', 'Separation of concerns', 'Easy integration'],\r\n      });\r\n    }\r\n\r\n    // Behavioral patterns\r\n    if (\r\n      requirements.some(\r\n        (req) => req.toLowerCase().includes('strategy') || req.toLowerCase().includes('algorithm'),\r\n      )\r\n    ) {\r\n      patterns.push({\r\n        name: 'Strategy Pattern',\r\n        type: 'behavioral',\r\n        purpose: 'Define family of algorithms and make them interchangeable',\r\n        applicability: 'Multiple ways to perform operations',\r\n        implementation: 'Strategy interfaces with concrete implementations',\r\n        benefits: ['Flexibility', 'Open/closed principle', 'Runtime selection'],\r\n      });\r\n    }\r\n\r\n    // Common patterns for all systems\r\n    patterns.push({\r\n      name: 'Repository Pattern',\r\n      type: 'architectural',\r\n      purpose: 'Separate data access logic from business logic',\r\n      applicability: 'Data persistence operations',\r\n      implementation: 'Repository interfaces with concrete implementations',\r\n      benefits: ['Testability', 'Loose coupling', 'Centralized data access'],\r\n    });\r\n\r\n    patterns.push({\r\n      name: 'Dependency Injection',\r\n      type: 'architectural',\r\n      purpose: 'Manage dependencies between objects',\r\n      applicability: 'All components requiring external dependencies',\r\n      implementation: 'Constructor injection with DI container',\r\n      benefits: ['Testability', 'Loose coupling', 'Flexibility'],\r\n    });\r\n\r\n    patterns.push({\r\n      name: 'Observer Pattern',\r\n      type: 'behavioral',\r\n      purpose: 'Notify multiple objects about state changes',\r\n      applicability: 'Event-driven communication',\r\n      implementation: 'Subject-observer relationships with event notifications',\r\n      benefits: ['Loose coupling', 'Dynamic relationships', 'Broadcast communication'],\r\n    });\r\n\r\n    return patterns;\r\n  }\r\n\r\n  /**\r\n   * Design data model\r\n   */\r\n  async designDataModel(specification) {\r\n    const dataModel = {\r\n      entities: [],\r\n      relationships: [],\r\n      constraints: [],\r\n      indexes: [],\r\n      views: [],\r\n    };\r\n\r\n    // Extract entities from requirements\r\n    const requirements = specification.requirements || [];\r\n    const entities = this.extractEntities(requirements);\r\n\r\n    for (const entityName of entities) {\r\n      const entity = {\r\n        name: entityName,\r\n        attributes: this.generateAttributes(entityName),\r\n        primaryKey: 'id',\r\n        foreignKeys: [],\r\n        constraints: this.generateConstraints(entityName),\r\n        indexes: this.generateIndexes(entityName),\r\n      };\r\n\r\n      dataModel.entities.push(entity);\r\n    }\r\n\r\n    // Define relationships\r\n    dataModel.relationships = this.defineRelationships(dataModel.entities);\r\n\r\n    // Define global constraints\r\n    dataModel.constraints = this.defineGlobalConstraints();\r\n\r\n    // Define indexes\r\n    dataModel.indexes = this.defineGlobalIndexes(dataModel.entities);\r\n\r\n    // Define views\r\n    dataModel.views = this.defineViews(dataModel.entities);\r\n\r\n    return dataModel;\r\n  }\r\n\r\n  /**\r\n   * Extract entities from requirements\r\n   */\r\n  extractEntities(requirements) {\r\n    const entities = new Set();\r\n\r\n    for (const requirement of requirements) {\r\n      const words = requirement.split(' ');\r\n\r\n      for (const word of words) {\r\n        // Look for nouns that could be entities\r\n        if (\r\n          word.length > 3 &&\r\n          !['system', 'must', 'should', 'will', 'data', 'user', 'interface'].includes(\r\n            word.toLowerCase(),\r\n          )\r\n        ) {\r\n          if (word[0] === word[0].toUpperCase()) {\r\n            entities.add(word);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // Add default entities if none found\r\n    if (entities.size === 0) {\r\n      entities.add('User');\r\n      entities.add('Session');\r\n      entities.add('Configuration');\r\n    }\r\n\r\n    return Array.from(entities);\r\n  }\r\n\r\n  /**\r\n   * Generate attributes for entity\r\n   */\r\n  generateAttributes(entityName) {\r\n    const commonAttributes = [\r\n      { name: 'id', type: 'UUID', nullable: false, unique: true },\r\n      { name: 'created_at', type: 'TIMESTAMP', nullable: false, default: 'CURRENT_TIMESTAMP' },\r\n      { name: 'updated_at', type: 'TIMESTAMP', nullable: false, default: 'CURRENT_TIMESTAMP' },\r\n      { name: 'version', type: 'INTEGER', nullable: false, default: '1' },\r\n    ];\r\n\r\n    const specificAttributes = [];\r\n    const entityLower = entityName.toLowerCase();\r\n\r\n    if (entityLower.includes('user')) {\r\n      specificAttributes.push(\r\n        { name: 'username', type: 'VARCHAR(50)', nullable: false, unique: true },\r\n        { name: 'email', type: 'VARCHAR(255)', nullable: false, unique: true },\r\n        { name: 'password_hash', type: 'VARCHAR(255)', nullable: false },\r\n        { name: 'is_active', type: 'BOOLEAN', nullable: false, default: 'true' },\r\n        { name: 'last_login', type: 'TIMESTAMP', nullable: true },\r\n      );\r\n    } else if (entityLower.includes('session')) {\r\n      specificAttributes.push(\r\n        { name: 'user_id', type: 'UUID', nullable: false },\r\n        { name: 'token', type: 'VARCHAR(255)', nullable: false, unique: true },\r\n        { name: 'expires_at', type: 'TIMESTAMP', nullable: false },\r\n        { name: 'ip_address', type: 'INET', nullable: true },\r\n        { name: 'user_agent', type: 'TEXT', nullable: true },\r\n      );\r\n    } else {\r\n      specificAttributes.push(\r\n        { name: 'name', type: 'VARCHAR(255)', nullable: false },\r\n        { name: 'description', type: 'TEXT', nullable: true },\r\n        { name: 'status', type: 'VARCHAR(50)', nullable: false, default: \"'active'\" },\r\n      );\r\n    }\r\n\r\n    return [...commonAttributes, ...specificAttributes];\r\n  }\r\n\r\n  /**\r\n   * Generate constraints for entity\r\n   */\r\n  generateConstraints(entityName) {\r\n    const constraints = [\r\n      { name: `${entityName.toLowerCase()}_id_pk`, type: 'PRIMARY KEY', column: 'id' },\r\n      {\r\n        name: `${entityName.toLowerCase()}_version_positive`,\r\n        type: 'CHECK',\r\n        condition: 'version > 0',\r\n      },\r\n      {\r\n        name: `${entityName.toLowerCase()}_created_before_updated`,\r\n        type: 'CHECK',\r\n        condition: 'created_at <= updated_at',\r\n      },\r\n    ];\r\n\r\n    const entityLower = entityName.toLowerCase();\r\n\r\n    if (entityLower.includes('user')) {\r\n      constraints.push(\r\n        {\r\n          name: 'user_email_format',\r\n          type: 'CHECK',\r\n          condition: \"email ~* '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\\\.[A-Za-z]{2,}$'\",\r\n        },\r\n        { name: 'user_username_length', type: 'CHECK', condition: 'length(username) >= 3' },\r\n      );\r\n    }\r\n\r\n    return constraints;\r\n  }\r\n\r\n  /**\r\n   * Generate indexes for entity\r\n   */\r\n  generateIndexes(entityName) {\r\n    const indexes = [\r\n      {\r\n        name: `idx_${entityName.toLowerCase()}_created_at`,\r\n        type: 'BTREE',\r\n        columns: ['created_at'],\r\n      },\r\n      {\r\n        name: `idx_${entityName.toLowerCase()}_updated_at`,\r\n        type: 'BTREE',\r\n        columns: ['updated_at'],\r\n      },\r\n    ];\r\n\r\n    const entityLower = entityName.toLowerCase();\r\n\r\n    if (entityLower.includes('user')) {\r\n      indexes.push(\r\n        { name: 'idx_user_email', type: 'BTREE', columns: ['email'] },\r\n        { name: 'idx_user_username', type: 'BTREE', columns: ['username'] },\r\n        { name: 'idx_user_active', type: 'BTREE', columns: ['is_active'] },\r\n      );\r\n    }\r\n\r\n    return indexes;\r\n  }\r\n\r\n  /**\r\n   * Define relationships between entities\r\n   */\r\n  defineRelationships(entities) {\r\n    const relationships = [];\r\n\r\n    // Look for entities that could have relationships\r\n    const userEntity = entities.find((e) => e.name.toLowerCase().includes('user'));\r\n    const sessionEntity = entities.find((e) => e.name.toLowerCase().includes('session'));\r\n\r\n    if (userEntity && sessionEntity) {\r\n      relationships.push({\r\n        name: 'user_sessions',\r\n        type: 'one-to-many',\r\n        parent: userEntity.name,\r\n        child: sessionEntity.name,\r\n        parentKey: 'id',\r\n        childKey: 'user_id',\r\n        onDelete: 'CASCADE',\r\n        onUpdate: 'RESTRICT',\r\n      });\r\n    }\r\n\r\n    return relationships;\r\n  }\r\n\r\n  /**\r\n   * Define global constraints\r\n   */\r\n  defineGlobalConstraints() {\r\n    return [\r\n      { name: 'no_future_created_at', type: 'CHECK', condition: 'created_at <= CURRENT_TIMESTAMP' },\r\n      { name: 'no_future_updated_at', type: 'CHECK', condition: 'updated_at <= CURRENT_TIMESTAMP' },\r\n    ];\r\n  }\r\n\r\n  /**\r\n   * Define global indexes\r\n   */\r\n  defineGlobalIndexes(entities) {\r\n    const indexes = [];\r\n\r\n    // Add composite indexes for common query patterns\r\n    for (const entity of entities) {\r\n      indexes.push({\r\n        name: `idx_${entity.name.toLowerCase()}_status_created`,\r\n        type: 'BTREE',\r\n        table: entity.name,\r\n        columns: ['status', 'created_at'],\r\n      });\r\n    }\r\n\r\n    return indexes;\r\n  }\r\n\r\n  /**\r\n   * Define views\r\n   */\r\n  defineViews(entities) {\r\n    const views = [];\r\n\r\n    // Create a view for active entities\r\n    for (const entity of entities) {\r\n      if (entity.attributes.some((attr) => attr.name === 'is_active' || attr.name === 'status')) {\r\n        views.push({\r\n          name: `active_${entity.name.toLowerCase()}s`,\r\n          definition: `SELECT * FROM ${entity.name} WHERE ${entity.attributes.some((attr) => attr.name === 'is_active') ? 'is_active = true' : \"status = 'active'\"}`,\r\n          purpose: `Show only active ${entity.name.toLowerCase()} records`,\r\n        });\r\n      }\r\n    }\r\n\r\n    return views;\r\n  }\r\n\r\n  /**\r\n   * Design API structure\r\n   */\r\n  async designApiStructure(specification) {\r\n    const apiDesign = {\r\n      version: 'v1',\r\n      baseUrl: '/api/v1',\r\n      authentication: 'Bearer Token',\r\n      endpoints: [],\r\n      schemas: [],\r\n      errorHandling: {},\r\n      rateLimiting: {},\r\n      versioning: {},\r\n    };\r\n\r\n    // Generate endpoints based on requirements\r\n    const requirements = specification.requirements || [];\r\n\r\n    for (const requirement of requirements) {\r\n      if (requirement.toLowerCase().includes('api')) {\r\n        const endpoints = this.generateEndpoints(requirement);\r\n        apiDesign.endpoints.push(...endpoints);\r\n      }\r\n    }\r\n\r\n    // Generate schemas\r\n    apiDesign.schemas = this.generateApiSchemas(apiDesign.endpoints);\r\n\r\n    // Define error handling\r\n    apiDesign.errorHandling = this.defineApiErrorHandling();\r\n\r\n    // Define rate limiting\r\n    apiDesign.rateLimiting = this.defineApiRateLimiting();\r\n\r\n    // Define versioning strategy\r\n    apiDesign.versioning = this.defineApiVersioning();\r\n\r\n    return apiDesign;\r\n  }\r\n\r\n  /**\r\n   * Generate endpoints from requirement\r\n   */\r\n  generateEndpoints(requirement) {\r\n    const endpoints = [];\r\n\r\n    // Basic CRUD endpoints\r\n    endpoints.push(\r\n      {\r\n        path: '/resources',\r\n        method: 'GET',\r\n        summary: 'List all resources',\r\n        parameters: [\r\n          { name: 'page', type: 'integer', description: 'Page number' },\r\n          { name: 'limit', type: 'integer', description: 'Items per page' },\r\n          { name: 'sort', type: 'string', description: 'Sort field' },\r\n        ],\r\n        responses: {\r\n          200: { description: 'Success', schema: 'ResourceList' },\r\n          400: { description: 'Bad Request', schema: 'Error' },\r\n          401: { description: 'Unauthorized', schema: 'Error' },\r\n        },\r\n      },\r\n      {\r\n        path: '/resources/{id}',\r\n        method: 'GET',\r\n        summary: 'Get resource by ID',\r\n        parameters: [{ name: 'id', type: 'string', description: 'Resource ID', required: true }],\r\n        responses: {\r\n          200: { description: 'Success', schema: 'Resource' },\r\n          404: { description: 'Not Found', schema: 'Error' },\r\n          401: { description: 'Unauthorized', schema: 'Error' },\r\n        },\r\n      },\r\n      {\r\n        path: '/resources',\r\n        method: 'POST',\r\n        summary: 'Create new resource',\r\n        requestBody: { schema: 'CreateResourceRequest' },\r\n        responses: {\r\n          201: { description: 'Created', schema: 'Resource' },\r\n          400: { description: 'Bad Request', schema: 'Error' },\r\n          401: { description: 'Unauthorized', schema: 'Error' },\r\n        },\r\n      },\r\n      {\r\n        path: '/resources/{id}',\r\n        method: 'PUT',\r\n        summary: 'Update resource',\r\n        parameters: [{ name: 'id', type: 'string', description: 'Resource ID', required: true }],\r\n        requestBody: { schema: 'UpdateResourceRequest' },\r\n        responses: {\r\n          200: { description: 'Updated', schema: 'Resource' },\r\n          404: { description: 'Not Found', schema: 'Error' },\r\n          400: { description: 'Bad Request', schema: 'Error' },\r\n          401: { description: 'Unauthorized', schema: 'Error' },\r\n        },\r\n      },\r\n      {\r\n        path: '/resources/{id}',\r\n        method: 'DELETE',\r\n        summary: 'Delete resource',\r\n        parameters: [{ name: 'id', type: 'string', description: 'Resource ID', required: true }],\r\n        responses: {\r\n          204: { description: 'Deleted' },\r\n          404: { description: 'Not Found', schema: 'Error' },\r\n          401: { description: 'Unauthorized', schema: 'Error' },\r\n        },\r\n      },\r\n    );\r\n\r\n    return endpoints;\r\n  }\r\n\r\n  /**\r\n   * Generate API schemas\r\n   */\r\n  generateApiSchemas(endpoints) {\r\n    const schemas = [];\r\n\r\n    // Basic resource schema\r\n    schemas.push({\r\n      name: 'Resource',\r\n      type: 'object',\r\n      properties: {\r\n        id: { type: 'string', format: 'uuid' },\r\n        name: { type: 'string' },\r\n        description: { type: 'string' },\r\n        status: { type: 'string', enum: ['active', 'inactive'] },\r\n        created_at: { type: 'string', format: 'date-time' },\r\n        updated_at: { type: 'string', format: 'date-time' },\r\n      },\r\n      required: ['id', 'name', 'status'],\r\n    });\r\n\r\n    // Resource list schema\r\n    schemas.push({\r\n      name: 'ResourceList',\r\n      type: 'object',\r\n      properties: {\r\n        data: { type: 'array', items: { $ref: '#/schemas/Resource' } },\r\n        pagination: {\r\n          type: 'object',\r\n          properties: {\r\n            page: { type: 'integer' },\r\n            limit: { type: 'integer' },\r\n            total: { type: 'integer' },\r\n            pages: { type: 'integer' },\r\n          },\r\n        },\r\n      },\r\n    });\r\n\r\n    // Error schema\r\n    schemas.push({\r\n      name: 'Error',\r\n      type: 'object',\r\n      properties: {\r\n        error: { type: 'string' },\r\n        message: { type: 'string' },\r\n        details: { type: 'array', items: { type: 'string' } },\r\n        timestamp: { type: 'string', format: 'date-time' },\r\n      },\r\n      required: ['error', 'message'],\r\n    });\r\n\r\n    return schemas;\r\n  }\r\n\r\n  /**\r\n   * Define API error handling\r\n   */\r\n  defineApiErrorHandling() {\r\n    return {\r\n      strategy: 'Consistent error responses with proper HTTP status codes',\r\n      errorCodes: {\r\n        400: 'Bad Request - Invalid input data',\r\n        401: 'Unauthorized - Authentication required',\r\n        403: 'Forbidden - Insufficient permissions',\r\n        404: 'Not Found - Resource not found',\r\n        409: 'Conflict - Resource already exists',\r\n        422: 'Unprocessable Entity - Validation errors',\r\n        429: 'Too Many Requests - Rate limit exceeded',\r\n        500: 'Internal Server Error - Server error',\r\n        503: 'Service Unavailable - Service temporarily unavailable',\r\n      },\r\n      errorFormat: {\r\n        error: 'Error type',\r\n        message: 'Human-readable error message',\r\n        details: 'Array of specific error details',\r\n        timestamp: 'ISO 8601 timestamp',\r\n      },\r\n      logging: 'All errors logged with request ID and stack trace',\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Define API rate limiting\r\n   */\r\n  defineApiRateLimiting() {\r\n    return {\r\n      strategy: 'Token bucket algorithm with per-user and per-IP limits',\r\n      limits: {\r\n        authenticated: { requests: 1000, window: '1 hour' },\r\n        anonymous: { requests: 100, window: '1 hour' },\r\n        burst: { requests: 10, window: '1 minute' },\r\n      },\r\n      headers: {\r\n        'X-RateLimit-Limit': 'Request limit for current window',\r\n        'X-RateLimit-Remaining': 'Remaining requests in current window',\r\n        'X-RateLimit-Reset': 'Unix timestamp when limit resets',\r\n      },\r\n      handling: 'Return 429 status with retry-after header',\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Define API versioning\r\n   */\r\n  defineApiVersioning() {\r\n    return {\r\n      strategy: 'URL path versioning with backward compatibility',\r\n      format: '/api/v{major}',\r\n      lifecycle: {\r\n        development: 'Active development with breaking changes',\r\n        stable: 'Stable API with backward compatibility',\r\n        deprecated: 'Deprecated with migration guide',\r\n        retired: 'No longer supported',\r\n      },\r\n      migration: 'Gradual migration with parallel support periods',\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Plan deployment architecture\r\n   */\r\n  async planDeploymentArchitecture(specification) {\r\n    const deployment = {\r\n      strategy: 'containerized',\r\n      environments: [],\r\n      infrastructure: {},\r\n      monitoring: {},\r\n      security: {},\r\n      scalability: {},\r\n    };\r\n\r\n    // Define environments\r\n    deployment.environments = [\r\n      {\r\n        name: 'development',\r\n        purpose: 'Development and testing',\r\n        resources: 'Single node with shared resources',\r\n        database: 'SQLite or embedded database',\r\n        monitoring: 'Basic logging',\r\n      },\r\n      {\r\n        name: 'staging',\r\n        purpose: 'Pre-production testing',\r\n        resources: 'Production-like environment with reduced capacity',\r\n        database: 'Managed database service',\r\n        monitoring: 'Full monitoring stack',\r\n      },\r\n      {\r\n        name: 'production',\r\n        purpose: 'Live application serving users',\r\n        resources: 'Multiple nodes with load balancing',\r\n        database: 'High-availability managed database',\r\n        monitoring: 'Comprehensive monitoring and alerting',\r\n      },\r\n    ];\r\n\r\n    // Define infrastructure\r\n    deployment.infrastructure = {\r\n      platform: 'Container orchestration (Kubernetes/Docker Swarm)',\r\n      compute: 'Auto-scaling container instances',\r\n      storage: 'Persistent volumes with backup',\r\n      networking: 'Load balancer with SSL termination',\r\n      dns: 'Managed DNS with health checks',\r\n    };\r\n\r\n    // Define monitoring\r\n    deployment.monitoring = {\r\n      metrics: 'Application and infrastructure metrics',\r\n      logging: 'Centralized logging with log aggregation',\r\n      tracing: 'Distributed tracing for request flow',\r\n      alerting: 'Multi-channel alerting for critical issues',\r\n      dashboards: 'Real-time dashboards for system health',\r\n    };\r\n\r\n    // Define security\r\n    deployment.security = {\r\n      secrets: 'Encrypted secrets management',\r\n      network: 'Network policies and firewall rules',\r\n      access: 'Role-based access control',\r\n      scanning: 'Container and dependency vulnerability scanning',\r\n      compliance: 'Security compliance monitoring',\r\n    };\r\n\r\n    // Define scalability\r\n    deployment.scalability = {\r\n      horizontal: 'Auto-scaling based on CPU/memory/requests',\r\n      vertical: 'Resource limits and requests optimization',\r\n      database: 'Database scaling with read replicas',\r\n      caching: 'Multi-layer caching strategy',\r\n      cdn: 'Content delivery network for static assets',\r\n    };\r\n\r\n    return deployment;\r\n  }\r\n\r\n  /**\r\n   * Design security architecture\r\n   */\r\n  async designSecurityArchitecture(specification) {\r\n    const security = {\r\n      authentication: {},\r\n      authorization: {},\r\n      dataProtection: {},\r\n      networkSecurity: {},\r\n      monitoring: {},\r\n      compliance: {},\r\n    };\r\n\r\n    // Authentication design\r\n    security.authentication = {\r\n      mechanism: 'JWT tokens with refresh token rotation',\r\n      providers: ['Local credentials', 'OAuth2/OpenID Connect'],\r\n      session: 'Stateless with secure token storage',\r\n      mfa: 'Multi-factor authentication for sensitive operations',\r\n      passwordPolicy: 'Strong password requirements with complexity rules',\r\n    };\r\n\r\n    // Authorization design\r\n    security.authorization = {\r\n      model: 'Role-based access control (RBAC)',\r\n      permissions: 'Fine-grained permissions with resource-level access',\r\n      policies: 'Attribute-based access control for complex rules',\r\n      delegation: 'Secure delegation with time-limited tokens',\r\n      auditing: 'Complete audit trail of access decisions',\r\n    };\r\n\r\n    // Data protection design\r\n    security.dataProtection = {\r\n      encryption: {\r\n        atRest: 'AES-256 encryption for stored data',\r\n        inTransit: 'TLS 1.3 for all network communication',\r\n        keys: 'Hardware security module or managed key service',\r\n      },\r\n      privacy: {\r\n        pii: 'Personal information identification and protection',\r\n        anonymization: 'Data anonymization for analytics',\r\n        retention: 'Data retention policies with automatic deletion',\r\n      },\r\n      backup: {\r\n        encryption: 'Encrypted backups with separate key management',\r\n        testing: 'Regular backup restoration testing',\r\n        offsite: 'Geographically distributed backup storage',\r\n      },\r\n    };\r\n\r\n    // Network security design\r\n    security.networkSecurity = {\r\n      firewall: 'Web application firewall with DDoS protection',\r\n      segmentation: 'Network segmentation with micro-segmentation',\r\n      monitoring: 'Network traffic monitoring and analysis',\r\n      vpn: 'VPN access for administrative operations',\r\n      certificates: 'Automated certificate management and renewal',\r\n    };\r\n\r\n    // Security monitoring design\r\n    security.monitoring = {\r\n      siem: 'Security information and event management',\r\n      ids: 'Intrusion detection and prevention systems',\r\n      behavior: 'User and entity behavior analytics',\r\n      threat: 'Threat intelligence integration',\r\n      incident: 'Automated incident response workflows',\r\n    };\r\n\r\n    // Compliance design\r\n    security.compliance = {\r\n      frameworks: ['GDPR', 'SOC 2', 'ISO 27001'],\r\n      auditing: 'Regular security audits and penetration testing',\r\n      documentation: 'Security policies and procedures documentation',\r\n      training: 'Security awareness training for all personnel',\r\n      reporting: 'Compliance reporting and evidence collection',\r\n    };\r\n\r\n    return security;\r\n  }\r\n\r\n  /**\r\n   * Plan scalability\r\n   */\r\n  async planScalability(specification) {\r\n    const scalability = {\r\n      horizontalScaling: {},\r\n      verticalScaling: {},\r\n      dataScaling: {},\r\n      performanceOptimization: {},\r\n      monitoring: {},\r\n    };\r\n\r\n    // Horizontal scaling plan\r\n    scalability.horizontalScaling = {\r\n      strategy: 'Auto-scaling based on demand metrics',\r\n      triggers: ['CPU utilization > 70%', 'Memory utilization > 80%', 'Request queue length > 10'],\r\n      limits: { minimum: 2, maximum: 20, scaleUpRate: 2, scaleDownRate: 1 },\r\n      loadBalancing: 'Round-robin with health checks',\r\n      sessionAffinity: 'Stateless design with external session storage',\r\n    };\r\n\r\n    // Vertical scaling plan\r\n    scalability.verticalScaling = {\r\n      strategy: 'Resource optimization based on usage patterns',\r\n      monitoring: 'Continuous resource utilization monitoring',\r\n      recommendations: 'Automated resource recommendation engine',\r\n      limits: 'Resource limits to prevent resource exhaustion',\r\n      optimization: 'Container resource optimization',\r\n    };\r\n\r\n    // Data scaling plan\r\n    scalability.dataScaling = {\r\n      database: {\r\n        readReplicas: 'Read replicas for read-heavy workloads',\r\n        sharding: 'Database sharding for large datasets',\r\n        caching: 'Multi-layer caching with Redis/Memcached',\r\n        indexing: 'Optimized indexing strategies',\r\n      },\r\n      storage: {\r\n        tiering: 'Storage tiering based on access patterns',\r\n        compression: 'Data compression for storage efficiency',\r\n        archiving: 'Automatic archiving of old data',\r\n        partitioning: 'Data partitioning for improved performance',\r\n      },\r\n    };\r\n\r\n    // Performance optimization plan\r\n    scalability.performanceOptimization = {\r\n      caching: {\r\n        application: 'In-memory application caching',\r\n        database: 'Database query result caching',\r\n        cdn: 'Content delivery network for static assets',\r\n        browser: 'Browser caching with appropriate headers',\r\n      },\r\n      optimization: {\r\n        queries: 'Database query optimization',\r\n        algorithms: 'Algorithm complexity optimization',\r\n        resources: 'Resource usage optimization',\r\n        networking: 'Network latency optimization',\r\n      },\r\n    };\r\n\r\n    // Monitoring plan\r\n    scalability.monitoring = {\r\n      metrics: [\r\n        'Response time and latency',\r\n        'Throughput and requests per second',\r\n        'Error rates and success rates',\r\n        'Resource utilization (CPU, memory, disk)',\r\n        'Database performance metrics',\r\n      ],\r\n      alerting: 'Proactive alerting for performance degradation',\r\n      capacity: 'Capacity planning based on growth projections',\r\n      testing: 'Regular performance testing and load testing',\r\n    };\r\n\r\n    return scalability;\r\n  }\r\n\r\n  /**\r\n   * Identify integration points\r\n   */\r\n  async identifyIntegrationPoints(specification) {\r\n    const integrations = [];\r\n    const requirements = specification.requirements || [];\r\n\r\n    // Analyze requirements for integration needs\r\n    for (const requirement of requirements) {\r\n      const reqLower = requirement.toLowerCase();\r\n\r\n      if (reqLower.includes('external') || reqLower.includes('third-party')) {\r\n        integrations.push({\r\n          name: 'External API Integration',\r\n          type: 'REST API',\r\n          purpose: 'Integrate with external services',\r\n          protocol: 'HTTPS',\r\n          authentication: 'API Key or OAuth2',\r\n          dataFormat: 'JSON',\r\n          errorHandling: 'Retry with exponential backoff',\r\n          monitoring: 'API health checks and response time monitoring',\r\n        });\r\n      }\r\n\r\n      if (reqLower.includes('database') || reqLower.includes('data')) {\r\n        integrations.push({\r\n          name: 'Database Integration',\r\n          type: 'Database',\r\n          purpose: 'Data persistence and retrieval',\r\n          protocol: 'Database-specific protocol',\r\n          authentication: 'Connection string with credentials',\r\n          dataFormat: 'SQL or NoSQL',\r\n          errorHandling: 'Connection pooling and retry logic',\r\n          monitoring: 'Database performance and connection monitoring',\r\n        });\r\n      }\r\n\r\n      if (reqLower.includes('message') || reqLower.includes('event')) {\r\n        integrations.push({\r\n          name: 'Message Queue Integration',\r\n          type: 'Message Queue',\r\n          purpose: 'Asynchronous communication',\r\n          protocol: 'AMQP or proprietary',\r\n          authentication: 'Queue-specific authentication',\r\n          dataFormat: 'JSON or Binary',\r\n          errorHandling: 'Dead letter queues and retry policies',\r\n          monitoring: 'Queue depth and processing time monitoring',\r\n        });\r\n      }\r\n    }\r\n\r\n    // Add common integrations\r\n    integrations.push({\r\n      name: 'Logging Integration',\r\n      type: 'Logging Service',\r\n      purpose: 'Centralized logging and monitoring',\r\n      protocol: 'HTTP/HTTPS',\r\n      authentication: 'API Key',\r\n      dataFormat: 'Structured logs (JSON)',\r\n      errorHandling: 'Local buffering with batch sending',\r\n      monitoring: 'Log ingestion and processing monitoring',\r\n    });\r\n\r\n    return integrations;\r\n  }\r\n\r\n  /**\r\n   * Define quality attributes\r\n   */\r\n  async defineQualityAttributes(specification) {\r\n    return {\r\n      performance: {\r\n        responseTime: 'API responses under 200ms for 95th percentile',\r\n        throughput: 'Handle 1000+ requests per second',\r\n        scalability: 'Scale horizontally to handle load increases',\r\n        efficiency: 'Optimize resource usage and minimize waste',\r\n      },\r\n      reliability: {\r\n        availability: '99.9% uptime with planned maintenance windows',\r\n        faultTolerance: 'Graceful degradation when components fail',\r\n        recoverability: 'Automatic recovery from transient failures',\r\n        durability: 'Data persistence with backup and recovery',\r\n      },\r\n      security: {\r\n        confidentiality: 'Protect sensitive data with encryption',\r\n        integrity: 'Ensure data accuracy and prevent tampering',\r\n        authentication: 'Verify user identity before access',\r\n        authorization: 'Control access based on user permissions',\r\n      },\r\n      usability: {\r\n        learnability: 'Intuitive interfaces requiring minimal training',\r\n        efficiency: 'Allow experienced users to work efficiently',\r\n        memorability: 'Easy to remember after periods of non-use',\r\n        errors: 'Minimize user errors and provide clear error messages',\r\n      },\r\n      maintainability: {\r\n        modifiability: 'Easy to modify and extend functionality',\r\n        testability: 'Comprehensive test coverage and automated testing',\r\n        reusability: 'Modular design with reusable components',\r\n        analyzability: 'Clear code structure and documentation',\r\n      },\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Document architectural decisions\r\n   */\r\n  async documentArchitecturalDecisions(result) {\r\n    const decisions = [];\r\n\r\n    // Architecture style decision\r\n    decisions.push({\r\n      id: 'AD-001',\r\n      title: `Use ${result.systemDesign.style} Architecture`,\r\n      status: 'Accepted',\r\n      context: 'Need to choose appropriate architectural style for the system',\r\n      decision: `Implement ${result.systemDesign.style} architecture with ${result.systemDesign.layers.length} layers`,\r\n      consequences: {\r\n        positive: [\r\n          'Clear separation of concerns',\r\n          'Maintainable code structure',\r\n          'Scalable design',\r\n        ],\r\n        negative: ['Potential performance overhead', 'Added complexity for simple operations'],\r\n      },\r\n      alternatives: ['Monolithic', 'Microservices', 'Event-driven'],\r\n      date: new Date().toISOString(),\r\n    });\r\n\r\n    // Design patterns decision\r\n    decisions.push({\r\n      id: 'AD-002',\r\n      title: 'Apply Standard Design Patterns',\r\n      status: 'Accepted',\r\n      context: 'Need to ensure consistent and well-understood design patterns',\r\n      decision: `Implement ${result.designPatterns.length} design patterns including Repository, Factory, and Strategy patterns`,\r\n      consequences: {\r\n        positive: [\r\n          'Improved code maintainability',\r\n          'Better testability',\r\n          'Consistent design approach',\r\n        ],\r\n        negative: ['Learning curve for developers', 'Potential over-engineering'],\r\n      },\r\n      alternatives: ['Ad-hoc design', 'Framework-specific patterns'],\r\n      date: new Date().toISOString(),\r\n    });\r\n\r\n    // Data model decision\r\n    decisions.push({\r\n      id: 'AD-003',\r\n      title: 'Relational Database Design',\r\n      status: 'Accepted',\r\n      context: 'Need to choose appropriate data storage and modeling approach',\r\n      decision: `Use relational database with ${result.dataModel.entities.length} entities and normalized schema`,\r\n      consequences: {\r\n        positive: ['ACID compliance', 'Strong consistency', 'Mature ecosystem'],\r\n        negative: ['Potential scalability limitations', 'Schema migration complexity'],\r\n      },\r\n      alternatives: ['NoSQL database', 'Document database', 'Graph database'],\r\n      date: new Date().toISOString(),\r\n    });\r\n\r\n    return decisions;\r\n  }\r\n\r\n  /**\r\n   * Assess architectural risks\r\n   */\r\n  async assessArchitecturalRisks(result) {\r\n    const risks = [];\r\n\r\n    // Complexity risk\r\n    risks.push({\r\n      id: 'AR-001',\r\n      category: 'Complexity',\r\n      description: 'System complexity may lead to maintenance challenges',\r\n      probability: 'Medium',\r\n      impact: 'High',\r\n      riskLevel: 'High',\r\n      mitigation: [\r\n        'Implement comprehensive documentation',\r\n        'Provide developer training',\r\n        'Establish coding standards',\r\n        'Regular code reviews',\r\n      ],\r\n      monitoring: 'Code complexity metrics and maintainability index',\r\n    });\r\n\r\n    // Performance risk\r\n    risks.push({\r\n      id: 'AR-002',\r\n      category: 'Performance',\r\n      description: 'Layered architecture may introduce performance overhead',\r\n      probability: 'Low',\r\n      impact: 'Medium',\r\n      riskLevel: 'Medium',\r\n      mitigation: [\r\n        'Performance testing and profiling',\r\n        'Caching strategies',\r\n        'Database optimization',\r\n        'Load balancing',\r\n      ],\r\n      monitoring: 'Response time and throughput monitoring',\r\n    });\r\n\r\n    // Security risk\r\n    risks.push({\r\n      id: 'AR-003',\r\n      category: 'Security',\r\n      description: 'Multiple integration points increase attack surface',\r\n      probability: 'Medium',\r\n      impact: 'High',\r\n      riskLevel: 'High',\r\n      mitigation: [\r\n        'Security architecture review',\r\n        'Regular security testing',\r\n        'Input validation and sanitization',\r\n        'Secure communication protocols',\r\n      ],\r\n      monitoring: 'Security event monitoring and alerting',\r\n    });\r\n\r\n    // Scalability risk\r\n    risks.push({\r\n      id: 'AR-004',\r\n      category: 'Scalability',\r\n      description: 'Database may become bottleneck under high load',\r\n      probability: 'Medium',\r\n      impact: 'High',\r\n      riskLevel: 'High',\r\n      mitigation: [\r\n        'Database optimization',\r\n        'Read replicas and caching',\r\n        'Connection pooling',\r\n        'Horizontal scaling strategies',\r\n      ],\r\n      monitoring: 'Database performance and connection monitoring',\r\n    });\r\n\r\n    return risks;\r\n  }\r\n\r\n  /**\r\n   * Generate architecture document\r\n   */\r\n  async generateArchitectureDocument(result) {\r\n    const document = `# ${this.taskDescription} - Architecture Design\r\n\r\n## System Architecture\r\n\r\n### Architecture Style\r\n**Style**: ${result.systemDesign.style}\r\n**Layers**: ${result.systemDesign.layers.length}\r\n\r\n${result.systemDesign.layers\r\n  .map(\r\n    (layer, index) => `\r\n#### ${index + 1}. ${layer.name}\r\n**Responsibility**: ${layer.responsibility}\r\n`,\r\n  )\r\n  .join('\\n')}\r\n\r\n### Data Flow\r\n${result.systemDesign.dataFlow.map((flow) => `- ${flow.from} â†’ ${flow.to} (${flow.direction}): ${flow.dataType}`).join('\\n')}\r\n\r\n### Control Flow\r\n${result.systemDesign.controlFlow\r\n  .map(\r\n    (flow) => `\r\n#### ${flow.layer}\r\n- **Order**: ${flow.order}\r\n- **Triggers**: ${flow.triggers.join(', ')}\r\n- **Actions**: ${flow.actions.join(', ')}\r\n- **Outcomes**: ${flow.outcomes.join(', ')}\r\n`,\r\n  )\r\n  .join('\\n')}\r\n\r\n## Components\r\n\r\n${result.components\r\n  .map(\r\n    (component, index) => `\r\n### ${index + 1}. ${component.name}\r\n**Type**: ${component.type}\r\n**Responsibility**: ${component.responsibility}\r\n**Interfaces**: ${component.interfaces.join(', ')}\r\n**Dependencies**: ${component.dependencies.join(', ')}\r\n**Patterns**: ${component.patterns.join(', ')}\r\n**Complexity**: ${component.complexity}\r\n`,\r\n  )\r\n  .join('\\n')}\r\n\r\n## Design Patterns\r\n\r\n${result.designPatterns\r\n  .map(\r\n    (pattern, index) => `\r\n### ${index + 1}. ${pattern.name}\r\n**Type**: ${pattern.type}\r\n**Purpose**: ${pattern.purpose}\r\n**Applicability**: ${pattern.applicability}\r\n**Implementation**: ${pattern.implementation}\r\n**Benefits**: ${pattern.benefits.join(', ')}\r\n`,\r\n  )\r\n  .join('\\n')}\r\n\r\n## Data Model\r\n\r\n### Entities\r\n${result.dataModel.entities\r\n  .map(\r\n    (entity, index) => `\r\n#### ${index + 1}. ${entity.name}\r\n**Primary Key**: ${entity.primaryKey}\r\n**Attributes**:\r\n${entity.attributes.map((attr) => `- ${attr.name}: ${attr.type}${attr.nullable ? '' : ' NOT NULL'}${attr.unique ? ' UNIQUE' : ''}${attr.default ? ` DEFAULT ${attr.default}` : ''}`).join('\\n')}\r\n\r\n**Constraints**:\r\n${entity.constraints.map((constraint) => `- ${constraint.name}: ${constraint.type}${constraint.condition ? ` (${constraint.condition})` : ''}`).join('\\n')}\r\n\r\n**Indexes**:\r\n${entity.indexes.map((index) => `- ${index.name}: ${index.type} (${index.columns.join(', ')})`).join('\\n')}\r\n`,\r\n  )\r\n  .join('\\n')}\r\n\r\n### Relationships\r\n${result.dataModel.relationships\r\n  .map(\r\n    (rel, index) => `\r\n#### ${index + 1}. ${rel.name}\r\n**Type**: ${rel.type}\r\n**Parent**: ${rel.parent} (${rel.parentKey})\r\n**Child**: ${rel.child} (${rel.childKey})\r\n**On Delete**: ${rel.onDelete}\r\n**On Update**: ${rel.onUpdate}\r\n`,\r\n  )\r\n  .join('\\n')}\r\n\r\n## API Design\r\n\r\n### General Information\r\n**Version**: ${result.apiDesign.version}\r\n**Base URL**: ${result.apiDesign.baseUrl}\r\n**Authentication**: ${result.apiDesign.authentication}\r\n\r\n### Endpoints\r\n${result.apiDesign.endpoints\r\n  .map(\r\n    (endpoint, index) => `\r\n#### ${index + 1}. ${endpoint.method} ${endpoint.path}\r\n**Summary**: ${endpoint.summary}\r\n**Parameters**: ${endpoint.parameters ? endpoint.parameters.map((p) => `${p.name} (${p.type})`).join(', ') : 'None'}\r\n**Request Body**: ${endpoint.requestBody ? endpoint.requestBody.schema : 'None'}\r\n**Responses**: ${Object.entries(endpoint.responses)\r\n      .map(([code, resp]) => `${code}: ${resp.description}`)\r\n      .join(', ')}\r\n`,\r\n  )\r\n  .join('\\n')}\r\n\r\n### Schemas\r\n${result.apiDesign.schemas\r\n  .map(\r\n    (schema, index) => `\r\n#### ${index + 1}. ${schema.name}\r\n**Type**: ${schema.type}\r\n**Properties**:\r\n${Object.entries(schema.properties)\r\n  .map(\r\n    ([name, prop]) =>\r\n      `- ${name}: ${prop.type}${prop.format ? ` (${prop.format})` : ''}${prop.enum ? ` [${prop.enum.join(', ')}]` : ''}`,\r\n  )\r\n  .join('\\n')}\r\n**Required**: ${schema.required ? schema.required.join(', ') : 'None'}\r\n`,\r\n  )\r\n  .join('\\n')}\r\n\r\n## Deployment Architecture\r\n\r\n### Environments\r\n${result.deploymentArchitecture.environments\r\n  .map(\r\n    (env, index) => `\r\n#### ${index + 1}. ${env.name}\r\n**Purpose**: ${env.purpose}\r\n**Resources**: ${env.resources}\r\n**Database**: ${env.database}\r\n**Monitoring**: ${env.monitoring}\r\n`,\r\n  )\r\n  .join('\\n')}\r\n\r\n### Infrastructure\r\n**Platform**: ${result.deploymentArchitecture.infrastructure.platform}\r\n**Compute**: ${result.deploymentArchitecture.infrastructure.compute}\r\n**Storage**: ${result.deploymentArchitecture.infrastructure.storage}\r\n**Networking**: ${result.deploymentArchitecture.infrastructure.networking}\r\n**DNS**: ${result.deploymentArchitecture.infrastructure.dns}\r\n\r\n## Security Architecture\r\n\r\n### Authentication\r\n**Mechanism**: ${result.securityArchitecture.authentication.mechanism}\r\n**Providers**: ${result.securityArchitecture.authentication.providers.join(', ')}\r\n**Session**: ${result.securityArchitecture.authentication.session}\r\n**MFA**: ${result.securityArchitecture.authentication.mfa}\r\n\r\n### Authorization\r\n**Model**: ${result.securityArchitecture.authorization.model}\r\n**Permissions**: ${result.securityArchitecture.authorization.permissions}\r\n**Policies**: ${result.securityArchitecture.authorization.policies}\r\n\r\n### Data Protection\r\n**Encryption at Rest**: ${result.securityArchitecture.dataProtection.encryption.atRest}\r\n**Encryption in Transit**: ${result.securityArchitecture.dataProtection.encryption.inTransit}\r\n**Key Management**: ${result.securityArchitecture.dataProtection.encryption.keys}\r\n\r\n## Scalability Plan\r\n\r\n### Horizontal Scaling\r\n**Strategy**: ${result.scalabilityPlan.horizontalScaling.strategy}\r\n**Triggers**: ${result.scalabilityPlan.horizontalScaling.triggers.join(', ')}\r\n**Limits**: Min: ${result.scalabilityPlan.horizontalScaling.limits.minimum}, Max: ${result.scalabilityPlan.horizontalScaling.limits.maximum}\r\n\r\n### Data Scaling\r\n**Read Replicas**: ${result.scalabilityPlan.dataScaling.database.readReplicas}\r\n**Sharding**: ${result.scalabilityPlan.dataScaling.database.sharding}\r\n**Caching**: ${result.scalabilityPlan.dataScaling.database.caching}\r\n\r\n## Quality Attributes\r\n\r\n${Object.entries(result.qualityAttributes)\r\n  .map(\r\n    ([category, attributes]) => `\r\n### ${category.charAt(0).toUpperCase() + category.slice(1)}\r\n${Object.entries(attributes)\r\n  .map(([attr, desc]) => `- **${attr}**: ${desc}`)\r\n  .join('\\n')}\r\n`,\r\n  )\r\n  .join('\\n')}\r\n\r\n## Architectural Decisions\r\n\r\n${result.architecturalDecisions\r\n  .map(\r\n    (decision, index) => `\r\n### ${decision.id}: ${decision.title}\r\n**Status**: ${decision.status}\r\n**Context**: ${decision.context}\r\n**Decision**: ${decision.decision}\r\n**Positive Consequences**: ${decision.consequences.positive.join(', ')}\r\n**Negative Consequences**: ${decision.consequences.negative.join(', ')}\r\n**Alternatives Considered**: ${decision.alternatives.join(', ')}\r\n**Date**: ${decision.date}\r\n`,\r\n  )\r\n  .join('\\n')}\r\n\r\n## Risk Assessment\r\n\r\n${result.riskAssessment\r\n  .map(\r\n    (risk, index) => `\r\n### ${risk.id}: ${risk.category}\r\n**Description**: ${risk.description}\r\n**Probability**: ${risk.probability}\r\n**Impact**: ${risk.impact}\r\n**Risk Level**: ${risk.riskLevel}\r\n**Mitigation**: ${risk.mitigation.join(', ')}\r\n**Monitoring**: ${risk.monitoring}\r\n`,\r\n  )\r\n  .join('\\n')}\r\n\r\n## Integration Points\r\n\r\n${result.integrationPoints\r\n  .map(\r\n    (integration, index) => `\r\n### ${index + 1}. ${integration.name}\r\n**Type**: ${integration.type}\r\n**Purpose**: ${integration.purpose}\r\n**Protocol**: ${integration.protocol}\r\n**Authentication**: ${integration.authentication}\r\n**Data Format**: ${integration.dataFormat}\r\n**Error Handling**: ${integration.errorHandling}\r\n**Monitoring**: ${integration.monitoring}\r\n`,\r\n  )\r\n  .join('\\n')}\r\n`;\r\n\r\n    // Save document\r\n    await this.saveArtifact('architecture.md', document);\r\n    return document;\r\n  }\r\n}\r\n\r\nexport default SparcArchitecture;\r\n"],"names":["SparcPhase","SparcArchitecture","taskDescription","options","components","designPatterns","systemDesign","dataModel","apiDesign","execute","console","log","initializePhase","result","deploymentArchitecture","securityArchitecture","scalabilityPlan","integrationPoints","qualityAttributes","architecturalDecisions","riskAssessment","specification","retrieveFromMemory","pseudocode","Error","designSystemArchitecture","defineComponents","selectDesignPatterns","designDataModel","designApiStructure","planDeploymentArchitecture","designSecurityArchitecture","planScalability","identifyIntegrationPoints","defineQualityAttributes","documentArchitecturalDecisions","assessArchitecturalRisks","generateArchitectureDocument","storeInMemory","error","message","architecture","style","layers","dataFlow","controlFlow","boundaries","requirements","hasApiRequirements","some","req","toLowerCase","includes","hasUiRequirements","hasDataRequirements","hasDistributedRequirements","name","responsibility","defineDataFlow","defineControlFlow","defineBoundaries","i","length","push","from","to","direction","dataType","map","layer","index","order","triggers","actions","outcomes","type","encapsulation","dependencies","contracts","functions","requirement","component","createComponentFromRequirement","func","createComponentFromFunction","createInfrastructureComponents","uniqueComponents","mergeComponents","reqLower","interfaces","patterns","complexity","toPascalCase","function","description","extractDependencies","steps","inferPatterns","level","componentMap","Map","key","has","existing","get","Set","set","Array","values","str","replace","match","letter","toUpperCase","step","purpose","applicability","implementation","benefits","entities","relationships","constraints","indexes","views","extractEntities","entityName","entity","attributes","generateAttributes","primaryKey","foreignKeys","generateConstraints","generateIndexes","defineRelationships","defineGlobalConstraints","defineGlobalIndexes","defineViews","words","split","word","add","size","commonAttributes","nullable","unique","default","specificAttributes","entityLower","column","condition","columns","userEntity","find","e","sessionEntity","parent","child","parentKey","childKey","onDelete","onUpdate","table","attr","definition","version","baseUrl","authentication","endpoints","schemas","errorHandling","rateLimiting","versioning","generateEndpoints","generateApiSchemas","defineApiErrorHandling","defineApiRateLimiting","defineApiVersioning","path","method","summary","parameters","responses","schema","required","requestBody","properties","id","format","status","enum","created_at","updated_at","data","items","$ref","pagination","page","limit","total","pages","details","timestamp","strategy","errorCodes","errorFormat","logging","limits","authenticated","requests","window","anonymous","burst","headers","handling","lifecycle","development","stable","deprecated","retired","migration","deployment","environments","infrastructure","monitoring","security","scalability","resources","database","platform","compute","storage","networking","dns","metrics","tracing","alerting","dashboards","secrets","network","access","scanning","compliance","horizontal","vertical","caching","cdn","authorization","dataProtection","networkSecurity","mechanism","providers","session","mfa","passwordPolicy","model","permissions","policies","delegation","auditing","encryption","atRest","inTransit","keys","privacy","pii","anonymization","retention","backup","testing","offsite","firewall","segmentation","vpn","certificates","siem","ids","behavior","threat","incident","frameworks","documentation","training","reporting","horizontalScaling","verticalScaling","dataScaling","performanceOptimization","minimum","maximum","scaleUpRate","scaleDownRate","loadBalancing","sessionAffinity","recommendations","optimization","readReplicas","sharding","indexing","tiering","compression","archiving","partitioning","application","browser","queries","algorithms","capacity","integrations","protocol","dataFormat","performance","responseTime","throughput","efficiency","reliability","availability","faultTolerance","recoverability","durability","confidentiality","integrity","usability","learnability","memorability","errors","maintainability","modifiability","testability","reusability","analyzability","decisions","title","context","decision","consequences","positive","negative","alternatives","date","Date","toISOString","risks","category","probability","impact","riskLevel","mitigation","document","join","flow","pattern","constraint","rel","endpoint","p","Object","entries","code","resp","prop","env","charAt","slice","desc","risk","integration","saveArtifact"],"mappings":"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"}