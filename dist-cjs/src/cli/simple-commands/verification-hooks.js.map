{"version":3,"sources":["../../../../src/cli/simple-commands/verification-hooks.js"],"sourcesContent":["#!/usr/bin/env node\r\n/**\r\n * Verification Hooks CLI\r\n * Provides verification integration for other commands via CLI\r\n */\r\n\r\nimport { execSync } from 'child_process';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\n// Parse command line arguments\r\nconst args = process.argv.slice(2);\r\nconst command = args[0];\r\nconst taskId = args[1];\r\nconst agentType = args[2] || 'unknown';\r\nconst additionalData = args[3] ? JSON.parse(args[3]) : {};\r\n\r\n// Verification thresholds\r\nconst THRESHOLDS = {\r\n  strict: 0.95,\r\n  moderate: 0.85,\r\n  development: 0.75\r\n};\r\n\r\n// Get current mode from environment or default\r\nconst mode = process.env.VERIFICATION_MODE || 'moderate';\r\nconst threshold = THRESHOLDS[mode];\r\n\r\n/**\r\n * Pre-task verification\r\n */\r\nasync function preTaskVerification(taskId, agentType, data) {\r\n  console.log(`üîç Pre-task verification: ${taskId} (${agentType})`);\r\n  \r\n  const checks = [];\r\n  \r\n  // Check git status\r\n  try {\r\n    const gitStatus = execSync('git status --porcelain', { encoding: 'utf8' });\r\n    const isClean = gitStatus.trim() === '';\r\n    checks.push({\r\n      name: 'git-status',\r\n      passed: isClean || data.allowDirty,\r\n      score: isClean ? 1.0 : 0.7\r\n    });\r\n  } catch (e) {\r\n    checks.push({ name: 'git-status', passed: false, score: 0 });\r\n  }\r\n  \r\n  // Check npm dependencies\r\n  if (fs.existsSync('package.json')) {\r\n    try {\r\n      execSync('npm ls --depth=0', { stdio: 'ignore' });\r\n      checks.push({ name: 'npm-deps', passed: true, score: 1.0 });\r\n    } catch {\r\n      checks.push({ name: 'npm-deps', passed: false, score: 0.5 });\r\n    }\r\n  }\r\n  \r\n  const avgScore = checks.reduce((sum, c) => sum + c.score, 0) / checks.length;\r\n  const passed = avgScore >= threshold;\r\n  \r\n  // Store result\r\n  storeVerification(taskId, 'pre', { \r\n    passed, \r\n    score: avgScore, \r\n    checks,\r\n    agentType \r\n  });\r\n  \r\n  if (!passed) {\r\n    console.error(`‚ùå Pre-task verification failed (${avgScore.toFixed(2)} < ${threshold})`);\r\n    process.exit(1);\r\n  }\r\n  \r\n  console.log(`‚úÖ Pre-task verification passed (${avgScore.toFixed(2)})`);\r\n  return 0;\r\n}\r\n\r\n/**\r\n * Post-task verification\r\n */\r\nasync function postTaskVerification(taskId, agentType, data) {\r\n  console.log(`üîç Post-task verification: ${taskId} (${agentType})`);\r\n  \r\n  const checks = [];\r\n  \r\n  // Run type checking if available\r\n  if (fs.existsSync('tsconfig.json') || fs.existsSync('package.json')) {\r\n    try {\r\n      const result = execSync('npm run typecheck 2>&1 || true', { encoding: 'utf8' });\r\n      const hasErrors = result.toLowerCase().includes('error');\r\n      checks.push({\r\n        name: 'typecheck',\r\n        passed: !hasErrors,\r\n        score: hasErrors ? 0.5 : 1.0\r\n      });\r\n    } catch {\r\n      checks.push({ name: 'typecheck', passed: false, score: 0.3 });\r\n    }\r\n  }\r\n  \r\n  // Run tests if available\r\n  if (fs.existsSync('package.json')) {\r\n    try {\r\n      const pkg = JSON.parse(fs.readFileSync('package.json', 'utf8'));\r\n      if (pkg.scripts && pkg.scripts.test) {\r\n        const result = execSync('npm test 2>&1 || true', { encoding: 'utf8' });\r\n        const passed = result.includes('PASS') || result.includes('passing');\r\n        checks.push({\r\n          name: 'tests',\r\n          passed,\r\n          score: passed ? 1.0 : 0.4\r\n        });\r\n      }\r\n    } catch {\r\n      checks.push({ name: 'tests', passed: false, score: 0.2 });\r\n    }\r\n  }\r\n  \r\n  // Run linting if available\r\n  if (fs.existsSync('.eslintrc.js') || fs.existsSync('.eslintrc.json')) {\r\n    try {\r\n      const result = execSync('npm run lint 2>&1 || true', { encoding: 'utf8' });\r\n      const hasErrors = result.toLowerCase().includes('error');\r\n      checks.push({\r\n        name: 'lint',\r\n        passed: !hasErrors,\r\n        score: hasErrors ? 0.6 : 1.0\r\n      });\r\n    } catch {\r\n      checks.push({ name: 'lint', passed: false, score: 0.4 });\r\n    }\r\n  }\r\n  \r\n  // If no checks were possible, use default\r\n  if (checks.length === 0) {\r\n    checks.push({\r\n      name: 'default',\r\n      passed: true,\r\n      score: 0.8\r\n    });\r\n  }\r\n  \r\n  const avgScore = checks.reduce((sum, c) => sum + c.score, 0) / checks.length;\r\n  const passed = avgScore >= threshold;\r\n  \r\n  // Store result\r\n  storeVerification(taskId, 'post', { \r\n    passed, \r\n    score: avgScore, \r\n    checks,\r\n    agentType \r\n  });\r\n  \r\n  if (!passed) {\r\n    console.error(`‚ùå Post-task verification failed (${avgScore.toFixed(2)} < ${threshold})`);\r\n    \r\n    // Attempt rollback if enabled\r\n    if (process.env.VERIFICATION_ROLLBACK === 'true') {\r\n      console.log('üîÑ Attempting rollback...');\r\n      try {\r\n        execSync('git reset --hard HEAD');\r\n        console.log('‚úÖ Rollback completed');\r\n      } catch (e) {\r\n        console.error('‚ùå Rollback failed:', e.message);\r\n      }\r\n    }\r\n    \r\n    process.exit(1);\r\n  }\r\n  \r\n  console.log(`‚úÖ Post-task verification passed (${avgScore.toFixed(2)})`);\r\n  return 0;\r\n}\r\n\r\n/**\r\n * Training integration - feed results to training system\r\n */\r\nasync function feedToTraining(taskId, agentType, data) {\r\n  const verificationData = loadVerification(taskId);\r\n  \r\n  if (!verificationData) {\r\n    console.log('‚ö†Ô∏è  No verification data to feed to training');\r\n    return;\r\n  }\r\n  \r\n  // Format for training system\r\n  const trainingData = {\r\n    taskId,\r\n    agentType,\r\n    preScore: verificationData.pre?.score || 0,\r\n    postScore: verificationData.post?.score || 0,\r\n    success: verificationData.post?.passed || false,\r\n    timestamp: new Date().toISOString()\r\n  };\r\n  \r\n  // Store in training data file\r\n  const trainingFile = '.claude-flow/training/verification-data.jsonl';\r\n  const dir = path.dirname(trainingFile);\r\n  \r\n  if (!fs.existsSync(dir)) {\r\n    fs.mkdirSync(dir, { recursive: true });\r\n  }\r\n  \r\n  fs.appendFileSync(trainingFile, JSON.stringify(trainingData) + '\\n');\r\n  console.log(`üìä Verification data fed to training system`);\r\n  \r\n  // If score is particularly low, flag for attention\r\n  if (trainingData.postScore < 0.5) {\r\n    console.warn(`‚ö†Ô∏è  Low verification score for ${agentType}: ${trainingData.postScore}`);\r\n  }\r\n}\r\n\r\n/**\r\n * Store verification results\r\n */\r\nfunction storeVerification(taskId, phase, data) {\r\n  const file = '.swarm/verification-memory.json';\r\n  const dir = path.dirname(file);\r\n  \r\n  if (!fs.existsSync(dir)) {\r\n    fs.mkdirSync(dir, { recursive: true });\r\n  }\r\n  \r\n  let memory = {};\r\n  if (fs.existsSync(file)) {\r\n    try {\r\n      memory = JSON.parse(fs.readFileSync(file, 'utf8'));\r\n    } catch {\r\n      memory = {};\r\n    }\r\n  }\r\n  \r\n  if (!memory.history) memory.history = [];\r\n  if (!memory.tasks) memory.tasks = {};\r\n  \r\n  // Store task-specific data\r\n  if (!memory.tasks[taskId]) {\r\n    memory.tasks[taskId] = {};\r\n  }\r\n  memory.tasks[taskId][phase] = data;\r\n  \r\n  // Add to history\r\n  memory.history.push({\r\n    taskId,\r\n    phase,\r\n    ...data,\r\n    timestamp: new Date().toISOString()\r\n  });\r\n  \r\n  // Keep only last 1000 entries\r\n  if (memory.history.length > 1000) {\r\n    memory.history = memory.history.slice(-1000);\r\n  }\r\n  \r\n  fs.writeFileSync(file, JSON.stringify(memory, null, 2));\r\n}\r\n\r\n/**\r\n * Load verification results\r\n */\r\nfunction loadVerification(taskId) {\r\n  const file = '.swarm/verification-memory.json';\r\n  \r\n  if (!fs.existsSync(file)) {\r\n    return null;\r\n  }\r\n  \r\n  try {\r\n    const memory = JSON.parse(fs.readFileSync(file, 'utf8'));\r\n    return memory.tasks?.[taskId] || null;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Show verification status\r\n */\r\nfunction showStatus() {\r\n  const file = '.swarm/verification-memory.json';\r\n  \r\n  if (!fs.existsSync(file)) {\r\n    console.log('No verification history found');\r\n    return;\r\n  }\r\n  \r\n  try {\r\n    const memory = JSON.parse(fs.readFileSync(file, 'utf8'));\r\n    const recent = memory.history?.slice(-10) || [];\r\n    \r\n    console.log(`üìä Verification Status`);\r\n    console.log(`Mode: ${mode} (threshold: ${threshold})`);\r\n    console.log(`Total verifications: ${memory.history?.length || 0}`);\r\n    \r\n    if (recent.length > 0) {\r\n      console.log(`\\nRecent verifications:`);\r\n      for (const v of recent) {\r\n        const status = v.passed ? '‚úÖ' : '‚ùå';\r\n        console.log(`  ${status} ${v.taskId} (${v.phase}): ${v.score.toFixed(2)}`);\r\n      }\r\n    }\r\n  } catch (e) {\r\n    console.error('Error reading verification history:', e.message);\r\n  }\r\n}\r\n\r\n// Main CLI handler\r\nasync function main() {\r\n  switch (command) {\r\n    case 'pre':\r\n      return preTaskVerification(taskId, agentType, additionalData);\r\n    \r\n    case 'post':\r\n      return postTaskVerification(taskId, agentType, additionalData);\r\n    \r\n    case 'train':\r\n      return feedToTraining(taskId, agentType, additionalData);\r\n    \r\n    case 'status':\r\n      return showStatus();\r\n    \r\n    default:\r\n      console.log('Usage: verification-hooks <pre|post|train|status> <taskId> [agentType] [data]');\r\n      process.exit(1);\r\n  }\r\n}\r\n\r\n// Run if called directly\r\nif (require.main === module) {\r\n  main().catch(console.error);\r\n}\r\n\r\n// Export for programmatic use\r\nexport {\r\n  preTaskVerification,\r\n  postTaskVerification,\r\n  feedToTraining,\r\n  showStatus\r\n};"],"names":["execSync","fs","path","args","process","argv","slice","command","taskId","agentType","additionalData","JSON","parse","THRESHOLDS","strict","moderate","development","mode","env","VERIFICATION_MODE","threshold","preTaskVerification","data","console","log","checks","gitStatus","encoding","isClean","trim","push","name","passed","allowDirty","score","e","existsSync","stdio","avgScore","reduce","sum","c","length","storeVerification","error","toFixed","exit","postTaskVerification","result","hasErrors","toLowerCase","includes","pkg","readFileSync","scripts","test","VERIFICATION_ROLLBACK","message","feedToTraining","verificationData","loadVerification","trainingData","preScore","pre","postScore","post","success","timestamp","Date","toISOString","trainingFile","dir","dirname","mkdirSync","recursive","appendFileSync","stringify","warn","phase","file","memory","history","tasks","writeFileSync","showStatus","recent","v","status","main","require","module","catch"],"mappings":"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"}