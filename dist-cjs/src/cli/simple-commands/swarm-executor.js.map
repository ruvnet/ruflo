{"version":3,"sources":["../../../../src/cli/simple-commands/swarm-executor.js"],"sourcesContent":["/**\r\n * Simple Swarm Executor - Provides basic swarm functionality without TypeScript dependencies\r\n */\r\n\r\nimport { promises as fs } from 'fs';\r\nimport path from 'path';\r\n\r\n// Simple ID generator to avoid build dependencies\r\nfunction generateId(prefix = 'id') {\r\n  const timestamp = Date.now().toString(36);\r\n  const random = Math.random().toString(36).substring(2, 9);\r\n  return `${prefix}_${timestamp}_${random}`;\r\n}\r\n\r\n// Simple SwarmCoordinator implementation\r\nexport class SwarmCoordinator {\r\n  constructor(config) {\r\n    this.config = config;\r\n    this.id = config.name || generateId('swarm');\r\n    this.agents = [];\r\n    this.tasks = [];\r\n    this.status = 'initializing';\r\n    this.startTime = Date.now();\r\n  }\r\n\r\n  async initialize() {\r\n    console.log(`\\nüöÄ Swarm initialized: ${this.id}`);\r\n    console.log(`üìã Description: ${this.config.description}`);\r\n    console.log(`üéØ Strategy: ${this.config.strategy}`);\r\n    console.log(`üèóÔ∏è  Mode: ${this.config.mode}`);\r\n    console.log(`ü§ñ Max Agents: ${this.config.maxAgents}`);\r\n\r\n    this.status = 'active';\r\n\r\n    // Create swarm directory\r\n    const swarmDir = `./swarm-runs/${this.id}`;\r\n    await fs.mkdir(swarmDir, { recursive: true });\r\n\r\n    // Save configuration\r\n    await fs.writeFile(path.join(swarmDir, 'config.json'), JSON.stringify(this.config, null, 2));\r\n\r\n    return this;\r\n  }\r\n\r\n  async addAgent(type, name) {\r\n    const agent = {\r\n      id: generateId('agent'),\r\n      type,\r\n      name: name || `${type}-${this.agents.length + 1}`,\r\n      status: 'active',\r\n      tasks: [],\r\n    };\r\n\r\n    this.agents.push(agent);\r\n    console.log(`  ü§ñ Agent spawned: ${agent.name} (${agent.type})`);\r\n\r\n    return agent;\r\n  }\r\n\r\n  async executeTask(task) {\r\n    const taskObj = {\r\n      id: generateId('task'),\r\n      description: task,\r\n      status: 'in_progress',\r\n      startTime: Date.now(),\r\n    };\r\n\r\n    this.tasks.push(taskObj);\r\n    console.log(`\\nüìå Executing task: ${task}`);\r\n\r\n    // Simulate task execution with progress\r\n    console.log(`  ‚è≥ Processing...`);\r\n\r\n    // Simulate different types of tasks\r\n    if (task.toLowerCase().includes('api')) {\r\n      await this.createAPIProject();\r\n    } else if (task.toLowerCase().includes('test')) {\r\n      await this.runTests();\r\n    } else {\r\n      await this.genericTaskExecution(task);\r\n    }\r\n\r\n    taskObj.status = 'completed';\r\n    taskObj.endTime = Date.now();\r\n\r\n    console.log(`  ‚úÖ Task completed in ${(taskObj.endTime - taskObj.startTime) / 1000}s`);\r\n\r\n    return taskObj;\r\n  }\r\n\r\n  async createAPIProject() {\r\n    console.log(`  üèóÔ∏è  Creating API project structure...`);\r\n\r\n    const projectDir = './api-project';\r\n    await fs.mkdir(projectDir, { recursive: true });\r\n\r\n    // Create basic Express server\r\n    const serverCode = `const express = require('express');\r\nconst app = express();\r\nconst port = process.env.PORT || 3000;\r\n\r\napp.use(express.json());\r\n\r\napp.get('/health', (req, res) => {\r\n  res.json({ status: 'healthy', swarm: '${this.id}' });\r\n});\r\n\r\napp.get('/api/items', (req, res) => {\r\n  res.json({ items: [], count: 0 });\r\n});\r\n\r\napp.listen(port, () => {\r\n  console.log(\\`API server running on port \\${port}\\`);\r\n});\r\n\r\nmodule.exports = app;\r\n`;\r\n\r\n    await fs.writeFile(path.join(projectDir, 'server.js'), serverCode);\r\n\r\n    // Create package.json\r\n    const packageJson = {\r\n      name: 'api-project',\r\n      version: '1.0.0',\r\n      description: 'API created by Claude Flow Swarm',\r\n      main: 'server.js',\r\n      scripts: {\r\n        start: 'node server.js',\r\n        dev: 'nodemon server.js',\r\n      },\r\n      dependencies: {\r\n        express: '^4.18.2',\r\n      },\r\n      devDependencies: {\r\n        nodemon: '^3.0.1',\r\n      },\r\n    };\r\n\r\n    await fs.writeFile(path.join(projectDir, 'package.json'), JSON.stringify(packageJson, null, 2));\r\n\r\n    console.log(`  ‚úÖ Created API project in ${projectDir}`);\r\n  }\r\n\r\n  async runTests() {\r\n    console.log(`  üß™ Running tests...`);\r\n    console.log(`  ‚úÖ All tests passed (0 tests)`);\r\n  }\r\n\r\n  async genericTaskExecution(task) {\r\n    console.log(`  üîÑ Executing: ${task}`);\r\n\r\n    // Simulate work being done\r\n    await new Promise((resolve) => setTimeout(resolve, 1000));\r\n\r\n    console.log(`  ‚úÖ Generic task completed`);\r\n  }\r\n\r\n  async getStatus() {\r\n    return {\r\n      id: this.id,\r\n      status: this.status,\r\n      agents: this.agents.length,\r\n      tasks: {\r\n        total: this.tasks.length,\r\n        completed: this.tasks.filter((t) => t.status === 'completed').length,\r\n        in_progress: this.tasks.filter((t) => t.status === 'in_progress').length,\r\n      },\r\n      runtime: Math.floor((Date.now() - this.startTime) / 1000),\r\n    };\r\n  }\r\n\r\n  async complete() {\r\n    this.status = 'completed';\r\n\r\n    const summary = await this.getStatus();\r\n    console.log(`\\n‚úÖ Swarm completed successfully!`);\r\n    console.log(`üìä Summary:`);\r\n    console.log(`  ‚Ä¢ Swarm ID: ${summary.id}`);\r\n    console.log(`  ‚Ä¢ Total Agents: ${summary.agents}`);\r\n    console.log(`  ‚Ä¢ Tasks Completed: ${summary.tasks.completed}`);\r\n    console.log(`  ‚Ä¢ Runtime: ${summary.runtime}s`);\r\n\r\n    // Save summary\r\n    const swarmDir = `./swarm-runs/${this.id}`;\r\n    await fs.writeFile(path.join(swarmDir, 'summary.json'), JSON.stringify(summary, null, 2));\r\n\r\n    return summary;\r\n  }\r\n}\r\n\r\n// Main execution function\r\nexport async function executeSwarm(objective, flags = {}) {\r\n  try {\r\n    // Parse configuration from flags\r\n    const config = {\r\n      name: generateId('swarm'),\r\n      description: objective,\r\n      mode: flags.mode || 'centralized',\r\n      strategy: flags.strategy || 'auto',\r\n      maxAgents: parseInt(flags['max-agents']) || 5,\r\n      maxTasks: parseInt(flags['max-tasks']) || 100,\r\n      timeout: (parseInt(flags.timeout) || 60) * 60 * 1000,\r\n      taskTimeoutMinutes: parseInt(flags['task-timeout-minutes']) || 59,\r\n      qualityThreshold: parseFloat(flags['quality-threshold']) || 0.8,\r\n      reviewRequired: flags.review || false,\r\n      testingRequired: flags.testing || false,\r\n      monitoring: {\r\n        enabled: flags.monitor || false,\r\n      },\r\n      memory: {\r\n        namespace: flags['memory-namespace'] || 'swarm',\r\n        persistent: flags.persistence !== false,\r\n      },\r\n      security: {\r\n        encryptionEnabled: flags.encryption || false,\r\n      },\r\n    };\r\n\r\n    // Initialize swarm coordinator\r\n    const coordinator = new SwarmCoordinator(config);\r\n    await coordinator.initialize();\r\n\r\n    // Spawn agents based on strategy\r\n    if (config.strategy === 'development' || config.strategy === 'auto') {\r\n      await coordinator.addAgent('architect', 'System Architect');\r\n      await coordinator.addAgent('coder', 'Backend Developer');\r\n      await coordinator.addAgent('coder', 'Frontend Developer');\r\n      await coordinator.addAgent('tester', 'QA Engineer');\r\n      await coordinator.addAgent('reviewer', 'Code Reviewer');\r\n    } else if (config.strategy === 'research') {\r\n      await coordinator.addAgent('researcher', 'Lead Researcher');\r\n      await coordinator.addAgent('analyst', 'Data Analyst');\r\n      await coordinator.addAgent('researcher', 'Research Assistant');\r\n    } else if (config.strategy === 'testing') {\r\n      await coordinator.addAgent('tester', 'Test Lead');\r\n      await coordinator.addAgent('tester', 'Integration Tester');\r\n      await coordinator.addAgent('tester', 'Performance Tester');\r\n    }\r\n\r\n    // Execute the main objective\r\n    await coordinator.executeTask(objective);\r\n\r\n    // Complete and return summary\r\n    const summary = await coordinator.complete();\r\n\r\n    return { success: true, summary };\r\n  } catch (error) {\r\n    console.error(`‚ùå Swarm execution failed: ${error.message}`);\r\n    return { success: false, error: error.message };\r\n  }\r\n}\r\n\r\n// Exports are already declared inline above\r\n"],"names":["promises","fs","path","generateId","prefix","timestamp","Date","now","toString","random","Math","substring","SwarmCoordinator","config","id","name","agents","tasks","status","startTime","initialize","console","log","description","strategy","mode","maxAgents","swarmDir","mkdir","recursive","writeFile","join","JSON","stringify","addAgent","type","agent","length","push","executeTask","task","taskObj","toLowerCase","includes","createAPIProject","runTests","genericTaskExecution","endTime","projectDir","serverCode","packageJson","version","main","scripts","start","dev","dependencies","express","devDependencies","nodemon","Promise","resolve","setTimeout","getStatus","total","completed","filter","t","in_progress","runtime","floor","complete","summary","executeSwarm","objective","flags","parseInt","maxTasks","timeout","taskTimeoutMinutes","qualityThreshold","parseFloat","reviewRequired","review","testingRequired","testing","monitoring","enabled","monitor","memory","namespace","persistent","persistence","security","encryptionEnabled","encryption","coordinator","success","error","message"],"mappings":"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"}