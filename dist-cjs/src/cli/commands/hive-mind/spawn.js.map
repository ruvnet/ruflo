{"version":3,"sources":["../../../../../src/cli/commands/hive-mind/spawn.ts"],"sourcesContent":["#!/usr/bin/env node\r\n/**\r\n * Hive Mind Agent Spawn Command\r\n *\r\n * Spawns specialized agents into the Hive Mind swarm\r\n * with automatic capability assignment and coordination.\r\n */\r\n\r\nimport { Command } from '../commander-fix.js';\r\nimport chalk from 'chalk';\r\nimport ora from 'ora';\r\nimport inquirer from 'inquirer';\r\nimport { HiveMind } from '../../../hive-mind/core/HiveMind.js';\r\nimport { AgentType, AgentCapability } from '../../../hive-mind/types.js';\r\nimport { formatSuccess, formatError, formatInfo, formatWarning } from '../../formatter.js';\r\n\r\nconst AGENT_TYPES: AgentType[] = [\r\n  'coordinator',\r\n  'researcher',\r\n  'coder',\r\n  'analyst',\r\n  'architect',\r\n  'tester',\r\n  'reviewer',\r\n  'optimizer',\r\n  'documenter',\r\n  'monitor',\r\n  'specialist',\r\n  'requirements_analyst',\r\n  'design_architect',\r\n  'system-architect',\r\n  'task_planner',\r\n  'task-planner',\r\n  'implementation_coder',\r\n  'developer',\r\n  'quality_reviewer',\r\n  'steering_documenter',\r\n];\r\n\r\nconst CAPABILITY_MAP: Record<AgentType, AgentCapability[]> = {\r\n  coordinator: ['task_management', 'resource_allocation', 'consensus_building'],\r\n  researcher: ['information_gathering', 'pattern_recognition', 'knowledge_synthesis'],\r\n  coder: ['code_generation', 'refactoring', 'debugging'],\r\n  analyst: ['data_analysis', 'performance_metrics', 'bottleneck_detection'],\r\n  architect: ['system_design', 'architecture_patterns', 'integration_planning'],\r\n  tester: ['test_generation', 'quality_assurance', 'edge_case_detection'],\r\n  reviewer: ['code_review', 'standards_enforcement', 'best_practices'],\r\n  optimizer: ['performance_optimization', 'resource_optimization', 'algorithm_improvement'],\r\n  documenter: ['documentation_generation', 'api_docs', 'user_guides'],\r\n  monitor: ['system_monitoring', 'health_checks', 'alerting'],\r\n  specialist: ['domain_expertise', 'custom_capabilities', 'problem_solving'],\r\n  requirements_analyst: ['requirements_analysis', 'user_story_creation', 'acceptance_criteria'],\r\n  design_architect: ['system_design', 'architecture', 'specs_driven_design'],\r\n  'system-architect': ['system_design', 'architecture_patterns', 'integration_planning'],\r\n  task_planner: ['task_management', 'workflow_orchestration'],\r\n  'task-planner': ['task_management', 'workflow_orchestration'],\r\n  implementation_coder: ['code_generation', 'implementation', 'debugging'],\r\n  developer: ['code_generation', 'implementation', 'debugging'],\r\n  quality_reviewer: ['code_review', 'quality_assurance', 'testing'],\r\n  steering_documenter: ['documentation_generation', 'governance']\r\n};\r\n\r\nexport const spawnCommand = new Command('spawn')\r\n  .description('Spawn specialized agents into the Hive Mind')\r\n  .argument('[type]', 'Agent type to spawn')\r\n  .option('-n, --name <string>', 'Custom agent name')\r\n  .option('-c, --capabilities <items>', 'Additional capabilities (comma-separated)')\r\n  .option('-s, --swarm-id <id>', 'Target swarm ID')\r\n  .option('-i, --interactive', 'Interactive spawn mode', false)\r\n  .option('-b, --batch <number>', 'Spawn multiple agents of same type', '1')\r\n  .option('--auto-assign', 'Automatically assign to available tasks', false)\r\n  .action(async (type, options) => {\r\n    const spinner = ora('Spawning agent...').start();\r\n\r\n    try {\r\n      // Get or prompt for swarm ID\r\n      const swarmId = options.swarmId || (await getActiveSwarmId());\r\n      if (!swarmId) {\r\n        throw new Error('No active swarm found. Initialize a Hive Mind first.');\r\n      }\r\n\r\n      // Interactive mode\r\n      if (options.interactive || !type) {\r\n        const answers = await inquirer.prompt([\r\n          {\r\n            type: 'list',\r\n            name: 'type',\r\n            message: 'Select agent type:',\r\n            choices: AGENT_TYPES,\r\n            when: !type,\r\n          },\r\n          {\r\n            type: 'checkbox',\r\n            name: 'additionalCapabilities',\r\n            message: 'Select additional capabilities:',\r\n            choices: getAllCapabilities(),\r\n            when: (answers) => {\r\n              const agentType = type || answers.type;\r\n              return agentType === 'specialist';\r\n            },\r\n          },\r\n          {\r\n            type: 'input',\r\n            name: 'customName',\r\n            message: 'Enter custom agent name (optional):',\r\n            when: !options.name,\r\n          },\r\n        ]);\r\n\r\n        type = type || answers.type;\r\n        options.name = options.name || answers.customName;\r\n        if (answers.additionalCapabilities) {\r\n          options.capabilities = answers.additionalCapabilities.join(',');\r\n        }\r\n      }\r\n\r\n      // Validate agent type\r\n      if (!AGENT_TYPES.includes(type as AgentType)) {\r\n        throw new Error(`Invalid agent type: ${type}`);\r\n      }\r\n\r\n      // Load Hive Mind\r\n      const hiveMind = await HiveMind.load(swarmId);\r\n\r\n      // Determine capabilities\r\n      const baseCapabilities = CAPABILITY_MAP[type as AgentType] || [];\r\n      const additionalCapabilities = options.capabilities\r\n        ? options.capabilities.split(',').map((c: string) => c.trim())\r\n        : [];\r\n      const capabilities = [...baseCapabilities, ...additionalCapabilities];\r\n\r\n      // Spawn agents\r\n      const batchSize = parseInt(options.batch, 10);\r\n      const spawnedAgents = [];\r\n\r\n      for (let i = 0; i < batchSize; i++) {\r\n        const agentName = options.name || `${type}-${Date.now()}-${i}`;\r\n        const agent = await hiveMind.spawnAgent({\r\n          type: type as AgentType,\r\n          name: agentName,\r\n          capabilities,\r\n          autoAssign: options.autoAssign,\r\n        });\r\n\r\n        spawnedAgents.push(agent);\r\n\r\n        if (batchSize > 1) {\r\n          spinner.text = `Spawning agents... (${i + 1}/${batchSize})`;\r\n        }\r\n      }\r\n\r\n      spinner.succeed(formatSuccess(`Successfully spawned ${batchSize} ${type} agent(s)!`));\r\n\r\n      // Display spawned agents\r\n      console.log('\\n' + chalk.bold('ðŸ¤– Spawned Agents:'));\r\n      spawnedAgents.forEach((agent) => {\r\n        console.log(formatInfo(`${agent.name} (${agent.id})`));\r\n        console.log(chalk.gray(`  Capabilities: ${agent.capabilities.join(', ')}`));\r\n        if (agent.currentTask) {\r\n          console.log(chalk.yellow(`  Assigned to: ${agent.currentTask}`));\r\n        }\r\n      });\r\n\r\n      // Show swarm stats\r\n      const stats = await hiveMind.getStats();\r\n      console.log('\\n' + chalk.bold('ðŸ“Š Swarm Statistics:'));\r\n      console.log(formatInfo(`Total Agents: ${stats.totalAgents}`));\r\n      console.log(formatInfo(`Active Agents: ${stats.activeAgents}`));\r\n      console.log(formatInfo(`Available Capacity: ${stats.availableCapacity}%`));\r\n\r\n      if (options.autoAssign && stats.pendingTasks > 0) {\r\n        console.log(formatWarning(`Auto-assigned to ${stats.pendingTasks} pending task(s)`));\r\n      }\r\n    } catch (error) {\r\n      spinner.fail(formatError('Failed to spawn agent'));\r\n      console.error(formatError((error as Error).message));\r\n      process.exit(1);\r\n    }\r\n  });\r\n\r\nasync function getActiveSwarmId(): Promise<string | null> {\r\n  const { DatabaseManager } = await import('../../../hive-mind/core/DatabaseManager.js');\r\n  const db = await DatabaseManager.getInstance();\r\n  return db.getActiveSwarmId();\r\n}\r\n\r\nfunction getAllCapabilities(): string[] {\r\n  const allCapabilities = new Set<string>();\r\n  Object.values(CAPABILITY_MAP).forEach((caps) => {\r\n    caps.forEach((cap) => allCapabilities.add(cap));\r\n  });\r\n  return Array.from(allCapabilities);\r\n}\r\n"],"names":["Command","chalk","ora","inquirer","HiveMind","formatSuccess","formatError","formatInfo","formatWarning","AGENT_TYPES","CAPABILITY_MAP","coordinator","researcher","coder","analyst","architect","tester","reviewer","optimizer","documenter","monitor","specialist","requirements_analyst","design_architect","task_planner","implementation_coder","developer","quality_reviewer","steering_documenter","spawnCommand","description","argument","option","action","type","options","spinner","start","swarmId","getActiveSwarmId","Error","interactive","answers","prompt","name","message","choices","when","getAllCapabilities","agentType","customName","additionalCapabilities","capabilities","join","includes","hiveMind","load","baseCapabilities","split","map","c","trim","batchSize","parseInt","batch","spawnedAgents","i","agentName","Date","now","agent","spawnAgent","autoAssign","push","text","succeed","console","log","bold","forEach","id","gray","currentTask","yellow","stats","getStats","totalAgents","activeAgents","availableCapacity","pendingTasks","error","fail","process","exit","DatabaseManager","db","getInstance","allCapabilities","Set","Object","values","caps","cap","add","Array","from"],"mappings":"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"}