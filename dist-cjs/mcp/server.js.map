{
  "version": 3,
  "sources": ["../../src/mcp/server.ts"],
  "sourcesContent": ["/**\n * MCP (Model Context Protocol) server implementation\n */\n\nimport {\n  MCPConfig,\n  MCPRequest,\n  MCPResponse,\n  MCPError,\n  MCPTool,\n  MCPInitializeParams,\n  MCPInitializeResult,\n  MCPSession,\n  MCPMetrics,\n  MCPProtocolVersion,\n  MCPCapabilities,\n  MCPContext,\n} from '../utils/types.js';\nimport type { IEventBus } from '../core/event-bus.js';\nimport type { ILogger } from '../core/logger.js';\nimport { MCPError as MCPErrorClass, MCPMethodNotFoundError } from '../utils/errors.js';\nimport type { ITransport } from './transports/base.js';\nimport { StdioTransport } from './transports/stdio.js';\nimport { HttpTransport } from './transports/http.js';\nimport { ToolRegistry } from './tools.js';\nimport { RequestRouter } from './router.js';\nimport { SessionManager, ISessionManager } from './session-manager.js';\nimport { AuthManager, IAuthManager } from './auth.js';\nimport { LoadBalancer, ILoadBalancer, RequestQueue } from './load-balancer.js';\nimport { createClaudeFlowTools, ClaudeFlowToolContext } from './claude-flow-tools.js';\nimport { createSwarmTools, SwarmToolContext } from './swarm-tools.js';\nimport {\n  createRuvSwarmTools,\n  RuvSwarmToolContext,\n  isRuvSwarmAvailable,\n  initializeRuvSwarmIntegration,\n} from './ruv-swarm-tools.js';\nimport { platform, arch } from 'node:os';\nimport { performance } from 'node:perf_hooks';\n\nexport interface IMCPServer {\n  start(): Promise<void>;\n  stop(): Promise<void>;\n  registerTool(tool: MCPTool): void;\n  getHealthStatus(): Promise<{\n    healthy: boolean;\n    error?: string;\n    metrics?: Record<string, number>;\n  }>;\n  getMetrics(): MCPMetrics;\n  getSessions(): MCPSession[];\n  getSession(sessionId: string): MCPSession | undefined;\n  terminateSession(sessionId: string): void;\n}\n\n/**\n * MCP server implementation\n */\nexport class MCPServer implements IMCPServer {\n  private transport: ITransport;\n  private toolRegistry: ToolRegistry;\n  private router: RequestRouter;\n  private sessionManager: ISessionManager;\n  private authManager: IAuthManager;\n  private loadBalancer?: ILoadBalancer;\n  private requestQueue?: RequestQueue;\n  private running = false;\n  private currentSession?: MCPSession | undefined;\n\n  private readonly serverInfo = {\n    name: 'Claude-Flow MCP Server',\n    version: '1.0.0',\n  };\n\n  private readonly supportedProtocolVersion: MCPProtocolVersion = {\n    major: 2024,\n    minor: 11,\n    patch: 5,\n  };\n\n  private readonly serverCapabilities: MCPCapabilities = {\n    logging: {\n      level: 'info',\n    },\n    tools: {\n      listChanged: true,\n    },\n    resources: {\n      listChanged: false,\n      subscribe: false,\n    },\n    prompts: {\n      listChanged: false,\n    },\n  };\n\n  constructor(\n    private config: MCPConfig,\n    private eventBus: IEventBus,\n    private logger: ILogger,\n    private orchestrator?: any, // Reference to orchestrator instance\n    private swarmCoordinator?: any, // Reference to swarm coordinator instance\n    private agentManager?: any, // Reference to agent manager instance\n    private resourceManager?: any, // Reference to resource manager instance\n    private messagebus?: any, // Reference to message bus instance\n    private monitor?: any, // Reference to real-time monitor instance\n  ) {\n    // Initialize transport\n    this.transport = this.createTransport();\n\n    // Initialize tool registry\n    this.toolRegistry = new ToolRegistry(logger);\n\n    // Initialize session manager\n    this.sessionManager = new SessionManager(config, logger);\n\n    // Initialize auth manager\n    this.authManager = new AuthManager(config.auth || { enabled: false, method: 'token' }, logger);\n\n    // Initialize load balancer if enabled\n    if (config.loadBalancer?.enabled) {\n      this.loadBalancer = new LoadBalancer(config.loadBalancer, logger);\n      this.requestQueue = new RequestQueue(1000, 30000, logger);\n    }\n\n    // Initialize request router\n    this.router = new RequestRouter(this.toolRegistry, logger);\n  }\n\n  async start(): Promise<void> {\n    if (this.running) {\n      throw new MCPErrorClass('MCP server already running');\n    }\n\n    this.logger.info('Starting MCP server', { transport: this.config.transport });\n\n    try {\n      // Set up request handler\n      this.transport.onRequest(async (request) => {\n        return await this.handleRequest(request);\n      });\n\n      // Start transport\n      await this.transport.start();\n\n      // Register built-in tools\n      this.registerBuiltInTools();\n\n      this.running = true;\n      this.logger.info('MCP server started successfully');\n    } catch (error) {\n      this.logger.error('Failed to start MCP server', error);\n      throw new MCPErrorClass('Failed to start MCP server', { error });\n    }\n  }\n\n  async stop(): Promise<void> {\n    if (!this.running) {\n      return;\n    }\n\n    this.logger.info('Stopping MCP server');\n\n    try {\n      // Stop transport\n      await this.transport.stop();\n\n      // Clean up session manager\n      if (this.sessionManager && 'destroy' in this.sessionManager) {\n        (this.sessionManager as any).destroy();\n      }\n\n      // Clean up all sessions\n      for (const session of this.sessionManager.getActiveSessions()) {\n        this.sessionManager.removeSession(session.id);\n      }\n\n      this.running = false;\n      this.currentSession = undefined;\n      this.logger.info('MCP server stopped');\n    } catch (error) {\n      this.logger.error('Error stopping MCP server', error);\n      throw error;\n    }\n  }\n\n  registerTool(tool: MCPTool): void {\n    this.toolRegistry.register(tool);\n    this.logger.info('Tool registered', { name: tool.name });\n  }\n\n  async getHealthStatus(): Promise<{\n    healthy: boolean;\n    error?: string;\n    metrics?: Record<string, number>;\n  }> {\n    try {\n      const transportHealth = await this.transport.getHealthStatus();\n      const registeredTools = this.toolRegistry.getToolCount();\n      const { totalRequests, successfulRequests, failedRequests } = this.router.getMetrics();\n      const sessionMetrics = this.sessionManager.getSessionMetrics();\n\n      const metrics: Record<string, number> = {\n        registeredTools,\n        totalRequests,\n        successfulRequests,\n        failedRequests,\n        totalSessions: sessionMetrics.total,\n        activeSessions: sessionMetrics.active,\n        authenticatedSessions: sessionMetrics.authenticated,\n        expiredSessions: sessionMetrics.expired,\n        ...transportHealth.metrics,\n      };\n\n      if (this.loadBalancer) {\n        const lbMetrics = this.loadBalancer.getMetrics();\n        metrics.rateLimitedRequests = lbMetrics.rateLimitedRequests;\n        metrics.averageResponseTime = lbMetrics.averageResponseTime;\n        metrics.requestsPerSecond = lbMetrics.requestsPerSecond;\n        metrics.circuitBreakerTrips = lbMetrics.circuitBreakerTrips;\n      }\n\n      const status: { healthy: boolean; error?: string; metrics?: Record<string, number> } = {\n        healthy: this.running && transportHealth.healthy,\n        metrics,\n      };\n      if (transportHealth.error !== undefined) {\n        status.error = transportHealth.error;\n      }\n      return status;\n    } catch (error) {\n      return {\n        healthy: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      };\n    }\n  }\n\n  getMetrics(): MCPMetrics {\n    const routerMetrics = this.router.getMetrics();\n    const sessionMetrics = this.sessionManager.getSessionMetrics();\n    const lbMetrics = this.loadBalancer?.getMetrics();\n\n    return {\n      totalRequests: routerMetrics.totalRequests,\n      successfulRequests: routerMetrics.successfulRequests,\n      failedRequests: routerMetrics.failedRequests,\n      averageResponseTime: lbMetrics?.averageResponseTime || 0,\n      activeSessions: sessionMetrics.active,\n      toolInvocations: {}, // TODO: Implement tool-specific metrics\n      errors: {}, // TODO: Implement error categorization\n      lastReset: lbMetrics?.lastReset || new Date(),\n    };\n  }\n\n  getSessions(): MCPSession[] {\n    return this.sessionManager.getActiveSessions();\n  }\n\n  getSession(sessionId: string): MCPSession | undefined {\n    return this.sessionManager.getSession(sessionId);\n  }\n\n  terminateSession(sessionId: string): void {\n    this.sessionManager.removeSession(sessionId);\n    if (this.currentSession?.id === sessionId) {\n      this.currentSession = undefined;\n    }\n  }\n\n  private async handleRequest(request: MCPRequest): Promise<MCPResponse> {\n    this.logger.debug('Handling MCP request', {\n      id: request.id,\n      method: request.method,\n    });\n\n    try {\n      // Handle initialization request separately\n      if (request.method === 'initialize') {\n        return await this.handleInitialize(request);\n      }\n\n      // Get or create session\n      const session = this.getOrCreateSession();\n\n      // Check if session is initialized for non-initialize requests\n      if (!session.isInitialized) {\n        return {\n          jsonrpc: '2.0',\n          id: request.id,\n          error: {\n            code: -32002,\n            message: 'Server not initialized',\n          },\n        };\n      }\n\n      // Update session activity\n      this.sessionManager.updateActivity(session.id);\n\n      // Check load balancer constraints\n      if (this.loadBalancer) {\n        const allowed = await this.loadBalancer.shouldAllowRequest(session, request);\n        if (!allowed) {\n          return {\n            jsonrpc: '2.0',\n            id: request.id,\n            error: {\n              code: -32000,\n              message: 'Rate limit exceeded or circuit breaker open',\n            },\n          };\n        }\n      }\n\n      // Record request start\n      const requestMetrics = this.loadBalancer?.recordRequestStart(session, request);\n\n      try {\n        // Process request through router\n        const result = await this.router.route(request);\n\n        const response: MCPResponse = {\n          jsonrpc: '2.0',\n          id: request.id,\n          result,\n        };\n\n        // Record success\n        if (requestMetrics) {\n          this.loadBalancer?.recordRequestEnd(requestMetrics, response);\n        }\n\n        return response;\n      } catch (error) {\n        // Record failure\n        if (requestMetrics) {\n          this.loadBalancer?.recordRequestEnd(requestMetrics, undefined, error as Error);\n        }\n        throw error;\n      }\n    } catch (error) {\n      this.logger.error('Error handling MCP request', {\n        id: request.id,\n        method: request.method,\n        error,\n      });\n\n      return {\n        jsonrpc: '2.0',\n        id: request.id,\n        error: this.errorToMCPError(error),\n      };\n    }\n  }\n\n  private async handleInitialize(request: MCPRequest): Promise<MCPResponse> {\n    try {\n      const params = request.params as MCPInitializeParams;\n\n      if (!params) {\n        return {\n          jsonrpc: '2.0',\n          id: request.id,\n          error: {\n            code: -32602,\n            message: 'Invalid params',\n          },\n        };\n      }\n\n      // Create session\n      const session = this.sessionManager.createSession(this.config.transport);\n      this.currentSession = session;\n\n      // Initialize session\n      this.sessionManager.initializeSession(session.id, params);\n\n      // Prepare response\n      const result: MCPInitializeResult = {\n        protocolVersion: this.supportedProtocolVersion,\n        capabilities: this.serverCapabilities,\n        serverInfo: this.serverInfo,\n        instructions: 'Claude-Flow MCP Server ready for tool execution',\n      };\n\n      this.logger.info('Session initialized', {\n        sessionId: session.id,\n        clientInfo: params.clientInfo,\n        protocolVersion: params.protocolVersion,\n      });\n\n      return {\n        jsonrpc: '2.0',\n        id: request.id,\n        result,\n      };\n    } catch (error) {\n      this.logger.error('Error during initialization', error);\n      return {\n        jsonrpc: '2.0',\n        id: request.id,\n        error: this.errorToMCPError(error),\n      };\n    }\n  }\n\n  private getOrCreateSession(): MCPSession {\n    if (this.currentSession) {\n      return this.currentSession;\n    }\n\n    // For stdio transport, create a default session\n    const session = this.sessionManager.createSession(this.config.transport);\n    this.currentSession = session;\n    return session;\n  }\n\n  private createTransport(): ITransport {\n    switch (this.config.transport) {\n      case 'stdio':\n        return new StdioTransport(this.logger);\n\n      case 'http':\n        return new HttpTransport(\n          this.config.host || 'localhost',\n          this.config.port || 3000,\n          this.config.tlsEnabled || false,\n          this.logger,\n        );\n\n      default:\n        throw new MCPErrorClass(`Unknown transport type: ${this.config.transport}`);\n    }\n  }\n\n  private registerBuiltInTools(): void {\n    // System information tool\n    this.registerTool({\n      name: 'system/info',\n      description: 'Get system information',\n      inputSchema: {\n        type: 'object',\n        properties: {},\n      },\n      handler: async () => {\n        return {\n          version: '1.0.0',\n          platform: platform(),\n          arch: arch(),\n          runtime: 'Node.js',\n          uptime: performance.now(),\n        };\n      },\n    });\n\n    // Health check tool\n    this.registerTool({\n      name: 'system/health',\n      description: 'Get system health status',\n      inputSchema: {\n        type: 'object',\n        properties: {},\n      },\n      handler: async () => {\n        return await this.getHealthStatus();\n      },\n    });\n\n    // List tools\n    this.registerTool({\n      name: 'tools/list',\n      description: 'List all available tools',\n      inputSchema: {\n        type: 'object',\n        properties: {},\n      },\n      handler: async () => {\n        return this.toolRegistry.listTools();\n      },\n    });\n\n    // Tool schema\n    this.registerTool({\n      name: 'tools/schema',\n      description: 'Get schema for a specific tool',\n      inputSchema: {\n        type: 'object',\n        properties: {\n          name: { type: 'string' },\n        },\n        required: ['name'],\n      },\n      handler: async (input: any) => {\n        const tool = this.toolRegistry.getTool(input.name);\n        if (!tool) {\n          throw new Error(`Tool not found: ${input.name}`);\n        }\n        return {\n          name: tool.name,\n          description: tool.description,\n          inputSchema: tool.inputSchema,\n        };\n      },\n    });\n\n    // Register Claude-Flow specific tools if orchestrator is available\n    if (this.orchestrator) {\n      const claudeFlowTools = createClaudeFlowTools(this.logger);\n\n      for (const tool of claudeFlowTools) {\n        // Wrap the handler to inject orchestrator context\n        const originalHandler = tool.handler;\n        tool.handler = async (input: unknown, context?: MCPContext) => {\n          const claudeFlowContext: ClaudeFlowToolContext = {\n            ...context,\n            orchestrator: this.orchestrator,\n          } as ClaudeFlowToolContext;\n\n          return await originalHandler(input, claudeFlowContext);\n        };\n\n        this.registerTool(tool);\n      }\n\n      this.logger.info('Registered Claude-Flow tools', { count: claudeFlowTools.length });\n    } else {\n      this.logger.warn('Orchestrator not available - Claude-Flow tools not registered');\n    }\n\n    // Register Swarm-specific tools if swarm components are available\n    if (this.swarmCoordinator || this.agentManager || this.resourceManager) {\n      const swarmTools = createSwarmTools(this.logger);\n\n      for (const tool of swarmTools) {\n        // Wrap the handler to inject swarm context\n        const originalHandler = tool.handler;\n        tool.handler = async (input: unknown, context?: MCPContext) => {\n          const swarmContext: SwarmToolContext = {\n            ...context,\n            swarmCoordinator: this.swarmCoordinator,\n            agentManager: this.agentManager,\n            resourceManager: this.resourceManager,\n            messageBus: this.messagebus,\n            monitor: this.monitor,\n          } as SwarmToolContext;\n\n          return await originalHandler(input, swarmContext);\n        };\n\n        this.registerTool(tool);\n      }\n\n      this.logger.info('Registered Swarm tools', { count: swarmTools.length });\n    } else {\n      this.logger.warn('Swarm components not available - Swarm tools not registered');\n    }\n\n    // Register ruv-swarm MCP tools if available\n    this.registerRuvSwarmTools();\n  }\n\n  /**\n   * Register ruv-swarm MCP tools if available\n   */\n  private async registerRuvSwarmTools(): Promise<void> {\n    try {\n      // Check if ruv-swarm is available\n      const available = await isRuvSwarmAvailable(this.logger);\n\n      if (!available) {\n        this.logger.info('ruv-swarm not available - skipping ruv-swarm MCP tools registration');\n        return;\n      }\n\n      // Initialize ruv-swarm integration\n      const workingDirectory = process.cwd();\n      const integration = await initializeRuvSwarmIntegration(workingDirectory, this.logger);\n\n      if (!integration.success) {\n        this.logger.warn('Failed to initialize ruv-swarm integration', {\n          error: integration.error,\n        });\n        return;\n      }\n\n      // Create ruv-swarm tools\n      const ruvSwarmTools = createRuvSwarmTools(this.logger);\n\n      for (const tool of ruvSwarmTools) {\n        // Wrap the handler to inject ruv-swarm context\n        const originalHandler = tool.handler;\n        tool.handler = async (input: unknown, context?: MCPContext) => {\n          const ruvSwarmContext: RuvSwarmToolContext = {\n            ...context,\n            workingDirectory,\n            sessionId: `mcp-session-${Date.now()}`,\n            swarmId: process.env.CLAUDE_SWARM_ID || `mcp-swarm-${Date.now()}`,\n          };\n\n          return await originalHandler(input, ruvSwarmContext);\n        };\n\n        this.registerTool(tool);\n      }\n\n      this.logger.info('Registered ruv-swarm MCP tools', {\n        count: ruvSwarmTools.length,\n        integration: integration.data,\n      });\n    } catch (error) {\n      this.logger.error('Error registering ruv-swarm MCP tools', error);\n    }\n  }\n\n  private errorToMCPError(error): MCPError {\n    if (error instanceof MCPMethodNotFoundError) {\n      return {\n        code: -32601,\n        message: error instanceof Error ? error.message : String(error),\n        data: error.details,\n      };\n    }\n\n    if (error instanceof MCPErrorClass) {\n      return {\n        code: -32603,\n        message: error instanceof Error ? error.message : String(error),\n        data: error.details,\n      };\n    }\n\n    if (error instanceof Error) {\n      return {\n        code: -32603,\n        message: error instanceof Error ? error.message : String(error),\n      };\n    }\n\n    return {\n      code: -32603,\n      message: 'Internal error',\n      data: error,\n    };\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAoBA,oBAAkE;AAElE,mBAA+B;AAC/B,kBAA8B;AAC9B,mBAA6B;AAC7B,oBAA8B;AAC9B,6BAAgD;AAChD,kBAA0C;AAC1C,2BAA0D;AAC1D,+BAA6D;AAC7D,yBAAmD;AACnD,6BAKO;AACP,qBAA+B;AAC/B,6BAA4B;AAoBrB,MAAM,UAAgC;AAAA,EAsC3C,YACU,QACA,UACA,QACA,cACA,kBACA,cACA,iBACA,YACA,SACR;AATQ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGR,SAAK,YAAY,KAAK,gBAAgB;AAGtC,SAAK,eAAe,IAAI,0BAAa,MAAM;AAG3C,SAAK,iBAAiB,IAAI,sCAAe,QAAQ,MAAM;AAGvD,SAAK,cAAc,IAAI,wBAAY,OAAO,QAAQ,EAAE,SAAS,OAAO,QAAQ,QAAQ,GAAG,MAAM;AAG7F,QAAI,OAAO,cAAc,SAAS;AAChC,WAAK,eAAe,IAAI,kCAAa,OAAO,cAAc,MAAM;AAChE,WAAK,eAAe,IAAI,kCAAa,KAAM,KAAO,MAAM;AAAA,IAC1D;AAGA,SAAK,SAAS,IAAI,4BAAc,KAAK,cAAc,MAAM;AAAA,EAC3D;AAAA,EA/HF,OA0D6C;AAAA;AAAA;AAAA,EACnC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,UAAU;AAAA,EACV;AAAA,EAES,aAAa;AAAA,IAC5B,MAAM;AAAA,IACN,SAAS;AAAA,EACX;AAAA,EAEiB,2BAA+C;AAAA,IAC9D,OAAO;AAAA,IACP,OAAO;AAAA,IACP,OAAO;AAAA,EACT;AAAA,EAEiB,qBAAsC;AAAA,IACrD,SAAS;AAAA,MACP,OAAO;AAAA,IACT;AAAA,IACA,OAAO;AAAA,MACL,aAAa;AAAA,IACf;AAAA,IACA,WAAW;AAAA,MACT,aAAa;AAAA,MACb,WAAW;AAAA,IACb;AAAA,IACA,SAAS;AAAA,MACP,aAAa;AAAA,IACf;AAAA,EACF;AAAA,EAmCA,MAAM,QAAuB;AAC3B,QAAI,KAAK,SAAS;AAChB,YAAM,IAAI,cAAAA,SAAc,4BAA4B;AAAA,IACtD;AAEA,SAAK,OAAO,KAAK,uBAAuB,EAAE,WAAW,KAAK,OAAO,UAAU,CAAC;AAE5E,QAAI;AAEF,WAAK,UAAU,UAAU,OAAO,YAAY;AAC1C,eAAO,MAAM,KAAK,cAAc,OAAO;AAAA,MACzC,CAAC;AAGD,YAAM,KAAK,UAAU,MAAM;AAG3B,WAAK,qBAAqB;AAE1B,WAAK,UAAU;AACf,WAAK,OAAO,KAAK,iCAAiC;AAAA,IACpD,SAAS,OAAO;AACd,WAAK,OAAO,MAAM,8BAA8B,KAAK;AACrD,YAAM,IAAI,cAAAA,SAAc,8BAA8B,EAAE,MAAM,CAAC;AAAA,IACjE;AAAA,EACF;AAAA,EAEA,MAAM,OAAsB;AAC1B,QAAI,CAAC,KAAK,SAAS;AACjB;AAAA,IACF;AAEA,SAAK,OAAO,KAAK,qBAAqB;AAEtC,QAAI;AAEF,YAAM,KAAK,UAAU,KAAK;AAG1B,UAAI,KAAK,kBAAkB,aAAa,KAAK,gBAAgB;AAC3D,QAAC,KAAK,eAAuB,QAAQ;AAAA,MACvC;AAGA,iBAAW,WAAW,KAAK,eAAe,kBAAkB,GAAG;AAC7D,aAAK,eAAe,cAAc,QAAQ,EAAE;AAAA,MAC9C;AAEA,WAAK,UAAU;AACf,WAAK,iBAAiB;AACtB,WAAK,OAAO,KAAK,oBAAoB;AAAA,IACvC,SAAS,OAAO;AACd,WAAK,OAAO,MAAM,6BAA6B,KAAK;AACpD,YAAM;AAAA,IACR;AAAA,EACF;AAAA,EAEA,aAAa,MAAqB;AAChC,SAAK,aAAa,SAAS,IAAI;AAC/B,SAAK,OAAO,KAAK,mBAAmB,EAAE,MAAM,KAAK,KAAK,CAAC;AAAA,EACzD;AAAA,EAEA,MAAM,kBAIH;AACD,QAAI;AACF,YAAM,kBAAkB,MAAM,KAAK,UAAU,gBAAgB;AAC7D,YAAM,kBAAkB,KAAK,aAAa,aAAa;AACvD,YAAM,EAAE,eAAe,oBAAoB,eAAe,IAAI,KAAK,OAAO,WAAW;AACrF,YAAM,iBAAiB,KAAK,eAAe,kBAAkB;AAE7D,YAAM,UAAkC;AAAA,QACtC;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA,eAAe,eAAe;AAAA,QAC9B,gBAAgB,eAAe;AAAA,QAC/B,uBAAuB,eAAe;AAAA,QACtC,iBAAiB,eAAe;AAAA,QAChC,GAAG,gBAAgB;AAAA,MACrB;AAEA,UAAI,KAAK,cAAc;AACrB,cAAM,YAAY,KAAK,aAAa,WAAW;AAC/C,gBAAQ,sBAAsB,UAAU;AACxC,gBAAQ,sBAAsB,UAAU;AACxC,gBAAQ,oBAAoB,UAAU;AACtC,gBAAQ,sBAAsB,UAAU;AAAA,MAC1C;AAEA,YAAM,SAAiF;AAAA,QACrF,SAAS,KAAK,WAAW,gBAAgB;AAAA,QACzC;AAAA,MACF;AACA,UAAI,gBAAgB,UAAU,QAAW;AACvC,eAAO,QAAQ,gBAAgB;AAAA,MACjC;AACA,aAAO;AAAA,IACT,SAAS,OAAO;AACd,aAAO;AAAA,QACL,SAAS;AAAA,QACT,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,MAClD;AAAA,IACF;AAAA,EACF;AAAA,EAEA,aAAyB;AACvB,UAAM,gBAAgB,KAAK,OAAO,WAAW;AAC7C,UAAM,iBAAiB,KAAK,eAAe,kBAAkB;AAC7D,UAAM,YAAY,KAAK,cAAc,WAAW;AAEhD,WAAO;AAAA,MACL,eAAe,cAAc;AAAA,MAC7B,oBAAoB,cAAc;AAAA,MAClC,gBAAgB,cAAc;AAAA,MAC9B,qBAAqB,WAAW,uBAAuB;AAAA,MACvD,gBAAgB,eAAe;AAAA,MAC/B,iBAAiB,CAAC;AAAA;AAAA,MAClB,QAAQ,CAAC;AAAA;AAAA,MACT,WAAW,WAAW,aAAa,oBAAI,KAAK;AAAA,IAC9C;AAAA,EACF;AAAA,EAEA,cAA4B;AAC1B,WAAO,KAAK,eAAe,kBAAkB;AAAA,EAC/C;AAAA,EAEA,WAAW,WAA2C;AACpD,WAAO,KAAK,eAAe,WAAW,SAAS;AAAA,EACjD;AAAA,EAEA,iBAAiB,WAAyB;AACxC,SAAK,eAAe,cAAc,SAAS;AAC3C,QAAI,KAAK,gBAAgB,OAAO,WAAW;AACzC,WAAK,iBAAiB;AAAA,IACxB;AAAA,EACF;AAAA,EAEA,MAAc,cAAc,SAA2C;AACrE,SAAK,OAAO,MAAM,wBAAwB;AAAA,MACxC,IAAI,QAAQ;AAAA,MACZ,QAAQ,QAAQ;AAAA,IAClB,CAAC;AAED,QAAI;AAEF,UAAI,QAAQ,WAAW,cAAc;AACnC,eAAO,MAAM,KAAK,iBAAiB,OAAO;AAAA,MAC5C;AAGA,YAAM,UAAU,KAAK,mBAAmB;AAGxC,UAAI,CAAC,QAAQ,eAAe;AAC1B,eAAO;AAAA,UACL,SAAS;AAAA,UACT,IAAI,QAAQ;AAAA,UACZ,OAAO;AAAA,YACL,MAAM;AAAA,YACN,SAAS;AAAA,UACX;AAAA,QACF;AAAA,MACF;AAGA,WAAK,eAAe,eAAe,QAAQ,EAAE;AAG7C,UAAI,KAAK,cAAc;AACrB,cAAM,UAAU,MAAM,KAAK,aAAa,mBAAmB,SAAS,OAAO;AAC3E,YAAI,CAAC,SAAS;AACZ,iBAAO;AAAA,YACL,SAAS;AAAA,YACT,IAAI,QAAQ;AAAA,YACZ,OAAO;AAAA,cACL,MAAM;AAAA,cACN,SAAS;AAAA,YACX;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAGA,YAAM,iBAAiB,KAAK,cAAc,mBAAmB,SAAS,OAAO;AAE7E,UAAI;AAEF,cAAM,SAAS,MAAM,KAAK,OAAO,MAAM,OAAO;AAE9C,cAAM,WAAwB;AAAA,UAC5B,SAAS;AAAA,UACT,IAAI,QAAQ;AAAA,UACZ;AAAA,QACF;AAGA,YAAI,gBAAgB;AAClB,eAAK,cAAc,iBAAiB,gBAAgB,QAAQ;AAAA,QAC9D;AAEA,eAAO;AAAA,MACT,SAAS,OAAO;AAEd,YAAI,gBAAgB;AAClB,eAAK,cAAc,iBAAiB,gBAAgB,QAAW,KAAc;AAAA,QAC/E;AACA,cAAM;AAAA,MACR;AAAA,IACF,SAAS,OAAO;AACd,WAAK,OAAO,MAAM,8BAA8B;AAAA,QAC9C,IAAI,QAAQ;AAAA,QACZ,QAAQ,QAAQ;AAAA,QAChB;AAAA,MACF,CAAC;AAED,aAAO;AAAA,QACL,SAAS;AAAA,QACT,IAAI,QAAQ;AAAA,QACZ,OAAO,KAAK,gBAAgB,KAAK;AAAA,MACnC;AAAA,IACF;AAAA,EACF;AAAA,EAEA,MAAc,iBAAiB,SAA2C;AACxE,QAAI;AACF,YAAM,SAAS,QAAQ;AAEvB,UAAI,CAAC,QAAQ;AACX,eAAO;AAAA,UACL,SAAS;AAAA,UACT,IAAI,QAAQ;AAAA,UACZ,OAAO;AAAA,YACL,MAAM;AAAA,YACN,SAAS;AAAA,UACX;AAAA,QACF;AAAA,MACF;AAGA,YAAM,UAAU,KAAK,eAAe,cAAc,KAAK,OAAO,SAAS;AACvE,WAAK,iBAAiB;AAGtB,WAAK,eAAe,kBAAkB,QAAQ,IAAI,MAAM;AAGxD,YAAM,SAA8B;AAAA,QAClC,iBAAiB,KAAK;AAAA,QACtB,cAAc,KAAK;AAAA,QACnB,YAAY,KAAK;AAAA,QACjB,cAAc;AAAA,MAChB;AAEA,WAAK,OAAO,KAAK,uBAAuB;AAAA,QACtC,WAAW,QAAQ;AAAA,QACnB,YAAY,OAAO;AAAA,QACnB,iBAAiB,OAAO;AAAA,MAC1B,CAAC;AAED,aAAO;AAAA,QACL,SAAS;AAAA,QACT,IAAI,QAAQ;AAAA,QACZ;AAAA,MACF;AAAA,IACF,SAAS,OAAO;AACd,WAAK,OAAO,MAAM,+BAA+B,KAAK;AACtD,aAAO;AAAA,QACL,SAAS;AAAA,QACT,IAAI,QAAQ;AAAA,QACZ,OAAO,KAAK,gBAAgB,KAAK;AAAA,MACnC;AAAA,IACF;AAAA,EACF;AAAA,EAEQ,qBAAiC;AACvC,QAAI,KAAK,gBAAgB;AACvB,aAAO,KAAK;AAAA,IACd;AAGA,UAAM,UAAU,KAAK,eAAe,cAAc,KAAK,OAAO,SAAS;AACvE,SAAK,iBAAiB;AACtB,WAAO;AAAA,EACT;AAAA,EAEQ,kBAA8B;AACpC,YAAQ,KAAK,OAAO,WAAW;AAAA,MAC7B,KAAK;AACH,eAAO,IAAI,4BAAe,KAAK,MAAM;AAAA,MAEvC,KAAK;AACH,eAAO,IAAI;AAAA,UACT,KAAK,OAAO,QAAQ;AAAA,UACpB,KAAK,OAAO,QAAQ;AAAA,UACpB,KAAK,OAAO,cAAc;AAAA,UAC1B,KAAK;AAAA,QACP;AAAA,MAEF;AACE,cAAM,IAAI,cAAAA,SAAc,2BAA2B,KAAK,OAAO,SAAS,EAAE;AAAA,IAC9E;AAAA,EACF;AAAA,EAEQ,uBAA6B;AAEnC,SAAK,aAAa;AAAA,MAChB,MAAM;AAAA,MACN,aAAa;AAAA,MACb,aAAa;AAAA,QACX,MAAM;AAAA,QACN,YAAY,CAAC;AAAA,MACf;AAAA,MACA,SAAS,YAAY;AACnB,eAAO;AAAA,UACL,SAAS;AAAA,UACT,cAAU,yBAAS;AAAA,UACnB,UAAM,qBAAK;AAAA,UACX,SAAS;AAAA,UACT,QAAQ,mCAAY,IAAI;AAAA,QAC1B;AAAA,MACF;AAAA,IACF,CAAC;AAGD,SAAK,aAAa;AAAA,MAChB,MAAM;AAAA,MACN,aAAa;AAAA,MACb,aAAa;AAAA,QACX,MAAM;AAAA,QACN,YAAY,CAAC;AAAA,MACf;AAAA,MACA,SAAS,YAAY;AACnB,eAAO,MAAM,KAAK,gBAAgB;AAAA,MACpC;AAAA,IACF,CAAC;AAGD,SAAK,aAAa;AAAA,MAChB,MAAM;AAAA,MACN,aAAa;AAAA,MACb,aAAa;AAAA,QACX,MAAM;AAAA,QACN,YAAY,CAAC;AAAA,MACf;AAAA,MACA,SAAS,YAAY;AACnB,eAAO,KAAK,aAAa,UAAU;AAAA,MACrC;AAAA,IACF,CAAC;AAGD,SAAK,aAAa;AAAA,MAChB,MAAM;AAAA,MACN,aAAa;AAAA,MACb,aAAa;AAAA,QACX,MAAM;AAAA,QACN,YAAY;AAAA,UACV,MAAM,EAAE,MAAM,SAAS;AAAA,QACzB;AAAA,QACA,UAAU,CAAC,MAAM;AAAA,MACnB;AAAA,MACA,SAAS,OAAO,UAAe;AAC7B,cAAM,OAAO,KAAK,aAAa,QAAQ,MAAM,IAAI;AACjD,YAAI,CAAC,MAAM;AACT,gBAAM,IAAI,MAAM,mBAAmB,MAAM,IAAI,EAAE;AAAA,QACjD;AACA,eAAO;AAAA,UACL,MAAM,KAAK;AAAA,UACX,aAAa,KAAK;AAAA,UAClB,aAAa,KAAK;AAAA,QACpB;AAAA,MACF;AAAA,IACF,CAAC;AAGD,QAAI,KAAK,cAAc;AACrB,YAAM,sBAAkB,gDAAsB,KAAK,MAAM;AAEzD,iBAAW,QAAQ,iBAAiB;AAElC,cAAM,kBAAkB,KAAK;AAC7B,aAAK,UAAU,OAAO,OAAgB,YAAyB;AAC7D,gBAAM,oBAA2C;AAAA,YAC/C,GAAG;AAAA,YACH,cAAc,KAAK;AAAA,UACrB;AAEA,iBAAO,MAAM,gBAAgB,OAAO,iBAAiB;AAAA,QACvD;AAEA,aAAK,aAAa,IAAI;AAAA,MACxB;AAEA,WAAK,OAAO,KAAK,gCAAgC,EAAE,OAAO,gBAAgB,OAAO,CAAC;AAAA,IACpF,OAAO;AACL,WAAK,OAAO,KAAK,+DAA+D;AAAA,IAClF;AAGA,QAAI,KAAK,oBAAoB,KAAK,gBAAgB,KAAK,iBAAiB;AACtE,YAAM,iBAAa,qCAAiB,KAAK,MAAM;AAE/C,iBAAW,QAAQ,YAAY;AAE7B,cAAM,kBAAkB,KAAK;AAC7B,aAAK,UAAU,OAAO,OAAgB,YAAyB;AAC7D,gBAAM,eAAiC;AAAA,YACrC,GAAG;AAAA,YACH,kBAAkB,KAAK;AAAA,YACvB,cAAc,KAAK;AAAA,YACnB,iBAAiB,KAAK;AAAA,YACtB,YAAY,KAAK;AAAA,YACjB,SAAS,KAAK;AAAA,UAChB;AAEA,iBAAO,MAAM,gBAAgB,OAAO,YAAY;AAAA,QAClD;AAEA,aAAK,aAAa,IAAI;AAAA,MACxB;AAEA,WAAK,OAAO,KAAK,0BAA0B,EAAE,OAAO,WAAW,OAAO,CAAC;AAAA,IACzE,OAAO;AACL,WAAK,OAAO,KAAK,6DAA6D;AAAA,IAChF;AAGA,SAAK,sBAAsB;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,wBAAuC;AACnD,QAAI;AAEF,YAAM,YAAY,UAAM,4CAAoB,KAAK,MAAM;AAEvD,UAAI,CAAC,WAAW;AACd,aAAK,OAAO,KAAK,qEAAqE;AACtF;AAAA,MACF;AAGA,YAAM,mBAAmB,QAAQ,IAAI;AACrC,YAAM,cAAc,UAAM,sDAA8B,kBAAkB,KAAK,MAAM;AAErF,UAAI,CAAC,YAAY,SAAS;AACxB,aAAK,OAAO,KAAK,8CAA8C;AAAA,UAC7D,OAAO,YAAY;AAAA,QACrB,CAAC;AACD;AAAA,MACF;AAGA,YAAM,oBAAgB,4CAAoB,KAAK,MAAM;AAErD,iBAAW,QAAQ,eAAe;AAEhC,cAAM,kBAAkB,KAAK;AAC7B,aAAK,UAAU,OAAO,OAAgB,YAAyB;AAC7D,gBAAM,kBAAuC;AAAA,YAC3C,GAAG;AAAA,YACH;AAAA,YACA,WAAW,eAAe,KAAK,IAAI,CAAC;AAAA,YACpC,SAAS,QAAQ,IAAI,mBAAmB,aAAa,KAAK,IAAI,CAAC;AAAA,UACjE;AAEA,iBAAO,MAAM,gBAAgB,OAAO,eAAe;AAAA,QACrD;AAEA,aAAK,aAAa,IAAI;AAAA,MACxB;AAEA,WAAK,OAAO,KAAK,kCAAkC;AAAA,QACjD,OAAO,cAAc;AAAA,QACrB,aAAa,YAAY;AAAA,MAC3B,CAAC;AAAA,IACH,SAAS,OAAO;AACd,WAAK,OAAO,MAAM,yCAAyC,KAAK;AAAA,IAClE;AAAA,EACF;AAAA,EAEQ,gBAAgB,OAAiB;AACvC,QAAI,iBAAiB,sCAAwB;AAC3C,aAAO;AAAA,QACL,MAAM;AAAA,QACN,SAAS,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK;AAAA,QAC9D,MAAM,MAAM;AAAA,MACd;AAAA,IACF;AAEA,QAAI,iBAAiB,cAAAA,UAAe;AAClC,aAAO;AAAA,QACL,MAAM;AAAA,QACN,SAAS,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK;AAAA,QAC9D,MAAM,MAAM;AAAA,MACd;AAAA,IACF;AAEA,QAAI,iBAAiB,OAAO;AAC1B,aAAO;AAAA,QACL,MAAM;AAAA,QACN,SAAS,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK;AAAA,MAChE;AAAA,IACF;AAEA,WAAO;AAAA,MACL,MAAM;AAAA,MACN,SAAS;AAAA,MACT,MAAM;AAAA,IACR;AAAA,EACF;AACF;",
  "names": ["MCPErrorClass"]
}
