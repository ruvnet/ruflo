{
  "version": 3,
  "sources": ["../../src/migration/logger.ts"],
  "sourcesContent": ["import * as process from 'node:process';\n/**\n * Migration Logger - Structured logging for migration operations\n */\n\nimport * as fs from 'fs-extra';\nimport * as path from 'path';\nimport * as chalk from 'chalk';\n\nexport interface LogEntry {\n  timestamp: Date;\n  level: 'info' | 'warn' | 'error' | 'success' | 'debug';\n  message: string;\n  context?: any;\n  stack?: string;\n}\n\nexport class MigrationLogger {\n  private logFile?: string;\n  private entries: LogEntry[] = [];\n\n  constructor(logFile?: string) {\n    this.logFile = logFile;\n  }\n\n  info(message: string, context?: any): void {\n    this.log('info', message, context);\n    console.log(chalk.blue(`\u2139\uFE0F  ${message}`));\n  }\n\n  warn(message: string, context?: any): void {\n    this.log('warn', message, context);\n    console.log(chalk.yellow(`\u26A0\uFE0F  ${message}`));\n  }\n\n  error(message: string, error?: Error | any, context?: any): void {\n    this.log('error', message, context, error?.stack);\n    console.log(chalk.red(`\u274C ${message}`));\n    if (error && (error instanceof Error ? error.message : String(error)) !== message) {\n      console.log(chalk.red(`   ${error instanceof Error ? error.message : String(error)}`));\n    }\n  }\n\n  success(message: string, context?: any): void {\n    this.log('success', message, context);\n    console.log(chalk.green(`\u2705 ${message}`));\n  }\n\n  debug(message: string, context?: any): void {\n    if (process.env.DEBUG === 'true' || process.env.NODE_ENV === 'development') {\n      this.log('debug', message, context);\n      console.log(chalk.gray(`\uD83D\uDD0D ${message}`));\n    }\n  }\n\n  private log(level: LogEntry['level'], message: string, context?: any, stack?: string): void {\n    const entry: LogEntry = {\n      timestamp: new Date(),\n      level,\n      message,\n      context,\n      stack,\n    };\n\n    this.entries.push(entry);\n\n    if (this.logFile) {\n      this.writeToFile(entry);\n    }\n  }\n\n  private async writeToFile(entry: LogEntry): Promise<void> {\n    if (!this.logFile) return;\n\n    try {\n      const logDir = path.dirname(this.logFile);\n      await fs.ensureDir(logDir);\n\n      const logLine = JSON.stringify(entry) + '\\n';\n      await fs.appendFile(this.logFile, logLine);\n    } catch (error) {\n      // Prevent recursive logging\n      console.error(\n        'Failed to write to log file:',\n        error instanceof Error ? error.message : String(error),\n      );\n    }\n  }\n\n  async saveToFile(filePath: string): Promise<void> {\n    await fs.ensureDir(path.dirname(filePath));\n    await fs.writeJson(filePath, this.entries, { spaces: 2 });\n  }\n\n  getEntries(): LogEntry[] {\n    return [...this.entries];\n  }\n\n  getEntriesByLevel(level: LogEntry['level']): LogEntry[] {\n    return this.entries.filter((entry) => entry.level === level);\n  }\n\n  clear(): void {\n    this.entries = [];\n  }\n\n  printSummary(): void {\n    const summary = {\n      total: this.entries.length,\n      info: this.getEntriesByLevel('info').length,\n      warn: this.getEntriesByLevel('warn').length,\n      error: this.getEntriesByLevel('error').length,\n      success: this.getEntriesByLevel('success').length,\n      debug: this.getEntriesByLevel('debug').length,\n    };\n\n    console.log(chalk.bold('\\n\uD83D\uDCCA Migration Log Summary'));\n    console.log(chalk.gray('\u2500'.repeat(30)));\n    console.log(`Total entries: ${summary.total}`);\n    console.log(`${chalk.blue('Info:')} ${summary.info}`);\n    console.log(`${chalk.green('Success:')} ${summary.success}`);\n    console.log(`${chalk.yellow('Warnings:')} ${summary.warn}`);\n    console.log(`${chalk.red('Errors:')} ${summary.error}`);\n    if (summary.debug > 0) {\n      console.log(`${chalk.gray('Debug:')} ${summary.debug}`);\n    }\n    console.log(chalk.gray('\u2500'.repeat(30)));\n  }\n}\n\n// Global logger instance\nexport const logger = new MigrationLogger();\n\n// Set log file if in production\nif (process.env.NODE_ENV === 'production') {\n  const logFile = path.join(process.cwd(), 'logs', 'migration.log');\n  logger['logFile'] = logFile;\n}\n"],
  "mappings": "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",
  "names": []
}
