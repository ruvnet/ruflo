{"version":3,"sources":["../../../../src/templates/claude-optimized/validate-template.js"],"sourcesContent":["#!/usr/bin/env node\r\n\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\n/**\r\n * Validate Claude optimized template installation\r\n * This script verifies that all required files are present and properly formatted\r\n */\r\n\r\nconst TEMPLATE_DIR = path.join(__dirname, '.claude');\r\nconst MANIFEST_PATH = path.join(__dirname, 'manifest.json');\r\n\r\n// Colors for console output\r\nconst colors = {\r\n  green: '\\x1b[32m',\r\n  red: '\\x1b[31m',\r\n  yellow: '\\x1b[33m',\r\n  blue: '\\x1b[34m',\r\n  reset: '\\x1b[0m',\r\n};\r\n\r\nfunction log(message, color = 'reset') {\r\n  console.log(colors[color] + message + colors.reset);\r\n}\r\n\r\n// Read manifest\r\nlet manifest;\r\ntry {\r\n  manifest = JSON.parse(fs.readFileSync(MANIFEST_PATH, 'utf8'));\r\n  log('âœ“ Manifest loaded successfully', 'green');\r\n} catch (error) {\r\n  log('âœ— Failed to load manifest: ' + error.message, 'red');\r\n  process.exit(1);\r\n}\r\n\r\nlet totalTests = 0;\r\nlet passedTests = 0;\r\n\r\nfunction test(description, condition) {\r\n  totalTests++;\r\n  if (condition) {\r\n    log(`  âœ“ ${description}`, 'green');\r\n    passedTests++;\r\n  } else {\r\n    log(`  âœ— ${description}`, 'red');\r\n  }\r\n}\r\n\r\n// Test 1: Template directory exists\r\nlog('\\n1. Checking template directory...', 'blue');\r\ntest('Template directory exists', fs.existsSync(TEMPLATE_DIR));\r\n\r\n// Test 2: Directory structure\r\nlog('\\n2. Validating directory structure...', 'blue');\r\nfor (const [dirName, dirInfo] of Object.entries(manifest.directories)) {\r\n  const dirPath = path.join(TEMPLATE_DIR, dirInfo.path);\r\n  test(`Directory ${dirInfo.path} exists`, fs.existsSync(dirPath));\r\n}\r\n\r\n// Test 3: File presence\r\nlog('\\n3. Checking file presence...', 'blue');\r\nfor (const file of manifest.files) {\r\n  const filePath = path.join(TEMPLATE_DIR, file.destination);\r\n  test(`File ${file.destination} exists`, fs.existsSync(filePath));\r\n}\r\n\r\n// Test 4: File content validation\r\nlog('\\n4. Validating file content...', 'blue');\r\nconst sampleFiles = ['commands/sparc.md', 'commands/sparc/architect.md', 'BATCHTOOLS_GUIDE.md'];\r\n\r\nfor (const fileName of sampleFiles) {\r\n  const filePath = path.join(TEMPLATE_DIR, fileName);\r\n  if (fs.existsSync(filePath)) {\r\n    const content = fs.readFileSync(filePath, 'utf8');\r\n    test(`${fileName} has content`, content.length > 100);\r\n    test(`${fileName} contains frontmatter`, content.startsWith('---'));\r\n  }\r\n}\r\n\r\n// Test 5: Command structure validation\r\nlog('\\n5. Validating command structure...', 'blue');\r\nconst sparcCommands = manifest.files.filter((f) => f.category === 'sparc-mode');\r\nfor (const cmd of sparcCommands.slice(0, 3)) {\r\n  // Test first 3 commands\r\n  const filePath = path.join(TEMPLATE_DIR, cmd.destination);\r\n  if (fs.existsSync(filePath)) {\r\n    const content = fs.readFileSync(filePath, 'utf8');\r\n    test(\r\n      `${cmd.destination} has proper structure`,\r\n      content.includes('## Instructions') || content.includes('You are'),\r\n    );\r\n  }\r\n}\r\n\r\n// Test 6: Test files validation\r\nlog('\\n6. Validating test files...', 'blue');\r\nconst testFiles = manifest.files.filter((f) => f.category === 'test');\r\nfor (const testFile of testFiles.slice(0, 3)) {\r\n  // Test first 3 test files\r\n  const filePath = path.join(TEMPLATE_DIR, testFile.destination);\r\n  if (fs.existsSync(filePath)) {\r\n    const content = fs.readFileSync(filePath, 'utf8');\r\n    test(\r\n      `${testFile.destination} has test structure`,\r\n      content.includes('describe') || content.includes('test') || content.includes('it'),\r\n    );\r\n  }\r\n}\r\n\r\n// Test 7: Version consistency\r\nlog('\\n7. Checking version consistency...', 'blue');\r\nconst versionFile = path.join(__dirname, 'VERSION');\r\nif (fs.existsSync(versionFile)) {\r\n  const fileVersion = fs.readFileSync(versionFile, 'utf8').trim();\r\n  test('Version file matches manifest', fileVersion === manifest.version);\r\n}\r\n\r\n// Test 8: File counts\r\nlog('\\n8. Validating file counts...', 'blue');\r\nfor (const [category, info] of Object.entries(manifest.categories)) {\r\n  const actualCount = manifest.files.filter((f) => f.category === category).length;\r\n  // Allow some flexibility in counts as they might have been updated\r\n  const countMatches = Math.abs(actualCount - info.count) <= 2;\r\n  test(\r\n    `${category} file count approximately correct (${actualCount} vs ${info.count})`,\r\n    countMatches,\r\n  );\r\n}\r\n\r\n// Test 9: Installation timestamp\r\nlog('\\n9. Checking installation status...', 'blue');\r\nconst installFile = path.join(__dirname, '.installed');\r\ntest('Installation timestamp exists', fs.existsSync(installFile));\r\n\r\n// Final summary\r\nlog('\\n' + '='.repeat(60), 'blue');\r\nlog('Validation Summary:', 'blue');\r\nlog(`  Total tests: ${totalTests}`);\r\nlog(`  Passed: ${passedTests}`, passedTests === totalTests ? 'green' : 'yellow');\r\nlog(`  Failed: ${totalTests - passedTests}`, totalTests - passedTests === 0 ? 'green' : 'red');\r\n\r\nconst percentage = Math.round((passedTests / totalTests) * 100);\r\nlog(\r\n  `  Success rate: ${percentage}%`,\r\n  percentage >= 90 ? 'green' : percentage >= 70 ? 'yellow' : 'red',\r\n);\r\n\r\nif (passedTests === totalTests) {\r\n  log('\\nðŸŽ‰ Template validation passed! All files are properly installed.', 'green');\r\n} else if (percentage >= 90) {\r\n  log('\\nâš ï¸  Template validation mostly passed with minor issues.', 'yellow');\r\n} else {\r\n  log('\\nâŒ Template validation failed. Please check the issues above.', 'red');\r\n}\r\n\r\n// Additional information\r\nlog('\\nTemplate Information:', 'blue');\r\nlog(`  Version: ${manifest.version}`);\r\nlog(`  Total files: ${manifest.files.length}`);\r\nlog(\r\n  `  Documentation files: ${manifest.files.filter((f) => f.category === 'documentation').length}`,\r\n);\r\nlog(`  Command files: ${manifest.files.filter((f) => f.category === 'command').length}`);\r\nlog(`  SPARC mode files: ${manifest.files.filter((f) => f.category === 'sparc-mode').length}`);\r\nlog(`  Test files: ${manifest.files.filter((f) => f.category === 'test').length}`);\r\n\r\nprocess.exit(passedTests === totalTests ? 0 : 1);\r\n"],"names":["fs","require","path","TEMPLATE_DIR","join","__dirname","MANIFEST_PATH","colors","green","red","yellow","blue","reset","log","message","color","console","manifest","JSON","parse","readFileSync","error","process","exit","totalTests","passedTests","test","description","condition","existsSync","dirName","dirInfo","Object","entries","directories","dirPath","file","files","filePath","destination","sampleFiles","fileName","content","length","startsWith","sparcCommands","filter","f","category","cmd","slice","includes","testFiles","testFile","versionFile","fileVersion","trim","version","info","categories","actualCount","countMatches","Math","abs","count","installFile","repeat","percentage","round"],"mappings":"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"}