{"version":3,"sources":["../../../src/enterprise/cloud-manager.ts"],"sourcesContent":["import { EventEmitter } from 'events';\r\nimport { writeFile, readFile, mkdir, readdir } from 'fs/promises';\r\nimport { join } from 'path';\r\nimport { Logger } from '../core/logger.js';\r\nimport { ConfigManager } from '../core/config.js';\r\n\r\nexport interface CloudProvider {\r\n  id: string;\r\n  name: string;\r\n  type: 'aws' | 'gcp' | 'azure' | 'kubernetes' | 'docker' | 'digitalocean' | 'linode' | 'custom';\r\n  credentials: {\r\n    accessKey?: string;\r\n    secretKey?: string;\r\n    projectId?: string;\r\n    subscriptionId?: string;\r\n    token?: string;\r\n    keyFile?: string;\r\n    customConfig?: Record<string, any>;\r\n  };\r\n  configuration: {\r\n    defaultRegion: string;\r\n    availableRegions: string[];\r\n    services: string[];\r\n    endpoints: Record<string, string>;\r\n    features: string[];\r\n  };\r\n  status: 'active' | 'inactive' | 'error' | 'maintenance';\r\n  quotas: {\r\n    computeInstances: number;\r\n    storage: number;\r\n    bandwidth: number;\r\n    requests: number;\r\n  };\r\n  pricing: {\r\n    currency: string;\r\n    computePerHour: number;\r\n    storagePerGB: number;\r\n    bandwidthPerGB: number;\r\n    requestsPer1000: number;\r\n  };\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nexport interface CloudResource {\r\n  id: string;\r\n  name: string;\r\n  type: 'compute' | 'storage' | 'network' | 'database' | 'cache' | 'queue' | 'function' | 'custom';\r\n  providerId: string;\r\n  region: string;\r\n  status: 'creating' | 'running' | 'stopped' | 'error' | 'terminated';\r\n  configuration: {\r\n    size: string;\r\n    image?: string;\r\n    ports?: number[];\r\n    environment?: Record<string, string>;\r\n    volumes?: VolumeMount[];\r\n    networks?: string[];\r\n    tags: Record<string, string>;\r\n  };\r\n  monitoring: {\r\n    enabled: boolean;\r\n    metrics: CloudMetric[];\r\n    alerts: CloudAlert[];\r\n    healthChecks: HealthCheck[];\r\n  };\r\n  security: {\r\n    encryption: boolean;\r\n    backups: boolean;\r\n    accessControl: AccessControl[];\r\n    vulnerabilityScanning: boolean;\r\n    complianceFrameworks: string[];\r\n  };\r\n  costs: {\r\n    hourlyRate: number;\r\n    monthlyEstimate: number;\r\n    actualSpend: number;\r\n    lastBillingDate: Date;\r\n    costBreakdown: Record<string, number>;\r\n  };\r\n  performance: {\r\n    cpu: number;\r\n    memory: number;\r\n    storage: number;\r\n    network: number;\r\n    uptime: number;\r\n    availability: number;\r\n  };\r\n  metadata: {\r\n    projectId?: string;\r\n    environment: string;\r\n    owner: string;\r\n    purpose: string;\r\n    lifecycle: 'temporary' | 'permanent' | 'scheduled';\r\n    expiryDate?: Date;\r\n  };\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n  auditLog: CloudAuditEntry[];\r\n}\r\n\r\nexport interface VolumeMount {\r\n  source: string;\r\n  destination: string;\r\n  type: 'bind' | 'volume' | 'tmpfs';\r\n  readOnly: boolean;\r\n  size?: string;\r\n}\r\n\r\nexport interface CloudMetric {\r\n  name: string;\r\n  type: 'counter' | 'gauge' | 'histogram';\r\n  value: number;\r\n  unit: string;\r\n  timestamp: Date;\r\n  tags: Record<string, string>;\r\n}\r\n\r\nexport interface CloudAlert {\r\n  id: string;\r\n  name: string;\r\n  condition: string;\r\n  threshold: number;\r\n  severity: 'low' | 'medium' | 'high' | 'critical';\r\n  enabled: boolean;\r\n  notifications: string[];\r\n  lastTriggered?: Date;\r\n}\r\n\r\nexport interface HealthCheck {\r\n  id: string;\r\n  name: string;\r\n  type: 'http' | 'tcp' | 'command';\r\n  configuration: {\r\n    url?: string;\r\n    port?: number;\r\n    command?: string;\r\n    expectedStatus?: number;\r\n    timeout: number;\r\n    interval: number;\r\n    retries: number;\r\n  };\r\n  status: 'healthy' | 'unhealthy' | 'unknown';\r\n  lastCheck: Date;\r\n  history: HealthCheckResult[];\r\n}\r\n\r\nexport interface HealthCheckResult {\r\n  timestamp: Date;\r\n  status: 'healthy' | 'unhealthy';\r\n  responseTime: number;\r\n  details?: string;\r\n}\r\n\r\nexport interface AccessControl {\r\n  type: 'ip' | 'role' | 'user' | 'group';\r\n  rule: string;\r\n  permissions: string[];\r\n  enabled: boolean;\r\n}\r\n\r\nexport interface CloudAuditEntry {\r\n  id: string;\r\n  timestamp: Date;\r\n  userId: string;\r\n  action: string;\r\n  resource: string;\r\n  details: Record<string, any>;\r\n  ipAddress?: string;\r\n  userAgent?: string;\r\n}\r\n\r\nexport interface CloudInfrastructure {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  projectId: string;\r\n  environment: string;\r\n  resources: string[];\r\n  topology: {\r\n    networks: NetworkTopology[];\r\n    loadBalancers: LoadBalancer[];\r\n    databases: Database[];\r\n    caches: Cache[];\r\n    queues: Queue[];\r\n  };\r\n  deployment: {\r\n    strategy: 'manual' | 'terraform' | 'cloudformation' | 'kubernetes' | 'custom';\r\n    template: string;\r\n    parameters: Record<string, any>;\r\n    lastDeployment?: Date;\r\n    deploymentHistory: DeploymentHistory[];\r\n  };\r\n  monitoring: {\r\n    dashboard: string;\r\n    alerts: string[];\r\n    sla: {\r\n      availability: number;\r\n      responseTime: number;\r\n      errorRate: number;\r\n    };\r\n  };\r\n  costs: {\r\n    budgetLimit: number;\r\n    currentSpend: number;\r\n    projectedSpend: number;\r\n    costAlerts: CostAlert[];\r\n    optimization: CostOptimization[];\r\n  };\r\n  compliance: {\r\n    frameworks: string[];\r\n    requirements: ComplianceRequirement[];\r\n    lastAudit: Date;\r\n    nextAudit: Date;\r\n  };\r\n  backup: {\r\n    enabled: boolean;\r\n    schedule: string;\r\n    retention: string;\r\n    lastBackup?: Date;\r\n    backupLocations: string[];\r\n  };\r\n  disaster_recovery: {\r\n    enabled: boolean;\r\n    rto: number; // Recovery Time Objective in minutes\r\n    rpo: number; // Recovery Point Objective in minutes\r\n    strategy: 'active-passive' | 'active-active' | 'pilot-light' | 'warm-standby';\r\n    testFrequency: string;\r\n    lastTest?: Date;\r\n  };\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nexport interface NetworkTopology {\r\n  id: string;\r\n  name: string;\r\n  type: 'vpc' | 'subnet' | 'security-group' | 'nat-gateway' | 'internet-gateway';\r\n  configuration: Record<string, any>;\r\n  connections: string[];\r\n}\r\n\r\nexport interface LoadBalancer {\r\n  id: string;\r\n  name: string;\r\n  type: 'application' | 'network' | 'classic';\r\n  configuration: {\r\n    algorithm: string;\r\n    healthCheck: string;\r\n    sslTermination: boolean;\r\n    targets: string[];\r\n  };\r\n}\r\n\r\nexport interface Database {\r\n  id: string;\r\n  name: string;\r\n  engine: string;\r\n  version: string;\r\n  configuration: {\r\n    instanceClass: string;\r\n    storage: number;\r\n    backup: boolean;\r\n    multiAZ: boolean;\r\n    encryption: boolean;\r\n  };\r\n}\r\n\r\nexport interface Cache {\r\n  id: string;\r\n  name: string;\r\n  engine: string;\r\n  configuration: {\r\n    nodeType: string;\r\n    numNodes: number;\r\n    evictionPolicy: string;\r\n  };\r\n}\r\n\r\nexport interface Queue {\r\n  id: string;\r\n  name: string;\r\n  type: 'sqs' | 'rabbitmq' | 'kafka' | 'redis';\r\n  configuration: {\r\n    visibility: number;\r\n    retention: number;\r\n    dlq: boolean;\r\n  };\r\n}\r\n\r\nexport interface DeploymentHistory {\r\n  id: string;\r\n  timestamp: Date;\r\n  version: string;\r\n  changes: string[];\r\n  status: 'success' | 'failed' | 'partial';\r\n  duration: number;\r\n  deployedBy: string;\r\n}\r\n\r\nexport interface CostAlert {\r\n  id: string;\r\n  name: string;\r\n  threshold: number;\r\n  type: 'absolute' | 'percentage';\r\n  frequency: 'daily' | 'weekly' | 'monthly';\r\n  notifications: string[];\r\n  enabled: boolean;\r\n}\r\n\r\nexport interface CostOptimization {\r\n  id: string;\r\n  type:\r\n    | 'rightsizing'\r\n    | 'scheduling'\r\n    | 'reserved-instances'\r\n    | 'spot-instances'\r\n    | 'storage-optimization';\r\n  description: string;\r\n  potentialSavings: number;\r\n  implementation: string;\r\n  effort: 'low' | 'medium' | 'high';\r\n  priority: 'low' | 'medium' | 'high' | 'critical';\r\n  status: 'identified' | 'planned' | 'implemented' | 'monitoring';\r\n}\r\n\r\nexport interface ComplianceRequirement {\r\n  id: string;\r\n  framework: string;\r\n  requirement: string;\r\n  status: 'compliant' | 'non-compliant' | 'pending';\r\n  evidence: string[];\r\n  remediation?: string;\r\n  dueDate?: Date;\r\n}\r\n\r\nexport interface CloudMetrics {\r\n  providers: {\r\n    total: number;\r\n    active: number;\r\n    inactive: number;\r\n    errors: number;\r\n  };\r\n  resources: {\r\n    total: number;\r\n    running: number;\r\n    stopped: number;\r\n    errors: number;\r\n    byType: Record<string, number>;\r\n    byProvider: Record<string, number>;\r\n    byEnvironment: Record<string, number>;\r\n  };\r\n  costs: {\r\n    totalSpend: number;\r\n    monthlySpend: number;\r\n    projectedSpend: number;\r\n    topSpenders: { resourceId: string; cost: number }[];\r\n    costByProvider: Record<string, number>;\r\n    costByEnvironment: Record<string, number>;\r\n    optimization: {\r\n      potentialSavings: number;\r\n      implementedSavings: number;\r\n      opportunities: number;\r\n    };\r\n  };\r\n  performance: {\r\n    averageUptime: number;\r\n    averageResponseTime: number;\r\n    errorRate: number;\r\n    availability: number;\r\n  };\r\n  security: {\r\n    vulnerabilities: {\r\n      critical: number;\r\n      high: number;\r\n      medium: number;\r\n      low: number;\r\n    };\r\n    compliance: {\r\n      compliant: number;\r\n      nonCompliant: number;\r\n      pending: number;\r\n    };\r\n    encryptionCoverage: number;\r\n    backupCoverage: number;\r\n  };\r\n}\r\n\r\nexport class CloudManager extends EventEmitter {\r\n  private providers: Map<string, CloudProvider> = new Map();\r\n  private resources: Map<string, CloudResource> = new Map();\r\n  private infrastructures: Map<string, CloudInfrastructure> = new Map();\r\n  private cloudPath: string;\r\n  private logger: Logger;\r\n  private config: ConfigManager;\r\n\r\n  constructor(cloudPath: string = './cloud', logger?: Logger, config?: ConfigManager) {\r\n    super();\r\n    this.cloudPath = cloudPath;\r\n    this.logger = logger || new Logger({ level: 'info', format: 'text', destination: 'console' });\r\n    this.config = config || ConfigManager.getInstance();\r\n  }\r\n\r\n  async initialize(): Promise<void> {\r\n    try {\r\n      await mkdir(this.cloudPath, { recursive: true });\r\n      await mkdir(join(this.cloudPath, 'providers'), { recursive: true });\r\n      await mkdir(join(this.cloudPath, 'resources'), { recursive: true });\r\n      await mkdir(join(this.cloudPath, 'infrastructures'), { recursive: true });\r\n      await mkdir(join(this.cloudPath, 'templates'), { recursive: true });\r\n\r\n      await this.loadConfigurations();\r\n      await this.initializeDefaultProviders();\r\n\r\n      this.logger.info('Cloud Manager initialized successfully');\r\n    } catch (error) {\r\n      this.logger.error('Failed to initialize Cloud Manager', { error });\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async addProvider(providerData: Partial<CloudProvider>): Promise<CloudProvider> {\r\n    const provider: CloudProvider = {\r\n      id: providerData.id || `provider-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n      name: providerData.name || 'Unnamed Provider',\r\n      type: providerData.type || 'custom',\r\n      credentials: providerData.credentials || {},\r\n      configuration: {\r\n        defaultRegion: 'us-east-1',\r\n        availableRegions: ['us-east-1', 'us-west-2', 'eu-west-1'],\r\n        services: [],\r\n        endpoints: {},\r\n        features: [],\r\n        ...providerData.configuration,\r\n      },\r\n      status: 'inactive',\r\n      quotas: {\r\n        computeInstances: 20,\r\n        storage: 1000,\r\n        bandwidth: 1000,\r\n        requests: 1000000,\r\n        ...providerData.quotas,\r\n      },\r\n      pricing: {\r\n        currency: 'USD',\r\n        computePerHour: 0.1,\r\n        storagePerGB: 0.023,\r\n        bandwidthPerGB: 0.09,\r\n        requestsPer1000: 0.0004,\r\n        ...providerData.pricing,\r\n      },\r\n      createdAt: new Date(),\r\n      updatedAt: new Date(),\r\n    };\r\n\r\n    // Validate credentials\r\n    try {\r\n      await this.validateProviderCredentials(provider);\r\n      provider.status = 'active';\r\n    } catch (error) {\r\n      provider.status = 'error';\r\n      this.logger.warn(`Provider credentials validation failed: ${provider.name}`, { error });\r\n    }\r\n\r\n    this.providers.set(provider.id, provider);\r\n    await this.saveProvider(provider);\r\n\r\n    this.emit('provider:added', provider);\r\n    this.logger.info(`Cloud provider added: ${provider.name} (${provider.id})`);\r\n\r\n    return provider;\r\n  }\r\n\r\n  async createResource(resourceData: {\r\n    name: string;\r\n    type: CloudResource['type'];\r\n    providerId: string;\r\n    region: string;\r\n    configuration: Partial<CloudResource['configuration']>;\r\n    metadata: Partial<CloudResource['metadata']>;\r\n  }): Promise<CloudResource> {\r\n    const provider = this.providers.get(resourceData.providerId);\r\n    if (!provider) {\r\n      throw new Error(`Provider not found: ${resourceData.providerId}`);\r\n    }\r\n\r\n    if (provider.status !== 'active') {\r\n      throw new Error(`Provider is not active: ${provider.name}`);\r\n    }\r\n\r\n    const resource: CloudResource = {\r\n      id: `resource-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n      name: resourceData.name,\r\n      type: resourceData.type,\r\n      providerId: resourceData.providerId,\r\n      region: resourceData.region,\r\n      status: 'creating',\r\n      configuration: {\r\n        size: 'small',\r\n        ports: [],\r\n        environment: {},\r\n        volumes: [],\r\n        networks: [],\r\n        tags: {},\r\n        ...resourceData.configuration,\r\n      },\r\n      monitoring: {\r\n        enabled: true,\r\n        metrics: [],\r\n        alerts: [],\r\n        healthChecks: [],\r\n      },\r\n      security: {\r\n        encryption: true,\r\n        backups: true,\r\n        accessControl: [],\r\n        vulnerabilityScanning: true,\r\n        complianceFrameworks: [],\r\n      },\r\n      costs: {\r\n        hourlyRate: this.calculateResourceCost(\r\n          provider,\r\n          resourceData.type,\r\n          resourceData.configuration.size || 'small',\r\n        ),\r\n        monthlyEstimate: 0,\r\n        actualSpend: 0,\r\n        lastBillingDate: new Date(),\r\n        costBreakdown: {},\r\n      },\r\n      performance: {\r\n        cpu: 0,\r\n        memory: 0,\r\n        storage: 0,\r\n        network: 0,\r\n        uptime: 100,\r\n        availability: 100,\r\n      },\r\n      metadata: {\r\n        environment: 'development',\r\n        owner: 'system',\r\n        purpose: 'general',\r\n        lifecycle: 'permanent',\r\n        ...resourceData.metadata,\r\n      },\r\n      createdAt: new Date(),\r\n      updatedAt: new Date(),\r\n      auditLog: [],\r\n    };\r\n\r\n    // Calculate monthly estimate\r\n    resource.costs.monthlyEstimate = resource.costs.hourlyRate * 24 * 30;\r\n\r\n    this.addAuditEntry(resource, resource.metadata.owner, 'resource_created', 'resource', {\r\n      resourceId: resource.id,\r\n      resourceName: resource.name,\r\n      providerId: resourceData.providerId,\r\n    });\r\n\r\n    this.resources.set(resource.id, resource);\r\n    await this.saveResource(resource);\r\n\r\n    // Start resource creation process\r\n    await this.provisionResource(resource);\r\n\r\n    this.emit('resource:created', resource);\r\n    this.logger.info(`Cloud resource created: ${resource.name} (${resource.id})`);\r\n\r\n    return resource;\r\n  }\r\n\r\n  async createInfrastructure(infrastructureData: {\r\n    name: string;\r\n    description: string;\r\n    projectId: string;\r\n    environment: string;\r\n    template: string;\r\n    parameters: Record<string, any>;\r\n  }): Promise<CloudInfrastructure> {\r\n    const infrastructure: CloudInfrastructure = {\r\n      id: `infra-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n      name: infrastructureData.name,\r\n      description: infrastructureData.description,\r\n      projectId: infrastructureData.projectId,\r\n      environment: infrastructureData.environment,\r\n      resources: [],\r\n      topology: {\r\n        networks: [],\r\n        loadBalancers: [],\r\n        databases: [],\r\n        caches: [],\r\n        queues: [],\r\n      },\r\n      deployment: {\r\n        strategy: 'terraform',\r\n        template: infrastructureData.template,\r\n        parameters: infrastructureData.parameters,\r\n        deploymentHistory: [],\r\n      },\r\n      monitoring: {\r\n        dashboard: '',\r\n        alerts: [],\r\n        sla: {\r\n          availability: 99.9,\r\n          responseTime: 200,\r\n          errorRate: 0.1,\r\n        },\r\n      },\r\n      costs: {\r\n        budgetLimit: 1000,\r\n        currentSpend: 0,\r\n        projectedSpend: 0,\r\n        costAlerts: [],\r\n        optimization: [],\r\n      },\r\n      compliance: {\r\n        frameworks: [],\r\n        requirements: [],\r\n        lastAudit: new Date(),\r\n        nextAudit: new Date(Date.now() + 90 * 24 * 60 * 60 * 1000), // 90 days\r\n      },\r\n      backup: {\r\n        enabled: true,\r\n        schedule: '0 2 * * *', // Daily at 2 AM\r\n        retention: '30d',\r\n        backupLocations: [],\r\n      },\r\n      disaster_recovery: {\r\n        enabled: false,\r\n        rto: 60, // 1 hour\r\n        rpo: 15, // 15 minutes\r\n        strategy: 'active-passive',\r\n        testFrequency: 'quarterly',\r\n      },\r\n      createdAt: new Date(),\r\n      updatedAt: new Date(),\r\n    };\r\n\r\n    this.infrastructures.set(infrastructure.id, infrastructure);\r\n    await this.saveInfrastructure(infrastructure);\r\n\r\n    this.emit('infrastructure:created', infrastructure);\r\n    this.logger.info(`Infrastructure created: ${infrastructure.name} (${infrastructure.id})`);\r\n\r\n    return infrastructure;\r\n  }\r\n\r\n  async deployInfrastructure(infrastructureId: string, userId: string = 'system'): Promise<void> {\r\n    const infrastructure = this.infrastructures.get(infrastructureId);\r\n    if (!infrastructure) {\r\n      throw new Error(`Infrastructure not found: ${infrastructureId}`);\r\n    }\r\n\r\n    const deploymentId = `deploy-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n    const startTime = new Date();\r\n\r\n    try {\r\n      this.logger.info(`Starting infrastructure deployment: ${infrastructure.name}`);\r\n      this.emit('infrastructure:deployment_started', { infrastructure, deploymentId });\r\n\r\n      // Execute deployment based on strategy\r\n      await this.executeInfrastructureDeployment(infrastructure);\r\n\r\n      const endTime = new Date();\r\n      const duration = endTime.getTime() - startTime.getTime();\r\n\r\n      const deployment: DeploymentHistory = {\r\n        id: deploymentId,\r\n        timestamp: startTime,\r\n        version: `v${Date.now()}`,\r\n        changes: ['Initial deployment'],\r\n        status: 'success',\r\n        duration,\r\n        deployedBy: userId,\r\n      };\r\n\r\n      infrastructure.deployment.deploymentHistory.push(deployment);\r\n      infrastructure.deployment.lastDeployment = startTime;\r\n      infrastructure.updatedAt = new Date();\r\n\r\n      await this.saveInfrastructure(infrastructure);\r\n\r\n      this.emit('infrastructure:deployment_completed', { infrastructure, deployment });\r\n      this.logger.info(\r\n        `Infrastructure deployment completed: ${infrastructure.name} in ${duration}ms`,\r\n      );\r\n    } catch (error) {\r\n      const endTime = new Date();\r\n      const duration = endTime.getTime() - startTime.getTime();\r\n\r\n      const deployment: DeploymentHistory = {\r\n        id: deploymentId,\r\n        timestamp: startTime,\r\n        version: `v${Date.now()}`,\r\n        changes: ['Failed deployment'],\r\n        status: 'failed',\r\n        duration,\r\n        deployedBy: userId,\r\n      };\r\n\r\n      infrastructure.deployment.deploymentHistory.push(deployment);\r\n      infrastructure.updatedAt = new Date();\r\n\r\n      await this.saveInfrastructure(infrastructure);\r\n\r\n      this.emit('infrastructure:deployment_failed', { infrastructure, deployment, error });\r\n      this.logger.error(`Infrastructure deployment failed: ${infrastructure.name}`, { error });\r\n\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async optimizeCosts(filters?: {\r\n    providerId?: string;\r\n    environment?: string;\r\n    resourceType?: string;\r\n  }): Promise<CostOptimization[]> {\r\n    let resources = Array.from(this.resources.values());\r\n\r\n    // Apply filters\r\n    if (filters) {\r\n      if (filters.providerId) {\r\n        resources = resources.filter((r) => r.providerId === filters.providerId);\r\n      }\r\n      if (filters.environment) {\r\n        resources = resources.filter((r) => r.metadata.environment === filters.environment);\r\n      }\r\n      if (filters.resourceType) {\r\n        resources = resources.filter((r) => r.type === filters.resourceType);\r\n      }\r\n    }\r\n\r\n    const optimizations: CostOptimization[] = [];\r\n\r\n    for (const resource of resources) {\r\n      // Rightsizing opportunities\r\n      if (resource.performance.cpu < 20 && resource.performance.memory < 30) {\r\n        optimizations.push({\r\n          id: `opt-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n          type: 'rightsizing',\r\n          description: `Resource ${resource.name} is underutilized (CPU: ${resource.performance.cpu}%, Memory: ${resource.performance.memory}%). Consider downsizing.`,\r\n          potentialSavings: resource.costs.monthlyEstimate * 0.3,\r\n          implementation: 'Downsize instance to smaller type',\r\n          effort: 'low',\r\n          priority: 'medium',\r\n          status: 'identified',\r\n        });\r\n      }\r\n\r\n      // Scheduling opportunities for non-production\r\n      if (resource.metadata.environment !== 'production' && resource.status === 'running') {\r\n        optimizations.push({\r\n          id: `opt-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n          type: 'scheduling',\r\n          description: `Resource ${resource.name} in ${resource.metadata.environment} environment could be scheduled to run only during business hours.`,\r\n          potentialSavings: resource.costs.monthlyEstimate * 0.6,\r\n          implementation: 'Implement auto-scaling schedule (8 AM - 6 PM weekdays)',\r\n          effort: 'medium',\r\n          priority: 'high',\r\n          status: 'identified',\r\n        });\r\n      }\r\n\r\n      // Storage optimization\r\n      if (resource.type === 'storage' && resource.performance.storage < 50) {\r\n        optimizations.push({\r\n          id: `opt-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n          type: 'storage-optimization',\r\n          description: `Storage resource ${resource.name} is only ${resource.performance.storage}% utilized. Consider reducing allocated storage.`,\r\n          potentialSavings: resource.costs.monthlyEstimate * 0.25,\r\n          implementation: 'Reduce storage allocation and implement lifecycle policies',\r\n          effort: 'low',\r\n          priority: 'medium',\r\n          status: 'identified',\r\n        });\r\n      }\r\n    }\r\n\r\n    // Sort by potential savings\r\n    optimizations.sort((a, b) => b.potentialSavings - a.potentialSavings);\r\n\r\n    this.logger.info(\r\n      `Cost optimization analysis completed: ${optimizations.length} opportunities identified`,\r\n    );\r\n    this.emit('cost_optimization:analyzed', { optimizations, resourceCount: resources.length });\r\n\r\n    return optimizations;\r\n  }\r\n\r\n  async getCloudMetrics(filters?: {\r\n    providerId?: string;\r\n    environment?: string;\r\n    timeRange?: { start: Date; end: Date };\r\n  }): Promise<CloudMetrics> {\r\n    let resources = Array.from(this.resources.values());\r\n    let providers = Array.from(this.providers.values());\r\n\r\n    // Apply filters\r\n    if (filters) {\r\n      if (filters.providerId) {\r\n        resources = resources.filter((r) => r.providerId === filters.providerId);\r\n        providers = providers.filter((p) => p.id === filters.providerId);\r\n      }\r\n      if (filters.environment) {\r\n        resources = resources.filter((r) => r.metadata.environment === filters.environment);\r\n      }\r\n      if (filters.timeRange) {\r\n        resources = resources.filter(\r\n          (r) => r.createdAt >= filters.timeRange!.start && r.createdAt <= filters.timeRange!.end,\r\n        );\r\n      }\r\n    }\r\n\r\n    // Provider metrics\r\n    const providerMetrics = {\r\n      total: providers.length,\r\n      active: providers.filter((p) => p.status === 'active').length,\r\n      inactive: providers.filter((p) => p.status === 'inactive').length,\r\n      errors: providers.filter((p) => p.status === 'error').length,\r\n    };\r\n\r\n    // Resource metrics\r\n    const resourcesByType: Record<string, number> = {};\r\n    const resourcesByProvider: Record<string, number> = {};\r\n    const resourcesByEnvironment: Record<string, number> = {};\r\n\r\n    for (const resource of resources) {\r\n      resourcesByType[resource.type] = (resourcesByType[resource.type] || 0) + 1;\r\n      resourcesByProvider[resource.providerId] =\r\n        (resourcesByProvider[resource.providerId] || 0) + 1;\r\n      resourcesByEnvironment[resource.metadata.environment] =\r\n        (resourcesByEnvironment[resource.metadata.environment] || 0) + 1;\r\n    }\r\n\r\n    const resourceMetrics = {\r\n      total: resources.length,\r\n      running: resources.filter((r) => r.status === 'running').length,\r\n      stopped: resources.filter((r) => r.status === 'stopped').length,\r\n      errors: resources.filter((r) => r.status === 'error').length,\r\n      byType: resourcesByType,\r\n      byProvider: resourcesByProvider,\r\n      byEnvironment: resourcesByEnvironment,\r\n    };\r\n\r\n    // Cost metrics\r\n    const totalSpend = resources.reduce((sum, r) => sum + r.costs.actualSpend, 0);\r\n    const monthlySpend = resources.reduce((sum, r) => sum + r.costs.monthlyEstimate, 0);\r\n    const projectedSpend = monthlySpend * 12;\r\n\r\n    const topSpenders = resources\r\n      .map((r) => ({ resourceId: r.id, cost: r.costs.actualSpend }))\r\n      .sort((a, b) => b.cost - a.cost)\r\n      .slice(0, 10);\r\n\r\n    const costByProvider: Record<string, number> = {};\r\n    const costByEnvironment: Record<string, number> = {};\r\n\r\n    for (const resource of resources) {\r\n      costByProvider[resource.providerId] =\r\n        (costByProvider[resource.providerId] || 0) + resource.costs.actualSpend;\r\n      costByEnvironment[resource.metadata.environment] =\r\n        (costByEnvironment[resource.metadata.environment] || 0) + resource.costs.actualSpend;\r\n    }\r\n\r\n    const costMetrics = {\r\n      totalSpend,\r\n      monthlySpend,\r\n      projectedSpend,\r\n      topSpenders,\r\n      costByProvider,\r\n      costByEnvironment,\r\n      optimization: {\r\n        potentialSavings: 0,\r\n        implementedSavings: 0,\r\n        opportunities: 0,\r\n      },\r\n    };\r\n\r\n    // Performance metrics\r\n    const performanceMetrics = {\r\n      averageUptime:\r\n        resources.length > 0\r\n          ? resources.reduce((sum, r) => sum + r.performance.uptime, 0) / resources.length\r\n          : 0,\r\n      averageResponseTime: 0, // Would be calculated from actual metrics\r\n      errorRate: 0, // Would be calculated from actual metrics\r\n      availability:\r\n        resources.length > 0\r\n          ? resources.reduce((sum, r) => sum + r.performance.availability, 0) / resources.length\r\n          : 0,\r\n    };\r\n\r\n    // Security metrics\r\n    const encryptedResources = resources.filter((r) => r.security.encryption).length;\r\n    const backedUpResources = resources.filter((r) => r.security.backups).length;\r\n\r\n    const securityMetrics = {\r\n      vulnerabilities: {\r\n        critical: 0,\r\n        high: 0,\r\n        medium: 0,\r\n        low: 0,\r\n      },\r\n      compliance: {\r\n        compliant: 0,\r\n        nonCompliant: 0,\r\n        pending: 0,\r\n      },\r\n      encryptionCoverage: resources.length > 0 ? (encryptedResources / resources.length) * 100 : 0,\r\n      backupCoverage: resources.length > 0 ? (backedUpResources / resources.length) * 100 : 0,\r\n    };\r\n\r\n    return {\r\n      providers: providerMetrics,\r\n      resources: resourceMetrics,\r\n      costs: costMetrics,\r\n      performance: performanceMetrics,\r\n      security: securityMetrics,\r\n    };\r\n  }\r\n\r\n  async scaleResource(\r\n    resourceId: string,\r\n    scalingConfig: {\r\n      size?: string;\r\n      replicas?: number;\r\n      autoScaling?: {\r\n        enabled: boolean;\r\n        minReplicas: number;\r\n        maxReplicas: number;\r\n        targetCPU: number;\r\n        targetMemory: number;\r\n      };\r\n    },\r\n    userId: string = 'system',\r\n  ): Promise<void> {\r\n    const resource = this.resources.get(resourceId);\r\n    if (!resource) {\r\n      throw new Error(`Resource not found: ${resourceId}`);\r\n    }\r\n\r\n    const oldConfiguration = { ...resource.configuration };\r\n\r\n    if (scalingConfig.size) {\r\n      resource.configuration.size = scalingConfig.size;\r\n\r\n      // Update cost calculation\r\n      const provider = this.providers.get(resource.providerId);\r\n      if (provider) {\r\n        resource.costs.hourlyRate = this.calculateResourceCost(\r\n          provider,\r\n          resource.type,\r\n          scalingConfig.size,\r\n        );\r\n        resource.costs.monthlyEstimate = resource.costs.hourlyRate * 24 * 30;\r\n      }\r\n    }\r\n\r\n    if (scalingConfig.replicas !== undefined) {\r\n      resource.configuration.tags.replicas = scalingConfig.replicas.toString();\r\n    }\r\n\r\n    if (scalingConfig.autoScaling) {\r\n      resource.configuration.tags.autoScaling = JSON.stringify(scalingConfig.autoScaling);\r\n    }\r\n\r\n    resource.updatedAt = new Date();\r\n\r\n    this.addAuditEntry(resource, userId, 'resource_scaled', 'resource', {\r\n      resourceId,\r\n      oldConfiguration,\r\n      newConfiguration: resource.configuration,\r\n      scalingConfig,\r\n    });\r\n\r\n    await this.saveResource(resource);\r\n\r\n    this.emit('resource:scaled', { resource, scalingConfig });\r\n    this.logger.info(`Resource scaled: ${resource.name} (${resourceId})`);\r\n  }\r\n\r\n  async deleteResource(resourceId: string, userId: string = 'system'): Promise<void> {\r\n    const resource = this.resources.get(resourceId);\r\n    if (!resource) {\r\n      throw new Error(`Resource not found: ${resourceId}`);\r\n    }\r\n\r\n    // Update status to indicate deletion in progress\r\n    resource.status = 'terminated';\r\n    resource.updatedAt = new Date();\r\n\r\n    this.addAuditEntry(resource, userId, 'resource_deleted', 'resource', {\r\n      resourceId,\r\n      resourceName: resource.name,\r\n    });\r\n\r\n    // Perform cloud provider cleanup\r\n    await this.deprovisionResource(resource);\r\n\r\n    this.resources.delete(resourceId);\r\n\r\n    this.emit('resource:deleted', { resourceId, resource });\r\n    this.logger.info(`Resource deleted: ${resource.name} (${resourceId})`);\r\n  }\r\n\r\n  // Private helper methods\r\n  private async loadConfigurations(): Promise<void> {\r\n    try {\r\n      // Load providers\r\n      const providerFiles = await readdir(join(this.cloudPath, 'providers'));\r\n      for (const file of providerFiles.filter((f) => f.endsWith('.json'))) {\r\n        const content = await readFile(join(this.cloudPath, 'providers', file), 'utf-8');\r\n        const provider: CloudProvider = JSON.parse(content);\r\n        this.providers.set(provider.id, provider);\r\n      }\r\n\r\n      // Load resources\r\n      const resourceFiles = await readdir(join(this.cloudPath, 'resources'));\r\n      for (const file of resourceFiles.filter((f) => f.endsWith('.json'))) {\r\n        const content = await readFile(join(this.cloudPath, 'resources', file), 'utf-8');\r\n        const resource: CloudResource = JSON.parse(content);\r\n        this.resources.set(resource.id, resource);\r\n      }\r\n\r\n      // Load infrastructures\r\n      const infraFiles = await readdir(join(this.cloudPath, 'infrastructures'));\r\n      for (const file of infraFiles.filter((f) => f.endsWith('.json'))) {\r\n        const content = await readFile(join(this.cloudPath, 'infrastructures', file), 'utf-8');\r\n        const infrastructure: CloudInfrastructure = JSON.parse(content);\r\n        this.infrastructures.set(infrastructure.id, infrastructure);\r\n      }\r\n\r\n      this.logger.info(\r\n        `Loaded ${this.providers.size} providers, ${this.resources.size} resources, ${this.infrastructures.size} infrastructures`,\r\n      );\r\n    } catch (error) {\r\n      this.logger.warn('Failed to load some cloud configurations', { error });\r\n    }\r\n  }\r\n\r\n  private async initializeDefaultProviders(): Promise<void> {\r\n    const defaultProviders = [\r\n      {\r\n        name: 'AWS',\r\n        type: 'aws' as const,\r\n        configuration: {\r\n          defaultRegion: 'us-east-1',\r\n          availableRegions: ['us-east-1', 'us-west-2', 'eu-west-1', 'ap-southeast-1'],\r\n          services: ['ec2', 's3', 'rds', 'lambda', 'ecs', 'eks'],\r\n          endpoints: {\r\n            ec2: 'https://ec2.amazonaws.com',\r\n            s3: 'https://s3.amazonaws.com',\r\n            rds: 'https://rds.amazonaws.com',\r\n          },\r\n          features: ['auto-scaling', 'load-balancing', 'monitoring', 'backup'],\r\n        },\r\n        pricing: {\r\n          currency: 'USD',\r\n          computePerHour: 0.1,\r\n          storagePerGB: 0.023,\r\n          bandwidthPerGB: 0.09,\r\n          requestsPer1000: 0.0004,\r\n        },\r\n      },\r\n      {\r\n        name: 'Google Cloud Platform',\r\n        type: 'gcp' as const,\r\n        configuration: {\r\n          defaultRegion: 'us-central1',\r\n          availableRegions: ['us-central1', 'us-east1', 'europe-west1', 'asia-east1'],\r\n          services: ['compute', 'storage', 'sql', 'functions', 'gke'],\r\n          endpoints: {\r\n            compute: 'https://compute.googleapis.com',\r\n            storage: 'https://storage.googleapis.com',\r\n            sql: 'https://sqladmin.googleapis.com',\r\n          },\r\n          features: ['auto-scaling', 'load-balancing', 'monitoring', 'backup'],\r\n        },\r\n        pricing: {\r\n          currency: 'USD',\r\n          computePerHour: 0.095,\r\n          storagePerGB: 0.02,\r\n          bandwidthPerGB: 0.08,\r\n          requestsPer1000: 0.0004,\r\n        },\r\n      },\r\n      {\r\n        name: 'Microsoft Azure',\r\n        type: 'azure' as const,\r\n        configuration: {\r\n          defaultRegion: 'East US',\r\n          availableRegions: ['East US', 'West US 2', 'West Europe', 'Southeast Asia'],\r\n          services: ['virtual-machines', 'storage', 'sql-database', 'functions', 'aks'],\r\n          endpoints: {\r\n            compute: 'https://management.azure.com',\r\n            storage: 'https://management.azure.com',\r\n            sql: 'https://management.azure.com',\r\n          },\r\n          features: ['auto-scaling', 'load-balancing', 'monitoring', 'backup'],\r\n        },\r\n        pricing: {\r\n          currency: 'USD',\r\n          computePerHour: 0.096,\r\n          storagePerGB: 0.024,\r\n          bandwidthPerGB: 0.087,\r\n          requestsPer1000: 0.0004,\r\n        },\r\n      },\r\n    ];\r\n\r\n    for (const providerData of defaultProviders) {\r\n      if (!Array.from(this.providers.values()).some((p) => p.name === providerData.name)) {\r\n        const provider: CloudProvider = {\r\n          id: `provider-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n          name: providerData.name,\r\n          type: providerData.type,\r\n          credentials: {},\r\n          configuration: providerData.configuration,\r\n          status: 'inactive',\r\n          quotas: {\r\n            computeInstances: 20,\r\n            storage: 1000,\r\n            bandwidth: 1000,\r\n            requests: 1000000,\r\n          },\r\n          pricing: providerData.pricing,\r\n          createdAt: new Date(),\r\n          updatedAt: new Date(),\r\n        };\r\n\r\n        this.providers.set(provider.id, provider);\r\n        await this.saveProvider(provider);\r\n      }\r\n    }\r\n  }\r\n\r\n  private async validateProviderCredentials(provider: CloudProvider): Promise<boolean> {\r\n    // Implement credential validation logic for each provider type\r\n    switch (provider.type) {\r\n      case 'aws':\r\n        return this.validateAWSCredentials(provider);\r\n      case 'gcp':\r\n        return this.validateGCPCredentials(provider);\r\n      case 'azure':\r\n        return this.validateAzureCredentials(provider);\r\n      default:\r\n        return true; // Assume valid for custom providers\r\n    }\r\n  }\r\n\r\n  private async validateAWSCredentials(provider: CloudProvider): Promise<boolean> {\r\n    // Implement AWS credential validation\r\n    // This would typically involve making a simple API call like ListRegions\r\n    return true; // Simplified for now\r\n  }\r\n\r\n  private async validateGCPCredentials(provider: CloudProvider): Promise<boolean> {\r\n    // Implement GCP credential validation\r\n    // This would typically involve making a simple API call like listing projects\r\n    return true; // Simplified for now\r\n  }\r\n\r\n  private async validateAzureCredentials(provider: CloudProvider): Promise<boolean> {\r\n    // Implement Azure credential validation\r\n    // This would typically involve making a simple API call like listing subscriptions\r\n    return true; // Simplified for now\r\n  }\r\n\r\n  private calculateResourceCost(provider: CloudProvider, type: string, size: string): number {\r\n    const baseHourlyRate = provider.pricing.computePerHour;\r\n\r\n    const sizeMultipliers: Record<string, number> = {\r\n      nano: 0.5,\r\n      micro: 0.75,\r\n      small: 1.0,\r\n      medium: 2.0,\r\n      large: 4.0,\r\n      xlarge: 8.0,\r\n      '2xlarge': 16.0,\r\n      '4xlarge': 32.0,\r\n    };\r\n\r\n    const typeMultipliers: Record<string, number> = {\r\n      compute: 1.0,\r\n      storage: 0.1,\r\n      database: 1.5,\r\n      cache: 0.8,\r\n      network: 0.3,\r\n      function: 0.01,\r\n    };\r\n\r\n    const sizeMultiplier = sizeMultipliers[size] || 1.0;\r\n    const typeMultiplier = typeMultipliers[type] || 1.0;\r\n\r\n    return baseHourlyRate * sizeMultiplier * typeMultiplier;\r\n  }\r\n\r\n  private async saveProvider(provider: CloudProvider): Promise<void> {\r\n    const filePath = join(this.cloudPath, 'providers', `${provider.id}.json`);\r\n    await writeFile(filePath, JSON.stringify(provider, null, 2));\r\n  }\r\n\r\n  private async saveResource(resource: CloudResource): Promise<void> {\r\n    const filePath = join(this.cloudPath, 'resources', `${resource.id}.json`);\r\n    await writeFile(filePath, JSON.stringify(resource, null, 2));\r\n  }\r\n\r\n  private async saveInfrastructure(infrastructure: CloudInfrastructure): Promise<void> {\r\n    const filePath = join(this.cloudPath, 'infrastructures', `${infrastructure.id}.json`);\r\n    await writeFile(filePath, JSON.stringify(infrastructure, null, 2));\r\n  }\r\n\r\n  private addAuditEntry(\r\n    resource: CloudResource,\r\n    userId: string,\r\n    action: string,\r\n    target: string,\r\n    details: Record<string, any>,\r\n  ): void {\r\n    const entry: CloudAuditEntry = {\r\n      id: `audit-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n      timestamp: new Date(),\r\n      userId,\r\n      action,\r\n      resource: target,\r\n      details,\r\n    };\r\n\r\n    resource.auditLog.push(entry);\r\n  }\r\n\r\n  private async provisionResource(resource: CloudResource): Promise<void> {\r\n    try {\r\n      this.logger.info(`Provisioning resource: ${resource.name}`);\r\n\r\n      // Simulate provisioning process\r\n      resource.status = 'running';\r\n      resource.updatedAt = new Date();\r\n\r\n      // Update performance metrics\r\n      resource.performance.cpu = Math.random() * 50 + 20; // 20-70%\r\n      resource.performance.memory = Math.random() * 60 + 30; // 30-90%\r\n      resource.performance.storage = Math.random() * 80 + 10; // 10-90%\r\n      resource.performance.network = Math.random() * 100; // 0-100 Mbps\r\n\r\n      await this.saveResource(resource);\r\n\r\n      this.emit('resource:provisioned', resource);\r\n      this.logger.info(`Resource provisioned successfully: ${resource.name}`);\r\n    } catch (error) {\r\n      resource.status = 'error';\r\n      resource.updatedAt = new Date();\r\n      await this.saveResource(resource);\r\n\r\n      this.emit('resource:provision_failed', { resource, error });\r\n      this.logger.error(`Resource provisioning failed: ${resource.name}`, { error });\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  private async deprovisionResource(resource: CloudResource): Promise<void> {\r\n    try {\r\n      this.logger.info(`Deprovisioning resource: ${resource.name}`);\r\n\r\n      // Implement cloud provider-specific deprovisioning logic\r\n      // This would typically involve API calls to delete the resource\r\n\r\n      this.emit('resource:deprovisioned', resource);\r\n      this.logger.info(`Resource deprovisioned successfully: ${resource.name}`);\r\n    } catch (error) {\r\n      this.emit('resource:deprovision_failed', { resource, error });\r\n      this.logger.error(`Resource deprovisioning failed: ${resource.name}`, { error });\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  private async executeInfrastructureDeployment(\r\n    infrastructure: CloudInfrastructure,\r\n  ): Promise<void> {\r\n    switch (infrastructure.deployment.strategy) {\r\n      case 'terraform':\r\n        await this.deployWithTerraform(infrastructure);\r\n        break;\r\n      case 'cloudformation':\r\n        await this.deployWithCloudFormation(infrastructure);\r\n        break;\r\n      case 'kubernetes':\r\n        await this.deployWithKubernetes(infrastructure);\r\n        break;\r\n      default:\r\n        await this.deployWithCustomStrategy(infrastructure);\r\n    }\r\n  }\r\n\r\n  private async deployWithTerraform(infrastructure: CloudInfrastructure): Promise<void> {\r\n    // Implement Terraform deployment logic\r\n    this.logger.info(`Deploying infrastructure with Terraform: ${infrastructure.name}`);\r\n\r\n    // This would typically:\r\n    // 1. Generate Terraform configuration from template\r\n    // 2. Run terraform init\r\n    // 3. Run terraform plan\r\n    // 4. Run terraform apply\r\n\r\n    // Simulate deployment\r\n    await new Promise((resolve) => setTimeout(resolve, 2000));\r\n  }\r\n\r\n  private async deployWithCloudFormation(infrastructure: CloudInfrastructure): Promise<void> {\r\n    // Implement CloudFormation deployment logic\r\n    this.logger.info(`Deploying infrastructure with CloudFormation: ${infrastructure.name}`);\r\n\r\n    // This would typically:\r\n    // 1. Upload template to S3\r\n    // 2. Create or update CloudFormation stack\r\n    // 3. Monitor stack events\r\n    // 4. Wait for completion\r\n\r\n    // Simulate deployment\r\n    await new Promise((resolve) => setTimeout(resolve, 2000));\r\n  }\r\n\r\n  private async deployWithKubernetes(infrastructure: CloudInfrastructure): Promise<void> {\r\n    // Implement Kubernetes deployment logic\r\n    this.logger.info(`Deploying infrastructure with Kubernetes: ${infrastructure.name}`);\r\n\r\n    // This would typically:\r\n    // 1. Generate Kubernetes manifests\r\n    // 2. Apply manifests using kubectl or Kubernetes API\r\n    // 3. Monitor deployment status\r\n    // 4. Wait for all resources to be ready\r\n\r\n    // Simulate deployment\r\n    await new Promise((resolve) => setTimeout(resolve, 2000));\r\n  }\r\n\r\n  private async deployWithCustomStrategy(infrastructure: CloudInfrastructure): Promise<void> {\r\n    // Implement custom deployment logic\r\n    this.logger.info(`Deploying infrastructure with custom strategy: ${infrastructure.name}`);\r\n\r\n    // This would be defined by the user's custom deployment script\r\n    // Simulate deployment\r\n    await new Promise((resolve) => setTimeout(resolve, 2000));\r\n  }\r\n}\r\n"],"names":["EventEmitter","writeFile","readFile","mkdir","readdir","join","Logger","ConfigManager","CloudManager","providers","Map","resources","infrastructures","cloudPath","logger","config","level","format","destination","getInstance","initialize","recursive","loadConfigurations","initializeDefaultProviders","info","error","addProvider","providerData","provider","id","Date","now","Math","random","toString","substr","name","type","credentials","configuration","defaultRegion","availableRegions","services","endpoints","features","status","quotas","computeInstances","storage","bandwidth","requests","pricing","currency","computePerHour","storagePerGB","bandwidthPerGB","requestsPer1000","createdAt","updatedAt","validateProviderCredentials","warn","set","saveProvider","emit","createResource","resourceData","get","providerId","Error","resource","region","size","ports","environment","volumes","networks","tags","monitoring","enabled","metrics","alerts","healthChecks","security","encryption","backups","accessControl","vulnerabilityScanning","complianceFrameworks","costs","hourlyRate","calculateResourceCost","monthlyEstimate","actualSpend","lastBillingDate","costBreakdown","performance","cpu","memory","network","uptime","availability","metadata","owner","purpose","lifecycle","auditLog","addAuditEntry","resourceId","resourceName","saveResource","provisionResource","createInfrastructure","infrastructureData","infrastructure","description","projectId","topology","loadBalancers","databases","caches","queues","deployment","strategy","template","parameters","deploymentHistory","dashboard","sla","responseTime","errorRate","budgetLimit","currentSpend","projectedSpend","costAlerts","optimization","compliance","frameworks","requirements","lastAudit","nextAudit","backup","schedule","retention","backupLocations","disaster_recovery","rto","rpo","testFrequency","saveInfrastructure","deployInfrastructure","infrastructureId","userId","deploymentId","startTime","executeInfrastructureDeployment","endTime","duration","getTime","timestamp","version","changes","deployedBy","push","lastDeployment","optimizeCosts","filters","Array","from","values","filter","r","resourceType","optimizations","potentialSavings","implementation","effort","priority","sort","a","b","length","resourceCount","getCloudMetrics","p","timeRange","start","end","providerMetrics","total","active","inactive","errors","resourcesByType","resourcesByProvider","resourcesByEnvironment","resourceMetrics","running","stopped","byType","byProvider","byEnvironment","totalSpend","reduce","sum","monthlySpend","topSpenders","map","cost","slice","costByProvider","costByEnvironment","costMetrics","implementedSavings","opportunities","performanceMetrics","averageUptime","averageResponseTime","encryptedResources","backedUpResources","securityMetrics","vulnerabilities","critical","high","medium","low","compliant","nonCompliant","pending","encryptionCoverage","backupCoverage","scaleResource","scalingConfig","oldConfiguration","replicas","undefined","autoScaling","JSON","stringify","newConfiguration","deleteResource","deprovisionResource","delete","providerFiles","file","f","endsWith","content","parse","resourceFiles","infraFiles","defaultProviders","ec2","s3","rds","compute","sql","some","validateAWSCredentials","validateGCPCredentials","validateAzureCredentials","baseHourlyRate","sizeMultipliers","nano","micro","small","large","xlarge","typeMultipliers","database","cache","function","sizeMultiplier","typeMultiplier","filePath","action","target","details","entry","deployWithTerraform","deployWithCloudFormation","deployWithKubernetes","deployWithCustomStrategy","Promise","resolve","setTimeout"],"mappings":"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"}