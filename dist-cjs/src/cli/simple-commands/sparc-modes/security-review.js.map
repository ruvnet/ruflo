{"version":3,"sources":["../../../../../src/cli/simple-commands/sparc-modes/security-review.js"],"sourcesContent":["// security-review.js - Security Reviewer mode orchestration template\r\nexport function getSecurityReviewOrchestration(taskDescription, memoryNamespace) {\r\n  return `\r\n## Task Orchestration Steps\r\n\r\n1. **Security Audit Scope Definition** (10 mins)\r\n   - Define audit boundaries for: \"${taskDescription}\"\r\n   - Query system architecture and sensitive areas:\r\n     \\`\\`\\`bash\r\n     npx claude-flow memory query ${memoryNamespace}_architecture\r\n     npx claude-flow memory query ${memoryNamespace}_auth\r\n     npx claude-flow memory query ${memoryNamespace}_config\r\n     \\`\\`\\`\r\n   - Identify critical assets:\r\n     - User data and PII\r\n     - Authentication tokens/sessions\r\n     - API keys and credentials\r\n     - Payment/financial data\r\n   - Map data flows and trust boundaries\r\n   - List all external interfaces and integrations\r\n   - Review authentication/authorization points\r\n   - Store scope: \\`npx claude-flow memory store ${memoryNamespace}_security_scope \"Audit scope: ${taskDescription}. Critical assets: user PII, JWT tokens, payment data. External interfaces: REST API, webhooks, third-party integrations.\"\\`\r\n\r\n2. **Static Security Analysis** (20 mins)\r\n   - Scan for hardcoded secrets and credentials:\r\n     - Check all code files for API keys, passwords\r\n     - Verify .env files are properly gitignored\r\n     - Ensure no secrets in logs or error messages\r\n   - Review environment configuration:\r\n     - Check for direct env coupling\r\n     - Verify secrets management approach\r\n     - Ensure config files don't expose sensitive data\r\n   - Analyze authentication/authorization:\r\n     - Review JWT implementation\r\n     - Check session management\r\n     - Verify role-based access control\r\n   - Inspect input validation and sanitization:\r\n     - SQL injection prevention\r\n     - XSS protection\r\n     - Command injection safeguards\r\n   - Check cryptographic implementations:\r\n     - Password hashing (bcrypt/scrypt/argon2)\r\n     - Data encryption at rest/transit\r\n     - Secure random number generation\r\n   - Audit file size compliance (< 500 lines)\r\n   - Review dependency vulnerabilities:\r\n     \\`\\`\\`bash\r\n     npm audit\r\n     \\`\\`\\`\r\n   - Store findings: \\`npx claude-flow memory store ${memoryNamespace}_vulnerabilities \"Critical: 2 hardcoded API keys found. High: Missing input validation in user-controller. Medium: Outdated JWT library. Low: Verbose error messages expose stack traces.\"\\`\r\n\r\n3. **Dynamic Security Analysis** (10 mins)\r\n   - Test authentication flows:\r\n     - Login/logout sequences\r\n     - Password reset process\r\n     - Token refresh mechanisms\r\n   - Check authorization boundaries:\r\n     - Test role-based access\r\n     - Verify resource ownership checks\r\n     - Test privilege escalation vectors\r\n   - Analyze rate limiting and DoS protection\r\n   - Review CORS and CSP policies\r\n   - Test error handling for information leakage\r\n   - Store dynamic findings: \\`npx claude-flow memory store ${memoryNamespace}_dynamic_findings \"Auth bypass: None found. Rate limiting: Missing on login endpoint. CORS: Overly permissive. Error handling: Leaks database schema in dev mode.\"\\`\r\n\r\n4. **Risk Assessment & Prioritization** (15 mins)\r\n   - Categorize findings by severity (CVSS scores):\r\n     - Critical (9.0-10.0): Immediate action required\r\n     - High (7.0-8.9): Fix before deployment\r\n     - Medium (4.0-6.9): Fix in next sprint\r\n     - Low (0.1-3.9): Track for future\r\n   - Assess potential business impact:\r\n     - Data breach consequences\r\n     - Compliance violations (GDPR, PCI-DSS)\r\n     - Reputation damage\r\n   - Calculate risk scores (likelihood Ã— impact)\r\n   - Prioritize remediation efforts\r\n   - Document attack vectors and exploit scenarios\r\n   - Store assessment: \\`npx claude-flow memory store ${memoryNamespace}_risk_assessment \"Critical risks: 2 (hardcoded secrets, missing auth on admin endpoints). High risks: 3 (outdated deps, missing rate limiting, weak session management). Compliance impact: GDPR violation risk due to logging PII.\"\\`\r\n\r\n5. **Remediation Plan & Implementation** (10 mins)\r\n   - Create specific fix recommendations:\r\n     - Move secrets to environment variables\r\n     - Implement proper secrets management (Vault/AWS Secrets Manager)\r\n     - Add comprehensive input validation\r\n     - Update vulnerable dependencies\r\n     - Implement rate limiting\r\n     - Fix authorization checks\r\n   - Suggest security enhancements:\r\n     - Add security headers (HSTS, CSP, X-Frame-Options)\r\n     - Implement audit logging\r\n     - Add intrusion detection\r\n     - Set up security monitoring\r\n   - Create security checklist for future development\r\n   - Implement critical fixes if authorized\r\n   - Store plan: \\`npx claude-flow memory store ${memoryNamespace}_remediation_plan \"Immediate: Remove hardcoded secrets, fix auth bypass. Next sprint: Implement rate limiting, update dependencies. Future: Add WAF, implement SIEM integration.\"\\`\r\n\r\n## Deliverables\r\n- security-audit-report.md:\r\n  - Executive summary\r\n  - Detailed findings with CVSS scores\r\n  - Risk assessment matrix\r\n  - Compliance gaps\r\n- remediation-plan.md:\r\n  - Prioritized fix list\r\n  - Implementation guidelines\r\n  - Timeline recommendations\r\n- security-checklist.md:\r\n  - Pre-deployment security checks\r\n  - Code review guidelines\r\n  - Security testing procedures\r\n- Fixed code (for critical issues):\r\n  - Removed hardcoded secrets\r\n  - Added input validation\r\n  - Fixed authorization gaps\r\n\r\n## Security Review Standards\r\n- OWASP Top 10 compliance\r\n- SANS CWE Top 25 coverage\r\n- Industry-specific requirements (PCI-DSS, HIPAA, etc.)\r\n- Zero tolerance for hardcoded secrets\r\n- All files must be < 500 lines for maintainability\r\n- Comprehensive logging without exposing sensitive data\r\n\r\n## Next Steps\r\nAfter security review:\r\n- \\`npx claude-flow sparc run code \"Implement security remediation plan\" --non-interactive\\`\r\n- \\`npx claude-flow sparc run tdd \"Write security test cases\" --non-interactive\\`\r\n- \\`npx claude-flow sparc run post-deployment-monitoring-mode \"Set up security monitoring and alerts\" --non-interactive\\``;\r\n}\r\n"],"names":["getSecurityReviewOrchestration","taskDescription","memoryNamespace"],"mappings":"AACA,OAAO,SAASA,+BAA+BC,eAAe,EAAEC,eAAe;IAC7E,OAAO,CAAC;;;;mCAIyB,EAAED,gBAAgB;;;kCAGnB,EAAEC,gBAAgB;kCAClB,EAAEA,gBAAgB;kCAClB,EAAEA,gBAAgB;;;;;;;;;;iDAUH,EAAEA,gBAAgB,8BAA8B,EAAED,gBAAgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;oDA4B/D,EAAEC,gBAAgB;;;;;;;;;;;;;;4DAcV,EAAEA,gBAAgB;;;;;;;;;;;;;;;sDAexB,EAAEA,gBAAgB;;;;;;;;;;;;;;;;;gDAiBxB,EAAEA,gBAAgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;yHAiCuD,CAAC;AAC1H"}