{"version":3,"sources":["../../../../src/cli/agents/index.ts"],"sourcesContent":["/**\r\n * Agent System Index - Central exports and agent factory\r\n */\r\n\r\n// Agent Classes\r\nexport { BaseAgent } from './base-agent.js';\r\nexport { ResearcherAgent, createResearcherAgent } from './researcher.js';\r\nexport { CoderAgent, createCoderAgent } from './coder.js';\r\nexport { AnalystAgent, createAnalystAgent } from './analyst.js';\r\nexport { ArchitectAgent, createArchitectAgent } from './architect.js';\r\nexport { TesterAgent, createTesterAgent } from './tester.js';\r\nexport { CoordinatorAgent, createCoordinatorAgent } from './coordinator.js';\r\n\r\n// Systems\r\nexport { AgentCapabilitySystem } from './capabilities.js';\r\nexport { AgentManager } from '../../agents/agent-manager.js';\r\nexport { AgentRegistry } from '../../agents/agent-registry.js';\r\n\r\n// Types\r\nexport type { AgentState } from './base-agent.js';\r\nexport type { CapabilityMatch, TaskRequirements, CapabilityRegistry } from './capabilities.js';\r\n\r\n// Agent Factory\r\nimport type { AgentType, AgentConfig, AgentEnvironment } from '../../swarm/types.js';\r\nimport type { ILogger } from '../../core/logger.js';\r\nimport type { IEventBus } from '../../core/event-bus.js';\r\nimport type { DistributedMemorySystem } from '../../memory/distributed-memory.js';\r\nimport { BaseAgent } from './base-agent.js';\r\nimport { createResearcherAgent } from './researcher.js';\r\nimport { createCoderAgent } from './coder.js';\r\nimport { createAnalystAgent } from './analyst.js';\r\nimport { createArchitectAgent } from './architect.js';\r\nimport { createTesterAgent } from './tester.js';\r\nimport { createCoordinatorAgent } from './coordinator.js';\r\nimport { generateId } from '../../utils/helpers.js';\r\n\r\nexport interface AgentFactoryConfig {\r\n  logger: ILogger;\r\n  eventBus: IEventBus;\r\n  memory: DistributedMemorySystem;\r\n}\r\n\r\n/**\r\n * Agent Factory - Creates specialized agents based on type\r\n */\r\nexport class AgentFactory {\r\n  private logger: ILogger;\r\n  private eventBus: IEventBus;\r\n  private memory: DistributedMemorySystem;\r\n  private agentCounter = 0;\r\n\r\n  constructor(config: AgentFactoryConfig) {\r\n    this.logger = config.logger;\r\n    this.eventBus = config.eventBus;\r\n    this.memory = config.memory;\r\n  }\r\n\r\n  /**\r\n   * Create an agent of the specified type\r\n   */\r\n  createAgent(\r\n    type: AgentType,\r\n    config: Partial<AgentConfig> = {},\r\n    environment: Partial<AgentEnvironment> = {},\r\n    customId?: string,\r\n  ): BaseAgent {\r\n    const id = customId || this.generateAgentId(type);\r\n\r\n    this.logger.info('Creating agent', {\r\n      id,\r\n      type,\r\n      factory: 'AgentFactory',\r\n    });\r\n\r\n    switch (type) {\r\n      case 'researcher':\r\n        return createResearcherAgent(\r\n          id,\r\n          config,\r\n          environment,\r\n          this.logger,\r\n          this.eventBus,\r\n          this.memory,\r\n        );\r\n\r\n      case 'coder':\r\n        return createCoderAgent(id, config, environment, this.logger, this.eventBus, this.memory);\r\n\r\n      case 'analyst':\r\n        return createAnalystAgent(id, config, environment, this.logger, this.eventBus, this.memory);\r\n\r\n      case 'architect':\r\n        return createArchitectAgent(\r\n          id,\r\n          config,\r\n          environment,\r\n          this.logger,\r\n          this.eventBus,\r\n          this.memory,\r\n        );\r\n\r\n      case 'tester':\r\n        return createTesterAgent(id, config, environment, this.logger, this.eventBus, this.memory);\r\n\r\n      case 'coordinator':\r\n        return createCoordinatorAgent(\r\n          id,\r\n          config,\r\n          environment,\r\n          this.logger,\r\n          this.eventBus,\r\n          this.memory,\r\n        );\r\n\r\n      default:\r\n        throw new Error(`Unknown agent type: ${type}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create multiple agents of different types\r\n   */\r\n  createAgents(\r\n    specs: Array<{\r\n      type: AgentType;\r\n      count?: number;\r\n      config?: Partial<AgentConfig>;\r\n      environment?: Partial<AgentEnvironment>;\r\n    }>,\r\n  ): BaseAgent[] {\r\n    const agents: BaseAgent[] = [];\r\n\r\n    for (const spec of specs) {\r\n      const count = spec.count || 1;\r\n      for (let i = 0; i < count; i++) {\r\n        const agent = this.createAgent(spec.type, spec.config, spec.environment);\r\n        agents.push(agent);\r\n      }\r\n    }\r\n\r\n    this.logger.info('Created multiple agents', {\r\n      totalAgents: agents.length,\r\n      specs: specs.map((s) => ({ type: s.type, count: s.count || 1 })),\r\n    });\r\n\r\n    return agents;\r\n  }\r\n\r\n  /**\r\n   * Create a balanced swarm of agents\r\n   */\r\n  createBalancedSwarm(\r\n    size: number = 5,\r\n    strategy: 'research' | 'development' | 'analysis' | 'balanced' = 'balanced',\r\n  ): BaseAgent[] {\r\n    const compositions = {\r\n      research: {\r\n        researcher: 0.4,\r\n        analyst: 0.3,\r\n        coordinator: 0.2,\r\n        architect: 0.1,\r\n      },\r\n      development: {\r\n        coder: 0.4,\r\n        tester: 0.25,\r\n        architect: 0.2,\r\n        coordinator: 0.15,\r\n      },\r\n      analysis: {\r\n        analyst: 0.4,\r\n        researcher: 0.3,\r\n        coordinator: 0.2,\r\n        architect: 0.1,\r\n      },\r\n      balanced: {\r\n        coder: 0.25,\r\n        researcher: 0.2,\r\n        analyst: 0.2,\r\n        tester: 0.15,\r\n        architect: 0.1,\r\n        coordinator: 0.1,\r\n      },\r\n    };\r\n\r\n    const composition = compositions[strategy];\r\n    const specs: Array<{ type: AgentType; count: number }> = [];\r\n\r\n    for (const [type, ratio] of Object.entries(composition)) {\r\n      const count = Math.max(1, Math.round(size * ratio));\r\n      specs.push({ type: type as AgentType, count });\r\n    }\r\n\r\n    // Adjust if we have too many agents\r\n    const totalCount = specs.reduce((sum, spec) => sum + spec.count, 0);\r\n    if (totalCount > size) {\r\n      // Remove from largest groups first\r\n      specs.sort((a, b) => b.count - a.count);\r\n      let excess = totalCount - size;\r\n      for (const spec of specs) {\r\n        if (excess <= 0) break;\r\n        const reduction = Math.min(excess, spec.count - 1);\r\n        spec.count -= reduction;\r\n        excess -= reduction;\r\n      }\r\n    }\r\n\r\n    return this.createAgents(specs.map((spec) => ({ type: spec.type, count: spec.count })));\r\n  }\r\n\r\n  /**\r\n   * Get supported agent types\r\n   */\r\n  getSupportedTypes(): AgentType[] {\r\n    return [\r\n      'researcher', 'coder', 'analyst', 'architect', 'tester', 'coordinator',\r\n      'reviewer', 'optimizer', 'documenter', 'monitor', 'specialist',\r\n      'requirements_analyst', 'design_architect', 'task_planner', \r\n      'implementation_coder', 'quality_reviewer', 'steering_documenter'\r\n    ];\r\n  }\r\n\r\n  /**\r\n   * Get agent type descriptions\r\n   */\r\n  getAgentTypeDescriptions(): Record<AgentType, string> {\r\n    return {\r\n      researcher: 'Specialized in information gathering, web research, and data collection',\r\n      coder: 'Expert in software development, code generation, and implementation',\r\n      analyst: 'Focused on data analysis, performance optimization, and insights',\r\n      architect: 'Designs system architecture, technical specifications, and solutions',\r\n      tester: 'Specializes in testing, quality assurance, and validation',\r\n      coordinator: 'Manages task orchestration, planning, and team coordination',\r\n      reviewer: 'Reviews and validates work quality and standards',\r\n      optimizer: 'Optimizes performance and efficiency across systems',\r\n      documenter: 'Creates and maintains comprehensive documentation',\r\n      monitor: 'Monitors system health and performance metrics',\r\n      specialist: 'Provides domain-specific expertise and specialized knowledge',\r\n      requirements_analyst: 'Analyzes requirements and creates user stories with acceptance criteria',\r\n      design_architect: 'Creates technical designs and system architecture for features',\r\n      'system-architect': 'High-level system architecture and design patterns',\r\n      task_planner: 'Plans implementation tasks and orchestrates workflow execution', \r\n      'task-planner': 'Plans implementation tasks and orchestrates workflow execution',\r\n      implementation_coder: 'Implements code based on designs with quality focus',\r\n      developer: 'General purpose software development and implementation',\r\n      quality_reviewer: 'Reviews code quality and ensures standards compliance',\r\n      steering_documenter: 'Maintains governance documentation and project steering'\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Generate unique agent ID\r\n   */\r\n  private generateAgentId(type: AgentType): string {\r\n    this.agentCounter++;\r\n    const timestamp = Date.now().toString(36);\r\n    const counter = this.agentCounter.toString(36).padStart(2, '0');\r\n    return `${type}-${timestamp}-${counter}`;\r\n  }\r\n}\r\n\r\n/**\r\n * Create default agent factory instance\r\n */\r\nexport function createAgentFactory(\r\n  logger: ILogger,\r\n  eventBus: IEventBus,\r\n  memory: DistributedMemorySystem,\r\n): AgentFactory {\r\n  return new AgentFactory({ logger, eventBus, memory });\r\n}\r\n\r\n/**\r\n * Agent lifecycle management utilities\r\n */\r\nexport class AgentLifecycle {\r\n  private agents = new Map<string, BaseAgent>();\r\n  private logger: ILogger;\r\n\r\n  constructor(logger: ILogger) {\r\n    this.logger = logger;\r\n  }\r\n\r\n  /**\r\n   * Register an agent for lifecycle management\r\n   */\r\n  register(agent: BaseAgent): void {\r\n    const info = agent.getAgentInfo();\r\n    this.agents.set(info.id.id, agent);\r\n    this.logger.info('Agent registered for lifecycle management', {\r\n      agentId: info.id.id,\r\n      type: info.type,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Initialize all registered agents\r\n   */\r\n  async initializeAll(): Promise<void> {\r\n    const initPromises = Array.from(this.agents.values()).map((agent) =>\r\n      agent.initialize().catch((error) => {\r\n        const info = agent.getAgentInfo();\r\n        this.logger.error('Agent initialization failed', {\r\n          agentId: info.id.id,\r\n          error: error instanceof Error ? error.message : String(error),\r\n        });\r\n        throw error;\r\n      }),\r\n    );\r\n\r\n    await Promise.all(initPromises);\r\n    this.logger.info('All agents initialized', {\r\n      count: this.agents.size,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Shutdown all registered agents\r\n   */\r\n  async shutdownAll(): Promise<void> {\r\n    const shutdownPromises = Array.from(this.agents.values()).map((agent) =>\r\n      agent.shutdown().catch((error) => {\r\n        const info = agent.getAgentInfo();\r\n        this.logger.error('Agent shutdown failed', {\r\n          agentId: info.id.id,\r\n          error: error instanceof Error ? error.message : String(error),\r\n        });\r\n      }),\r\n    );\r\n\r\n    await Promise.all(shutdownPromises);\r\n    this.agents.clear();\r\n    this.logger.info('All agents shutdown');\r\n  }\r\n\r\n  /**\r\n   * Get agent by ID\r\n   */\r\n  getAgent(agentId: string): BaseAgent | undefined {\r\n    return this.agents.get(agentId);\r\n  }\r\n\r\n  /**\r\n   * Get all registered agents\r\n   */\r\n  getAllAgents(): BaseAgent[] {\r\n    return Array.from(this.agents.values());\r\n  }\r\n\r\n  /**\r\n   * Get agents by type\r\n   */\r\n  getAgentsByType(type: AgentType): BaseAgent[] {\r\n    return Array.from(this.agents.values()).filter((agent) => {\r\n      const info = agent.getAgentInfo();\r\n      return info.type === type;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get agent statistics\r\n   */\r\n  getStatistics(): {\r\n    total: number;\r\n    byType: Record<AgentType, number>;\r\n    byStatus: Record<string, number>;\r\n    healthy: number;\r\n    active: number;\r\n  } {\r\n    const stats = {\r\n      total: this.agents.size,\r\n      byType: {} as Record<AgentType, number>,\r\n      byStatus: {} as Record<string, number>,\r\n      healthy: 0,\r\n      active: 0,\r\n    };\r\n\r\n    for (const agent of this.agents.values()) {\r\n      const info = agent.getAgentInfo();\r\n\r\n      // Count by type\r\n      stats.byType[info.type] = (stats.byType[info.type] || 0) + 1;\r\n\r\n      // Count by status\r\n      stats.byStatus[info.status] = (stats.byStatus[info.status] || 0) + 1;\r\n\r\n      // Count healthy agents (health > 0.7)\r\n      if (info.health > 0.7) {\r\n        stats.healthy++;\r\n      }\r\n\r\n      // Count active agents\r\n      if (info.status === 'idle' || info.status === 'busy') {\r\n        stats.active++;\r\n      }\r\n    }\r\n\r\n    return stats;\r\n  }\r\n}\r\n"],"names":["BaseAgent","ResearcherAgent","createResearcherAgent","CoderAgent","createCoderAgent","AnalystAgent","createAnalystAgent","ArchitectAgent","createArchitectAgent","TesterAgent","createTesterAgent","CoordinatorAgent","createCoordinatorAgent","AgentCapabilitySystem","AgentManager","AgentRegistry","AgentFactory","logger","eventBus","memory","agentCounter","config","createAgent","type","environment","customId","id","generateAgentId","info","factory","Error","createAgents","specs","agents","spec","count","i","agent","push","totalAgents","length","map","s","createBalancedSwarm","size","strategy","compositions","research","researcher","analyst","coordinator","architect","development","coder","tester","analysis","balanced","composition","ratio","Object","entries","Math","max","round","totalCount","reduce","sum","sort","a","b","excess","reduction","min","getSupportedTypes","getAgentTypeDescriptions","reviewer","optimizer","documenter","monitor","specialist","requirements_analyst","design_architect","task_planner","implementation_coder","developer","quality_reviewer","steering_documenter","timestamp","Date","now","toString","counter","padStart","createAgentFactory","AgentLifecycle","Map","register","getAgentInfo","set","agentId","initializeAll","initPromises","Array","from","values","initialize","catch","error","message","String","Promise","all","shutdownAll","shutdownPromises","shutdown","clear","getAgent","get","getAllAgents","getAgentsByType","filter","getStatistics","stats","total","byType","byStatus","healthy","active","status","health"],"mappings":"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"}