{"version":3,"sources":["../../../../../src/cli/simple-commands/init/batch-init.js"],"sourcesContent":["// batch-init.js - Batch initialization features with parallel processing\r\nimport { printSuccess, printError, printWarning, printInfo } from '../../utils.js';\r\nimport { promises as fs } from 'fs';\r\nimport { cwd, exit, existsSync } from '../../node-compat.js';\r\nimport process from 'process';\r\nimport {\r\n  PerformanceMonitor,\r\n  ResourceThresholdMonitor,\r\n  BatchOptimizer,\r\n} from './performance-monitor.js';\r\nimport { initCommand } from './index.js';\r\nimport { createSparcStructureManually } from './sparc-structure.js';\r\nimport { createClaudeSlashCommands } from './claude-commands/slash-commands.js';\r\nimport {\r\n  createSparcClaudeMd,\r\n  createFullClaudeMd,\r\n  createMinimalClaudeMd,\r\n} from './templates/claude-md.js';\r\nimport { createFullMemoryBankMd, createMinimalMemoryBankMd } from './templates/memory-bank-md.js';\r\nimport {\r\n  createFullCoordinationMd,\r\n  createMinimalCoordinationMd,\r\n} from './templates/coordination-md.js';\r\nimport { createAgentsReadme, createSessionsReadme } from './templates/readme-files.js';\r\n\r\n// Progress tracking for batch operations\r\nclass BatchProgressTracker {\r\n  constructor(totalProjects) {\r\n    this.totalProjects = totalProjects;\r\n    this.completed = 0;\r\n    this.failed = 0;\r\n    this.inProgress = new Map();\r\n    this.startTime = Date.now();\r\n  }\r\n\r\n  startProject(projectName) {\r\n    this.inProgress.set(projectName, Date.now());\r\n    this.updateDisplay();\r\n  }\r\n\r\n  completeProject(projectName, success = true) {\r\n    this.inProgress.delete(projectName);\r\n    if (success) {\r\n      this.completed++;\r\n    } else {\r\n      this.failed++;\r\n    }\r\n    this.updateDisplay();\r\n  }\r\n\r\n  updateDisplay() {\r\n    const elapsed = Math.floor((Date.now() - this.startTime) / 1000);\r\n    const progress = Math.floor(((this.completed + this.failed) / this.totalProjects) * 100);\r\n\r\n    console.clear();\r\n    console.log('ðŸš€ Batch Initialization Progress');\r\n    console.log('================================');\r\n    console.log(`Total Projects: ${this.totalProjects}`);\r\n    console.log(`Completed: ${this.completed} âœ…`);\r\n    console.log(`Failed: ${this.failed} âŒ`);\r\n    console.log(`In Progress: ${this.inProgress.size} ðŸ”„`);\r\n    console.log(`Progress: ${progress}% [${this.getProgressBar(progress)}]`);\r\n    console.log(`Elapsed Time: ${elapsed}s`);\r\n\r\n    if (this.inProgress.size > 0) {\r\n      console.log('\\nActive Projects:');\r\n      for (const [project, startTime] of this.inProgress) {\r\n        const projectElapsed = Math.floor((Date.now() - startTime) / 1000);\r\n        console.log(`  - ${project} (${projectElapsed}s)`);\r\n      }\r\n    }\r\n  }\r\n\r\n  getProgressBar(progress) {\r\n    const filled = Math.floor(progress / 5);\r\n    const empty = 20 - filled;\r\n    return 'â–ˆ'.repeat(filled) + 'â–‘'.repeat(empty);\r\n  }\r\n\r\n  getReport() {\r\n    const elapsed = Math.floor((Date.now() - this.startTime) / 1000);\r\n    return {\r\n      total: this.totalProjects,\r\n      completed: this.completed,\r\n      failed: this.failed,\r\n      elapsedTime: elapsed,\r\n      successRate:\r\n        this.totalProjects > 0 ? ((this.completed / this.totalProjects) * 100).toFixed(1) : 0,\r\n    };\r\n  }\r\n}\r\n\r\n// Resource management to prevent overload\r\nclass ResourceManager {\r\n  constructor(maxConcurrency = 5, maxMemoryMB = 1024) {\r\n    this.maxConcurrency = maxConcurrency;\r\n    this.maxMemoryMB = maxMemoryMB;\r\n    this.currentTasks = 0;\r\n    this.queue = [];\r\n  }\r\n\r\n  async acquire() {\r\n    while (this.currentTasks >= this.maxConcurrency) {\r\n      await new Promise((resolve) => {\r\n        this.queue.push(resolve);\r\n      });\r\n    }\r\n    this.currentTasks++;\r\n  }\r\n\r\n  release() {\r\n    this.currentTasks--;\r\n    if (this.queue.length > 0) {\r\n      const resolve = this.queue.shift();\r\n      resolve();\r\n    }\r\n  }\r\n\r\n  async withResource(fn) {\r\n    await this.acquire();\r\n    try {\r\n      return await fn();\r\n    } finally {\r\n      this.release();\r\n    }\r\n  }\r\n}\r\n\r\n// Project template definitions\r\nconst PROJECT_TEMPLATES = {\r\n  'web-api': {\r\n    name: 'Web API',\r\n    description: 'RESTful API with Express.js',\r\n    extraDirs: ['src', 'src/controllers', 'src/models', 'src/routes', 'tests'],\r\n    extraFiles: {\r\n      'package.json': {\r\n        name: '{{PROJECT_NAME}}',\r\n        version: '1.0.0',\r\n        type: 'module',\r\n        scripts: {\r\n          start: 'node src/index.js',\r\n          dev: 'nodemon src/index.js',\r\n          test: 'jest',\r\n        },\r\n        dependencies: {\r\n          express: '^4.18.0',\r\n          cors: '^2.8.5',\r\n          dotenv: '^16.0.0',\r\n        },\r\n      },\r\n      'src/index.js': `import express from 'express';\r\nimport cors from 'cors';\r\n\r\nconst app = express();\r\nconst PORT = process.env.PORT || 3000;\r\n\r\napp.use(cors());\r\napp.use(express.json());\r\n\r\napp.get('/', (req, res) => {\r\n  res.json({ message: 'Welcome to {{PROJECT_NAME}} API' });\r\n});\r\n\r\napp.listen(PORT, () => {\r\n  console.log(\\`Server running on port \\${PORT}\\`);\r\n});\r\n`,\r\n    },\r\n  },\r\n  'react-app': {\r\n    name: 'React Application',\r\n    description: 'Modern React app with TypeScript',\r\n    extraDirs: ['src', 'src/components', 'src/hooks', 'src/services', 'public'],\r\n    extraFiles: {\r\n      'package.json': {\r\n        name: '{{PROJECT_NAME}}',\r\n        version: '0.1.0',\r\n        private: true,\r\n        dependencies: {\r\n          react: '^18.2.0',\r\n          'react-dom': '^18.2.0',\r\n          'react-scripts': '5.0.1',\r\n          typescript: '^4.9.5',\r\n        },\r\n        scripts: {\r\n          start: 'react-scripts start',\r\n          build: 'react-scripts build',\r\n          test: 'react-scripts test',\r\n        },\r\n      },\r\n      'tsconfig.json': {\r\n        compilerOptions: {\r\n          target: 'es5',\r\n          lib: ['dom', 'es2015'],\r\n          jsx: 'react-jsx',\r\n          module: 'esnext',\r\n          moduleResolution: 'node',\r\n          strict: true,\r\n          esModuleInterop: true,\r\n          skipLibCheck: true,\r\n          forceConsistentCasingInFileNames: true,\r\n        },\r\n      },\r\n    },\r\n  },\r\n  microservice: {\r\n    name: 'Microservice',\r\n    description: 'Containerized microservice with Docker',\r\n    extraDirs: ['src', 'config', 'tests', 'scripts'],\r\n    extraFiles: {\r\n      Dockerfile: `FROM node:18-alpine\r\nWORKDIR /app\r\nCOPY package*.json ./\r\nRUN npm ci --only=production\r\nCOPY . .\r\nEXPOSE 8080\r\nCMD [\"node\", \"src/index.js\"]\r\n`,\r\n      'docker-compose.yml': `version: '3.8'\r\nservices:\r\n  {{PROJECT_NAME}}:\r\n    build: .\r\n    ports:\r\n      - \"8080:8080\"\r\n    environment:\r\n      - NODE_ENV={{ENVIRONMENT}}\r\n      - PORT=8080\r\n    restart: unless-stopped\r\n`,\r\n      '.dockerignore': `node_modules\r\nnpm-debug.log\r\n.env\r\n.git\r\n.gitignore\r\nREADME.md\r\n.DS_Store\r\ncoverage\r\n.nyc_output\r\n`,\r\n    },\r\n  },\r\n  'cli-tool': {\r\n    name: 'CLI Tool',\r\n    description: 'Command-line interface tool',\r\n    extraDirs: ['src', 'src/commands', 'src/utils', 'tests'],\r\n    extraFiles: {\r\n      'package.json': {\r\n        name: '{{PROJECT_NAME}}',\r\n        version: '1.0.0',\r\n        type: 'module',\r\n        bin: {\r\n          '{{PROJECT_NAME}}': './src/cli.js',\r\n        },\r\n        scripts: {\r\n          test: 'jest',\r\n          lint: 'eslint src/',\r\n        },\r\n      },\r\n      'src/cli.js': `#!/usr/bin/env node\r\nimport { Command } from 'commander';\r\n\r\nconst program = new Command();\r\n\r\nprogram\r\n  .name('{{PROJECT_NAME}}')\r\n  .description('{{PROJECT_DESCRIPTION}}')\r\n  .version('1.0.0');\r\n\r\nprogram\r\n  .command('hello')\r\n  .description('Say hello')\r\n  .option('-n, --name <name>', 'name to greet', 'World')\r\n  .action((options) => {\r\n    console.log(\\`Hello, \\${options.name}!\\`);\r\n  });\r\n\r\nprogram.parse();\r\n`,\r\n    },\r\n  },\r\n};\r\n\r\n// Environment configurations\r\nconst ENVIRONMENT_CONFIGS = {\r\n  dev: {\r\n    name: 'development',\r\n    features: ['debug', 'hot-reload', 'verbose-logging'],\r\n    config: {\r\n      NODE_ENV: 'development',\r\n      DEBUG: 'true',\r\n      LOG_LEVEL: 'debug',\r\n    },\r\n  },\r\n  staging: {\r\n    name: 'staging',\r\n    features: ['testing', 'monitoring'],\r\n    config: {\r\n      NODE_ENV: 'staging',\r\n      DEBUG: 'false',\r\n      LOG_LEVEL: 'info',\r\n    },\r\n  },\r\n  prod: {\r\n    name: 'production',\r\n    features: ['optimization', 'security', 'monitoring'],\r\n    config: {\r\n      NODE_ENV: 'production',\r\n      DEBUG: 'false',\r\n      LOG_LEVEL: 'error',\r\n    },\r\n  },\r\n};\r\n\r\n// Initialize a single project with options\r\nasync function initializeProject(projectPath, options = {}) {\r\n  const {\r\n    template = null,\r\n    environment = 'dev',\r\n    sparc = false,\r\n    minimal = false,\r\n    force = false,\r\n    customConfig = {},\r\n  } = options;\r\n\r\n  try {\r\n    // Get absolute project path\r\n    const currentDir = cwd();\r\n    const absoluteProjectPath = projectPath.startsWith('/')\r\n      ? projectPath\r\n      : `${currentDir}/${projectPath}`;\r\n\r\n    // Create project directory\r\n    await fs.mkdir(absoluteProjectPath, { recursive: true });\r\n\r\n    // Change to project directory\r\n    const originalDir = cwd();\r\n    process.chdir(absoluteProjectPath);\r\n\r\n    // Initialize base structure\r\n    const directories = [\r\n      'memory',\r\n      'memory/agents',\r\n      'memory/sessions',\r\n      'coordination',\r\n      'coordination/memory_bank',\r\n      'coordination/subtasks',\r\n      'coordination/orchestration',\r\n      '.claude',\r\n      '.claude/commands',\r\n      '.claude/commands/sparc',\r\n      '.claude/logs',\r\n    ];\r\n\r\n    // Add template-specific directories\r\n    if (template && PROJECT_TEMPLATES[template]) {\r\n      const templateConfig = PROJECT_TEMPLATES[template];\r\n      if (templateConfig.extraDirs) {\r\n        directories.push(...templateConfig.extraDirs);\r\n      }\r\n    }\r\n\r\n    // Create all directories in parallel\r\n    await Promise.all(\r\n      directories.map((dir) => fs.mkdir(dir, { recursive: true }).catch(() => {})),\r\n    );\r\n\r\n    // Create configuration files in parallel\r\n    const fileCreationTasks = [];\r\n\r\n    // CLAUDE.md\r\n    const claudeMd = sparc\r\n      ? createSparcClaudeMd()\r\n      : minimal\r\n        ? createMinimalClaudeMd()\r\n        : createFullClaudeMd();\r\n    fileCreationTasks.push(fs.writeFile('CLAUDE.md', claudeMd));\r\n\r\n    // memory-bank.md\r\n    const memoryBankMd = minimal ? createMinimalMemoryBankMd() : createFullMemoryBankMd();\r\n    fileCreationTasks.push(fs.writeFile('memory-bank.md', memoryBankMd));\r\n\r\n    // coordination.md\r\n    const coordinationMd = minimal ? createMinimalCoordinationMd() : createFullCoordinationMd();\r\n    fileCreationTasks.push(fs.writeFile('coordination.md', coordinationMd));\r\n\r\n    // README files\r\n    fileCreationTasks.push(\r\n      fs.writeFile('memory/agents/README.md', createAgentsReadme()),\r\n      fs.writeFile('memory/sessions/README.md', createSessionsReadme()),\r\n    );\r\n\r\n    // Persistence database\r\n    const initialData = {\r\n      agents: [],\r\n      tasks: [],\r\n      environment: environment,\r\n      template: template,\r\n      customConfig: customConfig,\r\n      lastUpdated: Date.now(),\r\n    };\r\n    fileCreationTasks.push(\r\n      fs.writeFile('memory/claude-flow-data.json', JSON.stringify(initialData, null, 2)),\r\n    );\r\n\r\n    // Environment configuration\r\n    if (ENVIRONMENT_CONFIGS[environment]) {\r\n      const envConfig = ENVIRONMENT_CONFIGS[environment];\r\n      const envContent = Object.entries(envConfig.config)\r\n        .map(([key, value]) => `${key}=${value}`)\r\n        .join('\\n');\r\n      fileCreationTasks.push(fs.writeFile('.env', envContent));\r\n    }\r\n\r\n    // Template-specific files\r\n    if (template && PROJECT_TEMPLATES[template]) {\r\n      const templateConfig = PROJECT_TEMPLATES[template];\r\n      if (templateConfig.extraFiles) {\r\n        for (const [filePath, content] of Object.entries(templateConfig.extraFiles)) {\r\n          let fileContent =\r\n            typeof content === 'object' ? JSON.stringify(content, null, 2) : content;\r\n\r\n          // Replace template variables\r\n          fileContent = fileContent\r\n            .replace(/{{PROJECT_NAME}}/g, projectPath.split('/').pop())\r\n            .replace(/{{PROJECT_DESCRIPTION}}/g, templateConfig.description)\r\n            .replace(/{{ENVIRONMENT}}/g, environment);\r\n\r\n          fileCreationTasks.push(fs.writeFile(filePath, fileContent));\r\n        }\r\n      }\r\n    }\r\n\r\n    // Execute all file creation tasks in parallel\r\n    await Promise.all(fileCreationTasks);\r\n\r\n    // SPARC initialization if requested\r\n    if (sparc) {\r\n      await createSparcStructureManually();\r\n      await createClaudeSlashCommands(projectPath);\r\n    }\r\n\r\n    // Change back to original directory\r\n    process.chdir(originalDir);\r\n\r\n    return { success: true, projectPath: absoluteProjectPath };\r\n  } catch (error) {\r\n    return { success: false, projectPath, error: error.message };\r\n  }\r\n}\r\n\r\n// Batch initialization with parallel processing\r\nexport async function batchInitCommand(projects, options = {}) {\r\n  const {\r\n    parallel = true,\r\n    maxConcurrency = 5,\r\n    template = null,\r\n    environments = ['dev'],\r\n    sparc = false,\r\n    minimal = false,\r\n    force = false,\r\n    progressTracking = true,\r\n    performanceMonitoring = true,\r\n  } = options;\r\n\r\n  if (!projects || projects.length === 0) {\r\n    printError('No projects specified for batch initialization');\r\n    return;\r\n  }\r\n\r\n  const totalProjects = projects.length * environments.length;\r\n  const tracker = progressTracking ? new BatchProgressTracker(totalProjects) : null;\r\n  const resourceManager = new ResourceManager(parallel ? maxConcurrency : 1);\r\n\r\n  // Initialize performance monitoring\r\n  const perfMonitor = new PerformanceMonitor({\r\n    enabled: performanceMonitoring,\r\n    logLevel: 'info',\r\n  });\r\n\r\n  const resourceMonitor = new ResourceThresholdMonitor({\r\n    maxMemoryMB: 2048,\r\n    ...ResourceThresholdMonitor.createDefaultCallbacks(),\r\n  });\r\n\r\n  // Calculate optimal settings\r\n  const optimalConcurrency = BatchOptimizer.calculateOptimalConcurrency(totalProjects);\r\n  const timeEstimate = BatchOptimizer.estimateCompletionTime(totalProjects, options);\r\n  const recommendations = BatchOptimizer.generateRecommendations(totalProjects, options);\r\n\r\n  if (maxConcurrency > optimalConcurrency) {\r\n    printWarning(`Concurrency ${maxConcurrency} may be too high. Optimal: ${optimalConcurrency}`);\r\n  }\r\n\r\n  perfMonitor.start();\r\n  resourceMonitor.start();\r\n\r\n  printSuccess(\r\n    `Starting batch initialization for ${projects.length} projects across ${environments.length} environments`,\r\n  );\r\n  console.log(`Template: ${template || 'default'}`);\r\n  console.log(`Parallelism: ${parallel ? `Yes (max ${maxConcurrency} concurrent)` : 'No'}`);\r\n  console.log(`SPARC: ${sparc ? 'Enabled' : 'Disabled'}\\n`);\r\n\r\n  const results = [];\r\n  const initTasks = [];\r\n\r\n  for (const project of projects) {\r\n    for (const env of environments) {\r\n      const projectPath = environments.length > 1 ? `${project}-${env}` : project;\r\n\r\n      const initTask = async () => {\r\n        if (tracker) tracker.startProject(projectPath);\r\n        perfMonitor.recordOperation('project-init-start', {\r\n          projectPath,\r\n          template,\r\n          environment: env,\r\n        });\r\n\r\n        const result = await resourceManager.withResource(async () => {\r\n          return await initializeProject(projectPath, {\r\n            template,\r\n            environment: env,\r\n            sparc,\r\n            minimal,\r\n            force,\r\n          });\r\n        });\r\n\r\n        if (result.success) {\r\n          perfMonitor.recordOperation('project-init-success', { projectPath });\r\n        } else {\r\n          perfMonitor.recordError(result.error, { projectPath, template, environment: env });\r\n        }\r\n\r\n        if (tracker) tracker.completeProject(projectPath, result.success);\r\n        results.push(result);\r\n      };\r\n\r\n      if (parallel) {\r\n        initTasks.push(initTask());\r\n      } else {\r\n        await initTask();\r\n      }\r\n    }\r\n  }\r\n\r\n  if (parallel) {\r\n    await Promise.all(initTasks);\r\n  }\r\n\r\n  // Final report\r\n  console.log('\\n\\nðŸ“Š Batch Initialization Report');\r\n  console.log('================================');\r\n\r\n  if (tracker) {\r\n    const report = tracker.getReport();\r\n    console.log(`Total Projects: ${report.total}`);\r\n    console.log(`Successful: ${report.completed} âœ…`);\r\n    console.log(`Failed: ${report.failed} âŒ`);\r\n    console.log(`Success Rate: ${report.successRate}%`);\r\n    console.log(`Total Time: ${report.elapsedTime}s`);\r\n    console.log(`Average Time per Project: ${(report.elapsedTime / report.total).toFixed(1)}s`);\r\n  }\r\n\r\n  // List successful projects\r\n  const successful = results.filter((r) => r.success);\r\n  if (successful.length > 0) {\r\n    console.log('\\nâœ… Successfully initialized:');\r\n    successful.forEach((r) => console.log(`  - ${r.projectPath}`));\r\n  }\r\n\r\n  // List failed projects\r\n  const failed = results.filter((r) => !r.success);\r\n  if (failed.length > 0) {\r\n    console.log('\\nâŒ Failed to initialize:');\r\n    failed.forEach((r) => console.log(`  - ${r.projectPath}: ${r.error}`));\r\n  }\r\n\r\n  // Stop monitoring and generate performance report\r\n  perfMonitor.stop();\r\n  resourceMonitor.stop();\r\n\r\n  if (performanceMonitoring) {\r\n    console.log(perfMonitor.generateReport());\r\n\r\n    // Show recommendations\r\n    if (recommendations.length > 0) {\r\n      console.log('\\nðŸ’¡ Recommendations:');\r\n      recommendations.forEach((rec) => console.log(`  â€¢ ${rec}`));\r\n    }\r\n  }\r\n\r\n  return results;\r\n}\r\n\r\n// Parse batch initialization config from file\r\nexport async function parseBatchConfig(configFile) {\r\n  try {\r\n    const content = await fs.readFile(configFile, 'utf8');\r\n    return JSON.parse(content);\r\n  } catch (error) {\r\n    printError(`Failed to read batch config file: ${error.message}`);\r\n    return null;\r\n  }\r\n}\r\n\r\n// Create batch initialization from config file\r\nexport async function batchInitFromConfig(configFile, options = {}) {\r\n  const config = await parseBatchConfig(configFile);\r\n  if (!config) return;\r\n\r\n  const { projects = [], baseOptions = {}, projectConfigs = {} } = config;\r\n\r\n  // Merge options with config\r\n  const mergedOptions = { ...baseOptions, ...options };\r\n\r\n  // If projectConfigs are specified, use them for individual project customization\r\n  if (Object.keys(projectConfigs).length > 0) {\r\n    const results = [];\r\n    const resourceManager = new ResourceManager(mergedOptions.maxConcurrency || 5);\r\n\r\n    for (const [projectName, projectConfig] of Object.entries(projectConfigs)) {\r\n      const projectOptions = { ...mergedOptions, ...projectConfig };\r\n      const result = await resourceManager.withResource(async () => {\r\n        return await initializeProject(projectName, projectOptions);\r\n      });\r\n      results.push(result);\r\n    }\r\n\r\n    return results;\r\n  }\r\n\r\n  // Otherwise, use standard batch init\r\n  return await batchInitCommand(projects, mergedOptions);\r\n}\r\n\r\n// Validation for batch operations\r\nexport function validateBatchOptions(options) {\r\n  const errors = [];\r\n\r\n  if (options.maxConcurrency && (options.maxConcurrency < 1 || options.maxConcurrency > 20)) {\r\n    errors.push('maxConcurrency must be between 1 and 20');\r\n  }\r\n\r\n  if (options.template && !PROJECT_TEMPLATES[options.template]) {\r\n    errors.push(\r\n      `Unknown template: ${options.template}. Available: ${Object.keys(PROJECT_TEMPLATES).join(', ')}`,\r\n    );\r\n  }\r\n\r\n  if (options.environments) {\r\n    for (const env of options.environments) {\r\n      if (!ENVIRONMENT_CONFIGS[env]) {\r\n        errors.push(\r\n          `Unknown environment: ${env}. Available: ${Object.keys(ENVIRONMENT_CONFIGS).join(', ')}`,\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  return errors;\r\n}\r\n\r\n// Export template and environment configurations for external use\r\nexport { PROJECT_TEMPLATES, ENVIRONMENT_CONFIGS };\r\n"],"names":["printSuccess","printError","printWarning","promises","fs","cwd","process","PerformanceMonitor","ResourceThresholdMonitor","BatchOptimizer","createSparcStructureManually","createClaudeSlashCommands","createSparcClaudeMd","createFullClaudeMd","createMinimalClaudeMd","createFullMemoryBankMd","createMinimalMemoryBankMd","createFullCoordinationMd","createMinimalCoordinationMd","createAgentsReadme","createSessionsReadme","BatchProgressTracker","totalProjects","completed","failed","inProgress","Map","startTime","Date","now","startProject","projectName","set","updateDisplay","completeProject","success","delete","elapsed","Math","floor","progress","console","clear","log","size","getProgressBar","project","projectElapsed","filled","empty","repeat","getReport","total","elapsedTime","successRate","toFixed","ResourceManager","maxConcurrency","maxMemoryMB","currentTasks","queue","acquire","Promise","resolve","push","release","length","shift","withResource","fn","PROJECT_TEMPLATES","name","description","extraDirs","extraFiles","version","type","scripts","start","dev","test","dependencies","express","cors","dotenv","private","react","typescript","build","compilerOptions","target","lib","jsx","module","moduleResolution","strict","esModuleInterop","skipLibCheck","forceConsistentCasingInFileNames","microservice","Dockerfile","bin","lint","ENVIRONMENT_CONFIGS","features","config","NODE_ENV","DEBUG","LOG_LEVEL","staging","prod","initializeProject","projectPath","options","template","environment","sparc","minimal","force","customConfig","currentDir","absoluteProjectPath","startsWith","mkdir","recursive","originalDir","chdir","directories","templateConfig","all","map","dir","catch","fileCreationTasks","claudeMd","writeFile","memoryBankMd","coordinationMd","initialData","agents","tasks","lastUpdated","JSON","stringify","envConfig","envContent","Object","entries","key","value","join","filePath","content","fileContent","replace","split","pop","error","message","batchInitCommand","projects","parallel","environments","progressTracking","performanceMonitoring","tracker","resourceManager","perfMonitor","enabled","logLevel","resourceMonitor","createDefaultCallbacks","optimalConcurrency","calculateOptimalConcurrency","timeEstimate","estimateCompletionTime","recommendations","generateRecommendations","results","initTasks","env","initTask","recordOperation","result","recordError","report","successful","filter","r","forEach","stop","generateReport","rec","parseBatchConfig","configFile","readFile","parse","batchInitFromConfig","baseOptions","projectConfigs","mergedOptions","keys","projectConfig","projectOptions","validateBatchOptions","errors"],"mappings":"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"}