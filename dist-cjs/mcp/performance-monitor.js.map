{
  "version": 3,
  "sources": ["../../src/mcp/performance-monitor.ts"],
  "sourcesContent": ["/**\n * MCP Performance Monitoring and Optimization\n */\n\nimport { EventEmitter } from 'node:events';\nimport { performance } from 'node:perf_hooks';\nimport type { ILogger } from '../core/logger.js';\nimport type { MCPSession, MCPRequest, MCPResponse, MCPMetrics } from '../utils/types.js';\n\nexport interface PerformanceMetrics {\n  requestCount: number;\n  averageResponseTime: number;\n  minResponseTime: number;\n  maxResponseTime: number;\n  p50ResponseTime: number;\n  p95ResponseTime: number;\n  p99ResponseTime: number;\n  errorRate: number;\n  throughput: number; // requests per second\n  activeConnections: number;\n  memoryUsage: {\n    heapUsed: number;\n    heapTotal: number;\n    external: number;\n    rss: number;\n  };\n  cpuUsage: {\n    user: number;\n    system: number;\n  };\n  timestamp: Date;\n}\n\nexport interface RequestMetrics {\n  id: string;\n  method: string;\n  sessionId: string;\n  startTime: number;\n  endTime?: number;\n  duration?: number;\n  success?: boolean;\n  error?: string;\n  requestSize?: number;\n  responseSize?: number;\n}\n\nexport interface AlertRule {\n  id: string;\n  name: string;\n  metric: string;\n  operator: 'gt' | 'lt' | 'eq' | 'gte' | 'lte';\n  threshold: number;\n  duration: number; // milliseconds\n  enabled: boolean;\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  actions: string[];\n}\n\nexport interface Alert {\n  id: string;\n  ruleId: string;\n  ruleName: string;\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  message: string;\n  triggeredAt: Date;\n  resolvedAt?: Date;\n  currentValue: number;\n  threshold: number;\n  metadata?: Record<string, unknown>;\n}\n\nexport interface OptimizationSuggestion {\n  id: string;\n  type: 'performance' | 'memory' | 'throughput' | 'latency';\n  priority: 'low' | 'medium' | 'high';\n  title: string;\n  description: string;\n  impact: string;\n  implementation: string;\n  estimatedImprovement: string;\n  detectedAt: Date;\n  metrics: Record<string, number>;\n}\n\n/**\n * MCP Performance Monitor\n * Provides comprehensive performance monitoring, alerting, and optimization suggestions\n */\nexport class MCPPerformanceMonitor extends EventEmitter {\n  private requestMetrics = new Map<string, RequestMetrics>();\n  private historicalMetrics: PerformanceMetrics[] = [];\n  private responseTimes: number[] = [];\n  private alertRules = new Map<string, AlertRule>();\n  private activeAlerts = new Map<string, Alert>();\n  private optimizationSuggestions: OptimizationSuggestion[] = [];\n\n  private metricsTimer?: NodeJS.Timeout;\n  private alertCheckTimer?: NodeJS.Timeout;\n  private cleanupTimer?: NodeJS.Timeout;\n\n  private readonly config = {\n    metricsInterval: 10000, // 10 seconds\n    alertCheckInterval: 5000, // 5 seconds\n    maxHistorySize: 1000,\n    maxResponseTimeHistory: 10000,\n    cleanupInterval: 300000, // 5 minutes\n    requestTimeout: 30000, // 30 seconds\n  };\n\n  constructor(private logger: ILogger) {\n    super();\n    this.setupDefaultAlertRules();\n    this.startMonitoring();\n  }\n\n  /**\n   * Record the start of a request\n   */\n  recordRequestStart(request: MCPRequest, session: MCPSession): string {\n    const requestId = `${request.id}_${Date.now()}`;\n    const metrics: RequestMetrics = {\n      id: requestId,\n      method: request.method,\n      sessionId: session.id,\n      startTime: performance.now(),\n      requestSize: this.calculateRequestSize(request),\n    };\n\n    this.requestMetrics.set(requestId, metrics);\n\n    this.logger.debug('Request started', {\n      requestId,\n      method: request.method,\n      sessionId: session.id,\n    });\n\n    return requestId;\n  }\n\n  /**\n   * Record the completion of a request\n   */\n  recordRequestEnd(requestId: string, response?: MCPResponse, error?: Error): void {\n    const metrics = this.requestMetrics.get(requestId);\n    if (!metrics) {\n      this.logger.warn('Request metrics not found', { requestId });\n      return;\n    }\n\n    const endTime = performance.now();\n    const duration = endTime - metrics.startTime;\n\n    metrics.endTime = endTime;\n    metrics.duration = duration;\n    metrics.success = !error;\n    metrics.error = error?.message;\n    metrics.responseSize = response ? this.calculateResponseSize(response) : 0;\n\n    // Add to response time history\n    this.responseTimes.push(duration);\n    if (this.responseTimes.length > this.config.maxResponseTimeHistory) {\n      this.responseTimes.shift();\n    }\n\n    this.logger.debug('Request completed', {\n      requestId,\n      duration,\n      success: metrics.success,\n      error: metrics.error,\n    });\n\n    this.emit('requestCompleted', metrics);\n\n    // Remove from active metrics after some time\n    setTimeout(() => {\n      this.requestMetrics.delete(requestId);\n    }, 60000); // Keep for 1 minute\n  }\n\n  /**\n   * Get current performance metrics\n   */\n  getCurrentMetrics(): PerformanceMetrics {\n    const now = Date.now();\n    const completedRequests = Array.from(this.requestMetrics.values()).filter(\n      (m) => m.endTime !== undefined,\n    );\n\n    const successfulRequests = completedRequests.filter((m) => m.success);\n    const errorRate =\n      completedRequests.length > 0\n        ? ((completedRequests.length - successfulRequests.length) / completedRequests.length) * 100\n        : 0;\n\n    // Calculate response time percentiles\n    const sortedTimes = [...this.responseTimes].sort((a, b) => a - b);\n    const p50 = this.getPercentile(sortedTimes, 0.5);\n    const p95 = this.getPercentile(sortedTimes, 0.95);\n    const p99 = this.getPercentile(sortedTimes, 0.99);\n\n    // Calculate throughput (requests per second over last minute)\n    const oneMinuteAgo = now - 60000;\n    const recentRequests = completedRequests.filter(\n      (m) => m.endTime && m.startTime + oneMinuteAgo > 0,\n    );\n    const throughput = recentRequests.length / 60;\n\n    const memUsage = process.memoryUsage();\n    const cpuUsage = process.cpuUsage();\n\n    const metrics: PerformanceMetrics = {\n      requestCount: completedRequests.length,\n      averageResponseTime:\n        this.responseTimes.length > 0\n          ? this.responseTimes.reduce((a, b) => a + b, 0) / this.responseTimes.length\n          : 0,\n      minResponseTime: sortedTimes.length > 0 ? sortedTimes[0] : 0,\n      maxResponseTime: sortedTimes.length > 0 ? sortedTimes[sortedTimes.length - 1] : 0,\n      p50ResponseTime: p50,\n      p95ResponseTime: p95,\n      p99ResponseTime: p99,\n      errorRate,\n      throughput,\n      activeConnections: this.requestMetrics.size,\n      memoryUsage: {\n        heapUsed: memUsage.heapUsed,\n        heapTotal: memUsage.heapTotal,\n        external: memUsage.external,\n        rss: memUsage.rss,\n      },\n      cpuUsage: {\n        user: cpuUsage.user / 1000000, // Convert to seconds\n        system: cpuUsage.system / 1000000,\n      },\n      timestamp: new Date(),\n    };\n\n    return metrics;\n  }\n\n  /**\n   * Get historical metrics\n   */\n  getHistoricalMetrics(limit?: number): PerformanceMetrics[] {\n    return limit ? this.historicalMetrics.slice(-limit) : [...this.historicalMetrics];\n  }\n\n  /**\n   * Add custom alert rule\n   */\n  addAlertRule(rule: AlertRule): void {\n    this.alertRules.set(rule.id, rule);\n    this.logger.info('Alert rule added', {\n      id: rule.id,\n      name: rule.name,\n      metric: rule.metric,\n      threshold: rule.threshold,\n    });\n  }\n\n  /**\n   * Remove alert rule\n   */\n  removeAlertRule(ruleId: string): void {\n    this.alertRules.delete(ruleId);\n\n    // Resolve any active alerts for this rule\n    for (const [alertId, alert] of this.activeAlerts.entries()) {\n      if (alert.ruleId === ruleId) {\n        this.resolveAlert(alertId);\n      }\n    }\n\n    this.logger.info('Alert rule removed', { ruleId });\n  }\n\n  /**\n   * Get active alerts\n   */\n  getActiveAlerts(): Alert[] {\n    return Array.from(this.activeAlerts.values());\n  }\n\n  /**\n   * Get optimization suggestions\n   */\n  getOptimizationSuggestions(): OptimizationSuggestion[] {\n    return [...this.optimizationSuggestions];\n  }\n\n  /**\n   * Get performance summary\n   */\n  getPerformanceSummary(): {\n    current: PerformanceMetrics;\n    trends: {\n      responseTime: 'improving' | 'degrading' | 'stable';\n      throughput: 'improving' | 'degrading' | 'stable';\n      errorRate: 'improving' | 'degrading' | 'stable';\n    };\n    alerts: number;\n    suggestions: number;\n  } {\n    const current = this.getCurrentMetrics();\n    const trends = this.calculateTrends();\n\n    return {\n      current,\n      trends,\n      alerts: this.activeAlerts.size,\n      suggestions: this.optimizationSuggestions.length,\n    };\n  }\n\n  /**\n   * Resolve an alert\n   */\n  resolveAlert(alertId: string): void {\n    const alert = this.activeAlerts.get(alertId);\n    if (alert) {\n      alert.resolvedAt = new Date();\n      this.activeAlerts.delete(alertId);\n\n      this.logger.info('Alert resolved', {\n        alertId,\n        ruleName: alert.ruleName,\n        duration: alert.resolvedAt.getTime() - alert.triggeredAt.getTime(),\n      });\n\n      this.emit('alertResolved', alert);\n    }\n  }\n\n  /**\n   * Clear all optimization suggestions\n   */\n  clearOptimizationSuggestions(): void {\n    this.optimizationSuggestions = [];\n    this.logger.info('Optimization suggestions cleared');\n  }\n\n  /**\n   * Stop monitoring\n   */\n  stop(): void {\n    if (this.metricsTimer) {\n      clearInterval(this.metricsTimer);\n      this.metricsTimer = undefined;\n    }\n\n    if (this.alertCheckTimer) {\n      clearInterval(this.alertCheckTimer);\n      this.alertCheckTimer = undefined;\n    }\n\n    if (this.cleanupTimer) {\n      clearInterval(this.cleanupTimer);\n      this.cleanupTimer = undefined;\n    }\n\n    this.logger.info('Performance monitoring stopped');\n  }\n\n  private startMonitoring(): void {\n    // Collect metrics periodically\n    this.metricsTimer = setInterval(() => {\n      const metrics = this.getCurrentMetrics();\n      this.historicalMetrics.push(metrics);\n\n      // Keep only recent history\n      if (this.historicalMetrics.length > this.config.maxHistorySize) {\n        this.historicalMetrics.shift();\n      }\n\n      this.emit('metricsCollected', metrics);\n    }, this.config.metricsInterval);\n\n    // Check alerts periodically\n    this.alertCheckTimer = setInterval(() => {\n      this.checkAlerts();\n    }, this.config.alertCheckInterval);\n\n    // Cleanup old data\n    this.cleanupTimer = setInterval(() => {\n      this.cleanup();\n      this.generateOptimizationSuggestions();\n    }, this.config.cleanupInterval);\n\n    this.logger.info('Performance monitoring started');\n  }\n\n  private setupDefaultAlertRules(): void {\n    const defaultRules: AlertRule[] = [\n      {\n        id: 'high_response_time',\n        name: 'High Response Time',\n        metric: 'averageResponseTime',\n        operator: 'gt',\n        threshold: 5000, // 5 seconds\n        duration: 30000, // 30 seconds\n        enabled: true,\n        severity: 'medium',\n        actions: ['log', 'notify'],\n      },\n      {\n        id: 'high_error_rate',\n        name: 'High Error Rate',\n        metric: 'errorRate',\n        operator: 'gt',\n        threshold: 10, // 10%\n        duration: 60000, // 1 minute\n        enabled: true,\n        severity: 'high',\n        actions: ['log', 'notify', 'alert'],\n      },\n      {\n        id: 'low_throughput',\n        name: 'Low Throughput',\n        metric: 'throughput',\n        operator: 'lt',\n        threshold: 1, // 1 request per second\n        duration: 120000, // 2 minutes\n        enabled: true,\n        severity: 'medium',\n        actions: ['log', 'notify'],\n      },\n      {\n        id: 'high_memory_usage',\n        name: 'High Memory Usage',\n        metric: 'memoryUsage.heapUsed',\n        operator: 'gt',\n        threshold: 1024 * 1024 * 1024, // 1GB\n        duration: 300000, // 5 minutes\n        enabled: true,\n        severity: 'high',\n        actions: ['log', 'notify', 'alert'],\n      },\n    ];\n\n    for (const rule of defaultRules) {\n      this.alertRules.set(rule.id, rule);\n    }\n  }\n\n  private checkAlerts(): void {\n    const metrics = this.getCurrentMetrics();\n\n    for (const rule of this.alertRules.values()) {\n      if (!rule.enabled) continue;\n\n      const value = this.getMetricValue(metrics, rule.metric);\n      const triggered = this.evaluateCondition(value, rule.operator, rule.threshold);\n\n      const existingAlert = Array.from(this.activeAlerts.values()).find(\n        (a) => a.ruleId === rule.id && !a.resolvedAt,\n      );\n\n      if (triggered && !existingAlert) {\n        // Create new alert\n        const alert: Alert = {\n          id: `alert_${rule.id}_${Date.now()}`,\n          ruleId: rule.id,\n          ruleName: rule.name,\n          severity: rule.severity,\n          message: `${rule.name}: ${rule.metric} is ${value} (threshold: ${rule.threshold})`,\n          triggeredAt: new Date(),\n          currentValue: value,\n          threshold: rule.threshold,\n        };\n\n        this.activeAlerts.set(alert.id, alert);\n\n        this.logger.warn('Alert triggered', {\n          alertId: alert.id,\n          ruleName: rule.name,\n          metric: rule.metric,\n          value,\n          threshold: rule.threshold,\n        });\n\n        this.emit('alertTriggered', alert);\n      } else if (!triggered && existingAlert) {\n        // Resolve existing alert\n        this.resolveAlert(existingAlert.id);\n      }\n    }\n  }\n\n  private getMetricValue(metrics: PerformanceMetrics, path: string): number {\n    const parts = path.split('.');\n    let value: any = metrics;\n\n    for (const part of parts) {\n      value = value?.[part];\n      if (value === undefined) break;\n    }\n\n    return typeof value === 'number' ? value : 0;\n  }\n\n  private evaluateCondition(value: number, operator: string, threshold: number): boolean {\n    switch (operator) {\n      case 'gt':\n        return value > threshold;\n      case 'gte':\n        return value >= threshold;\n      case 'lt':\n        return value < threshold;\n      case 'lte':\n        return value <= threshold;\n      case 'eq':\n        return value === threshold;\n      default:\n        return false;\n    }\n  }\n\n  private getPercentile(sortedArray: number[], percentile: number): number {\n    if (sortedArray.length === 0) return 0;\n\n    const index = Math.ceil(sortedArray.length * percentile) - 1;\n    return sortedArray[Math.max(0, Math.min(index, sortedArray.length - 1))];\n  }\n\n  private calculateTrends(): {\n    responseTime: 'improving' | 'degrading' | 'stable';\n    throughput: 'improving' | 'degrading' | 'stable';\n    errorRate: 'improving' | 'degrading' | 'stable';\n  } {\n    const recentMetrics = this.historicalMetrics.slice(-10); // Last 10 data points\n\n    if (recentMetrics.length < 2) {\n      return {\n        responseTime: 'stable',\n        throughput: 'stable',\n        errorRate: 'stable',\n      };\n    }\n\n    const first = recentMetrics[0];\n    const last = recentMetrics[recentMetrics.length - 1];\n\n    return {\n      responseTime: this.getTrend(first.averageResponseTime, last.averageResponseTime, true),\n      throughput: this.getTrend(first.throughput, last.throughput, false),\n      errorRate: this.getTrend(first.errorRate, last.errorRate, true),\n    };\n  }\n\n  private getTrend(\n    oldValue: number,\n    newValue: number,\n    lowerIsBetter: boolean,\n  ): 'improving' | 'degrading' | 'stable' {\n    const change = (newValue - oldValue) / oldValue;\n    const threshold = 0.1; // 10% change threshold\n\n    if (Math.abs(change) < threshold) {\n      return 'stable';\n    }\n\n    const improving = lowerIsBetter ? change < 0 : change > 0;\n    return improving ? 'improving' : 'degrading';\n  }\n\n  private generateOptimizationSuggestions(): void {\n    const metrics = this.getCurrentMetrics();\n    const suggestions: OptimizationSuggestion[] = [];\n\n    // High response time suggestion\n    if (metrics.averageResponseTime > 2000) {\n      suggestions.push({\n        id: `opt_response_time_${Date.now()}`,\n        type: 'performance',\n        priority: 'high',\n        title: 'Optimize Response Time',\n        description: 'Average response time is above 2 seconds',\n        impact: 'Improve user experience and system throughput',\n        implementation:\n          'Consider implementing caching, optimizing database queries, or adding connection pooling',\n        estimatedImprovement: '30-50% response time reduction',\n        detectedAt: new Date(),\n        metrics: { averageResponseTime: metrics.averageResponseTime },\n      });\n    }\n\n    // High memory usage suggestion\n    if (metrics.memoryUsage.heapUsed > 512 * 1024 * 1024) {\n      // 512MB\n      suggestions.push({\n        id: `opt_memory_${Date.now()}`,\n        type: 'memory',\n        priority: 'medium',\n        title: 'Optimize Memory Usage',\n        description: 'Heap memory usage is high',\n        impact: 'Prevent memory leaks and improve stability',\n        implementation:\n          'Review memory usage patterns, implement object pooling, or add garbage collection tuning',\n        estimatedImprovement: '20-30% memory reduction',\n        detectedAt: new Date(),\n        metrics: { heapUsed: metrics.memoryUsage.heapUsed },\n      });\n    }\n\n    // Low throughput suggestion\n    if (metrics.throughput < 5 && metrics.requestCount > 100) {\n      suggestions.push({\n        id: `opt_throughput_${Date.now()}`,\n        type: 'throughput',\n        priority: 'medium',\n        title: 'Improve Throughput',\n        description: 'Request throughput is below optimal levels',\n        impact: 'Handle more concurrent requests efficiently',\n        implementation: 'Consider horizontal scaling, load balancing, or request batching',\n        estimatedImprovement: '2-3x throughput increase',\n        detectedAt: new Date(),\n        metrics: { throughput: metrics.throughput },\n      });\n    }\n\n    // Add only new suggestions\n    for (const suggestion of suggestions) {\n      const exists = this.optimizationSuggestions.some(\n        (s) => s.type === suggestion.type && s.title === suggestion.title,\n      );\n\n      if (!exists) {\n        this.optimizationSuggestions.push(suggestion);\n        this.emit('optimizationSuggestion', suggestion);\n      }\n    }\n\n    // Keep only recent suggestions (last 24 hours)\n    const dayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);\n    this.optimizationSuggestions = this.optimizationSuggestions.filter(\n      (s) => s.detectedAt > dayAgo,\n    );\n  }\n\n  private cleanup(): void {\n    const now = Date.now();\n\n    // Clean up old request metrics\n    for (const [id, metrics] of this.requestMetrics.entries()) {\n      if (now - metrics.startTime > this.config.requestTimeout) {\n        this.requestMetrics.delete(id);\n      }\n    }\n\n    // Clean up old response times\n    if (this.responseTimes.length > this.config.maxResponseTimeHistory) {\n      this.responseTimes = this.responseTimes.slice(-this.config.maxResponseTimeHistory);\n    }\n  }\n\n  private calculateRequestSize(request: MCPRequest): number {\n    return JSON.stringify(request).length;\n  }\n\n  private calculateResponseSize(response: MCPResponse): number {\n    return JSON.stringify(response).length;\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
