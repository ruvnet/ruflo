{"version":3,"sources":["../../../../../../src/cli/simple-commands/init/validation/config-validator.js"],"sourcesContent":["import { promises as fs } from 'fs';\r\n// config-validator.js - Configuration file validation\r\n\r\nexport class ConfigValidator {\r\n  constructor(workingDir) {\r\n    this.workingDir = workingDir;\r\n  }\r\n\r\n  /**\r\n   * Validate .roomodes configuration file\r\n   */\r\n  async validateRoomodes() {\r\n    const result = {\r\n      success: true,\r\n      errors: [],\r\n      warnings: [],\r\n      config: null,\r\n    };\r\n\r\n    const roomodesPath = `${this.workingDir}/.roomodes`;\r\n\r\n    try {\r\n      // Check if file exists\r\n      const stat = await fs.stat(roomodesPath);\r\n      if (!stat.isFile) {\r\n        result.success = false;\r\n        result.errors.push('.roomodes exists but is not a file');\r\n        return result;\r\n      }\r\n\r\n      // Read and parse JSON\r\n      const content = await fs.readFile(roomodesPath, 'utf8');\r\n\r\n      try {\r\n        const config = JSON.parse(content);\r\n        result.config = config;\r\n\r\n        // Validate structure\r\n        const validationResult = this.validateRoomodesStructure(config);\r\n        if (!validationResult.valid) {\r\n          result.success = false;\r\n          result.errors.push(...validationResult.errors);\r\n        }\r\n        result.warnings.push(...validationResult.warnings);\r\n      } catch (jsonError) {\r\n        result.success = false;\r\n        result.errors.push(`Invalid JSON in .roomodes: ${jsonError.message}`);\r\n      }\r\n    } catch (error) {\r\n      if (error instanceof Deno.errors.NotFound) {\r\n        result.warnings.push('.roomodes file not found - SPARC features may not be available');\r\n      } else {\r\n        result.success = false;\r\n        result.errors.push(`Could not read .roomodes: ${error.message}`);\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Validate CLAUDE.md configuration\r\n   */\r\n  async validateClaudeMd() {\r\n    const result = {\r\n      success: true,\r\n      errors: [],\r\n      warnings: [],\r\n      content: null,\r\n    };\r\n\r\n    const claudeMdPath = `${this.workingDir}/CLAUDE.md`;\r\n\r\n    try {\r\n      const content = await fs.readFile(claudeMdPath, 'utf8');\r\n      result.content = content;\r\n\r\n      // Check for required sections\r\n      const requiredSections = [\r\n        '# Claude Code Configuration',\r\n        '## Project Overview',\r\n        '## SPARC Development Commands',\r\n      ];\r\n\r\n      for (const section of requiredSections) {\r\n        if (!content.includes(section)) {\r\n          result.warnings.push(`Missing recommended section: ${section}`);\r\n        }\r\n      }\r\n\r\n      // Check for important command patterns\r\n      const importantCommands = ['npx claude-flow sparc', 'npm run build', 'npm run test'];\r\n\r\n      for (const command of importantCommands) {\r\n        if (!content.includes(command)) {\r\n          result.warnings.push(`Missing important command reference: ${command}`);\r\n        }\r\n      }\r\n\r\n      // Check file size\r\n      if (content.length < 100) {\r\n        result.success = false;\r\n        result.errors.push('CLAUDE.md appears to be too short or empty');\r\n      }\r\n    } catch (error) {\r\n      result.success = false;\r\n      result.errors.push(`Could not read CLAUDE.md: ${error.message}`);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Validate memory configuration\r\n   */\r\n  async validateMemoryConfig() {\r\n    const result = {\r\n      success: true,\r\n      errors: [],\r\n      warnings: [],\r\n      data: null,\r\n    };\r\n\r\n    const memoryDataPath = `${this.workingDir}/memory/claude-flow-data.json`;\r\n\r\n    try {\r\n      const content = await fs.readFile(memoryDataPath, 'utf8');\r\n\r\n      try {\r\n        const data = JSON.parse(content);\r\n        result.data = data;\r\n\r\n        // Validate structure\r\n        const validationResult = this.validateMemoryDataStructure(data);\r\n        if (!validationResult.valid) {\r\n          result.success = false;\r\n          result.errors.push(...validationResult.errors);\r\n        }\r\n        result.warnings.push(...validationResult.warnings);\r\n      } catch (jsonError) {\r\n        result.success = false;\r\n        result.errors.push(`Invalid JSON in memory data: ${jsonError.message}`);\r\n      }\r\n    } catch (error) {\r\n      result.success = false;\r\n      result.errors.push(`Could not read memory data: ${error.message}`);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Validate coordination configuration\r\n   */\r\n  async validateCoordinationConfig() {\r\n    const result = {\r\n      success: true,\r\n      errors: [],\r\n      warnings: [],\r\n      content: null,\r\n    };\r\n\r\n    const coordinationPath = `${this.workingDir}/coordination.md`;\r\n\r\n    try {\r\n      const content = await fs.readFile(coordinationPath, 'utf8');\r\n      result.content = content;\r\n\r\n      // Check for required sections\r\n      const requiredSections = [\r\n        '# Multi-Agent Coordination',\r\n        '## Agent Coordination Patterns',\r\n        '## Memory Management',\r\n      ];\r\n\r\n      for (const section of requiredSections) {\r\n        if (!content.includes(section)) {\r\n          result.warnings.push(`Missing recommended section in coordination.md: ${section}`);\r\n        }\r\n      }\r\n\r\n      // Check file size\r\n      if (content.length < 50) {\r\n        result.warnings.push('coordination.md appears to be very short');\r\n      }\r\n    } catch (error) {\r\n      result.success = false;\r\n      result.errors.push(`Could not read coordination.md: ${error.message}`);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Validate executable configuration\r\n   */\r\n  async validateExecutable() {\r\n    const result = {\r\n      success: true,\r\n      errors: [],\r\n      warnings: [],\r\n    };\r\n\r\n    const executablePath = `${this.workingDir}/claude-flow`;\r\n\r\n    try {\r\n      const stat = await fs.stat(executablePath);\r\n\r\n      if (!stat.isFile) {\r\n        result.success = false;\r\n        result.errors.push('claude-flow executable is not a file');\r\n        return result;\r\n      }\r\n\r\n      // Check if executable (on Unix systems)\r\n      if (Deno.build.os !== 'windows') {\r\n        const isExecutable = (stat.mode & 0o111) !== 0;\r\n        if (!isExecutable) {\r\n          result.warnings.push('claude-flow file is not executable');\r\n        }\r\n      }\r\n\r\n      // Read and validate content\r\n      const content = await fs.readFile(executablePath, 'utf8');\r\n\r\n      // Check for required elements\r\n      if (content.includes('#!/usr/bin/env')) {\r\n        // Script file\r\n        if (!content.includes('claude-flow') && !content.includes('deno run')) {\r\n          result.warnings.push('Executable script may not be properly configured');\r\n        }\r\n      } else {\r\n        result.warnings.push('Executable may not have proper shebang');\r\n      }\r\n    } catch (error) {\r\n      result.success = false;\r\n      result.errors.push(`Could not validate executable: ${error.message}`);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  // Helper methods\r\n\r\n  validateRoomodesStructure(config) {\r\n    const result = {\r\n      valid: true,\r\n      errors: [],\r\n      warnings: [],\r\n    };\r\n\r\n    // Check top-level structure\r\n    if (typeof config !== 'object' || config === null) {\r\n      result.valid = false;\r\n      result.errors.push('.roomodes must be a JSON object');\r\n      return result;\r\n    }\r\n\r\n    // Check for required fields\r\n    const requiredFields = ['modes', 'version'];\r\n    for (const field of requiredFields) {\r\n      if (!(field in config)) {\r\n        result.warnings.push(`Missing recommended field in .roomodes: ${field}`);\r\n      }\r\n    }\r\n\r\n    // Validate modes if present\r\n    if ('modes' in config) {\r\n      if (typeof config.modes !== 'object' || config.modes === null) {\r\n        result.valid = false;\r\n        result.errors.push('.roomodes modes must be an object');\r\n      } else {\r\n        // Check each mode\r\n        for (const [modeName, modeConfig] of Object.entries(config.modes)) {\r\n          const modeValidation = this.validateModeConfig(modeName, modeConfig);\r\n          if (!modeValidation.valid) {\r\n            result.warnings.push(...modeValidation.errors.map((err) => `Mode ${modeName}: ${err}`));\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  validateModeConfig(modeName, modeConfig) {\r\n    const result = {\r\n      valid: true,\r\n      errors: [],\r\n    };\r\n\r\n    if (typeof modeConfig !== 'object' || modeConfig === null) {\r\n      result.valid = false;\r\n      result.errors.push('mode configuration must be an object');\r\n      return result;\r\n    }\r\n\r\n    // Check for recommended fields\r\n    const recommendedFields = ['description', 'persona', 'tools'];\r\n    for (const field of recommendedFields) {\r\n      if (!(field in modeConfig)) {\r\n        result.errors.push(`missing recommended field: ${field}`);\r\n      }\r\n    }\r\n\r\n    // Validate specific fields\r\n    if ('tools' in modeConfig && !Array.isArray(modeConfig.tools)) {\r\n      result.errors.push('tools must be an array');\r\n    }\r\n\r\n    if ('description' in modeConfig && typeof modeConfig.description !== 'string') {\r\n      result.errors.push('description must be a string');\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  validateMemoryDataStructure(data) {\r\n    const result = {\r\n      valid: true,\r\n      errors: [],\r\n      warnings: [],\r\n    };\r\n\r\n    if (typeof data !== 'object' || data === null) {\r\n      result.valid = false;\r\n      result.errors.push('Memory data must be a JSON object');\r\n      return result;\r\n    }\r\n\r\n    // Check for required fields\r\n    const requiredFields = ['agents', 'tasks', 'lastUpdated'];\r\n    for (const field of requiredFields) {\r\n      if (!(field in data)) {\r\n        result.warnings.push(`Missing field in memory data: ${field}`);\r\n      }\r\n    }\r\n\r\n    // Validate field types\r\n    if ('agents' in data && !Array.isArray(data.agents)) {\r\n      result.errors.push('agents must be an array');\r\n    }\r\n\r\n    if ('tasks' in data && !Array.isArray(data.tasks)) {\r\n      result.errors.push('tasks must be an array');\r\n    }\r\n\r\n    if ('lastUpdated' in data && typeof data.lastUpdated !== 'number') {\r\n      result.warnings.push('lastUpdated should be a timestamp number');\r\n    }\r\n\r\n    return result;\r\n  }\r\n}\r\n"],"names":["promises","fs","ConfigValidator","workingDir","validateRoomodes","result","success","errors","warnings","config","roomodesPath","stat","isFile","push","content","readFile","JSON","parse","validationResult","validateRoomodesStructure","valid","jsonError","message","error","Deno","NotFound","validateClaudeMd","claudeMdPath","requiredSections","section","includes","importantCommands","command","length","validateMemoryConfig","data","memoryDataPath","validateMemoryDataStructure","validateCoordinationConfig","coordinationPath","validateExecutable","executablePath","build","os","isExecutable","mode","requiredFields","field","modes","modeName","modeConfig","Object","entries","modeValidation","validateModeConfig","map","err","recommendedFields","Array","isArray","tools","description","agents","tasks","lastUpdated"],"mappings":"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"}