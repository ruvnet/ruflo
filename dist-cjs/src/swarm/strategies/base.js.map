{"version":3,"sources":["../../../../src/swarm/strategies/base.ts"],"sourcesContent":["/**\r\n * Base Strategy Interface for Swarm Task Execution\r\n * Provides the foundation for different task execution strategies\r\n */\r\n\r\nimport type { TaskDefinition, SwarmObjective, AgentState, SwarmConfig } from '../types.js';\r\n\r\nexport interface StrategyMetrics {\r\n  tasksCompleted: number;\r\n  averageExecutionTime: number;\r\n  successRate: number;\r\n  resourceUtilization: number;\r\n  parallelismEfficiency: number;\r\n  cacheHitRate: number;\r\n  predictionAccuracy: number;\r\n  // Additional metrics\r\n  queriesExecuted?: number;\r\n  averageResponseTime?: number;\r\n  cacheHits?: number;\r\n  cacheMisses?: number;\r\n  credibilityScores?: Record<string, number>;\r\n}\r\n\r\nexport interface TaskPattern {\r\n  pattern: RegExp;\r\n  type: string;\r\n  complexity: number;\r\n  estimatedDuration: number;\r\n  requiredAgents: number;\r\n  priority: number;\r\n}\r\n\r\nexport interface DecompositionResult {\r\n  tasks: TaskDefinition[];\r\n  dependencies: Map<string, string[]>;\r\n  estimatedDuration: number;\r\n  recommendedStrategy: string;\r\n  complexity: number;\r\n  batchGroups: TaskBatch[];\r\n  // Additional properties for caching and memory\r\n  timestamp: Date;\r\n  ttl: number;\r\n  accessCount: number;\r\n  lastAccessed: Date;\r\n  data: any;\r\n  // Resource requirements\r\n  resourceRequirements?: {\r\n    memory?: number;\r\n    cpu?: number;\r\n    network?: string;\r\n    storage?: string;\r\n  };\r\n}\r\n\r\nexport interface TaskBatch {\r\n  id: string;\r\n  tasks: TaskDefinition[];\r\n  canRunInParallel: boolean;\r\n  estimatedDuration: number;\r\n  requiredResources: Record<string, number>;\r\n}\r\n\r\nexport interface AgentAllocation {\r\n  agentId: string;\r\n  tasks: string[];\r\n  estimatedWorkload: number;\r\n  capabilities: string[];\r\n}\r\n\r\nexport abstract class BaseStrategy {\r\n  protected metrics: StrategyMetrics;\r\n  protected taskPatterns: TaskPattern[];\r\n  protected cache: Map<string, DecompositionResult>;\r\n  protected config: SwarmConfig;\r\n\r\n  constructor(config: SwarmConfig) {\r\n    this.config = config;\r\n    this.metrics = this.initializeMetrics();\r\n    this.taskPatterns = this.initializeTaskPatterns();\r\n    this.cache = new Map();\r\n  }\r\n\r\n  // Abstract methods that must be implemented by concrete strategies\r\n  abstract decomposeObjective(objective: SwarmObjective): Promise<DecompositionResult>;\r\n  abstract selectAgentForTask(\r\n    task: TaskDefinition,\r\n    availableAgents: AgentState[],\r\n  ): Promise<string | null>;\r\n  abstract optimizeTaskSchedule(\r\n    tasks: TaskDefinition[],\r\n    agents: AgentState[],\r\n  ): Promise<AgentAllocation[]>;\r\n\r\n  // Common utility methods\r\n  protected initializeMetrics(): StrategyMetrics {\r\n    return {\r\n      tasksCompleted: 0,\r\n      averageExecutionTime: 0,\r\n      successRate: 0,\r\n      resourceUtilization: 0,\r\n      parallelismEfficiency: 0,\r\n      cacheHitRate: 0,\r\n      predictionAccuracy: 0,\r\n    };\r\n  }\r\n\r\n  protected initializeTaskPatterns(): TaskPattern[] {\r\n    return [\r\n      {\r\n        pattern: /create|build|implement|develop/i,\r\n        type: 'development',\r\n        complexity: 3,\r\n        estimatedDuration: 15 * 60 * 1000,\r\n        requiredAgents: 2,\r\n        priority: 2,\r\n      },\r\n      {\r\n        pattern: /test|verify|validate/i,\r\n        type: 'testing',\r\n        complexity: 2,\r\n        estimatedDuration: 8 * 60 * 1000,\r\n        requiredAgents: 1,\r\n        priority: 1,\r\n      },\r\n      {\r\n        pattern: /analyze|research|investigate/i,\r\n        type: 'analysis',\r\n        complexity: 2,\r\n        estimatedDuration: 10 * 60 * 1000,\r\n        requiredAgents: 1,\r\n        priority: 1,\r\n      },\r\n      {\r\n        pattern: /document|write|explain/i,\r\n        type: 'documentation',\r\n        complexity: 1,\r\n        estimatedDuration: 5 * 60 * 1000,\r\n        requiredAgents: 1,\r\n        priority: 0,\r\n      },\r\n      {\r\n        pattern: /optimize|improve|refactor/i,\r\n        type: 'optimization',\r\n        complexity: 3,\r\n        estimatedDuration: 12 * 60 * 1000,\r\n        requiredAgents: 2,\r\n        priority: 1,\r\n      },\r\n    ];\r\n  }\r\n\r\n  protected detectTaskType(description: string): string {\r\n    for (const pattern of this.taskPatterns) {\r\n      if (pattern.pattern.test(description)) {\r\n        return pattern.type;\r\n      }\r\n    }\r\n    return 'generic';\r\n  }\r\n\r\n  protected estimateComplexity(description: string): number {\r\n    const pattern = this.taskPatterns.find((p) => p.pattern.test(description));\r\n    if (pattern) {\r\n      return pattern.complexity;\r\n    }\r\n\r\n    // Fallback complexity estimation based on description length and keywords\r\n    let complexity = 1;\r\n    const words = description.split(' ').length;\r\n\r\n    if (words > 50) complexity += 1;\r\n    if (words > 100) complexity += 1;\r\n\r\n    const complexKeywords = ['integrate', 'complex', 'advanced', 'multiple', 'system'];\r\n    const foundKeywords = complexKeywords.filter((keyword) =>\r\n      description.toLowerCase().includes(keyword),\r\n    ).length;\r\n\r\n    complexity += foundKeywords;\r\n\r\n    return Math.min(complexity, 5); // Cap at 5\r\n  }\r\n\r\n  protected getCacheKey(objective: SwarmObjective): string {\r\n    return `${objective.strategy}-${objective.description.slice(0, 100)}`;\r\n  }\r\n\r\n  protected updateMetrics(result: DecompositionResult, executionTime: number): void {\r\n    this.metrics.tasksCompleted += result.tasks.length;\r\n    this.metrics.averageExecutionTime = (this.metrics.averageExecutionTime + executionTime) / 2;\r\n  }\r\n\r\n  public getMetrics(): StrategyMetrics {\r\n    return { ...this.metrics };\r\n  }\r\n\r\n  public clearCache(): void {\r\n    this.cache.clear();\r\n  }\r\n}\r\n"],"names":["BaseStrategy","metrics","taskPatterns","cache","config","initializeMetrics","initializeTaskPatterns","Map","tasksCompleted","averageExecutionTime","successRate","resourceUtilization","parallelismEfficiency","cacheHitRate","predictionAccuracy","pattern","type","complexity","estimatedDuration","requiredAgents","priority","detectTaskType","description","test","estimateComplexity","find","p","words","split","length","complexKeywords","foundKeywords","filter","keyword","toLowerCase","includes","Math","min","getCacheKey","objective","strategy","slice","updateMetrics","result","executionTime","tasks","getMetrics","clearCache","clear"],"mappings":"AAqEA,OAAO,MAAeA;IACVC,QAAyB;IACzBC,aAA4B;IAC5BC,MAAwC;IACxCC,OAAoB;IAE9B,YAAYA,MAAmB,CAAE;QAC/B,IAAI,CAACA,MAAM,GAAGA;QACd,IAAI,CAACH,OAAO,GAAG,IAAI,CAACI,iBAAiB;QACrC,IAAI,CAACH,YAAY,GAAG,IAAI,CAACI,sBAAsB;QAC/C,IAAI,CAACH,KAAK,GAAG,IAAII;IACnB;IAcUF,oBAAqC;QAC7C,OAAO;YACLG,gBAAgB;YAChBC,sBAAsB;YACtBC,aAAa;YACbC,qBAAqB;YACrBC,uBAAuB;YACvBC,cAAc;YACdC,oBAAoB;QACtB;IACF;IAEUR,yBAAwC;QAChD,OAAO;YACL;gBACES,SAAS;gBACTC,MAAM;gBACNC,YAAY;gBACZC,mBAAmB,KAAK,KAAK;gBAC7BC,gBAAgB;gBAChBC,UAAU;YACZ;YACA;gBACEL,SAAS;gBACTC,MAAM;gBACNC,YAAY;gBACZC,mBAAmB,IAAI,KAAK;gBAC5BC,gBAAgB;gBAChBC,UAAU;YACZ;YACA;gBACEL,SAAS;gBACTC,MAAM;gBACNC,YAAY;gBACZC,mBAAmB,KAAK,KAAK;gBAC7BC,gBAAgB;gBAChBC,UAAU;YACZ;YACA;gBACEL,SAAS;gBACTC,MAAM;gBACNC,YAAY;gBACZC,mBAAmB,IAAI,KAAK;gBAC5BC,gBAAgB;gBAChBC,UAAU;YACZ;YACA;gBACEL,SAAS;gBACTC,MAAM;gBACNC,YAAY;gBACZC,mBAAmB,KAAK,KAAK;gBAC7BC,gBAAgB;gBAChBC,UAAU;YACZ;SACD;IACH;IAEUC,eAAeC,WAAmB,EAAU;QACpD,KAAK,MAAMP,WAAW,IAAI,CAACb,YAAY,CAAE;YACvC,IAAIa,QAAQA,OAAO,CAACQ,IAAI,CAACD,cAAc;gBACrC,OAAOP,QAAQC,IAAI;YACrB;QACF;QACA,OAAO;IACT;IAEUQ,mBAAmBF,WAAmB,EAAU;QACxD,MAAMP,UAAU,IAAI,CAACb,YAAY,CAACuB,IAAI,CAAC,CAACC,IAAMA,EAAEX,OAAO,CAACQ,IAAI,CAACD;QAC7D,IAAIP,SAAS;YACX,OAAOA,QAAQE,UAAU;QAC3B;QAGA,IAAIA,aAAa;QACjB,MAAMU,QAAQL,YAAYM,KAAK,CAAC,KAAKC,MAAM;QAE3C,IAAIF,QAAQ,IAAIV,cAAc;QAC9B,IAAIU,QAAQ,KAAKV,cAAc;QAE/B,MAAMa,kBAAkB;YAAC;YAAa;YAAW;YAAY;YAAY;SAAS;QAClF,MAAMC,gBAAgBD,gBAAgBE,MAAM,CAAC,CAACC,UAC5CX,YAAYY,WAAW,GAAGC,QAAQ,CAACF,UACnCJ,MAAM;QAERZ,cAAcc;QAEd,OAAOK,KAAKC,GAAG,CAACpB,YAAY;IAC9B;IAEUqB,YAAYC,SAAyB,EAAU;QACvD,OAAO,GAAGA,UAAUC,QAAQ,CAAC,CAAC,EAAED,UAAUjB,WAAW,CAACmB,KAAK,CAAC,GAAG,MAAM;IACvE;IAEUC,cAAcC,MAA2B,EAAEC,aAAqB,EAAQ;QAChF,IAAI,CAAC3C,OAAO,CAACO,cAAc,IAAImC,OAAOE,KAAK,CAAChB,MAAM;QAClD,IAAI,CAAC5B,OAAO,CAACQ,oBAAoB,GAAG,AAAC,CAAA,IAAI,CAACR,OAAO,CAACQ,oBAAoB,GAAGmC,aAAY,IAAK;IAC5F;IAEOE,aAA8B;QACnC,OAAO;YAAE,GAAG,IAAI,CAAC7C,OAAO;QAAC;IAC3B;IAEO8C,aAAmB;QACxB,IAAI,CAAC5C,KAAK,CAAC6C,KAAK;IAClB;AACF"}