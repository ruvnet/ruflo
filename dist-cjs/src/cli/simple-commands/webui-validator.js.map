{"version":3,"sources":["../../../../src/cli/simple-commands/webui-validator.js"],"sourcesContent":["/**\r\n * WebUI Cross-Platform Validator\r\n * Validates that WebUI components work across Node.js and Deno\r\n */\r\n\r\nimport { compat } from '../runtime-detector.js';\r\nimport { promises as fs } from 'fs';\r\n\r\nexport class WebUIValidator {\r\n  constructor() {\r\n    this.tests = [];\r\n    this.results = {\r\n      passed: 0,\r\n      failed: 0,\r\n      total: 0,\r\n    };\r\n  }\r\n\r\n  async runValidation() {\r\n    console.log(`üîç WebUI Cross-Platform Validation (${compat.runtime})`);\r\n    console.log('‚îÄ'.repeat(50));\r\n\r\n    // Runtime Detection Test\r\n    this.test('Runtime Detection', () => {\r\n      const isValidRuntime = compat.runtime === 'node' || compat.runtime === 'deno';\r\n      const hasPlatform = compat.platform && compat.platform.os;\r\n      return isValidRuntime && hasPlatform;\r\n    });\r\n\r\n    // Terminal I/O Test\r\n    this.test('Terminal I/O Layer', () => {\r\n      const terminal = compat.terminal;\r\n      const hasRequiredMethods =\r\n        terminal &&\r\n        typeof terminal.write === 'function' &&\r\n        typeof terminal.read === 'function' &&\r\n        typeof terminal.exit === 'function';\r\n      return hasRequiredMethods;\r\n    });\r\n\r\n    // Component Import Test\r\n    await this.asyncTest('Component Imports', async () => {\r\n      try {\r\n        await import('./start-wrapper.js');\r\n        await import('./process-ui-enhanced.js');\r\n        return true;\r\n      } catch (err) {\r\n        return false;\r\n      }\r\n    });\r\n\r\n    // UI Instantiation Test\r\n    await this.asyncTest('UI Instantiation', async () => {\r\n      try {\r\n        const { EnhancedProcessUI } = await import('./process-ui-enhanced.js');\r\n        const ui = new EnhancedProcessUI();\r\n        return ui && ui.processes && ui.processes.size > 0;\r\n      } catch (err) {\r\n        return false;\r\n      }\r\n    });\r\n\r\n    // File Operations Test\r\n    await this.asyncTest('File Operations', async () => {\r\n      try {\r\n        await compat.safeCall(async () => {\r\n          if (compat.runtime === 'deno') {\r\n            await fs.writeFile('.webui-test', 'test', 'utf8');\r\n            await fs.unlink('.webui-test');\r\n          } else {\r\n            const fs = await import('fs/promises');\r\n            await fs.writeFile('.webui-test', 'test', 'utf8');\r\n            await fs.unlink('.webui-test');\r\n          }\r\n        });\r\n        return true;\r\n      } catch (err) {\r\n        return false;\r\n      }\r\n    });\r\n\r\n    this.printSummary();\r\n    return this.results.failed === 0;\r\n  }\r\n\r\n  test(name, testFn) {\r\n    this.results.total++;\r\n    try {\r\n      const result = testFn();\r\n      if (result) {\r\n        console.log(`‚úÖ ${name}`);\r\n        this.results.passed++;\r\n      } else {\r\n        console.log(`‚ùå ${name}`);\r\n        this.results.failed++;\r\n      }\r\n    } catch (err) {\r\n      console.log(`‚ùå ${name}: ${err.message}`);\r\n      this.results.failed++;\r\n    }\r\n  }\r\n\r\n  async asyncTest(name, testFn) {\r\n    this.results.total++;\r\n    try {\r\n      const result = await testFn();\r\n      if (result) {\r\n        console.log(`‚úÖ ${name}`);\r\n        this.results.passed++;\r\n      } else {\r\n        console.log(`‚ùå ${name}`);\r\n        this.results.failed++;\r\n      }\r\n    } catch (err) {\r\n      console.log(`‚ùå ${name}: ${err.message}`);\r\n      this.results.failed++;\r\n    }\r\n  }\r\n\r\n  printSummary() {\r\n    console.log('‚îÄ'.repeat(50));\r\n    console.log(`üìä Results: ${this.results.passed}/${this.results.total} passed`);\r\n    if (this.results.failed === 0) {\r\n      console.log('üéâ All validations passed! WebUI is cross-platform compatible.');\r\n    } else {\r\n      console.log(`‚ö†Ô∏è  ${this.results.failed} validation(s) failed.`);\r\n    }\r\n  }\r\n}\r\n\r\n// Auto-run if called directly\r\nif (import.meta.url === `file://${process.argv[1]}`) {\r\n  const validator = new WebUIValidator();\r\n  const success = await validator.runValidation();\r\n  process.exit(success ? 0 : 1);\r\n}\r\n"],"names":["compat","promises","fs","WebUIValidator","tests","results","passed","failed","total","runValidation","console","log","runtime","repeat","test","isValidRuntime","hasPlatform","platform","os","terminal","hasRequiredMethods","write","read","exit","asyncTest","err","EnhancedProcessUI","ui","processes","size","safeCall","writeFile","unlink","printSummary","name","testFn","result","message","url","process","argv","validator","success"],"mappings":"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"}