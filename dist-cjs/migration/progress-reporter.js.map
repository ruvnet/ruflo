{
  "version": 3,
  "sources": ["../../src/migration/progress-reporter.ts"],
  "sourcesContent": ["/**\n * Progress Reporter - Provides visual feedback during migration\n */\n\nimport * as chalk from 'chalk';\nimport type { MigrationProgress } from './types.js';\n\nexport class ProgressReporter {\n  private progress: MigrationProgress;\n  private startTime: Date;\n  private spinner: string[] = ['\u280B', '\u2819', '\u2839', '\u2838', '\u283C', '\u2834', '\u2826', '\u2827', '\u2807', '\u280F'];\n  private spinnerIndex: number = 0;\n  private intervalId: NodeJS.Timeout | null = null;\n\n  constructor() {\n    this.progress = {\n      total: 0,\n      completed: 0,\n      current: '',\n      phase: 'analyzing',\n      errors: 0,\n      warnings: 0,\n    };\n    this.startTime = new Date();\n  }\n\n  start(phase: MigrationProgress['phase'], message: string): void {\n    this.progress.phase = phase;\n    this.progress.current = message;\n    this.startTime = new Date();\n\n    console.log(chalk.bold(`\\n\uD83D\uDE80 Starting ${phase}...`));\n    this.startSpinner();\n  }\n\n  update(\n    phase: MigrationProgress['phase'],\n    message: string,\n    completed?: number,\n    total?: number,\n  ): void {\n    this.progress.phase = phase;\n    this.progress.current = message;\n\n    if (completed !== undefined) {\n      this.progress.completed = completed;\n    }\n\n    if (total !== undefined) {\n      this.progress.total = total;\n    }\n\n    this.updateDisplay();\n  }\n\n  complete(message: string): void {\n    this.stopSpinner();\n\n    const duration = new Date().getTime() - this.startTime.getTime();\n    const seconds = (duration / 1000).toFixed(2);\n\n    console.log(chalk.green(`\\n\u2705 ${message}`));\n    console.log(chalk.gray(`   Completed in ${seconds}s`));\n\n    if (this.progress.warnings > 0) {\n      console.log(chalk.yellow(`   ${this.progress.warnings} warnings`));\n    }\n\n    if (this.progress.errors > 0) {\n      console.log(chalk.red(`   ${this.progress.errors} errors`));\n    }\n  }\n\n  error(message: string): void {\n    this.stopSpinner();\n    console.log(chalk.red(`\\n\u274C ${message}`));\n    this.progress.errors++;\n  }\n\n  warning(message: string): void {\n    console.log(chalk.yellow(`\u26A0\uFE0F  ${message}`));\n    this.progress.warnings++;\n  }\n\n  info(message: string): void {\n    console.log(chalk.blue(`\u2139\uFE0F  ${message}`));\n  }\n\n  private startSpinner(): void {\n    this.intervalId = setInterval(() => {\n      this.spinnerIndex = (this.spinnerIndex + 1) % this.spinner.length;\n      this.updateDisplay();\n    }, 100);\n  }\n\n  private stopSpinner(): void {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = null;\n    }\n    // Clear the spinner line\n    process.stdout.write('\\r\\x1b[K');\n  }\n\n  private updateDisplay(): void {\n    const spinner = this.spinner[this.spinnerIndex];\n    const phase = this.getPhaseDisplay();\n    const progress = this.getProgressDisplay();\n\n    const message = `${spinner} ${phase} ${progress} ${this.progress.current}`;\n\n    // Clear line and write new message\n    process.stdout.write('\\r\\x1b[K' + message);\n  }\n\n  private getPhaseDisplay(): string {\n    const phases = {\n      analyzing: chalk.blue('\uD83D\uDCCA Analyzing'),\n      'backing-up': chalk.yellow('\uD83D\uDCBE Backing up'),\n      migrating: chalk.green('\uD83D\uDD04 Migrating'),\n      validating: chalk.cyan('\u2705 Validating'),\n      complete: chalk.green('\u2705 Complete'),\n    };\n\n    return phases[this.progress.phase] || chalk.gray('\u23F3 Processing');\n  }\n\n  private getProgressDisplay(): string {\n    if (this.progress.total > 0) {\n      const percentage = Math.round((this.progress.completed / this.progress.total) * 100);\n      const progressBar = this.createProgressBar(percentage);\n      return `${progressBar} ${this.progress.completed}/${this.progress.total} (${percentage}%)`;\n    }\n    return '';\n  }\n\n  private createProgressBar(percentage: number, width: number = 20): string {\n    const filled = Math.round((percentage / 100) * width);\n    const empty = width - filled;\n\n    const filledBar = '\u2588'.repeat(filled);\n    const emptyBar = '\u2591'.repeat(empty);\n\n    return chalk.green(filledBar) + chalk.gray(emptyBar);\n  }\n\n  setTotal(total: number): void {\n    this.progress.total = total;\n  }\n\n  increment(message?: string): void {\n    this.progress.completed++;\n    if (message) {\n      this.progress.current = message;\n    }\n    this.updateDisplay();\n  }\n\n  getProgress(): MigrationProgress {\n    return { ...this.progress };\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
