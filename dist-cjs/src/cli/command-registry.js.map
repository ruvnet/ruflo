{"version":3,"sources":["../../../src/cli/command-registry.js"],"sourcesContent":["// command-registry.js - Extensible command registration system\r\nimport process from 'process';\r\nimport { initCommand } from './simple-commands/init/index.js';\r\nimport { memoryCommand } from './simple-commands/memory.js';\r\nimport { memoryConsolidationCommand } from './simple-commands/memory-consolidation.js';\r\nimport { sparcCommand } from './simple-commands/sparc.js';\r\nimport { agentCommand } from './simple-commands/agent.js';\r\nimport { taskCommand } from './simple-commands/task.js';\r\nimport { configCommand } from './simple-commands/config.js';\r\nimport { statusCommand } from './simple-commands/status.js';\r\nimport { mcpCommand } from './simple-commands/mcp.js';\r\nimport { proxyCommand } from './simple-commands/proxy.js';\r\nimport { monitorCommand } from './simple-commands/monitor.js';\r\nimport { startCommand } from './simple-commands/start.js';\r\nimport { swarmCommand } from './simple-commands/swarm.js';\r\nimport { batchManagerCommand } from './simple-commands/batch-manager.js';\r\nimport { githubCommand } from './simple-commands/github.js';\r\nimport { trainingAction } from './simple-commands/training.js';\r\nimport { analysisAction } from './simple-commands/analysis.js';\r\nimport { automationAction } from './simple-commands/automation.js';\r\nimport { coordinationAction } from './simple-commands/coordination.js';\r\nimport { hooksAction } from './simple-commands/hooks.js';\r\nimport { hookSafetyCommand } from './simple-commands/hook-safety.js';\r\nimport { hiveMindCommand } from './simple-commands/hive-mind.js';\r\nimport { HelpFormatter } from './help-formatter.js';\r\nimport hiveMindOptimizeCommand from './simple-commands/hive-mind-optimize.js';\r\nimport { neuralCommand } from './simple-commands/neural.js';\r\nimport { goalCommand } from './simple-commands/goal.js';\r\nimport {\r\n  showUnifiedMetrics,\r\n  fixTaskAttribution,\r\n} from './simple-commands/swarm-metrics-integration.js';\r\nimport { migrateHooksCommand, migrateHooksCommandConfig } from './simple-commands/migrate-hooks.js';\r\nimport {\r\n  fixHookVariablesCommand,\r\n  fixHookVariablesCommandConfig,\r\n} from './simple-commands/fix-hook-variables.js';\r\nimport { \r\n  initializePerformanceTracking,\r\n  trackCommandExecution \r\n} from './simple-commands/performance-hooks.js';\r\n// Maestro commands integrated with clean implementation\r\n// Note: Maestro TypeScript commands now integrated directly in ./commands/maestro.ts\r\n// Note: TypeScript imports commented out for Node.js compatibility\r\n// import { ruvSwarmAction } from './commands/ruv-swarm.ts';\r\n// import { configIntegrationAction } from './commands/config-integration.ts';\r\n\r\n// Command registry for extensible CLI\r\nexport const commandRegistry = new Map();\r\n\r\n// Register core commands\r\nexport function registerCoreCommands() {\r\n  commandRegistry.set('init', {\r\n    handler: initCommand,\r\n    description: 'Initialize Claude Code integration files and SPARC development environment',\r\n    usage: 'init [--force] [--minimal] [--sparc]',\r\n    examples: [\r\n      'npx claude-flow@latest init --sparc  # Recommended: Full SPARC setup',\r\n      'init --sparc                         # Initialize with SPARC modes',\r\n      'init --force --minimal               # Minimal setup, overwrite existing',\r\n      'init --sparc --force                 # Force SPARC setup',\r\n    ],\r\n    details: `\r\nThe --sparc flag creates a complete development environment:\r\n  ‚Ä¢ .roomodes file containing 17 specialized SPARC modes\r\n  ‚Ä¢ CLAUDE.md for AI-readable project instructions\r\n  ‚Ä¢ Pre-configured modes: architect, code, tdd, debug, security, and more\r\n  ‚Ä¢ Ready for TDD workflows and automated code generation\r\n  \r\nFirst-time users should run: npx claude-flow@latest init --sparc`,\r\n  });\r\n\r\n  commandRegistry.set('start', {\r\n    handler: startCommand,\r\n    description: 'Start the Claude-Flow orchestration system',\r\n    usage: 'start [--daemon] [--port <port>] [--verbose] [--ui] [--web]',\r\n    examples: [\r\n      'start                    # Start in interactive mode',\r\n      'start --daemon           # Start as background daemon',\r\n      'start --port 8080        # Use custom MCP port',\r\n      'start --verbose          # Show detailed system activity',\r\n      'start --ui               # Launch terminal-based UI',\r\n      'start --web              # Launch web-based UI',\r\n    ],\r\n  });\r\n\r\n  // Add start-ui as a convenient alias for launching the UI\r\n  commandRegistry.set('start-ui', {\r\n    handler: async (args, flags) => {\r\n      // Import and use the direct UI launcher\r\n      const { launchUI } = await import('./simple-commands/start-ui.js');\r\n      // Pass the full raw arguments from process.argv\r\n      const fullArgs = process.argv.slice(3); // Skip node, script, and command\r\n      return launchUI(fullArgs);\r\n    },\r\n    description: 'Start the UI interface (web UI by default)',\r\n    usage: 'start-ui [--port <port>] [--terminal]',\r\n    examples: [\r\n      'start-ui                 # Launch web-based UI (default)',\r\n      'start-ui --port 3000     # Use custom port',\r\n      'start-ui --terminal      # Launch terminal-based UI instead',\r\n    ],\r\n  });\r\n\r\n  commandRegistry.set('memory', {\r\n    handler: memoryCommand,\r\n    description: 'Memory management operations',\r\n    usage: 'memory <subcommand> [options]',\r\n    examples: [\r\n      'memory store key \"value\"',\r\n      'memory query search_term',\r\n      'memory stats',\r\n      'memory export backup.json',\r\n    ],\r\n  });\r\n\r\n  commandRegistry.set('memory-consolidate', {\r\n    handler: memoryConsolidationCommand,\r\n    description: 'Consolidate fragmented memory stores into unified database',\r\n    usage: 'memory-consolidate <command> [options]',\r\n    examples: [\r\n      'memory-consolidate scan                # Scan for all memory stores',\r\n      'memory-consolidate plan                # Create consolidation plan',\r\n      'memory-consolidate execute --force     # Execute consolidation',\r\n      'memory-consolidate report              # Generate report',\r\n    ],\r\n    details: `\r\nMemory Consolidation Features:\r\n  ‚Ä¢ Discovers all memory storage locations (JSON & SQLite)\r\n  ‚Ä¢ Creates automatic backups before consolidation\r\n  ‚Ä¢ Merges all stores into unified SQLite database\r\n  ‚Ä¢ Optimizes with indices for better performance\r\n  ‚Ä¢ Maintains backward compatibility\r\n  \r\nBenefits:\r\n  ‚Ä¢ Single source of truth for all memory data\r\n  ‚Ä¢ Improved query performance with indices\r\n  ‚Ä¢ Reduced disk fragmentation\r\n  ‚Ä¢ Easier backup and restore\r\n  ‚Ä¢ Cross-session persistence`,\r\n  });\r\n\r\n  commandRegistry.set('sparc', {\r\n    handler: sparcCommand,\r\n    description: 'SPARC development mode operations',\r\n    usage: 'sparc [subcommand] [options]',\r\n    examples: [\r\n      'sparc \"orchestrate full app development\"  # Default: sparc orchestrator',\r\n      'sparc modes                               # List available modes',\r\n      'sparc run code \"implement feature\"        # Run specific mode',\r\n      'sparc tdd \"feature description\"           # TDD workflow',\r\n      'sparc info architect                      # Mode details',\r\n    ],\r\n  });\r\n\r\n  // Note: Maestro commands are now handled by TypeScript module\r\n  // See src/cli/commands/maestro.ts for the clean implementation\r\n  commandRegistry.set('maestro', {\r\n    handler: () => {\r\n      console.log('‚ö†Ô∏è  Maestro commands have been moved to TypeScript.');\r\n      console.log('Please use: npx claude-flow maestro help');\r\n      console.log('Or import from: ./commands/maestro.js after compilation');\r\n    },\r\n    description: 'Maestro: Specs-Driven Development with Hive Mind Integration',\r\n    usage: 'maestro <subcommand> [options]',\r\n    examples: [\r\n      'maestro create-spec my-feature --request \"Implement user auth\"',\r\n      'maestro generate-design my-feature',\r\n      'maestro generate-tasks my-feature',\r\n      'maestro implement-task my-feature 1',\r\n      'maestro approve-phase my-feature',\r\n      'maestro status my-feature --detailed',\r\n      'maestro init-steering api-design',\r\n      'maestro help',\r\n    ],\r\n  });\r\n\r\n  commandRegistry.set('agent', {\r\n    handler: agentCommand,\r\n    description: 'Manage AI agents, memory, and agentic-flow integration (NEW in v2.6.0)',\r\n    usage: 'agent <subcommand> [options]',\r\n    examples: [\r\n      'agent run coder \"Build REST API\" --optimize  # Multi-provider execution',\r\n      'agent agents                                  # List 66+ available agents',\r\n      'agent memory init                             # Initialize ReasoningBank',\r\n      'agent config wizard                           # Configure API keys',\r\n      'agent mcp start --daemon                      # Start MCP server',\r\n      'agent spawn researcher --name \"DataBot\"      # Internal agent management',\r\n    ],\r\n    details: `\r\nAgent management features:\r\n  ‚Ä¢ Multi-provider execution (Anthropic, OpenRouter, ONNX, Gemini)\r\n  ‚Ä¢ ReasoningBank memory system (70% ‚Üí 88% success improvement)\r\n  ‚Ä¢ Model optimization (85-98% cost savings)\r\n  ‚Ä¢ MCP server management (213+ tools)\r\n  ‚Ä¢ Configuration management (API keys, models, settings)\r\n  ‚Ä¢ Custom agent creation and management\r\n  ‚Ä¢ Internal agent hierarchies and coordination\r\n\r\nSubcommands:\r\n  run          - Execute agents with multi-provider support\r\n  agents       - List all 66+ available agents\r\n  create       - Create custom agents\r\n  info         - Show agent information\r\n  conflicts    - Check for agent conflicts\r\n  memory       - ReasoningBank memory management\r\n  config       - Configuration management\r\n  mcp          - MCP server management\r\n  spawn        - Internal agent management\r\n  list         - List internal agents\r\n\r\nSee 'claude-flow help agent' for full documentation.`,\r\n  });\r\n\r\n  commandRegistry.set('proxy', {\r\n    handler: proxyCommand,\r\n    description: 'OpenRouter proxy server for 85-98% cost savings (NEW in v2.6.0)',\r\n    usage: 'proxy <subcommand> [options]',\r\n    examples: [\r\n      'proxy start --daemon                         # Start proxy server',\r\n      'proxy status --verbose                       # Check status',\r\n      'proxy config                                 # Configuration guide',\r\n      'proxy logs --follow                          # View logs',\r\n    ],\r\n    details: `\r\nOpenRouter Proxy Features:\r\n  ‚Ä¢ Transparent API translation (Anthropic ‚Üí OpenRouter)\r\n  ‚Ä¢ 85-98% cost savings vs direct Anthropic API\r\n  ‚Ä¢ Works with Claude Code out of the box\r\n  ‚Ä¢ Zero code changes required\r\n  ‚Ä¢ Supports all OpenRouter models\r\n\r\nCost Savings Examples:\r\n  ‚Ä¢ Claude 3.5 Sonnet: $3.00 ‚Üí $0.30 per million tokens (90% savings)\r\n  ‚Ä¢ Claude 3 Opus: $15.00 ‚Üí $2.25 per million tokens (85% savings)\r\n  ‚Ä¢ DeepSeek R1: Free (100% savings)\r\n\r\nSetup:\r\n  1. Get OpenRouter API key: https://openrouter.ai/keys\r\n  2. claude-flow agent config set OPENROUTER_API_KEY sk-or-xxx\r\n  3. claude-flow proxy start --daemon\r\n  4. export ANTHROPIC_BASE_URL=http://localhost:8080\r\n  5. Use Claude Code normally ‚Üí automatic savings!\r\n\r\nCommands:\r\n  start        - Start proxy server\r\n  stop         - Stop proxy server\r\n  restart      - Restart proxy server\r\n  status       - Get server status\r\n  logs         - View server logs\r\n  config       - Configuration guide`,\r\n  });\r\n\r\n  commandRegistry.set('task', {\r\n    handler: taskCommand,\r\n    description: 'Manage tasks and workflows',\r\n    usage: 'task <subcommand> [options]',\r\n    examples: [\r\n      'task create research \"Market analysis\"',\r\n      'task list --filter running',\r\n      'task workflow examples/dev-flow.json',\r\n      'task coordination status',\r\n    ],\r\n  });\r\n\r\n  commandRegistry.set('config', {\r\n    handler: configCommand,\r\n    description: 'Manage system configuration',\r\n    usage: 'config <subcommand> [options]',\r\n    examples: [\r\n      'config init',\r\n      'config set terminal.poolSize 15',\r\n      'config get orchestrator.maxConcurrentTasks',\r\n      'config validate',\r\n    ],\r\n  });\r\n\r\n  commandRegistry.set('status', {\r\n    handler: statusCommand,\r\n    description: 'Show system status and health',\r\n    usage: 'status [--verbose] [--json]',\r\n    examples: ['status', 'status --verbose', 'status --json'],\r\n  });\r\n\r\n  commandRegistry.set('mcp', {\r\n    handler: mcpCommand,\r\n    description: 'Manage MCP server and tools',\r\n    usage: 'mcp <subcommand> [options]',\r\n    examples: ['mcp status', 'mcp start --port 8080', 'mcp tools --verbose', 'mcp auth setup'],\r\n  });\r\n\r\n  commandRegistry.set('monitor', {\r\n    handler: monitorCommand,\r\n    description: 'Real-time system monitoring',\r\n    usage: 'monitor [--watch] [--interval <ms>]',\r\n    examples: [\r\n      'monitor',\r\n      'monitor --watch',\r\n      'monitor --interval 1000 --watch',\r\n      'monitor --format json',\r\n    ],\r\n  });\r\n\r\n  commandRegistry.set('swarm', {\r\n    handler: swarmCommand,\r\n    description: 'Swarm-based AI agent coordination',\r\n    usage: 'swarm <objective> [options]',\r\n    examples: [\r\n      'swarm \"Build a REST API\"',\r\n      'swarm \"Research cloud architecture\" --strategy research',\r\n      'swarm \"Analyze data\" --max-agents 3 --parallel',\r\n      'swarm \"Development task\" --ui --monitor --background',\r\n    ],\r\n  });\r\n\r\n  commandRegistry.set('hive-mind', {\r\n    handler: hiveMindCommand,\r\n    description: 'üß† Advanced Hive Mind swarm intelligence with collective decision-making',\r\n    usage: 'hive-mind <subcommand> [options]',\r\n    examples: [\r\n      'hive-mind init                          # Initialize hive mind system',\r\n      'hive-mind spawn \"Build microservices\"   # Create swarm with objective',\r\n      'hive-mind wizard                        # Interactive setup wizard',\r\n      'hive-mind status                        # View active swarms',\r\n      'hive-mind consensus                     # View consensus decisions',\r\n      'hive-mind metrics                       # Performance analytics',\r\n    ],\r\n    customHelp: true, // Use command's own help function\r\n    details: `\r\nHive Mind System Features:\r\n  ‚Ä¢ Queen-led coordination with specialized worker agents\r\n  ‚Ä¢ Collective memory and knowledge sharing\r\n  ‚Ä¢ Consensus building for critical decisions  \r\n  ‚Ä¢ Auto-scaling based on workload\r\n  ‚Ä¢ Parallel task execution with work stealing\r\n  ‚Ä¢ Real-time monitoring and metrics\r\n  ‚Ä¢ SQLite-backed persistence\r\n  ‚Ä¢ MCP tool integration for 87+ operations\r\n\r\nQueen Types:\r\n  ‚Ä¢ Strategic - Long-term planning and optimization\r\n  ‚Ä¢ Tactical - Task prioritization and rapid response\r\n  ‚Ä¢ Adaptive - Learning and strategy evolution\r\n\r\nWorker Types:\r\n  ‚Ä¢ Researcher, Coder, Analyst, Tester\r\n  ‚Ä¢ Architect, Reviewer, Optimizer, Documenter\r\n\r\nUse 'hive-mind wizard' for interactive setup or 'hive-mind help' for full documentation.`,\r\n  });\r\n\r\n  commandRegistry.set('hive-mind-optimize', {\r\n    handler: hiveMindOptimizeCommand,\r\n    description: 'üîß Optimize hive mind database for better performance',\r\n    usage: 'hive-mind-optimize [options]',\r\n    examples: [\r\n      'hive-mind-optimize                      # Interactive optimization wizard',\r\n      'hive-mind-optimize --auto               # Auto-optimize with defaults',\r\n      'hive-mind-optimize --report             # Generate optimization report',\r\n      'hive-mind-optimize --clean-memory --memory-days 60',\r\n      'hive-mind-optimize --auto --vacuum --archive-tasks',\r\n    ],\r\n    details: `\r\nHive Mind Database Optimization Features:\r\n  ‚Ä¢ Safe, backward-compatible optimizations\r\n  ‚Ä¢ Performance indexes for 50% faster queries\r\n  ‚Ä¢ Memory cleanup and archiving\r\n  ‚Ä¢ Task archival for space management\r\n  ‚Ä¢ Behavioral pattern tracking\r\n  ‚Ä¢ Database integrity checking\r\n  \r\nOptimization Levels:\r\n  ‚Ä¢ v1.0 ‚Üí v1.1: Basic performance indexes\r\n  ‚Ä¢ v1.1 ‚Üí v1.2: Advanced query optimization\r\n  ‚Ä¢ v1.2 ‚Üí v1.3: Performance tracking tables\r\n  ‚Ä¢ v1.3 ‚Üí v1.4: Memory optimization features\r\n  ‚Ä¢ v1.4 ‚Üí v1.5: Behavioral analysis tracking\r\n\r\nSafety Features:\r\n  ‚Ä¢ Automatic backups before major operations\r\n  ‚Ä¢ All changes are backward-compatible\r\n  ‚Ä¢ Existing data is always preserved\r\n  ‚Ä¢ Rollback capability on errors`,\r\n  });\r\n\r\n  commandRegistry.set('swarm-metrics', {\r\n    handler: async (args, flags) => {\r\n      const subcommand = args[0];\r\n      if (subcommand === 'fix') {\r\n        return await fixTaskAttribution();\r\n      } else {\r\n        return await showUnifiedMetrics();\r\n      }\r\n    },\r\n    description: 'Unified swarm metrics and task attribution diagnostics',\r\n    usage: 'swarm-metrics [fix] [options]',\r\n    examples: [\r\n      'swarm-metrics                    # Show unified metrics from all swarm systems',\r\n      'swarm-metrics fix                # Fix task attribution issues between systems',\r\n    ],\r\n    details: `\r\nSwarm Metrics Integration Features:\r\n  ‚Ä¢ Unified view of hive-mind and ruv-swarm metrics\r\n  ‚Ä¢ Task attribution diagnosis and repair\r\n  ‚Ä¢ Cross-system swarm performance comparison\r\n  ‚Ä¢ Database integration status checking\r\n  ‚Ä¢ Automatic sample task creation for empty swarms\r\n\r\nThis command helps resolve issues where:\r\n  ‚Ä¢ Overall task statistics show correctly but per-swarm shows 0/0\r\n  ‚Ä¢ Multiple swarm systems are not properly integrated\r\n  ‚Ä¢ Task assignments are missing or incorrectly attributed\r\n\r\nUse 'swarm-metrics fix' to automatically repair attribution issues.`,\r\n  });\r\n\r\n  commandRegistry.set('batch', {\r\n    handler: batchManagerCommand,\r\n    description: 'Batch operation management and configuration utilities',\r\n    usage: 'batch <command> [options]',\r\n    examples: [\r\n      'batch create-config my-batch.json',\r\n      'batch create-config --interactive',\r\n      'batch validate-config my-batch.json',\r\n      'batch estimate my-batch.json',\r\n      'batch list-templates',\r\n      'batch list-environments',\r\n    ],\r\n    details: `\r\nBatch operations support:\r\n  ‚Ä¢ Multiple project initialization with templates\r\n  ‚Ä¢ Environment-specific configurations (dev, staging, prod)\r\n  ‚Ä¢ Parallel processing with resource management\r\n  ‚Ä¢ Progress tracking and detailed reporting\r\n  ‚Ä¢ Configuration validation and estimation tools\r\n  \r\nUse with init command:\r\n  claude-flow init --batch-init project1,project2,project3\r\n  claude-flow init --config batch-config.json --parallel`,\r\n  });\r\n\r\n  commandRegistry.set('github', {\r\n    handler: githubCommand,\r\n    description: 'GitHub workflow automation with 6 specialized modes',\r\n    usage: 'github <mode> <objective> [options]',\r\n    examples: [\r\n      'github pr-manager \"create feature PR with automated testing\"',\r\n      'github gh-coordinator \"setup CI/CD pipeline\" --auto-approve',\r\n      'github release-manager \"prepare v2.0.0 release\"',\r\n      'github repo-architect \"optimize repository structure\"',\r\n      'github issue-tracker \"analyze project roadmap issues\"',\r\n      'github sync-coordinator \"sync package versions across repos\"',\r\n    ],\r\n    details: `\r\nGitHub automation modes:\r\n  ‚Ä¢ gh-coordinator: GitHub workflow orchestration and coordination\r\n  ‚Ä¢ pr-manager: Pull request management with multi-reviewer coordination\r\n  ‚Ä¢ issue-tracker: Issue management and project coordination\r\n  ‚Ä¢ release-manager: Release coordination and deployment pipelines\r\n  ‚Ä¢ repo-architect: Repository structure optimization\r\n  ‚Ä¢ sync-coordinator: Multi-package synchronization and version alignment\r\n  \r\nAdvanced features:\r\n  ‚Ä¢ Multi-reviewer coordination with automated scheduling\r\n  ‚Ä¢ Intelligent issue categorization and assignment\r\n  ‚Ä¢ Automated testing integration and quality gates\r\n  ‚Ä¢ Release pipeline orchestration with rollback capabilities`,\r\n  });\r\n\r\n  commandRegistry.set('training', {\r\n    handler: trainingAction,\r\n    description: 'Neural pattern learning and model updates',\r\n    usage: 'training <command> [options]',\r\n    examples: [\r\n      'training neural-train --data recent --model task-predictor',\r\n      'training pattern-learn --operation \"file-creation\" --outcome \"success\"',\r\n      'training model-update --agent-type coordinator --operation-result \"efficient\"',\r\n    ],\r\n    details: `\r\nNeural training commands:\r\n  ‚Ä¢ neural-train: Train neural patterns from operations\r\n  ‚Ä¢ pattern-learn: Learn from specific operation outcomes\r\n  ‚Ä¢ model-update: Update agent models with new insights\r\n  \r\nImproves task selection accuracy, agent performance prediction, and coordination efficiency.`,\r\n  });\r\n\r\n  commandRegistry.set('analysis', {\r\n    handler: analysisAction,\r\n    description: 'Performance and usage analytics',\r\n    usage: 'analysis <command> [options]',\r\n    examples: [\r\n      'analysis bottleneck-detect --scope system',\r\n      'analysis performance-report --timeframe 7d --format detailed',\r\n      'analysis token-usage --breakdown --cost-analysis',\r\n    ],\r\n    details: `\r\nAnalysis commands:\r\n  ‚Ä¢ bottleneck-detect: Detect performance bottlenecks in the system\r\n  ‚Ä¢ performance-report: Generate comprehensive performance reports\r\n  ‚Ä¢ token-usage: Analyze token consumption and costs\r\n  \r\nHelps with performance optimization, cost management, and resource allocation.`,\r\n  });\r\n\r\n  commandRegistry.set('automation', {\r\n    handler: automationAction,\r\n    description: 'Intelligent agent and workflow management with MLE-STAR and Claude integration',\r\n    usage: 'automation <command> [options]',\r\n    examples: [\r\n      'automation auto-agent --task-complexity enterprise --swarm-id swarm-123',\r\n      'automation smart-spawn --requirement \"web-development\" --max-agents 8',\r\n      'automation workflow-select --project-type api --priority speed',\r\n      'automation run-workflow my-workflow.json --claude --non-interactive',\r\n      'automation mle-star --dataset data/train.csv --target price --claude',\r\n    ],\r\n    details: `\r\nAutomation commands:\r\n  ‚Ä¢ auto-agent: Automatically spawn optimal agents based on task complexity\r\n  ‚Ä¢ smart-spawn: Intelligently spawn agents based on specific requirements\r\n  ‚Ä¢ workflow-select: Select and configure optimal workflows for project types\r\n  ‚Ä¢ run-workflow: Execute workflows from JSON/YAML files with Claude integration\r\n  ‚Ä¢ mle-star: Run MLE-STAR Machine Learning Engineering workflow (flagship)\r\n  \r\nNew features:\r\n  ‚Ä¢ Claude CLI integration for actual execution\r\n  ‚Ä¢ MLE-STAR methodology for ML engineering\r\n  ‚Ä¢ Non-interactive mode for CI/CD integration\r\n  ‚Ä¢ Comprehensive workflow templates\r\n  \r\nProvides optimal resource allocation, intelligent agent selection, and complete automation workflows.`,\r\n  });\r\n\r\n  commandRegistry.set('coordination', {\r\n    handler: coordinationAction,\r\n    description: 'Swarm and agent orchestration',\r\n    usage: 'coordination <command> [options]',\r\n    examples: [\r\n      'coordination swarm-init --topology hierarchical --max-agents 8',\r\n      'coordination agent-spawn --type developer --name \"api-dev\" --swarm-id swarm-123',\r\n      'coordination task-orchestrate --task \"Build REST API\" --strategy parallel',\r\n    ],\r\n    details: `\r\nCoordination commands:\r\n  ‚Ä¢ swarm-init: Initialize swarm coordination infrastructure\r\n  ‚Ä¢ agent-spawn: Spawn and coordinate new agents\r\n  ‚Ä¢ task-orchestrate: Orchestrate task execution across agents\r\n  \r\nEnables intelligent task distribution, agent synchronization, and shared memory coordination.`,\r\n  });\r\n\r\n  commandRegistry.set('hooks', {\r\n    handler: hooksAction,\r\n    description: 'Lifecycle event management',\r\n    usage: 'hooks <command> [options]',\r\n    examples: [\r\n      'hooks pre-task --description \"Build API\" --task-id task-123',\r\n      'hooks post-task --task-id task-123 --analyze-performance --generate-insights',\r\n      'hooks session-end --export-metrics --generate-summary',\r\n    ],\r\n    details: `\r\nHooks commands:\r\n  ‚Ä¢ pre-task: Execute before task begins (preparation & setup)\r\n  ‚Ä¢ post-task: Execute after task completion (analysis & cleanup)\r\n  ‚Ä¢ pre-edit: Execute before file modifications (backup & validation)\r\n  ‚Ä¢ post-edit: Execute after file modifications (tracking & coordination)\r\n  ‚Ä¢ session-end: Execute at session termination (cleanup & export)\r\n  \r\nEnables automated preparation & cleanup, performance tracking, and coordination synchronization.`,\r\n  });\r\n\r\n  commandRegistry.set('hook-safety', {\r\n    handler: hookSafetyCommand,\r\n    description: 'üö® Critical hook safety system - Prevent infinite loops & financial damage',\r\n    usage: 'hook-safety <command> [options]',\r\n    examples: [\r\n      'hook-safety validate                           # Check for dangerous hook configurations',\r\n      'hook-safety validate --config ~/.claude/settings.json',\r\n      'hook-safety status                             # View safety status and context',\r\n      'hook-safety reset                              # Reset circuit breakers',\r\n      'hook-safety safe-mode                          # Enable safe mode (skip all hooks)',\r\n    ],\r\n    details: `\r\nüö® CRITICAL: Stop hooks calling 'claude' commands create INFINITE LOOPS that can:\r\n  ‚Ä¢ Bypass API rate limits\r\n  ‚Ä¢ Cost thousands of dollars per day  \r\n  ‚Ä¢ Make your system unresponsive\r\n\r\nHook Safety commands:\r\n  ‚Ä¢ validate: Check Claude Code settings for dangerous patterns\r\n  ‚Ä¢ status: Show current safety status and execution context\r\n  ‚Ä¢ reset: Reset circuit breakers and execution counters  \r\n  ‚Ä¢ safe-mode: Enable/disable safe mode (skips all hooks)\r\n\r\nSAFE ALTERNATIVES:\r\n  ‚Ä¢ Use PostToolUse hooks instead of Stop hooks\r\n  ‚Ä¢ Implement flag-based update patterns\r\n  ‚Ä¢ Use 'claude --skip-hooks' for manual updates\r\n  ‚Ä¢ Create conditional execution scripts\r\n\r\nFor more information: https://github.com/ruvnet/claude-flow/issues/166`,\r\n  });\r\n\r\n  commandRegistry.set('migrate-hooks', migrateHooksCommandConfig);\r\n\r\n  commandRegistry.set('fix-hook-variables', {\r\n    handler: fixHookVariablesCommand,\r\n    ...fixHookVariablesCommandConfig,\r\n  });\r\n\r\n  // Verification system commands\r\n  commandRegistry.set('verify', {\r\n    handler: async (args, flags) => {\r\n      try {\r\n        const { verificationCommand } = await import('./simple-commands/verification.js');\r\n        return await verificationCommand(args, flags);\r\n      } catch (error) {\r\n        console.error('‚ùå Error loading verification module:', error.message);\r\n        console.log('Error details:', error);\r\n      }\r\n    },\r\n    description: 'üîç Verification and truth enforcement system',\r\n    usage: 'verify <subcommand> [options]',\r\n    examples: [\r\n      'verify status                    # Show verification system status',\r\n      'verify check --taskId task-123   # Run verification checks',\r\n      'verify validate --taskId task-456 # Validate task results',\r\n      'verify config                    # Manage verification config',\r\n      'verify cleanup --force           # Clean up old verification data',\r\n    ],\r\n    details: `\r\nVerification system commands:\r\n  ‚Ä¢ status: Show current system status and health\r\n  ‚Ä¢ check: Run verification checks on tasks\r\n  ‚Ä¢ validate: Validate task completion and results\r\n  ‚Ä¢ config: Manage verification configuration\r\n  ‚Ä¢ cleanup: Clean up old verification data\r\n  ‚Ä¢ pre-task: Execute pre-task verification\r\n  ‚Ä¢ post-task: Execute post-task validation\r\n  ‚Ä¢ integration: Run integration tests\r\n  ‚Ä¢ truth: Execute truth telemetry checks\r\n  ‚Ä¢ rollback: Trigger rollback if needed\r\n\r\nTruth enforcement features:\r\n  ‚Ä¢ 0.95 minimum truth threshold\r\n  ‚Ä¢ Cross-agent integration testing\r\n  ‚Ä¢ Automated rollback on failures\r\n  ‚Ä¢ Cryptographic verification\r\n  ‚Ä¢ Byzantine fault tolerance`,\r\n  });\r\n\r\n  commandRegistry.set('truth', {\r\n    handler: async (args, flags) => {\r\n      try {\r\n        const { truthCommand } = await import('./simple-commands/verification.js');\r\n        return await truthCommand(args, flags);\r\n      } catch (error) {\r\n        console.error('‚ùå Error loading verification module:', error.message);\r\n        console.log('Error details:', error);\r\n      }\r\n    },\r\n    description: 'üéØ Truth telemetry and accuracy scoring',\r\n    usage: 'truth [options]',\r\n    examples: [\r\n      'truth                            # Show current truth scores',\r\n      'truth --taskId task-123          # Check truth for specific task',\r\n      'truth --threshold 0.95           # Set minimum truth threshold',\r\n      'truth --report                   # Generate truth report',\r\n    ],\r\n    details: `\r\nTruth scoring system:\r\n  ‚Ä¢ Real-time truth metrics collection\r\n  ‚Ä¢ Agent performance scoring\r\n  ‚Ä¢ System-wide truth accuracy tracking\r\n  ‚Ä¢ Automated alerting for threshold violations\r\n  ‚Ä¢ Dashboard data export functionality\r\n\r\nTarget metrics:\r\n  ‚Ä¢ >95% truth accuracy rate\r\n  ‚Ä¢ <10% human intervention rate\r\n  ‚Ä¢ >90% integration success rate\r\n  ‚Ä¢ <5% automated rollback frequency`,\r\n  });\r\n\r\n  commandRegistry.set('neural', {\r\n    handler: neuralCommand,\r\n    description: 'üß† Neural module commands for SAFLA self-learning systems',\r\n    usage: 'neural <command> [options]',\r\n    examples: [\r\n      'neural init                      # Initialize neural module',\r\n      'neural init --force              # Force overwrite existing',\r\n      'neural init --target ./agents    # Custom location',\r\n    ],\r\n    details: `\r\nNeural Module Features:\r\n  ‚Ä¢ Self-Aware Feedback Loop Algorithm (SAFLA)\r\n  ‚Ä¢ 4-tier memory system (Vector, Episodic, Semantic, Working)\r\n  ‚Ä¢ 172,000+ ops/sec processing with WASM optimization\r\n  ‚Ä¢ 60% memory compression while maintaining recall\r\n  ‚Ä¢ Cross-session learning and persistence\r\n  ‚Ä¢ Distributed neural training with MCP integration`,\r\n  });\r\n\r\n  commandRegistry.set('goal', {\r\n    handler: goalCommand,\r\n    description: 'üéØ Goal module commands for GOAP intelligent planning',\r\n    usage: 'goal <command> [options]',\r\n    examples: [\r\n      'goal init                        # Initialize goal module',\r\n      'goal init --force                # Force overwrite existing',\r\n      'goal init --target ./agents      # Custom location',\r\n    ],\r\n    details: `\r\nGoal Module Features:\r\n  ‚Ä¢ Goal-Oriented Action Planning (GOAP) algorithm\r\n  ‚Ä¢ A* pathfinding for optimal plan generation\r\n  ‚Ä¢ OODA loop execution monitoring\r\n  ‚Ä¢ Adaptive replanning on failures\r\n  ‚Ä¢ Mixed LLM + code execution\r\n  ‚Ä¢ Cost-optimized action sequences`,\r\n  });\r\n\r\n  commandRegistry.set('pair', {\r\n    handler: async (args, flags) => {\r\n      try {\r\n        const pairCommand = (await import('./simple-commands/pair.js')).default;\r\n        return await pairCommand(args, flags);\r\n      } catch (error) {\r\n        console.error('‚ùå Error loading pair module:', error.message);\r\n        console.log('Error details:', error);\r\n      }\r\n    },\r\n    description: 'üë• Interactive pair programming with AI assistance',\r\n    usage: 'pair [options]',\r\n    examples: [\r\n      'pair --start                     # Start pair programming session',\r\n      'pair --start --mode driver       # You write, AI assists',\r\n      'pair --start --verify --test     # Enable verification and testing',\r\n      'pair --status                    # Show session status',\r\n      'pair --end                       # End current session',\r\n    ],\r\n    details: `\r\nPair programming features:\r\n  ‚Ä¢ Three modes: driver, navigator, switch\r\n  ‚Ä¢ Real-time code assistance\r\n  ‚Ä¢ Optional verification and testing\r\n  ‚Ä¢ Session persistence\r\n  ‚Ä¢ Background execution support`,\r\n  });\r\n\r\n  commandRegistry.set('verify-train', {\r\n    handler: async (args, flags) => {\r\n      try {\r\n        const { verificationTrainingCommand } = await import('./simple-commands/verification-training-integration.js');\r\n        return await verificationTrainingCommand(args, flags);\r\n      } catch (error) {\r\n        console.error('‚ùå Error loading verification-training module:', error.message);\r\n        console.log('Error details:', error);\r\n      }\r\n    },\r\n    description: 'üß† Verification-Training integration for continuous improvement',\r\n    usage: 'verify-train <command> [options]',\r\n    examples: [\r\n      'verify-train status              # Show training status',\r\n      'verify-train feed                # Feed verification data to training',\r\n      'verify-train predict coder       # Predict verification outcome',\r\n      'verify-train recommend           # Get agent recommendations',\r\n      'verify-train train               # Trigger neural training',\r\n    ],\r\n    details: `\r\nVerification-Training Integration:\r\n  ‚Ä¢ Feeds verification results to training system\r\n  ‚Ä¢ Learns from agent performance over time\r\n  ‚Ä¢ Predicts verification outcomes\r\n  ‚Ä¢ Recommends best agents for tasks\r\n  ‚Ä¢ Improves reliability through continuous learning`,\r\n  });\r\n\r\n  commandRegistry.set('train-pipeline', {\r\n    handler: async (args, flags) => {\r\n      try {\r\n        // Always use real execution - no more simulation\r\n        const { trainingPipelineCommand } = await import('./simple-commands/training-pipeline.js');\r\n        return await trainingPipelineCommand(args, flags);\r\n      } catch (error) {\r\n        console.error('‚ùå Error loading training-pipeline module:', error.message);\r\n        console.log('Error details:', error);\r\n      }\r\n    },\r\n    description: 'üöÄ Real training pipeline with actual code execution and learning',\r\n    usage: 'train-pipeline <command> [options]',\r\n    examples: [\r\n      'train-pipeline run               # Run training with real code',\r\n      'train-pipeline run --complexity hard --iterations 5',\r\n      'train-pipeline generate          # Generate real training tasks',\r\n      'train-pipeline validate          # Validate current performance',\r\n      'train-pipeline status            # Show pipeline status with real metrics',\r\n    ],\r\n    details: `\r\nReal Training Pipeline Features:\r\n  ‚Ä¢ Creates actual code files and tests\r\n  ‚Ä¢ Runs real npm test commands\r\n  ‚Ä¢ Learns from actual test results\r\n  ‚Ä¢ Validates improvements with real metrics\r\n  ‚Ä¢ Applies learned optimizations to production\r\n  \r\nPipeline Stages:\r\n  1. Generate real code tasks (easy/medium/hard)\r\n  2. Execute with different strategies using npm\r\n  3. Learn from real test results\r\n  4. Validate actual improvements\r\n  5. Apply to production configuration\r\n  \r\nOptions:\r\n  --complexity <level> Task complexity (easy/medium/hard)\r\n  --iterations <n>     Number of training iterations`,\r\n  });\r\n\r\n  commandRegistry.set('stream-chain', {\r\n    handler: async (args, flags) => {\r\n      try {\r\n        const { streamChainCommand } = await import('./simple-commands/stream-chain.js');\r\n        return await streamChainCommand(args, flags);\r\n      } catch (error) {\r\n        console.error('‚ùå Error loading stream-chain module:', error.message);\r\n        console.log('Error details:', error);\r\n      }\r\n    },\r\n    description: 'üîó Connect multiple Claude instances via stream-json for chained workflows',\r\n    usage: 'stream-chain <subcommand> [options]',\r\n    examples: [\r\n      'stream-chain run \"analyze\" \"design\" \"implement\"  # Custom chain',\r\n      'stream-chain demo                                 # Run demo chain', \r\n      'stream-chain pipeline analysis                    # Run analysis pipeline',\r\n      'stream-chain test                                 # Test stream connection',\r\n      'stream-chain help                                 # Show detailed help',\r\n    ],\r\n    details: `\r\nüìö SUBCOMMANDS\r\n    run <p1> <p2> [...]  Execute custom chain (min 2 prompts)\r\n    demo                 Run 3-step demo chain\r\n    pipeline <type>      Run predefined pipeline (analysis/refactor/test/optimize)\r\n    test                 Test stream connection\r\n    help                 Show comprehensive documentation\r\n\r\n‚öôÔ∏è  OPTIONS\r\n    --verbose            Show detailed execution info\r\n    --timeout <seconds>  Timeout per step (default: 30)\r\n    --debug              Enable debug mode\r\n\r\nüîÑ STREAM CHAINING\r\n    Chains multiple Claude Code calls with context preservation:\r\n    ‚Ä¢ Step 1 outputs stream-json ‚Üí Step 2 receives context ‚Üí Step 3...\r\n    ‚Ä¢ 100% context preservation between steps\r\n    ‚Ä¢ Real execution with Claude Code (not simulated)\r\n\r\nüöÄ PIPELINES\r\n    analysis  - Analyze ‚Üí Identify issues ‚Üí Generate report\r\n    refactor  - Find opportunities ‚Üí Create plan ‚Üí Apply changes\r\n    test      - Analyze coverage ‚Üí Design cases ‚Üí Generate tests\r\n    optimize  - Profile code ‚Üí Find bottlenecks ‚Üí Apply optimizations\r\n\r\n‚ö° PERFORMANCE\r\n    ‚Ä¢ Latency: ~10-30s per step\r\n    ‚Ä¢ Context: Full preservation\r\n    ‚Ä¢ Streaming: No intermediate files\r\n\r\nüìñ For full documentation: stream-chain help`,\r\n  });\r\n\r\n  commandRegistry.set('hive', {\r\n    handler: async (args, flags) => {\r\n      try {\r\n        // Try to load the hive command module\r\n        const { hiveAction } = await import('./commands/hive.js');\r\n        return hiveAction({ args, flags, command: 'hive' });\r\n      } catch (error) {\r\n        // Fallback to simple implementation if module not found\r\n        console.log('üêù Hive Mind - Advanced Multi-Agent Coordination');\r\n        console.log('');\r\n        console.log('The Hive Mind system provides:');\r\n        console.log('  ‚Ä¢ Consensus-based decision making');\r\n        console.log('  ‚Ä¢ Distributed task orchestration');\r\n        console.log('  ‚Ä¢ Quality-driven execution');\r\n        console.log('  ‚Ä¢ Real-time swarm monitoring');\r\n        console.log('');\r\n        console.log('Usage: hive <objective> [options]');\r\n        console.log('');\r\n        console.log('For full functionality, ensure the hive module is properly built.');\r\n      }\r\n    },\r\n    description: 'Hive Mind - Advanced multi-agent swarm with consensus',\r\n    usage: 'hive <objective> [options]',\r\n    examples: [\r\n      'hive \"Build microservices architecture\"',\r\n      'hive \"Optimize database performance\" --consensus unanimous',\r\n      'hive \"Develop ML pipeline\" --topology mesh --monitor',\r\n      'hive \"Create REST API\" --sparc --max-agents 8',\r\n      'hive \"Research cloud patterns\" --background --quality-threshold 0.9',\r\n    ],\r\n    details: `\r\nHive Mind features:\r\n  ‚Ä¢ üëë Queen-led orchestration with specialized agents\r\n  ‚Ä¢ üó≥Ô∏è Consensus mechanisms (quorum, unanimous, weighted, leader)\r\n  ‚Ä¢ üèóÔ∏è Multiple topologies (hierarchical, mesh, ring, star)\r\n  ‚Ä¢ üìä Real-time monitoring dashboard\r\n  ‚Ä¢ üß™ SPARC methodology integration\r\n  ‚Ä¢ üíæ Distributed memory and knowledge sharing\r\n  \r\nAgent types:\r\n  ‚Ä¢ Queen: Orchestrator and decision maker\r\n  ‚Ä¢ Architect: System design and planning  \r\n  ‚Ä¢ Worker: Implementation and execution\r\n  ‚Ä¢ Scout: Research and exploration\r\n  ‚Ä¢ Guardian: Quality and validation\r\n  \r\nOptions:\r\n  --topology <type>         Swarm topology (default: hierarchical)\r\n  --consensus <type>        Decision mechanism (default: quorum)\r\n  --max-agents <n>          Maximum agents (default: 8)\r\n  --quality-threshold <n>   Min quality 0-1 (default: 0.8)\r\n  --sparc                   Use SPARC methodology\r\n  --monitor                 Real-time monitoring\r\n  --background              Run in background`,\r\n  });\r\n\r\n  // Temporarily commented out for Node.js compatibility\r\n  /*\r\n  commandRegistry.set('ruv-swarm', {\r\n    handler: ruvSwarmAction,\r\n    description: 'Advanced AI swarm coordination with neural capabilities',\r\n    usage: 'ruv-swarm <command> [options]',\r\n    examples: [\r\n      'ruv-swarm init --topology mesh --max-agents 8',\r\n      'ruv-swarm spawn researcher --name \"AI Researcher\"',\r\n      'ruv-swarm orchestrate \"Build a REST API\"',\r\n      'ruv-swarm neural train --iterations 20',\r\n      'ruv-swarm benchmark --type swarm',\r\n      'ruv-swarm config show',\r\n      'ruv-swarm status --verbose'\r\n    ],\r\n    details: `\r\nAdvanced swarm coordination features:\r\n  ‚Ä¢ 84.8% SWE-Bench solve rate\r\n  ‚Ä¢ 32.3% token reduction through coordination\r\n  ‚Ä¢ 2.8-4.4x speed improvement via parallel execution\r\n  ‚Ä¢ 27+ neural models for cognitive approaches\r\n  ‚Ä¢ Persistent memory across sessions\r\n  ‚Ä¢ Automatic topology optimization\r\n  \r\nCommands:\r\n  init        - Initialize swarm with specified topology\r\n  status      - Get current swarm status and metrics\r\n  spawn       - Spawn specialized agents (researcher, coder, analyst, etc.)\r\n  orchestrate - Coordinate complex tasks across agents\r\n  neural      - Neural pattern training and management\r\n  benchmark   - Performance testing and optimization\r\n  config      - Configuration management\r\n  memory      - Memory usage and coordination data`\r\n  });\r\n  */\r\n\r\n  // Additional ruv-swarm coordination commands - temporarily commented out\r\n  /*\r\n  commandRegistry.set('swarm-init', {\r\n    handler: async (args, flags) => {\r\n      const { ruvSwarmAction } = await import('./commands/ruv-swarm.js');\r\n      return ruvSwarmAction({ args: ['init', ...args], flags });\r\n    },\r\n    description: 'Quick swarm initialization with topology selection',\r\n    usage: 'swarm-init [--topology <type>] [--max-agents <n>] [--strategy <type>]',\r\n    examples: [\r\n      'swarm-init --topology mesh --max-agents 8',\r\n      'swarm-init --topology hierarchical --strategy specialized',\r\n      'swarm-init --topology star --max-agents 5 --strategy balanced'\r\n    ]\r\n  });\r\n\r\n  commandRegistry.set('neural-spawn', {\r\n    handler: async (args, flags) => {\r\n      const { ruvSwarmAction } = await import('./commands/ruv-swarm.js');\r\n      return ruvSwarmAction({ args: ['spawn', ...args], flags });\r\n    },\r\n    description: 'Spawn neural agents with cognitive capabilities',\r\n    usage: 'neural-spawn <type> [--name <name>] [--capabilities <list>]',\r\n    examples: [\r\n      'neural-spawn researcher --name \"Data Analyst\"',\r\n      'neural-spawn coder --capabilities \"typescript,react,api\"',\r\n      'neural-spawn coordinator --name \"Project Manager\"'\r\n    ]\r\n  });\r\n\r\n  commandRegistry.set('memory-coordinate', {\r\n    handler: async (args, flags) => {\r\n      const { ruvSwarmAction } = await import('./commands/ruv-swarm.js');\r\n      return ruvSwarmAction({ args: ['memory', ...args], flags });\r\n    },\r\n    description: 'Coordinate memory across swarm agents',\r\n    usage: 'memory-coordinate [--detail <level>] [--sync] [--compress]',\r\n    examples: [\r\n      'memory-coordinate --detail summary',\r\n      'memory-coordinate --detail detailed --sync',\r\n      'memory-coordinate --compress --sync'\r\n    ]\r\n  });\r\n\r\n  commandRegistry.set('config-integration', {\r\n    handler: configIntegrationAction,\r\n    description: 'Enhanced configuration management with ruv-swarm integration',\r\n    usage: 'config-integration <command> [options]',\r\n    examples: [\r\n      'config-integration setup --enable-ruv-swarm',\r\n      'config-integration preset development',\r\n      'config-integration sync --force',\r\n      'config-integration status --verbose',\r\n      'config-integration export my-config.json',\r\n      'config-integration validate --fix'\r\n    ],\r\n    details: `\r\nAdvanced configuration management features:\r\n  ‚Ä¢ Unified configuration across Claude-Flow and ruv-swarm\r\n  ‚Ä¢ Configuration presets for different environments\r\n  ‚Ä¢ Automatic synchronization between config systems\r\n  ‚Ä¢ Import/export capabilities with validation\r\n  ‚Ä¢ Real-time status monitoring and validation\r\n  \r\nPresets:\r\n  development  - Hierarchical topology, specialized strategy, 8 agents\r\n  research     - Mesh topology, adaptive strategy, 12 agents  \r\n  production   - Star topology, balanced strategy, 6 agents\r\n  \r\nCommands:\r\n  setup        - Initialize ruv-swarm integration\r\n  sync         - Synchronize configurations\r\n  status       - Show integration status\r\n  validate     - Validate all configurations\r\n  preset       - Apply configuration preset\r\n  export       - Export unified configuration\r\n  import       - Import and apply configuration`\r\n  });\r\n  */\r\n}\r\n\r\n// Register a new command\r\nexport function registerCommand(name, command) {\r\n  if (commandRegistry.has(name)) {\r\n    console.warn(`Command '${name}' already exists and will be overwritten`);\r\n  }\r\n\r\n  commandRegistry.set(name, {\r\n    handler: command.handler,\r\n    description: command.description || 'No description available',\r\n    usage: command.usage || `${name} [options]`,\r\n    examples: command.examples || [],\r\n    hidden: command.hidden || false,\r\n  });\r\n}\r\n\r\n// Get command handler\r\nexport function getCommand(name) {\r\n  return commandRegistry.get(name);\r\n}\r\n\r\n// List all registered commands\r\nexport function listCommands(includeHidden = false) {\r\n  const commands = [];\r\n  for (const [name, command] of commandRegistry.entries()) {\r\n    if (includeHidden || !command.hidden) {\r\n      commands.push({\r\n        name,\r\n        ...command,\r\n      });\r\n    }\r\n  }\r\n  return commands.sort((a, b) => a.name.localeCompare(b.name));\r\n}\r\n\r\n// Check if command exists\r\nexport function hasCommand(name) {\r\n  return commandRegistry.has(name);\r\n}\r\n\r\n// Execute a command\r\nexport async function executeCommand(name, subArgs, flags) {\r\n  const command = commandRegistry.get(name);\r\n  if (!command) {\r\n    throw new Error(`Unknown command: ${name}`);\r\n  }\r\n\r\n  try {\r\n    // Track command execution for performance metrics\r\n    await trackCommandExecution(name, command.handler, subArgs, flags);\r\n  } catch (err) {\r\n    throw new Error(`Command '${name}' failed: ${err.message}`);\r\n  }\r\n}\r\n\r\n// Helper to show command help\r\nexport function showCommandHelp(name) {\r\n  const command = commandRegistry.get(name);\r\n  if (!command) {\r\n    console.log(\r\n      HelpFormatter.formatError(\r\n        `Unknown command: ${name}`,\r\n        'claude-flow',\r\n        'claude-flow <command> [options]',\r\n      ),\r\n    );\r\n    return;\r\n  }\r\n\r\n  // If command has custom help, call it with help flag\r\n  if (command.customHelp) {\r\n    command.handler(['--help'], { help: true });\r\n    return;\r\n  }\r\n\r\n  // Convert command info to standardized format\r\n  const helpInfo = {\r\n    name: `claude-flow ${name}`,\r\n    description: HelpFormatter.stripFormatting(command.description),\r\n    usage: `claude-flow ${command.usage}`,\r\n    details: command.details, // Pass through the details section\r\n  };\r\n\r\n  // Parse examples\r\n  if (command.examples && command.examples.length > 0) {\r\n    helpInfo.examples = command.examples.map((ex) => {\r\n      if (ex.startsWith('npx')) {\r\n        return ex;\r\n      }\r\n      return `claude-flow ${ex}`;\r\n    });\r\n  }\r\n\r\n  // Parse options from details if available\r\n  if (command.details) {\r\n    const optionsMatch = command.details.match(/Options:([\\s\\S]*?)(?=\\n\\n|$)/);\r\n    if (optionsMatch) {\r\n      const optionsText = optionsMatch[1];\r\n      const options = [];\r\n      const optionLines = optionsText.split('\\n').filter((line) => line.trim());\r\n\r\n      for (const line of optionLines) {\r\n        const match = line.match(/^\\s*(--.+?)\\s{2,}(.+)$/);\r\n        if (match) {\r\n          let [_, flags, description] = match;\r\n          // Check for default value in description\r\n          const defaultMatch = description.match(/\\(default: (.+?)\\)/);\r\n          const option = {\r\n            flags: flags.trim(),\r\n            description: description.replace(/\\(default: .+?\\)/, '').trim(),\r\n          };\r\n          if (defaultMatch) {\r\n            option.defaultValue = defaultMatch[1];\r\n          }\r\n          options.push(option);\r\n        }\r\n      }\r\n\r\n      if (options.length > 0) {\r\n        helpInfo.options = options;\r\n      }\r\n    }\r\n  }\r\n\r\n  console.log(HelpFormatter.formatHelp(helpInfo));\r\n}\r\n\r\n// Helper to show all commands\r\nexport function showAllCommands() {\r\n  const commands = listCommands();\r\n\r\n  console.log('Available commands:');\r\n  console.log();\r\n\r\n  for (const command of commands) {\r\n    console.log(`  ${command.name.padEnd(12)} ${command.description}`);\r\n  }\r\n\r\n  console.log();\r\n  console.log('Use \"claude-flow help <command>\" for detailed usage information');\r\n}\r\n\r\n// Initialize the command registry\r\nregisterCoreCommands();\r\n\r\n// Initialize performance tracking\r\ninitializePerformanceTracking().catch(err => {\r\n  // Performance tracking is optional, don't fail if it errors\r\n  console.error('Failed to initialize performance tracking:', err.message);\r\n});\r\n"],"names":["process","initCommand","memoryCommand","memoryConsolidationCommand","sparcCommand","agentCommand","taskCommand","configCommand","statusCommand","mcpCommand","proxyCommand","monitorCommand","startCommand","swarmCommand","batchManagerCommand","githubCommand","trainingAction","analysisAction","automationAction","coordinationAction","hooksAction","hookSafetyCommand","hiveMindCommand","HelpFormatter","hiveMindOptimizeCommand","neuralCommand","goalCommand","showUnifiedMetrics","fixTaskAttribution","migrateHooksCommandConfig","fixHookVariablesCommand","fixHookVariablesCommandConfig","initializePerformanceTracking","trackCommandExecution","commandRegistry","Map","registerCoreCommands","set","handler","description","usage","examples","details","args","flags","launchUI","fullArgs","argv","slice","console","log","customHelp","subcommand","verificationCommand","error","message","truthCommand","pairCommand","default","verificationTrainingCommand","trainingPipelineCommand","streamChainCommand","hiveAction","command","registerCommand","name","has","warn","hidden","getCommand","get","listCommands","includeHidden","commands","entries","push","sort","a","b","localeCompare","hasCommand","executeCommand","subArgs","Error","err","showCommandHelp","formatError","help","helpInfo","stripFormatting","length","map","ex","startsWith","optionsMatch","match","optionsText","options","optionLines","split","filter","line","trim","_","defaultMatch","option","replace","defaultValue","formatHelp","showAllCommands","padEnd","catch"],"mappings":"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"}