{
  "version": 3,
  "sources": ["../../../../src/cli/commands/hive-mind/ps.ts"],
  "sourcesContent": ["#!/usr/bin/env node\n/**\n * Hive Mind PS (Process Status) Command\n *\n * Show active sessions and their processes\n */\n\nimport { Command } from 'commander';\nimport chalk from 'chalk';\nimport { HiveMindSessionManager } from '../../simple-commands/hive-mind/session-manager.js';\nimport Table from 'cli-table3';\n\nexport const psCommand = new Command('ps')\n  .description('Show active hive mind sessions and processes')\n  .option('-a, --all', 'Show all sessions including stopped ones')\n  .option('-v, --verbose', 'Show detailed process information')\n  .action(async (options) => {\n    const sessionManager = new HiveMindSessionManager();\n\n    try {\n      const sessions = options.all\n        ? sessionManager.getActiveSessionsWithProcessInfo()\n        : sessionManager\n            .getActiveSessionsWithProcessInfo()\n            .filter((s: any) => s.status === 'active' || s.status === 'paused');\n\n      if (sessions.length === 0) {\n        console.log(chalk.yellow('No sessions found'));\n        return;\n      }\n\n      // Clean up orphaned processes first\n      const cleanedCount = sessionManager.cleanupOrphanedProcesses();\n      if (cleanedCount > 0) {\n        console.log(chalk.blue(`Cleaned up ${cleanedCount} orphaned session(s)\\n`));\n      }\n\n      // Create table\n      const table = new Table({\n        head: [\n          chalk.cyan('Session ID'),\n          chalk.cyan('Swarm'),\n          chalk.cyan('Status'),\n          chalk.cyan('Parent PID'),\n          chalk.cyan('Child PIDs'),\n          chalk.cyan('Progress'),\n          chalk.cyan('Duration'),\n        ],\n        style: {\n          head: [],\n          border: ['gray'],\n        },\n      });\n\n      for (const session of sessions) {\n        const duration = new Date().getTime() - new Date(session.created_at).getTime();\n        const durationStr = formatDuration(duration);\n\n        const statusColor =\n          session.status === 'active'\n            ? chalk.green\n            : session.status === 'paused'\n              ? chalk.yellow\n              : session.status === 'stopped'\n                ? chalk.red\n                : chalk.gray;\n\n        table.push([\n          session.id.substring(0, 20) + '...',\n          session.swarm_name,\n          statusColor(session.status),\n          session.parent_pid || '-',\n          session.child_pids.length > 0 ? session.child_pids.join(', ') : '-',\n          `${session.completion_percentage}%`,\n          durationStr,\n        ]);\n      }\n\n      console.log(table.toString());\n\n      if (options.verbose) {\n        console.log('\\n' + chalk.bold('Detailed Session Information:'));\n\n        for (const session of sessions) {\n          console.log('\\n' + chalk.cyan(`Session: ${session.id}`));\n          console.log(chalk.gray(`  Objective: ${session.objective || 'N/A'}`));\n          console.log(chalk.gray(`  Created: ${new Date(session.created_at).toLocaleString()}`));\n          console.log(chalk.gray(`  Updated: ${new Date(session.updated_at).toLocaleString()}`));\n\n          if (session.paused_at) {\n            console.log(chalk.gray(`  Paused: ${new Date(session.paused_at).toLocaleString()}`));\n          }\n\n          console.log(chalk.gray(`  Agents: ${session.agent_count || 0}`));\n          console.log(\n            chalk.gray(\n              `  Tasks: ${session.task_count || 0} (${session.completed_tasks || 0} completed)`,\n            ),\n          );\n\n          if (session.child_pids.length > 0) {\n            console.log(chalk.gray(`  Active Processes:`));\n            for (const pid of session.child_pids) {\n              console.log(chalk.gray(`    - PID ${pid}`));\n            }\n          }\n        }\n      }\n\n      // Summary\n      const activeSessions = sessions.filter((s: any) => s.status === 'active').length;\n      const pausedSessions = sessions.filter((s: any) => s.status === 'paused').length;\n      const totalProcesses = sessions.reduce((sum: any, s: any) => sum + s.total_processes, 0);\n\n      console.log('\\n' + chalk.bold('Summary:'));\n      console.log(chalk.gray(`  Active sessions: ${activeSessions}`));\n      console.log(chalk.gray(`  Paused sessions: ${pausedSessions}`));\n      console.log(chalk.gray(`  Total processes: ${totalProcesses}`));\n    } catch (error) {\n      console.error(chalk.red('Error listing sessions:'), (error as Error).message);\n      process.exit(1);\n    } finally {\n      sessionManager.close();\n    }\n  });\n\nfunction formatDuration(ms: number) {\n  const seconds = Math.floor(ms / 1000);\n  const minutes = Math.floor(seconds / 60);\n  const hours = Math.floor(minutes / 60);\n\n  if (hours > 0) {\n    return `${hours}h ${minutes % 60}m`;\n  } else if (minutes > 0) {\n    return `${minutes}m ${seconds % 60}s`;\n  } else {\n    return `${seconds}s`;\n  }\n}\n"],
  "mappings": "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",
  "names": ["chalk", "Table"]
}
