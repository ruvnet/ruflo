{
  "version": 3,
  "sources": ["../../src/enterprise/security-manager.ts"],
  "sourcesContent": ["import { EventEmitter } from 'events';\nimport { writeFile, readFile, mkdir, readdir } from 'fs/promises';\nimport { join } from 'path';\nimport { spawn } from 'child_process';\nimport { Logger } from '../core/logger.js';\nimport { ConfigManager } from '../core/config.js';\n\nexport interface SecurityScan {\n  id: string;\n  name: string;\n  type:\n    | 'vulnerability'\n    | 'dependency'\n    | 'code-quality'\n    | 'secrets'\n    | 'compliance'\n    | 'infrastructure'\n    | 'container';\n  status: 'pending' | 'running' | 'completed' | 'failed' | 'cancelled';\n  projectId?: string;\n  target: {\n    type: 'repository' | 'container' | 'infrastructure' | 'application' | 'dependencies';\n    path: string;\n    branch?: string;\n    commit?: string;\n    image?: string;\n    tag?: string;\n  };\n  configuration: {\n    scanner: string;\n    rules: string[];\n    excludes: string[];\n    severity: SecuritySeverity[];\n    formats: string[];\n    outputPath: string;\n  };\n  results: SecurityFinding[];\n  metrics: {\n    totalFindings: number;\n    criticalFindings: number;\n    highFindings: number;\n    mediumFindings: number;\n    lowFindings: number;\n    falsePositives: number;\n    suppressed: number;\n    scanDuration: number;\n    filesScanned: number;\n    linesScanned: number;\n  };\n  compliance: {\n    frameworks: string[];\n    requirements: ComplianceCheck[];\n    overallScore: number;\n    passedChecks: number;\n    failedChecks: number;\n  };\n  remediation: {\n    autoFixAvailable: SecurityFinding[];\n    manualReview: SecurityFinding[];\n    recommendations: SecurityRecommendation[];\n  };\n  schedule?: {\n    frequency: 'manual' | 'daily' | 'weekly' | 'monthly' | 'on-commit' | 'on-deploy';\n    nextRun?: Date;\n    lastRun?: Date;\n  };\n  notifications: {\n    channels: string[];\n    thresholds: {\n      critical: number;\n      high: number;\n      medium: number;\n    };\n  };\n  createdAt: Date;\n  updatedAt: Date;\n  createdBy: string;\n  auditLog: SecurityAuditEntry[];\n}\n\nexport type SecuritySeverity = 'critical' | 'high' | 'medium' | 'low' | 'info';\n\nexport interface SecurityFinding {\n  id: string;\n  title: string;\n  description: string;\n  severity: SecuritySeverity;\n  category:\n    | 'vulnerability'\n    | 'secret'\n    | 'misconfiguration'\n    | 'compliance'\n    | 'code-quality'\n    | 'license';\n  cwe?: string; // Common Weakness Enumeration\n  cve?: string; // Common Vulnerabilities and Exposures\n  cvss?: {\n    score: number;\n    vector: string;\n    version: string;\n  };\n  location: {\n    file: string;\n    line?: number;\n    column?: number;\n    function?: string;\n    component?: string;\n  };\n  evidence: {\n    snippet?: string;\n    context?: string;\n    references?: string[];\n  };\n  impact: string;\n  remediation: {\n    description: string;\n    effort: 'low' | 'medium' | 'high';\n    priority: 'low' | 'medium' | 'high' | 'critical';\n    autoFixable: boolean;\n    steps: string[];\n    references: string[];\n  };\n  status: 'open' | 'triaged' | 'in-progress' | 'resolved' | 'suppressed' | 'false-positive';\n  assignedTo?: string;\n  dueDate?: Date;\n  tags: string[];\n  metadata: Record<string, any>;\n  firstSeen: Date;\n  lastSeen: Date;\n  occurrences: number;\n}\n\nexport interface ComplianceCheck {\n  id: string;\n  framework: string; // e.g., 'SOC2', 'GDPR', 'HIPAA', 'PCI-DSS', 'CIS', 'NIST'\n  control: string;\n  description: string;\n  status: 'passed' | 'failed' | 'not-applicable' | 'manual-review';\n  severity: SecuritySeverity;\n  evidence?: string;\n  remediation?: string;\n  lastChecked: Date;\n}\n\nexport interface SecurityRecommendation {\n  id: string;\n  title: string;\n  description: string;\n  category:\n    | 'security-hardening'\n    | 'vulnerability-management'\n    | 'access-control'\n    | 'monitoring'\n    | 'compliance';\n  priority: 'low' | 'medium' | 'high' | 'critical';\n  effort: 'low' | 'medium' | 'high';\n  impact: string;\n  implementation: {\n    steps: string[];\n    tools: string[];\n    timeEstimate: string;\n    cost: string;\n  };\n  references: string[];\n  applicableFrameworks: string[];\n}\n\nexport interface SecurityPolicy {\n  id: string;\n  name: string;\n  description: string;\n  type: 'scanning' | 'access-control' | 'compliance' | 'incident-response' | 'data-protection';\n  version: string;\n  status: 'draft' | 'active' | 'deprecated';\n  rules: SecurityRule[];\n  enforcement: {\n    level: 'advisory' | 'warning' | 'blocking';\n    exceptions: string[];\n    approvers: string[];\n  };\n  applicability: {\n    projects: string[];\n    environments: string[];\n    resources: string[];\n  };\n  schedule: {\n    reviewFrequency: 'quarterly' | 'annually' | 'as-needed';\n    nextReview: Date;\n    lastReview?: Date;\n    reviewer: string;\n  };\n  metrics: {\n    violations: number;\n    compliance: number;\n    exceptions: number;\n  };\n  createdAt: Date;\n  updatedAt: Date;\n  createdBy: string;\n}\n\nexport interface SecurityRule {\n  id: string;\n  name: string;\n  description: string;\n  condition: string; // Query or condition syntax\n  action: 'allow' | 'deny' | 'alert' | 'audit';\n  severity: SecuritySeverity;\n  parameters: Record<string, any>;\n  enabled: boolean;\n}\n\nexport interface SecurityIncident {\n  id: string;\n  title: string;\n  description: string;\n  severity: SecuritySeverity;\n  status: 'open' | 'investigating' | 'contained' | 'resolved' | 'closed';\n  type:\n    | 'security-breach'\n    | 'vulnerability-exploit'\n    | 'policy-violation'\n    | 'suspicious-activity'\n    | 'compliance-violation';\n  source: {\n    type: 'scan' | 'alert' | 'user-report' | 'automated-detection';\n    details: Record<string, any>;\n  };\n  affected: {\n    systems: string[];\n    data: string[];\n    users: string[];\n  };\n  timeline: {\n    detected: Date;\n    reported: Date;\n    acknowledged: Date;\n    contained?: Date;\n    resolved?: Date;\n    closed?: Date;\n  };\n  response: {\n    assignedTo: string[];\n    actions: SecurityAction[];\n    communications: SecurityCommunication[];\n    lessons: string[];\n  };\n  evidence: {\n    logs: string[];\n    files: string[];\n    screenshots: string[];\n    forensics: string[];\n  };\n  impact: {\n    confidentiality: 'none' | 'low' | 'medium' | 'high';\n    integrity: 'none' | 'low' | 'medium' | 'high';\n    availability: 'none' | 'low' | 'medium' | 'high';\n    financialLoss?: number;\n    reputationalDamage?: string;\n    regulatoryImplications?: string[];\n  };\n  rootCause: {\n    primary: string;\n    contributing: string[];\n    analysis: string;\n  };\n  remediation: {\n    immediate: string[];\n    shortTerm: string[];\n    longTerm: string[];\n    preventive: string[];\n  };\n  createdAt: Date;\n  updatedAt: Date;\n  createdBy: string;\n  auditLog: SecurityAuditEntry[];\n}\n\nexport interface SecurityAction {\n  id: string;\n  type:\n    | 'investigation'\n    | 'containment'\n    | 'eradication'\n    | 'recovery'\n    | 'notification'\n    | 'documentation';\n  description: string;\n  assignedTo: string;\n  status: 'pending' | 'in-progress' | 'completed' | 'cancelled';\n  dueDate?: Date;\n  completedAt?: Date;\n  notes: string;\n}\n\nexport interface SecurityCommunication {\n  id: string;\n  type: 'internal' | 'external' | 'regulatory' | 'customer' | 'media';\n  audience: string[];\n  subject: string;\n  message: string;\n  sentAt: Date;\n  sentBy: string;\n  channel: 'email' | 'phone' | 'meeting' | 'document' | 'portal';\n}\n\nexport interface SecurityAuditEntry {\n  id: string;\n  timestamp: Date;\n  userId: string;\n  action: string;\n  target: string;\n  details: Record<string, any>;\n  ipAddress?: string;\n  userAgent?: string;\n}\n\nexport interface VulnerabilityDatabase {\n  id: string;\n  name: string;\n  type: 'nvd' | 'github' | 'snyk' | 'custom';\n  url: string;\n  updateFrequency: 'hourly' | 'daily' | 'weekly';\n  lastUpdate: Date;\n  status: 'active' | 'inactive' | 'error';\n  configuration: Record<string, any>;\n}\n\nexport interface SecurityMetrics {\n  scans: {\n    total: number;\n    completed: number;\n    failed: number;\n    inProgress: number;\n    byType: Record<string, number>;\n    averageDuration: number;\n  };\n  findings: {\n    total: number;\n    open: number;\n    resolved: number;\n    suppressed: number;\n    bySeverity: Record<SecuritySeverity, number>;\n    byCategory: Record<string, number>;\n    meanTimeToResolution: number;\n  };\n  compliance: {\n    frameworks: Record<\n      string,\n      {\n        total: number;\n        passed: number;\n        failed: number;\n        score: number;\n      }\n    >;\n    overallScore: number;\n    trending: 'improving' | 'stable' | 'declining';\n  };\n  incidents: {\n    total: number;\n    open: number;\n    resolved: number;\n    bySeverity: Record<SecuritySeverity, number>;\n    meanTimeToDetection: number;\n    meanTimeToResponse: number;\n    meanTimeToResolution: number;\n  };\n  policies: {\n    total: number;\n    active: number;\n    violations: number;\n    compliance: number;\n  };\n  trends: {\n    findingsTrend: Array<{ date: Date; count: number }>;\n    complianceTrend: Array<{ date: Date; score: number }>;\n    incidentsTrend: Array<{ date: Date; count: number }>;\n  };\n}\n\nexport class SecurityManager extends EventEmitter {\n  private scans: Map<string, SecurityScan> = new Map();\n  private policies: Map<string, SecurityPolicy> = new Map();\n  private incidents: Map<string, SecurityIncident> = new Map();\n  private vulnerabilityDatabases: Map<string, VulnerabilityDatabase> = new Map();\n  private securityPath: string;\n  private logger: Logger;\n  private config: ConfigManager;\n\n  constructor(securityPath: string = './security', logger?: Logger, config?: ConfigManager) {\n    super();\n    this.securityPath = securityPath;\n    this.logger = logger || new Logger({ level: 'info', format: 'text', destination: 'console' });\n    this.config = config || ConfigManager.getInstance();\n  }\n\n  async initialize(): Promise<void> {\n    try {\n      await mkdir(this.securityPath, { recursive: true });\n      await mkdir(join(this.securityPath, 'scans'), { recursive: true });\n      await mkdir(join(this.securityPath, 'policies'), { recursive: true });\n      await mkdir(join(this.securityPath, 'incidents'), { recursive: true });\n      await mkdir(join(this.securityPath, 'reports'), { recursive: true });\n      await mkdir(join(this.securityPath, 'databases'), { recursive: true });\n\n      await this.loadConfigurations();\n      await this.initializeDefaultPolicies();\n      await this.initializeVulnerabilityDatabases();\n\n      this.logger.info('Security Manager initialized successfully');\n    } catch (error) {\n      this.logger.error('Failed to initialize Security Manager', { error });\n      throw error;\n    }\n  }\n\n  async createSecurityScan(scanData: {\n    name: string;\n    type: SecurityScan['type'];\n    target: SecurityScan['target'];\n    configuration?: Partial<SecurityScan['configuration']>;\n    projectId?: string;\n    schedule?: SecurityScan['schedule'];\n  }): Promise<SecurityScan> {\n    const scan: SecurityScan = {\n      id: `scan-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      name: scanData.name,\n      type: scanData.type,\n      status: 'pending',\n      projectId: scanData.projectId,\n      target: scanData.target,\n      configuration: {\n        scanner: this.getDefaultScanner(scanData.type),\n        rules: [],\n        excludes: [],\n        severity: ['critical', 'high', 'medium', 'low'],\n        formats: ['json', 'html'],\n        outputPath: join(this.securityPath, 'reports'),\n        ...scanData.configuration,\n      },\n      results: [],\n      metrics: {\n        totalFindings: 0,\n        criticalFindings: 0,\n        highFindings: 0,\n        mediumFindings: 0,\n        lowFindings: 0,\n        falsePositives: 0,\n        suppressed: 0,\n        scanDuration: 0,\n        filesScanned: 0,\n        linesScanned: 0,\n      },\n      compliance: {\n        frameworks: [],\n        requirements: [],\n        overallScore: 0,\n        passedChecks: 0,\n        failedChecks: 0,\n      },\n      remediation: {\n        autoFixAvailable: [],\n        manualReview: [],\n        recommendations: [],\n      },\n      schedule: scanData.schedule,\n      notifications: {\n        channels: [],\n        thresholds: {\n          critical: 1,\n          high: 5,\n          medium: 10,\n        },\n      },\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      createdBy: 'system',\n      auditLog: [],\n    };\n\n    this.addAuditEntry(scan, 'system', 'scan_created', 'scan', {\n      scanId: scan.id,\n      scanName: scan.name,\n      scanType: scan.type,\n    });\n\n    this.scans.set(scan.id, scan);\n    await this.saveScan(scan);\n\n    this.emit('scan:created', scan);\n    this.logger.info(`Security scan created: ${scan.name} (${scan.id})`);\n\n    return scan;\n  }\n\n  async executeScan(scanId: string): Promise<void> {\n    const scan = this.scans.get(scanId);\n    if (!scan) {\n      throw new Error(`Scan not found: ${scanId}`);\n    }\n\n    if (scan.status !== 'pending') {\n      throw new Error(`Scan ${scanId} is not in pending status`);\n    }\n\n    scan.status = 'running';\n    scan.updatedAt = new Date();\n\n    this.addAuditEntry(scan, 'system', 'scan_started', 'scan', {\n      scanId,\n      target: scan.target,\n    });\n\n    await this.saveScan(scan);\n    this.emit('scan:started', scan);\n\n    try {\n      const startTime = Date.now();\n\n      // Execute the appropriate scanner\n      const findings = await this.executeScanEngine(scan);\n\n      const endTime = Date.now();\n      scan.metrics.scanDuration = endTime - startTime;\n      scan.results = findings;\n      scan.status = 'completed';\n\n      // Calculate metrics\n      this.calculateScanMetrics(scan);\n\n      // Run compliance checks\n      await this.runComplianceChecks(scan);\n\n      // Generate remediation recommendations\n      await this.generateRemediationRecommendations(scan);\n\n      // Check notification thresholds\n      await this.checkNotificationThresholds(scan);\n\n      scan.updatedAt = new Date();\n\n      this.addAuditEntry(scan, 'system', 'scan_completed', 'scan', {\n        scanId,\n        duration: scan.metrics.scanDuration,\n        findingsCount: scan.results.length,\n      });\n\n      await this.saveScan(scan);\n      this.emit('scan:completed', scan);\n\n      this.logger.info(\n        `Security scan completed: ${scan.name} (${scan.id}) - ${scan.results.length} findings`,\n      );\n    } catch (error) {\n      scan.status = 'failed';\n      scan.updatedAt = new Date();\n\n      this.addAuditEntry(scan, 'system', 'scan_failed', 'scan', {\n        scanId,\n        error: error instanceof Error ? error.message : String(error),\n      });\n\n      await this.saveScan(scan);\n      this.emit('scan:failed', { scan, error });\n\n      this.logger.error(`Security scan failed: ${scan.name} (${scanId})`, { error });\n      throw error;\n    }\n  }\n\n  async createSecurityIncident(incidentData: {\n    title: string;\n    description: string;\n    severity: SecuritySeverity;\n    type: SecurityIncident['type'];\n    source: SecurityIncident['source'];\n    affected?: Partial<SecurityIncident['affected']>;\n  }): Promise<SecurityIncident> {\n    const incident: SecurityIncident = {\n      id: `incident-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      title: incidentData.title,\n      description: incidentData.description,\n      severity: incidentData.severity,\n      status: 'open',\n      type: incidentData.type,\n      source: incidentData.source,\n      affected: {\n        systems: [],\n        data: [],\n        users: [],\n        ...incidentData.affected,\n      },\n      timeline: {\n        detected: new Date(),\n        reported: new Date(),\n        acknowledged: new Date(),\n      },\n      response: {\n        assignedTo: [],\n        actions: [],\n        communications: [],\n        lessons: [],\n      },\n      evidence: {\n        logs: [],\n        files: [],\n        screenshots: [],\n        forensics: [],\n      },\n      impact: {\n        confidentiality: 'none',\n        integrity: 'none',\n        availability: 'none',\n      },\n      rootCause: {\n        primary: '',\n        contributing: [],\n        analysis: '',\n      },\n      remediation: {\n        immediate: [],\n        shortTerm: [],\n        longTerm: [],\n        preventive: [],\n      },\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      createdBy: 'system',\n      auditLog: [],\n    };\n\n    this.addAuditEntry(incident, 'system', 'incident_created', 'incident', {\n      incidentId: incident.id,\n      severity: incident.severity,\n      type: incident.type,\n    });\n\n    this.incidents.set(incident.id, incident);\n    await this.saveIncident(incident);\n\n    // Auto-assign based on severity and type\n    await this.autoAssignIncident(incident);\n\n    // Send immediate notifications for high/critical incidents\n    if (incident.severity === 'critical' || incident.severity === 'high') {\n      await this.sendIncidentNotification(incident);\n    }\n\n    this.emit('incident:created', incident);\n    this.logger.info(`Security incident created: ${incident.title} (${incident.id})`);\n\n    return incident;\n  }\n\n  async updateIncident(\n    incidentId: string,\n    updates: Partial<SecurityIncident>,\n    userId: string = 'system',\n  ): Promise<SecurityIncident> {\n    const incident = this.incidents.get(incidentId);\n    if (!incident) {\n      throw new Error(`Incident not found: ${incidentId}`);\n    }\n\n    const oldStatus = incident.status;\n    Object.assign(incident, updates);\n    incident.updatedAt = new Date();\n\n    // Update timeline based on status changes\n    if (updates.status && updates.status !== oldStatus) {\n      this.updateIncidentTimeline(incident, updates.status);\n    }\n\n    this.addAuditEntry(incident, userId, 'incident_updated', 'incident', {\n      incidentId,\n      changes: Object.keys(updates),\n      oldStatus,\n      newStatus: incident.status,\n    });\n\n    await this.saveIncident(incident);\n    this.emit('incident:updated', { incident, updates });\n\n    this.logger.info(`Security incident updated: ${incident.title} (${incidentId})`);\n\n    return incident;\n  }\n\n  async runComplianceAssessment(\n    frameworks: string[],\n    scope?: {\n      projectId?: string;\n      environment?: string;\n      resources?: string[];\n    },\n  ): Promise<ComplianceCheck[]> {\n    const checks: ComplianceCheck[] = [];\n\n    for (const framework of frameworks) {\n      const frameworkChecks = await this.runFrameworkChecks(framework, scope);\n      checks.push(...frameworkChecks);\n    }\n\n    this.logger.info(\n      `Compliance assessment completed: ${checks.length} checks across ${frameworks.length} frameworks`,\n    );\n    this.emit('compliance:assessed', { frameworks, checks, scope });\n\n    return checks;\n  }\n\n  async createSecurityPolicy(policyData: {\n    name: string;\n    description: string;\n    type: SecurityPolicy['type'];\n    rules: Omit<SecurityRule, 'id'>[];\n    enforcement?: Partial<SecurityPolicy['enforcement']>;\n    applicability?: Partial<SecurityPolicy['applicability']>;\n  }): Promise<SecurityPolicy> {\n    const policy: SecurityPolicy = {\n      id: `policy-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      name: policyData.name,\n      description: policyData.description,\n      type: policyData.type,\n      version: '1.0.0',\n      status: 'draft',\n      rules: policyData.rules.map((rule) => ({\n        id: `rule-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n        ...rule,\n      })),\n      enforcement: {\n        level: 'warning',\n        exceptions: [],\n        approvers: [],\n        ...policyData.enforcement,\n      },\n      applicability: {\n        projects: [],\n        environments: [],\n        resources: [],\n        ...policyData.applicability,\n      },\n      schedule: {\n        reviewFrequency: 'annually',\n        nextReview: new Date(Date.now() + 365 * 24 * 60 * 60 * 1000), // 1 year\n        reviewer: 'security-team',\n      },\n      metrics: {\n        violations: 0,\n        compliance: 100,\n        exceptions: 0,\n      },\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      createdBy: 'system',\n    };\n\n    this.policies.set(policy.id, policy);\n    await this.savePolicy(policy);\n\n    this.emit('policy:created', policy);\n    this.logger.info(`Security policy created: ${policy.name} (${policy.id})`);\n\n    return policy;\n  }\n\n  async getSecurityMetrics(filters?: {\n    timeRange?: { start: Date; end: Date };\n    projectId?: string;\n    environment?: string;\n    severity?: SecuritySeverity[];\n  }): Promise<SecurityMetrics> {\n    let scans = Array.from(this.scans.values());\n    let incidents = Array.from(this.incidents.values());\n\n    // Apply filters\n    if (filters) {\n      if (filters.timeRange) {\n        scans = scans.filter(\n          (s) => s.createdAt >= filters.timeRange!.start && s.createdAt <= filters.timeRange!.end,\n        );\n        incidents = incidents.filter(\n          (i) => i.createdAt >= filters.timeRange!.start && i.createdAt <= filters.timeRange!.end,\n        );\n      }\n      if (filters.projectId) {\n        scans = scans.filter((s) => s.projectId === filters.projectId);\n      }\n    }\n\n    // Calculate scan metrics\n    const scanMetrics = {\n      total: scans.length,\n      completed: scans.filter((s) => s.status === 'completed').length,\n      failed: scans.filter((s) => s.status === 'failed').length,\n      inProgress: scans.filter((s) => s.status === 'running').length,\n      byType: this.groupBy(scans, 'type'),\n      averageDuration:\n        scans.length > 0\n          ? scans.reduce((sum, s) => sum + s.metrics.scanDuration, 0) / scans.length\n          : 0,\n    };\n\n    // Calculate finding metrics\n    const allFindings = scans.flatMap((s) => s.results);\n    const findingMetrics = {\n      total: allFindings.length,\n      open: allFindings.filter((f) => f.status === 'open').length,\n      resolved: allFindings.filter((f) => f.status === 'resolved').length,\n      suppressed: allFindings.filter((f) => f.status === 'suppressed').length,\n      bySeverity: this.groupBy(allFindings, 'severity') as Record<SecuritySeverity, number>,\n      byCategory: this.groupBy(allFindings, 'category'),\n      meanTimeToResolution: this.calculateMTTR(allFindings),\n    };\n\n    // Calculate compliance metrics\n    const allComplianceChecks = scans.flatMap((s) => s.compliance.requirements);\n    const complianceFrameworks: Record<string, any> = {};\n\n    for (const check of allComplianceChecks) {\n      if (!complianceFrameworks[check.framework]) {\n        complianceFrameworks[check.framework] = {\n          total: 0,\n          passed: 0,\n          failed: 0,\n          score: 0,\n        };\n      }\n\n      complianceFrameworks[check.framework].total++;\n      if (check.status === 'passed') {\n        complianceFrameworks[check.framework].passed++;\n      } else if (check.status === 'failed') {\n        complianceFrameworks[check.framework].failed++;\n      }\n    }\n\n    // Calculate scores\n    for (const framework in complianceFrameworks) {\n      const fw = complianceFrameworks[framework];\n      fw.score = fw.total > 0 ? (fw.passed / fw.total) * 100 : 0;\n    }\n\n    const overallComplianceScore =\n      Object.values(complianceFrameworks).length > 0\n        ? Object.values(complianceFrameworks).reduce((sum: number, fw: any) => sum + fw.score, 0) /\n          Object.values(complianceFrameworks).length\n        : 0;\n\n    // Calculate incident metrics\n    const incidentMetrics = {\n      total: incidents.length,\n      open: incidents.filter((i) => i.status === 'open' || i.status === 'investigating').length,\n      resolved: incidents.filter((i) => i.status === 'resolved' || i.status === 'closed').length,\n      bySeverity: this.groupBy(incidents, 'severity') as Record<SecuritySeverity, number>,\n      meanTimeToDetection: this.calculateMTTD(incidents),\n      meanTimeToResponse: this.calculateMTTResponse(incidents),\n      meanTimeToResolution: this.calculateIncidentMTTR(incidents),\n    };\n\n    // Policy metrics\n    const policies = Array.from(this.policies.values());\n    const policyMetrics = {\n      total: policies.length,\n      active: policies.filter((p) => p.status === 'active').length,\n      violations: policies.reduce((sum, p) => sum + p.metrics.violations, 0),\n      compliance:\n        policies.length > 0\n          ? policies.reduce((sum, p) => sum + p.metrics.compliance, 0) / policies.length\n          : 0,\n    };\n\n    return {\n      scans: scanMetrics,\n      findings: findingMetrics,\n      compliance: {\n        frameworks: complianceFrameworks,\n        overallScore: overallComplianceScore,\n        trending: 'stable', // Would be calculated from historical data\n      },\n      incidents: incidentMetrics,\n      policies: policyMetrics,\n      trends: {\n        findingsTrend: [], // Would be calculated from historical data\n        complianceTrend: [], // Would be calculated from historical data\n        incidentsTrend: [], // Would be calculated from historical data\n      },\n    };\n  }\n\n  // Private helper methods\n  private async loadConfigurations(): Promise<void> {\n    try {\n      // Load scans\n      const scanFiles = await readdir(join(this.securityPath, 'scans'));\n      for (const file of scanFiles.filter((f) => f.endsWith('.json'))) {\n        const content = await readFile(join(this.securityPath, 'scans', file), 'utf-8');\n        const scan: SecurityScan = JSON.parse(content);\n        this.scans.set(scan.id, scan);\n      }\n\n      // Load policies\n      const policyFiles = await readdir(join(this.securityPath, 'policies'));\n      for (const file of policyFiles.filter((f) => f.endsWith('.json'))) {\n        const content = await readFile(join(this.securityPath, 'policies', file), 'utf-8');\n        const policy: SecurityPolicy = JSON.parse(content);\n        this.policies.set(policy.id, policy);\n      }\n\n      // Load incidents\n      const incidentFiles = await readdir(join(this.securityPath, 'incidents'));\n      for (const file of incidentFiles.filter((f) => f.endsWith('.json'))) {\n        const content = await readFile(join(this.securityPath, 'incidents', file), 'utf-8');\n        const incident: SecurityIncident = JSON.parse(content);\n        this.incidents.set(incident.id, incident);\n      }\n\n      this.logger.info(\n        `Loaded ${this.scans.size} scans, ${this.policies.size} policies, ${this.incidents.size} incidents`,\n      );\n    } catch (error) {\n      this.logger.warn('Failed to load some security configurations', { error });\n    }\n  }\n\n  private async initializeDefaultPolicies(): Promise<void> {\n    const defaultPolicies = [\n      {\n        name: 'Critical Vulnerability Policy',\n        description: 'Immediate action required for critical vulnerabilities',\n        type: 'scanning' as const,\n        rules: [\n          {\n            name: 'Critical CVSS Score',\n            description: 'Alert on vulnerabilities with CVSS score >= 9.0',\n            condition: 'cvss.score >= 9.0',\n            action: 'alert' as const,\n            severity: 'critical' as const,\n            parameters: { threshold: 9.0 },\n            enabled: true,\n          },\n        ],\n        enforcement: {\n          level: 'blocking' as const,\n          exceptions: [],\n          approvers: ['security-lead'],\n        },\n      },\n      {\n        name: 'Secret Detection Policy',\n        description: 'Detect exposed secrets and credentials',\n        type: 'scanning' as const,\n        rules: [\n          {\n            name: 'API Key Detection',\n            description: 'Detect exposed API keys',\n            condition: 'category == \"secret\" && type == \"api-key\"',\n            action: 'deny' as const,\n            severity: 'high' as const,\n            parameters: {},\n            enabled: true,\n          },\n        ],\n      },\n    ];\n\n    for (const policyData of defaultPolicies) {\n      if (!Array.from(this.policies.values()).some((p) => p.name === policyData.name)) {\n        await this.createSecurityPolicy(policyData);\n      }\n    }\n  }\n\n  private async initializeVulnerabilityDatabases(): Promise<void> {\n    const databases: VulnerabilityDatabase[] = [\n      {\n        id: 'nvd',\n        name: 'National Vulnerability Database',\n        type: 'nvd',\n        url: 'https://nvd.nist.gov/feeds/json/cve/1.1/',\n        updateFrequency: 'daily',\n        lastUpdate: new Date(),\n        status: 'active',\n        configuration: {},\n      },\n      {\n        id: 'github-advisories',\n        name: 'GitHub Security Advisories',\n        type: 'github',\n        url: 'https://api.github.com/advisories',\n        updateFrequency: 'daily',\n        lastUpdate: new Date(),\n        status: 'active',\n        configuration: {},\n      },\n    ];\n\n    for (const db of databases) {\n      this.vulnerabilityDatabases.set(db.id, db);\n    }\n  }\n\n  private getDefaultScanner(type: SecurityScan['type']): string {\n    const scanners: Record<SecurityScan['type'], string> = {\n      vulnerability: 'trivy',\n      dependency: 'npm-audit',\n      'code-quality': 'sonarqube',\n      secrets: 'gitleaks',\n      compliance: 'inspec',\n      infrastructure: 'checkov',\n      container: 'clair',\n    };\n\n    return scanners[type] || 'generic';\n  }\n\n  private async executeScanEngine(scan: SecurityScan): Promise<SecurityFinding[]> {\n    const findings: SecurityFinding[] = [];\n\n    switch (scan.configuration.scanner) {\n      case 'trivy':\n        return this.executeTrivyScan(scan);\n      case 'npm-audit':\n        return this.executeNpmAuditScan(scan);\n      case 'gitleaks':\n        return this.executeGitleaksScan(scan);\n      case 'checkov':\n        return this.executeCheckovScan(scan);\n      default:\n        return this.executeGenericScan(scan);\n    }\n  }\n\n  private async executeTrivyScan(scan: SecurityScan): Promise<SecurityFinding[]> {\n    return new Promise((resolve, reject) => {\n      const findings: SecurityFinding[] = [];\n\n      // Mock Trivy execution\n      const mockFindings = [\n        {\n          id: `finding-${Date.now()}-1`,\n          title: 'CVE-2023-12345: Remote Code Execution in libxml2',\n          description: 'A buffer overflow vulnerability in libxml2 allows remote code execution',\n          severity: 'critical' as const,\n          category: 'vulnerability' as const,\n          cve: 'CVE-2023-12345',\n          cvss: {\n            score: 9.8,\n            vector: 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H',\n            version: '3.1',\n          },\n          location: {\n            file: 'package-lock.json',\n            line: 125,\n            component: 'libxml2@2.9.10',\n          },\n          evidence: {\n            snippet: '\"libxml2\": \"2.9.10\"',\n            context: 'Dependency declaration',\n            references: ['https://nvd.nist.gov/vuln/detail/CVE-2023-12345'],\n          },\n          impact: 'Remote attackers could execute arbitrary code',\n          remediation: {\n            description: 'Update libxml2 to version 2.9.14 or later',\n            effort: 'low' as const,\n            priority: 'critical' as const,\n            autoFixable: true,\n            steps: ['npm update libxml2'],\n            references: ['https://github.com/GNOME/libxml2/releases'],\n          },\n          status: 'open' as const,\n          tags: ['cve', 'rce', 'dependency'],\n          metadata: {},\n          firstSeen: new Date(),\n          lastSeen: new Date(),\n          occurrences: 1,\n        },\n      ];\n\n      // Simulate scan delay\n      setTimeout(() => {\n        resolve(mockFindings);\n      }, 2000);\n    });\n  }\n\n  private async executeNpmAuditScan(scan: SecurityScan): Promise<SecurityFinding[]> {\n    return new Promise((resolve, reject) => {\n      const command = 'npm';\n      const args = ['audit', '--json'];\n\n      const child = spawn(command, args, {\n        cwd: scan.target.path,\n        stdio: ['pipe', 'pipe', 'pipe'],\n      });\n\n      let stdout = '';\n      let stderr = '';\n\n      child.stdout?.on('data', (data) => {\n        stdout += data.toString();\n      });\n\n      child.stderr?.on('data', (data) => {\n        stderr += data.toString();\n      });\n\n      child.on('close', (code) => {\n        try {\n          const auditResult = JSON.parse(stdout);\n          const findings = this.parseNpmAuditResults(auditResult);\n          resolve(findings);\n        } catch (error) {\n          reject(\n            new Error(\n              `Failed to parse npm audit results: ${error instanceof Error ? error.message : String(error)}`,\n            ),\n          );\n        }\n      });\n\n      child.on('error', (error) => {\n        reject(error);\n      });\n    });\n  }\n\n  private async executeGitleaksScan(scan: SecurityScan): Promise<SecurityFinding[]> {\n    // Mock Gitleaks scan for secrets detection\n    return [\n      {\n        id: `finding-${Date.now()}-2`,\n        title: 'Exposed AWS Access Key',\n        description: 'AWS access key found in source code',\n        severity: 'high' as const,\n        category: 'secret' as const,\n        location: {\n          file: 'config/aws.js',\n          line: 12,\n          column: 20,\n        },\n        evidence: {\n          snippet: 'const accessKey = \"AKIA123456789...\"',\n          context: 'Hardcoded AWS credentials',\n        },\n        impact: 'Unauthorized access to AWS resources',\n        remediation: {\n          description: 'Remove hardcoded credentials and use environment variables or IAM roles',\n          effort: 'medium' as const,\n          priority: 'high' as const,\n          autoFixable: false,\n          steps: [\n            'Remove hardcoded credentials',\n            'Use environment variables',\n            'Rotate compromised keys',\n          ],\n          references: ['https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html'],\n        },\n        status: 'open' as const,\n        tags: ['secret', 'aws', 'credentials'],\n        metadata: {},\n        firstSeen: new Date(),\n        lastSeen: new Date(),\n        occurrences: 1,\n      },\n    ];\n  }\n\n  private async executeCheckovScan(scan: SecurityScan): Promise<SecurityFinding[]> {\n    // Mock Checkov scan for infrastructure as code\n    return [];\n  }\n\n  private async executeGenericScan(scan: SecurityScan): Promise<SecurityFinding[]> {\n    // Generic scan implementation\n    return [];\n  }\n\n  private parseNpmAuditResults(auditResult: any): SecurityFinding[] {\n    const findings: SecurityFinding[] = [];\n\n    if (auditResult.vulnerabilities) {\n      for (const [packageName, vulnData] of Object.entries(auditResult.vulnerabilities)) {\n        const vuln = vulnData as any;\n\n        findings.push({\n          id: `finding-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n          title: `${vuln.severity} vulnerability in ${packageName}`,\n          description: vuln.title || 'Vulnerability detected',\n          severity: vuln.severity as SecuritySeverity,\n          category: 'vulnerability',\n          cve: vuln.cve,\n          location: {\n            file: 'package.json',\n            component: packageName,\n          },\n          evidence: {\n            snippet: `\"${packageName}\": \"${vuln.range}\"`,\n            references: vuln.url ? [vuln.url] : [],\n          },\n          impact: vuln.overview || 'Security vulnerability',\n          remediation: {\n            description: vuln.recommendation || 'Update to a secure version',\n            effort: 'low' as const,\n            priority:\n              vuln.severity === 'info'\n                ? 'low'\n                : (vuln.severity as 'low' | 'medium' | 'high' | 'critical'),\n            autoFixable: true,\n            steps: [`npm update ${packageName}`],\n            references: vuln.url ? [vuln.url] : [],\n          },\n          status: 'open',\n          tags: ['npm', 'dependency'],\n          metadata: { packageName, range: vuln.range },\n          firstSeen: new Date(),\n          lastSeen: new Date(),\n          occurrences: 1,\n        });\n      }\n    }\n\n    return findings;\n  }\n\n  private calculateScanMetrics(scan: SecurityScan): void {\n    const findings = scan.results;\n\n    scan.metrics.totalFindings = findings.length;\n    scan.metrics.criticalFindings = findings.filter((f) => f.severity === 'critical').length;\n    scan.metrics.highFindings = findings.filter((f) => f.severity === 'high').length;\n    scan.metrics.mediumFindings = findings.filter((f) => f.severity === 'medium').length;\n    scan.metrics.lowFindings = findings.filter((f) => f.severity === 'low').length;\n    scan.metrics.falsePositives = findings.filter((f) => f.status === 'false-positive').length;\n    scan.metrics.suppressed = findings.filter((f) => f.status === 'suppressed').length;\n  }\n\n  private async runComplianceChecks(scan: SecurityScan): Promise<void> {\n    // Mock compliance checks\n    const frameworks = ['SOC2', 'GDPR', 'PCI-DSS'];\n\n    for (const framework of frameworks) {\n      const checks = await this.runFrameworkChecks(framework, { projectId: scan.projectId });\n      scan.compliance.requirements.push(...checks);\n    }\n\n    scan.compliance.frameworks = frameworks;\n    scan.compliance.passedChecks = scan.compliance.requirements.filter(\n      (r) => r.status === 'passed',\n    ).length;\n    scan.compliance.failedChecks = scan.compliance.requirements.filter(\n      (r) => r.status === 'failed',\n    ).length;\n    scan.compliance.overallScore =\n      scan.compliance.requirements.length > 0\n        ? (scan.compliance.passedChecks / scan.compliance.requirements.length) * 100\n        : 0;\n  }\n\n  private async runFrameworkChecks(framework: string, scope?: any): Promise<ComplianceCheck[]> {\n    // Mock compliance checks for different frameworks\n    const mockChecks: ComplianceCheck[] = [\n      {\n        id: `check-${Date.now()}-1`,\n        framework,\n        control: 'CC6.1',\n        description: 'Encryption in transit',\n        status: 'passed',\n        severity: 'high',\n        evidence: 'TLS 1.2+ configured',\n        lastChecked: new Date(),\n      },\n      {\n        id: `check-${Date.now()}-2`,\n        framework,\n        control: 'CC6.7',\n        description: 'Encryption at rest',\n        status: 'failed',\n        severity: 'medium',\n        remediation: 'Enable database encryption',\n        lastChecked: new Date(),\n      },\n    ];\n\n    return mockChecks;\n  }\n\n  private async generateRemediationRecommendations(scan: SecurityScan): Promise<void> {\n    const autoFixable = scan.results.filter((f) => f.remediation.autoFixable);\n    const manualReview = scan.results.filter((f) => !f.remediation.autoFixable);\n\n    scan.remediation.autoFixAvailable = autoFixable;\n    scan.remediation.manualReview = manualReview;\n\n    // Generate general recommendations\n    scan.remediation.recommendations = [\n      {\n        id: `rec-${Date.now()}-1`,\n        title: 'Implement Automated Dependency Updates',\n        description: 'Set up automated dependency updates to reduce vulnerability exposure',\n        category: 'vulnerability-management',\n        priority: 'high',\n        effort: 'medium',\n        impact: 'Reduces time to patch vulnerabilities',\n        implementation: {\n          steps: [\n            'Configure Dependabot or Renovate',\n            'Set up automated testing pipeline',\n            'Enable auto-merge for low-risk updates',\n          ],\n          tools: ['Dependabot', 'Renovate', 'GitHub Actions'],\n          timeEstimate: '2-4 hours',\n          cost: 'Free',\n        },\n        references: [\n          'https://docs.github.com/en/code-security/dependabot',\n          'https://renovatebot.com/',\n        ],\n        applicableFrameworks: ['SOC2', 'ISO27001'],\n      },\n    ];\n  }\n\n  private async checkNotificationThresholds(scan: SecurityScan): Promise<void> {\n    const thresholds = scan.notifications.thresholds;\n\n    if (\n      scan.metrics.criticalFindings >= thresholds.critical ||\n      scan.metrics.highFindings >= thresholds.high ||\n      scan.metrics.mediumFindings >= thresholds.medium\n    ) {\n      await this.sendScanNotification(scan);\n    }\n  }\n\n  private async sendScanNotification(scan: SecurityScan): Promise<void> {\n    const message = `Security scan '${scan.name}' completed with ${scan.metrics.totalFindings} findings (${scan.metrics.criticalFindings} critical, ${scan.metrics.highFindings} high)`;\n\n    this.emit('notification:scan', {\n      scan,\n      message,\n      severity:\n        scan.metrics.criticalFindings > 0\n          ? 'critical'\n          : scan.metrics.highFindings > 0\n            ? 'high'\n            : 'medium',\n    });\n\n    this.logger.warn(message);\n  }\n\n  private async autoAssignIncident(incident: SecurityIncident): Promise<void> {\n    // Auto-assign based on severity and type\n    const assignmentRules: Record<string, string[]> = {\n      critical: ['security-lead', 'ciso'],\n      high: ['security-team'],\n      medium: ['security-analyst'],\n      low: ['security-analyst'],\n    };\n\n    incident.response.assignedTo = assignmentRules[incident.severity] || ['security-team'];\n  }\n\n  private async sendIncidentNotification(incident: SecurityIncident): Promise<void> {\n    const message = `SECURITY INCIDENT: ${incident.title} (${incident.severity.toUpperCase()})`;\n\n    this.emit('notification:incident', {\n      incident,\n      message,\n      urgency: incident.severity === 'critical' ? 'immediate' : 'high',\n    });\n\n    this.logger.error(message);\n  }\n\n  private updateIncidentTimeline(incident: SecurityIncident, newStatus: string): void {\n    const now = new Date();\n\n    switch (newStatus) {\n      case 'investigating':\n        incident.timeline.acknowledged = now;\n        break;\n      case 'contained':\n        incident.timeline.contained = now;\n        break;\n      case 'resolved':\n        incident.timeline.resolved = now;\n        break;\n      case 'closed':\n        incident.timeline.closed = now;\n        break;\n    }\n  }\n\n  private async saveScan(scan: SecurityScan): Promise<void> {\n    const filePath = join(this.securityPath, 'scans', `${scan.id}.json`);\n    await writeFile(filePath, JSON.stringify(scan, null, 2));\n  }\n\n  private async savePolicy(policy: SecurityPolicy): Promise<void> {\n    const filePath = join(this.securityPath, 'policies', `${policy.id}.json`);\n    await writeFile(filePath, JSON.stringify(policy, null, 2));\n  }\n\n  private async saveIncident(incident: SecurityIncident): Promise<void> {\n    const filePath = join(this.securityPath, 'incidents', `${incident.id}.json`);\n    await writeFile(filePath, JSON.stringify(incident, null, 2));\n  }\n\n  private addAuditEntry(\n    target: SecurityScan | SecurityIncident,\n    userId: string,\n    action: string,\n    targetType: string,\n    details: Record<string, any>,\n  ): void {\n    const entry: SecurityAuditEntry = {\n      id: `audit-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      timestamp: new Date(),\n      userId,\n      action,\n      target: targetType,\n      details,\n    };\n\n    target.auditLog.push(entry);\n  }\n\n  private groupBy<T>(array: T[], key: keyof T): Record<string, number> {\n    return array.reduce(\n      (groups, item) => {\n        const value = String(item[key]);\n        groups[value] = (groups[value] || 0) + 1;\n        return groups;\n      },\n      {} as Record<string, number>,\n    );\n  }\n\n  private calculateMTTR(findings: SecurityFinding[]): number {\n    const resolvedFindings = findings.filter(\n      (f) => f.status === 'resolved' && f.firstSeen && f.lastSeen,\n    );\n\n    if (resolvedFindings.length === 0) return 0;\n\n    const totalTime = resolvedFindings.reduce(\n      (sum, f) => sum + (f.lastSeen.getTime() - f.firstSeen.getTime()),\n      0,\n    );\n\n    return totalTime / resolvedFindings.length;\n  }\n\n  private calculateMTTD(incidents: SecurityIncident[]): number {\n    const detectedIncidents = incidents.filter((i) => i.timeline.detected && i.timeline.reported);\n\n    if (detectedIncidents.length === 0) return 0;\n\n    const totalTime = detectedIncidents.reduce(\n      (sum, i) => sum + (i.timeline.reported.getTime() - i.timeline.detected.getTime()),\n      0,\n    );\n\n    return totalTime / detectedIncidents.length;\n  }\n\n  private calculateMTTResponse(incidents: SecurityIncident[]): number {\n    const respondedIncidents = incidents.filter(\n      (i) => i.timeline.reported && i.timeline.acknowledged,\n    );\n\n    if (respondedIncidents.length === 0) return 0;\n\n    const totalTime = respondedIncidents.reduce(\n      (sum, i) => sum + (i.timeline.acknowledged.getTime() - i.timeline.reported.getTime()),\n      0,\n    );\n\n    return totalTime / respondedIncidents.length;\n  }\n\n  private calculateIncidentMTTR(incidents: SecurityIncident[]): number {\n    const resolvedIncidents = incidents.filter((i) => i.timeline.reported && i.timeline.resolved);\n\n    if (resolvedIncidents.length === 0) return 0;\n\n    const totalTime = resolvedIncidents.reduce(\n      (sum, i) => sum + (i.timeline.resolved!.getTime() - i.timeline.reported.getTime()),\n      0,\n    );\n\n    return totalTime / resolvedIncidents.length;\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
