{"version":3,"sources":["../../../../src/cli/ui/compatible-ui.ts"],"sourcesContent":["/**\r\n * Compatible Terminal UI - Works without raw mode\r\n * Designed for environments that don't support stdin raw mode\r\n */\r\n\r\nimport readline from 'readline';\r\nimport chalk from 'chalk';\r\n\r\nexport interface UIProcess {\r\n  id: string;\r\n  name: string;\r\n  status: 'running' | 'stopped' | 'starting' | 'stopping' | 'error' | 'crashed';\r\n  type: string;\r\n  pid?: number;\r\n  startTime?: number;\r\n  metrics?: {\r\n    cpu?: number;\r\n    memory?: number;\r\n    restarts?: number;\r\n    lastError?: string;\r\n  };\r\n}\r\n\r\nexport interface UISystemStats {\r\n  totalProcesses: number;\r\n  runningProcesses: number;\r\n  errorProcesses: number;\r\n}\r\n\r\nexport class CompatibleUI {\r\n  private processes: UIProcess[] = [];\r\n  private running = false;\r\n  private rl: readline.Interface;\r\n\r\n  constructor() {\r\n    this.rl = readline.createInterface({\r\n      input: process.stdin,\r\n      output: process.stdout,\r\n      terminal: false, // Don't require raw mode\r\n    });\r\n  }\r\n\r\n  async start(): Promise<void> {\r\n    this.running = true;\r\n\r\n    // Initial render\r\n    this.render();\r\n\r\n    // Setup command loop\r\n    while (this.running) {\r\n      const command = await this.promptCommand();\r\n      await this.handleCommand(command);\r\n    }\r\n  }\r\n\r\n  stop(): void {\r\n    this.running = false;\r\n    this.rl.close();\r\n    console.clear();\r\n  }\r\n\r\n  updateProcesses(processes: UIProcess[]): void {\r\n    this.processes = processes;\r\n    if (this.running) {\r\n      this.render();\r\n    }\r\n  }\r\n\r\n  private async promptCommand(): Promise<string> {\r\n    return new Promise((resolve) => {\r\n      this.rl.question('\\nCommand: ', (answer) => {\r\n        resolve(answer.trim());\r\n      });\r\n    });\r\n  }\r\n\r\n  private async handleCommand(input: string): Promise<void> {\r\n    switch (input.toLowerCase()) {\r\n      case 'q':\r\n      case 'quit':\r\n      case 'exit':\r\n        await this.handleExit();\r\n        break;\r\n\r\n      case 'r':\r\n      case 'refresh':\r\n        this.render();\r\n        break;\r\n\r\n      case 'h':\r\n      case 'help':\r\n      case '?':\r\n        this.showHelp();\r\n        break;\r\n\r\n      case 's':\r\n      case 'status':\r\n        this.showStatus();\r\n        break;\r\n\r\n      case 'l':\r\n      case 'list':\r\n        this.showProcessList();\r\n        break;\r\n\r\n      default:\r\n        // Check if it's a number (process selection)\r\n        const num = parseInt(input);\r\n        if (!isNaN(num) && num >= 1 && num <= this.processes.length) {\r\n          await this.showProcessDetails(this.processes[num - 1]);\r\n        } else {\r\n          console.log(chalk.yellow('Invalid command. Type \"h\" for help.'));\r\n        }\r\n        break;\r\n    }\r\n  }\r\n\r\n  private render(): void {\r\n    console.clear();\r\n    const stats = this.getSystemStats();\r\n\r\n    // Header\r\n    console.log(chalk.cyan.bold('üß† Claude-Flow System Monitor'));\r\n    console.log(chalk.gray('‚îÄ'.repeat(60)));\r\n\r\n    // System stats\r\n    console.log(\r\n      chalk.white('System Status:'),\r\n      chalk.green(`${stats.runningProcesses}/${stats.totalProcesses} running`),\r\n    );\r\n\r\n    if (stats.errorProcesses > 0) {\r\n      console.log(chalk.red(`‚ö†Ô∏è  ${stats.errorProcesses} processes with errors`));\r\n    }\r\n\r\n    console.log();\r\n\r\n    // Process list\r\n    console.log(chalk.white.bold('Processes:'));\r\n    console.log(chalk.gray('‚îÄ'.repeat(60)));\r\n\r\n    if (this.processes.length === 0) {\r\n      console.log(chalk.gray('No processes configured'));\r\n    } else {\r\n      this.processes.forEach((process, index) => {\r\n        const num = `[${index + 1}]`.padEnd(4);\r\n        const status = this.getStatusDisplay(process.status);\r\n        const name = process.name.padEnd(25);\r\n\r\n        console.log(`${chalk.gray(num)} ${status} ${chalk.white(name)}`);\r\n\r\n        if (process.metrics?.lastError) {\r\n          console.log(chalk.red(`       Error: ${process.metrics.lastError}`));\r\n        }\r\n      });\r\n    }\r\n\r\n    // Footer\r\n    console.log(chalk.gray('‚îÄ'.repeat(60)));\r\n    console.log(\r\n      chalk.gray(\r\n        'Commands: [1-9] Process details [s] Status [l] List [r] Refresh [h] Help [q] Quit',\r\n      ),\r\n    );\r\n  }\r\n\r\n  private showStatus(): void {\r\n    const stats = this.getSystemStats();\r\n\r\n    console.log();\r\n    console.log(chalk.cyan.bold('üìä System Status Details'));\r\n    console.log(chalk.gray('‚îÄ'.repeat(40)));\r\n    console.log(chalk.white('Total Processes:'), stats.totalProcesses);\r\n    console.log(chalk.white('Running:'), chalk.green(stats.runningProcesses));\r\n    console.log(\r\n      chalk.white('Stopped:'),\r\n      chalk.gray(stats.totalProcesses - stats.runningProcesses - stats.errorProcesses),\r\n    );\r\n    console.log(chalk.white('Errors:'), chalk.red(stats.errorProcesses));\r\n    console.log(chalk.white('System Load:'), this.getSystemLoad());\r\n    console.log(chalk.white('Uptime:'), this.getSystemUptime());\r\n  }\r\n\r\n  private showProcessList(): void {\r\n    console.log();\r\n    console.log(chalk.cyan.bold('üìã Process List'));\r\n    console.log(chalk.gray('‚îÄ'.repeat(60)));\r\n\r\n    if (this.processes.length === 0) {\r\n      console.log(chalk.gray('No processes configured'));\r\n      return;\r\n    }\r\n\r\n    this.processes.forEach((process, index) => {\r\n      console.log(\r\n        `${chalk.gray(`[${index + 1}]`)} ${this.getStatusDisplay(process.status)} ${chalk.white.bold(process.name)}`,\r\n      );\r\n      console.log(chalk.gray(`    Type: ${process.type}`));\r\n\r\n      if (process.pid) {\r\n        console.log(chalk.gray(`    PID: ${process.pid}`));\r\n      }\r\n\r\n      if (process.startTime) {\r\n        const uptime = Date.now() - process.startTime;\r\n        console.log(chalk.gray(`    Uptime: ${this.formatUptime(uptime)}`));\r\n      }\r\n\r\n      if (process.metrics) {\r\n        if (process.metrics.cpu !== undefined) {\r\n          console.log(chalk.gray(`    CPU: ${process.metrics.cpu.toFixed(1)}%`));\r\n        }\r\n        if (process.metrics.memory !== undefined) {\r\n          console.log(chalk.gray(`    Memory: ${process.metrics.memory.toFixed(0)} MB`));\r\n        }\r\n      }\r\n\r\n      console.log();\r\n    });\r\n  }\r\n\r\n  private async showProcessDetails(process: UIProcess): Promise<void> {\r\n    console.log();\r\n    console.log(chalk.cyan.bold(`üìã Process Details: ${process.name}`));\r\n    console.log(chalk.gray('‚îÄ'.repeat(60)));\r\n\r\n    console.log(chalk.white('ID:'), process.id);\r\n    console.log(chalk.white('Type:'), process.type);\r\n    console.log(chalk.white('Status:'), this.getStatusDisplay(process.status), process.status);\r\n\r\n    if (process.pid) {\r\n      console.log(chalk.white('PID:'), process.pid);\r\n    }\r\n\r\n    if (process.startTime) {\r\n      const uptime = Date.now() - process.startTime;\r\n      console.log(chalk.white('Uptime:'), this.formatUptime(uptime));\r\n    }\r\n\r\n    if (process.metrics) {\r\n      console.log();\r\n      console.log(chalk.white.bold('Metrics:'));\r\n      if (process.metrics.cpu !== undefined) {\r\n        console.log(chalk.white('CPU:'), `${process.metrics.cpu.toFixed(1)}%`);\r\n      }\r\n      if (process.metrics.memory !== undefined) {\r\n        console.log(chalk.white('Memory:'), `${process.metrics.memory.toFixed(0)} MB`);\r\n      }\r\n      if (process.metrics.restarts !== undefined) {\r\n        console.log(chalk.white('Restarts:'), process.metrics.restarts);\r\n      }\r\n      if (process.metrics.lastError) {\r\n        console.log(chalk.red('Last Error:'), process.metrics.lastError);\r\n      }\r\n    }\r\n  }\r\n\r\n  private getStatusDisplay(status: string): string {\r\n    switch (status) {\r\n      case 'running':\r\n        return chalk.green('‚óè');\r\n      case 'stopped':\r\n        return chalk.gray('‚óã');\r\n      case 'starting':\r\n        return chalk.yellow('‚óê');\r\n      case 'stopping':\r\n        return chalk.yellow('‚óë');\r\n      case 'error':\r\n        return chalk.red('‚úó');\r\n      case 'crashed':\r\n        return chalk.red('‚ò†');\r\n      default:\r\n        return chalk.gray('?');\r\n    }\r\n  }\r\n\r\n  private getSystemStats(): UISystemStats {\r\n    return {\r\n      totalProcesses: this.processes.length,\r\n      runningProcesses: this.processes.filter((p) => p.status === 'running').length,\r\n      errorProcesses: this.processes.filter((p) => p.status === 'error' || p.status === 'crashed')\r\n        .length,\r\n    };\r\n  }\r\n\r\n  private getSystemLoad(): string {\r\n    // Simulate system load\r\n    return '0.45, 0.52, 0.48';\r\n  }\r\n\r\n  private getSystemUptime(): string {\r\n    const uptime = process.uptime() * 1000;\r\n    return this.formatUptime(uptime);\r\n  }\r\n\r\n  private formatUptime(ms: number): string {\r\n    const seconds = Math.floor(ms / 1000);\r\n    const minutes = Math.floor(seconds / 60);\r\n    const hours = Math.floor(minutes / 60);\r\n    const days = Math.floor(hours / 24);\r\n\r\n    if (days > 0) {\r\n      return `${days}d ${hours % 24}h`;\r\n    } else if (hours > 0) {\r\n      return `${hours}h ${minutes % 60}m`;\r\n    } else if (minutes > 0) {\r\n      return `${minutes}m ${seconds % 60}s`;\r\n    } else {\r\n      return `${seconds}s`;\r\n    }\r\n  }\r\n\r\n  private showHelp(): void {\r\n    console.log();\r\n    console.log(chalk.cyan.bold('üß† Claude-Flow System Monitor - Help'));\r\n    console.log(chalk.gray('‚îÄ'.repeat(60)));\r\n    console.log();\r\n    console.log(chalk.white.bold('Commands:'));\r\n    console.log('  1-9     - Show process details by number');\r\n    console.log('  s       - Show system status');\r\n    console.log('  l       - List all processes');\r\n    console.log('  r       - Refresh display');\r\n    console.log('  h/?     - Show this help');\r\n    console.log('  q       - Quit');\r\n    console.log();\r\n    console.log(chalk.white.bold('Features:'));\r\n    console.log('  ‚Ä¢ Non-interactive mode (works in any terminal)');\r\n    console.log('  ‚Ä¢ Real-time process monitoring');\r\n    console.log('  ‚Ä¢ System statistics');\r\n    console.log('  ‚Ä¢ Compatible with VS Code, CI/CD, containers');\r\n  }\r\n\r\n  private async handleExit(): Promise<void> {\r\n    const runningProcesses = this.processes.filter((p) => p.status === 'running');\r\n\r\n    if (runningProcesses.length > 0) {\r\n      console.log();\r\n      console.log(chalk.yellow(`‚ö†Ô∏è  ${runningProcesses.length} processes are still running.`));\r\n      console.log('These processes will continue running in the background.');\r\n      console.log('Use the main CLI to stop them if needed.');\r\n    }\r\n\r\n    this.stop();\r\n  }\r\n}\r\n\r\n// Factory function to create UI instances\r\nexport function createCompatibleUI(): CompatibleUI {\r\n  return new CompatibleUI();\r\n}\r\n\r\n// Check if raw mode is supported\r\nexport function isRawModeSupported(): boolean {\r\n  try {\r\n    return process.stdin.isTTY && typeof process.stdin.setRawMode === 'function';\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\n// Fallback UI launcher that chooses the best available UI\r\nexport async function launchUI(): Promise<void> {\r\n  const ui = createCompatibleUI();\r\n\r\n  // Mock some example processes for demonstration\r\n  const mockProcesses: UIProcess[] = [\r\n    {\r\n      id: 'orchestrator',\r\n      name: 'Orchestrator Engine',\r\n      status: 'running',\r\n      type: 'core',\r\n      pid: 12345,\r\n      startTime: Date.now() - 30000,\r\n      metrics: { cpu: 2.1, memory: 45.2, restarts: 0 },\r\n    },\r\n    {\r\n      id: 'memory-manager',\r\n      name: 'Memory Manager',\r\n      status: 'running',\r\n      type: 'service',\r\n      pid: 12346,\r\n      startTime: Date.now() - 25000,\r\n      metrics: { cpu: 0.8, memory: 12.5, restarts: 0 },\r\n    },\r\n    {\r\n      id: 'mcp-server',\r\n      name: 'MCP Server',\r\n      status: 'stopped',\r\n      type: 'server',\r\n      metrics: { restarts: 1 },\r\n    },\r\n  ];\r\n\r\n  ui.updateProcesses(mockProcesses);\r\n\r\n  console.log(chalk.green('‚úÖ Starting Claude-Flow UI (compatible mode)'));\r\n  console.log(chalk.gray('Note: Using compatible UI mode for broader terminal support'));\r\n  console.log();\r\n\r\n  await ui.start();\r\n}\r\n"],"names":["readline","chalk","CompatibleUI","processes","running","rl","createInterface","input","process","stdin","output","stdout","terminal","start","render","command","promptCommand","handleCommand","stop","close","console","clear","updateProcesses","Promise","resolve","question","answer","trim","toLowerCase","handleExit","showHelp","showStatus","showProcessList","num","parseInt","isNaN","length","showProcessDetails","log","yellow","stats","getSystemStats","cyan","bold","gray","repeat","white","green","runningProcesses","totalProcesses","errorProcesses","red","forEach","index","padEnd","status","getStatusDisplay","name","metrics","lastError","getSystemLoad","getSystemUptime","type","pid","startTime","uptime","Date","now","formatUptime","cpu","undefined","toFixed","memory","id","restarts","filter","p","ms","seconds","Math","floor","minutes","hours","days","createCompatibleUI","isRawModeSupported","isTTY","setRawMode","launchUI","ui","mockProcesses"],"mappings":"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"}