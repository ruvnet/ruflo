{
  "version": 3,
  "sources": ["../../src/mcp/protocol-manager.ts"],
  "sourcesContent": ["/**\n * MCP Protocol Version Management and Compatibility Checking\n */\n\nimport type { MCPProtocolVersion, MCPCapabilities, MCPInitializeParams } from '../utils/types.js';\nimport type { ILogger } from '../core/logger.js';\nimport { MCPError } from '../utils/errors.js';\n\nexport interface ProtocolVersionInfo {\n  version: MCPProtocolVersion;\n  name: string;\n  releaseDate: Date;\n  deprecated?: boolean;\n  deprecationDate?: Date;\n  supportedFeatures: string[];\n  breakingChanges?: string[];\n  migrationGuide?: string;\n}\n\nexport interface CompatibilityResult {\n  compatible: boolean;\n  warnings: string[];\n  errors: string[];\n  recommendedVersion?: MCPProtocolVersion;\n  missingFeatures?: string[];\n  deprecatedFeatures?: string[];\n}\n\nexport interface NegotiationResult {\n  agreedVersion: MCPProtocolVersion;\n  agreedCapabilities: MCPCapabilities;\n  clientCapabilities: MCPCapabilities;\n  serverCapabilities: MCPCapabilities;\n  warnings: string[];\n  limitations: string[];\n}\n\n/**\n * MCP Protocol Manager\n * Handles protocol version negotiation, compatibility checking, and feature management\n */\nexport class MCPProtocolManager {\n  private supportedVersions: Map<string, ProtocolVersionInfo> = new Map();\n  private currentVersion: MCPProtocolVersion;\n  private serverCapabilities: MCPCapabilities;\n\n  private readonly knownVersions: ProtocolVersionInfo[] = [\n    {\n      version: { major: 2024, minor: 11, patch: 5 },\n      name: 'MCP 2024.11.5',\n      releaseDate: new Date('2024-11-01'),\n      supportedFeatures: [\n        'tools',\n        'prompts',\n        'resources',\n        'logging',\n        'sampling',\n        'notifications',\n        'tool_list_changed',\n        'resource_list_changed',\n        'prompt_list_changed',\n      ],\n    },\n    {\n      version: { major: 2024, minor: 11, patch: 4 },\n      name: 'MCP 2024.11.4',\n      releaseDate: new Date('2024-10-15'),\n      supportedFeatures: [\n        'tools',\n        'prompts',\n        'resources',\n        'logging',\n        'notifications',\n        'tool_list_changed',\n        'resource_list_changed',\n      ],\n    },\n    {\n      version: { major: 2024, minor: 11, patch: 3 },\n      name: 'MCP 2024.11.3',\n      releaseDate: new Date('2024-10-01'),\n      supportedFeatures: ['tools', 'prompts', 'resources', 'logging', 'notifications'],\n    },\n    {\n      version: { major: 2024, minor: 10, patch: 0 },\n      name: 'MCP 2024.10.0',\n      releaseDate: new Date('2024-09-01'),\n      deprecated: true,\n      deprecationDate: new Date('2024-11-01'),\n      supportedFeatures: ['tools', 'prompts', 'resources', 'logging'],\n      breakingChanges: ['Changed tool response format', 'Modified error codes'],\n      migrationGuide: 'https://docs.mcp.io/migration/2024.10-to-2024.11',\n    },\n  ];\n\n  constructor(\n    private logger: ILogger,\n    preferredVersion?: MCPProtocolVersion,\n    serverCapabilities?: MCPCapabilities,\n  ) {\n    // Initialize supported versions\n    for (const versionInfo of this.knownVersions) {\n      const key = this.versionToString(versionInfo.version);\n      this.supportedVersions.set(key, versionInfo);\n    }\n\n    // Set current version (latest supported or preferred)\n    this.currentVersion = preferredVersion || this.getLatestSupportedVersion();\n\n    // Set server capabilities\n    this.serverCapabilities = serverCapabilities || this.getDefaultCapabilities();\n\n    this.logger.info('Protocol manager initialized', {\n      currentVersion: this.versionToString(this.currentVersion),\n      supportedVersions: this.getSupportedVersionStrings(),\n    });\n  }\n\n  /**\n   * Negotiate protocol version and capabilities with client\n   */\n  async negotiateProtocol(clientParams: MCPInitializeParams): Promise<NegotiationResult> {\n    this.logger.debug('Starting protocol negotiation', {\n      clientVersion: this.versionToString(clientParams.protocolVersion),\n      clientCapabilities: clientParams.capabilities,\n      clientInfo: clientParams.clientInfo,\n    });\n\n    const result: NegotiationResult = {\n      agreedVersion: this.currentVersion,\n      agreedCapabilities: { ...this.serverCapabilities },\n      clientCapabilities: clientParams.capabilities,\n      serverCapabilities: this.serverCapabilities,\n      warnings: [],\n      limitations: [],\n    };\n\n    try {\n      // Check version compatibility\n      const compatibility = this.checkCompatibility(clientParams.protocolVersion);\n\n      if (!compatibility.compatible) {\n        throw new MCPError(\n          `Protocol version ${this.versionToString(clientParams.protocolVersion)} is not compatible. ${compatibility.errors.join(', ')}`,\n        );\n      }\n\n      // Use client's version if it's supported and newer\n      if (this.isVersionSupported(clientParams.protocolVersion)) {\n        const clientVersionInfo = this.getVersionInfo(clientParams.protocolVersion);\n        const currentVersionInfo = this.getVersionInfo(this.currentVersion);\n\n        if (clientVersionInfo && currentVersionInfo) {\n          if (this.compareVersions(clientParams.protocolVersion, this.currentVersion) <= 0) {\n            result.agreedVersion = clientParams.protocolVersion;\n          }\n        }\n      }\n\n      // Negotiate capabilities\n      result.agreedCapabilities = this.negotiateCapabilities(\n        clientParams.capabilities,\n        this.serverCapabilities,\n        result.agreedVersion,\n      );\n\n      // Add warnings from compatibility check\n      result.warnings.push(...compatibility.warnings);\n\n      // Check for deprecated features\n      const versionInfo = this.getVersionInfo(result.agreedVersion);\n      if (versionInfo?.deprecated) {\n        result.warnings.push(\n          `Protocol version ${this.versionToString(result.agreedVersion)} is deprecated. ` +\n            `Please upgrade to a newer version.`,\n        );\n      }\n\n      // Check for missing features\n      const missingFeatures = this.getMissingFeatures(\n        result.agreedVersion,\n        result.agreedCapabilities,\n      );\n\n      if (missingFeatures.length > 0) {\n        result.limitations.push(\n          `Some features may not be available: ${missingFeatures.join(', ')}`,\n        );\n      }\n\n      this.logger.info('Protocol negotiation completed', {\n        agreedVersion: this.versionToString(result.agreedVersion),\n        warnings: result.warnings.length,\n        limitations: result.limitations.length,\n      });\n\n      return result;\n    } catch (error) {\n      this.logger.error('Protocol negotiation failed', {\n        clientVersion: this.versionToString(clientParams.protocolVersion),\n        error,\n      });\n      throw error;\n    }\n  }\n\n  /**\n   * Check compatibility between client and server versions\n   */\n  checkCompatibility(clientVersion: MCPProtocolVersion): CompatibilityResult {\n    const result: CompatibilityResult = {\n      compatible: false,\n      warnings: [],\n      errors: [],\n    };\n\n    const clientVersionInfo = this.getVersionInfo(clientVersion);\n    const serverVersionInfo = this.getVersionInfo(this.currentVersion);\n\n    // Check if version is known\n    if (!clientVersionInfo) {\n      result.errors.push(`Unknown protocol version: ${this.versionToString(clientVersion)}`);\n      result.recommendedVersion = this.getLatestSupportedVersion();\n      return result;\n    }\n\n    // Check major version compatibility\n    if (clientVersion.major !== this.currentVersion.major) {\n      result.errors.push(\n        `Major version mismatch: client ${clientVersion.major}, server ${this.currentVersion.major}`,\n      );\n      return result;\n    }\n\n    // Check if client version is too new\n    if (this.compareVersions(clientVersion, this.currentVersion) > 0) {\n      result.errors.push(\n        `Client version ${this.versionToString(clientVersion)} is newer than supported server version ${this.versionToString(this.currentVersion)}`,\n      );\n      result.recommendedVersion = this.currentVersion;\n      return result;\n    }\n\n    // Check for deprecated versions\n    if (clientVersionInfo.deprecated) {\n      result.warnings.push(\n        `Client is using deprecated version ${this.versionToString(clientVersion)}. ` +\n          `Support will be removed after ${clientVersionInfo.deprecationDate?.toISOString().split('T')[0]}`,\n      );\n      result.recommendedVersion = this.getLatestSupportedVersion();\n    }\n\n    // Check for missing features\n    const serverFeatures = serverVersionInfo?.supportedFeatures || [];\n    const clientFeatures = clientVersionInfo.supportedFeatures;\n    const missingFeatures = serverFeatures.filter((feature) => !clientFeatures.includes(feature));\n\n    if (missingFeatures.length > 0) {\n      result.missingFeatures = missingFeatures;\n      result.warnings.push(\n        `Client version lacks some server features: ${missingFeatures.join(', ')}`,\n      );\n    }\n\n    // Check for deprecated features being used\n    const deprecatedFeatures = this.getDeprecatedFeatures(clientVersion);\n    if (deprecatedFeatures.length > 0) {\n      result.deprecatedFeatures = deprecatedFeatures;\n      result.warnings.push(\n        `Client version uses deprecated features: ${deprecatedFeatures.join(', ')}`,\n      );\n    }\n\n    result.compatible = true;\n    return result;\n  }\n\n  /**\n   * Get information about a specific protocol version\n   */\n  getVersionInfo(version: MCPProtocolVersion): ProtocolVersionInfo | undefined {\n    return this.supportedVersions.get(this.versionToString(version));\n  }\n\n  /**\n   * Check if a version is supported\n   */\n  isVersionSupported(version: MCPProtocolVersion): boolean {\n    return this.supportedVersions.has(this.versionToString(version));\n  }\n\n  /**\n   * Get the latest supported version\n   */\n  getLatestSupportedVersion(): MCPProtocolVersion {\n    const versions = Array.from(this.supportedVersions.values())\n      .filter((v) => !v.deprecated)\n      .sort((a, b) => this.compareVersions(b.version, a.version));\n\n    return versions[0]?.version || { major: 2024, minor: 11, patch: 5 };\n  }\n\n  /**\n   * Get all supported version strings\n   */\n  getSupportedVersionStrings(): string[] {\n    return Array.from(this.supportedVersions.keys());\n  }\n\n  /**\n   * Get current server capabilities\n   */\n  getServerCapabilities(): MCPCapabilities {\n    return { ...this.serverCapabilities };\n  }\n\n  /**\n   * Update server capabilities\n   */\n  updateServerCapabilities(capabilities: Partial<MCPCapabilities>): void {\n    this.serverCapabilities = { ...this.serverCapabilities, ...capabilities };\n    this.logger.info('Server capabilities updated', { capabilities: this.serverCapabilities });\n  }\n\n  /**\n   * Check if a feature is supported in a specific version\n   */\n  isFeatureSupported(version: MCPProtocolVersion, feature: string): boolean {\n    const versionInfo = this.getVersionInfo(version);\n    return versionInfo?.supportedFeatures.includes(feature) || false;\n  }\n\n  private versionToString(version: MCPProtocolVersion): string {\n    return `${version.major}.${version.minor}.${version.patch}`;\n  }\n\n  private compareVersions(a: MCPProtocolVersion, b: MCPProtocolVersion): number {\n    if (a.major !== b.major) return a.major - b.major;\n    if (a.minor !== b.minor) return a.minor - b.minor;\n    return a.patch - b.patch;\n  }\n\n  private getDefaultCapabilities(): MCPCapabilities {\n    return {\n      logging: {\n        level: 'info',\n      },\n      tools: {\n        listChanged: true,\n      },\n      resources: {\n        listChanged: true,\n        subscribe: false,\n      },\n      prompts: {\n        listChanged: true,\n      },\n    };\n  }\n\n  private negotiateCapabilities(\n    clientCapabilities: MCPCapabilities,\n    serverCapabilities: MCPCapabilities,\n    agreedVersion: MCPProtocolVersion,\n  ): MCPCapabilities {\n    const result: MCPCapabilities = {};\n\n    // Negotiate logging capabilities\n    if (clientCapabilities.logging && serverCapabilities.logging) {\n      result.logging = {\n        level: this.negotiateLogLevel(\n          clientCapabilities.logging.level,\n          serverCapabilities.logging.level,\n        ),\n      };\n    }\n\n    // Negotiate tools capabilities\n    if (clientCapabilities.tools && serverCapabilities.tools) {\n      result.tools = {\n        listChanged: clientCapabilities.tools.listChanged && serverCapabilities.tools.listChanged,\n      };\n    }\n\n    // Negotiate resources capabilities\n    if (clientCapabilities.resources && serverCapabilities.resources) {\n      result.resources = {\n        listChanged:\n          clientCapabilities.resources.listChanged && serverCapabilities.resources.listChanged,\n        subscribe: clientCapabilities.resources.subscribe && serverCapabilities.resources.subscribe,\n      };\n    }\n\n    // Negotiate prompts capabilities\n    if (clientCapabilities.prompts && serverCapabilities.prompts) {\n      result.prompts = {\n        listChanged:\n          clientCapabilities.prompts.listChanged && serverCapabilities.prompts.listChanged,\n      };\n    }\n\n    // Only include capabilities supported by the agreed version\n    return this.filterCapabilitiesByVersion(result, agreedVersion);\n  }\n\n  private negotiateLogLevel(\n    clientLevel?: 'debug' | 'info' | 'warn' | 'error',\n    serverLevel?: 'debug' | 'info' | 'warn' | 'error',\n  ): 'debug' | 'info' | 'warn' | 'error' {\n    const levels = ['debug', 'info', 'warn', 'error'];\n    const clientIndex = clientLevel ? levels.indexOf(clientLevel) : 1;\n    const serverIndex = serverLevel ? levels.indexOf(serverLevel) : 1;\n\n    // Use the more restrictive (higher) level\n    const chosenIndex = Math.max(clientIndex, serverIndex);\n    return levels[chosenIndex] as 'debug' | 'info' | 'warn' | 'error';\n  }\n\n  private filterCapabilitiesByVersion(\n    capabilities: MCPCapabilities,\n    version: MCPProtocolVersion,\n  ): MCPCapabilities {\n    const versionInfo = this.getVersionInfo(version);\n    if (!versionInfo) return capabilities;\n\n    const result: MCPCapabilities = {};\n\n    // Only include capabilities supported by this version\n    if (versionInfo.supportedFeatures.includes('logging') && capabilities.logging) {\n      result.logging = capabilities.logging;\n    }\n\n    if (versionInfo.supportedFeatures.includes('tools') && capabilities.tools) {\n      result.tools = capabilities.tools;\n    }\n\n    if (versionInfo.supportedFeatures.includes('resources') && capabilities.resources) {\n      result.resources = capabilities.resources;\n    }\n\n    if (versionInfo.supportedFeatures.includes('prompts') && capabilities.prompts) {\n      result.prompts = capabilities.prompts;\n    }\n\n    return result;\n  }\n\n  private getMissingFeatures(version: MCPProtocolVersion, capabilities: MCPCapabilities): string[] {\n    const versionInfo = this.getVersionInfo(version);\n    if (!versionInfo) return [];\n\n    const missing: string[] = [];\n    const availableFeatures = versionInfo.supportedFeatures;\n\n    // Check what's missing compared to latest version\n    const latestVersion = this.getLatestSupportedVersion();\n    const latestVersionInfo = this.getVersionInfo(latestVersion);\n\n    if (latestVersionInfo) {\n      for (const feature of latestVersionInfo.supportedFeatures) {\n        if (!availableFeatures.includes(feature)) {\n          missing.push(feature);\n        }\n      }\n    }\n\n    return missing;\n  }\n\n  private getDeprecatedFeatures(version: MCPProtocolVersion): string[] {\n    const versionInfo = this.getVersionInfo(version);\n    return versionInfo?.breakingChanges || [];\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
