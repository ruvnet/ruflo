{
  "version": 3,
  "sources": ["../../src/monitoring/diagnostics.ts"],
  "sourcesContent": ["/**\n * Diagnostic Tools for Claude Flow v2.0.0\n */\n\nimport { EventBus } from '../core/event-bus.js';\nimport { Logger } from '../core/logger.js';\nimport { SystemIntegration } from '../integration/system-integration.js';\nimport { HealthCheckManager } from './health-check.js';\nimport type { SystemHealth, SystemMetrics, ComponentStatus } from '../integration/types.js';\nimport { getErrorMessage } from '../utils/error-handler.js';\nimport { promises as fs } from 'fs';\nimport path from 'path';\n\nexport interface DiagnosticReport {\n  timestamp: number;\n  systemHealth: SystemHealth;\n  metrics: SystemMetrics | null;\n  components: ComponentDiagnostic[];\n  performance: PerformanceDiagnostic;\n  recommendations: string[];\n  severity: 'low' | 'medium' | 'high' | 'critical';\n}\n\nexport interface ComponentDiagnostic {\n  name: string;\n  status: 'healthy' | 'warning' | 'unhealthy';\n  version?: string;\n  uptime: number;\n  lastError?: string;\n  metrics?: Record<string, any>;\n  issues: DiagnosticIssue[];\n}\n\nexport interface DiagnosticIssue {\n  type: string;\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  message: string;\n  recommendation?: string;\n  data?: any;\n}\n\nexport interface PerformanceDiagnostic {\n  averageResponseTime: number;\n  throughput: number;\n  errorRate: number;\n  memoryLeaks: boolean;\n  bottlenecks: string[];\n  optimization: string[];\n}\n\nexport interface DiagnosticConfig {\n  enableDetailedAnalysis?: boolean;\n  includePerformanceMetrics?: boolean;\n  generateRecommendations?: boolean;\n  exportFormat?: 'json' | 'html' | 'text';\n  outputPath?: string;\n}\n\nexport class DiagnosticManager {\n  private eventBus: EventBus;\n  private logger: Logger;\n  private systemIntegration: SystemIntegration;\n  private healthCheckManager: HealthCheckManager;\n  private performanceHistory: Map<string, number[]> = new Map();\n  private errorHistory: Map<string, any[]> = new Map();\n\n  constructor(eventBus: EventBus, logger: Logger, healthCheckManager?: HealthCheckManager) {\n    this.eventBus = eventBus;\n    this.logger = logger;\n    this.systemIntegration = SystemIntegration.getInstance();\n    this.healthCheckManager = healthCheckManager || new HealthCheckManager(eventBus, logger);\n\n    this.setupEventHandlers();\n  }\n\n  /**\n   * Generate comprehensive diagnostic report\n   */\n  async generateDiagnosticReport(config: DiagnosticConfig = {}): Promise<DiagnosticReport> {\n    this.logger.info('Generating comprehensive diagnostic report');\n\n    const startTime = Date.now();\n\n    try {\n      // Get system health\n      const systemHealth = await this.systemIntegration.getSystemHealth();\n\n      // Get current metrics\n      const metrics = this.healthCheckManager.getCurrentMetrics();\n\n      // Analyze components\n      const components = await this.analyzeComponents(config);\n\n      // Analyze performance\n      const performance = await this.analyzePerformance(config);\n\n      // Generate recommendations\n      const recommendations =\n        config.generateRecommendations !== false\n          ? this.generateRecommendations(systemHealth, performance, components)\n          : [];\n\n      // Determine overall severity\n      const severity = this.calculateSeverity(systemHealth, components);\n\n      const report: DiagnosticReport = {\n        timestamp: Date.now(),\n        systemHealth,\n        metrics,\n        components,\n        performance,\n        recommendations,\n        severity,\n      };\n\n      // Export report if requested\n      if (config.outputPath) {\n        await this.exportReport(report, config);\n      }\n\n      const duration = Date.now() - startTime;\n      this.logger.info(`Diagnostic report generated in ${duration}ms`);\n\n      this.eventBus.emit('diagnostics:report:generated', {\n        report,\n        duration,\n        timestamp: Date.now(),\n      });\n\n      return report;\n    } catch (error) {\n      this.logger.error('Failed to generate diagnostic report:', getErrorMessage(error));\n      throw error;\n    }\n  }\n\n  /**\n   * Analyze individual components\n   */\n  private async analyzeComponents(config: DiagnosticConfig): Promise<ComponentDiagnostic[]> {\n    const componentNames = [\n      'orchestrator',\n      'configManager',\n      'memoryManager',\n      'agentManager',\n      'swarmCoordinator',\n      'taskEngine',\n      'monitor',\n      'mcpServer',\n    ];\n\n    const diagnostics = await Promise.all(\n      componentNames.map((name) => this.analyzeComponent(name, config)),\n    );\n\n    return diagnostics.filter((d) => d !== null) as ComponentDiagnostic[];\n  }\n\n  /**\n   * Analyze individual component\n   */\n  private async analyzeComponent(\n    componentName: string,\n    config: DiagnosticConfig,\n  ): Promise<ComponentDiagnostic | null> {\n    try {\n      const component = this.systemIntegration.getComponent(componentName);\n\n      if (!component) {\n        return {\n          name: componentName,\n          status: 'unhealthy',\n          uptime: 0,\n          issues: [\n            {\n              type: 'missing_component',\n              severity: 'critical',\n              message: 'Component is not available',\n              recommendation: 'Check component initialization',\n            },\n          ],\n        };\n      }\n\n      const issues: DiagnosticIssue[] = [];\n      let status: 'healthy' | 'warning' | 'unhealthy' = 'healthy';\n\n      // Check component health history\n      const healthHistory = this.healthCheckManager.getHealthHistory(componentName);\n      const recentChecks = healthHistory.slice(-10); // Last 10 checks\n      const failureRate =\n        recentChecks.filter((check) => !check.healthy).length / recentChecks.length;\n\n      if (failureRate > 0.5) {\n        status = 'unhealthy';\n        issues.push({\n          type: 'high_failure_rate',\n          severity: 'high',\n          message: `High failure rate: ${(failureRate * 100).toFixed(1)}%`,\n          recommendation: 'Investigate component stability',\n        });\n      } else if (failureRate > 0.2) {\n        status = 'warning';\n        issues.push({\n          type: 'moderate_failure_rate',\n          severity: 'medium',\n          message: `Moderate failure rate: ${(failureRate * 100).toFixed(1)}%`,\n          recommendation: 'Monitor component health',\n        });\n      }\n\n      // Check for performance issues\n      if (config.includePerformanceMetrics !== false) {\n        const performanceIssues = this.analyzeComponentPerformance(componentName);\n        issues.push(...performanceIssues);\n      }\n\n      // Check for memory leaks\n      const memoryIssues = this.checkMemoryLeaks(componentName);\n      issues.push(...memoryIssues);\n\n      // Get component metrics\n      let componentMetrics: Record<string, any> = {};\n      if (typeof component.getMetrics === 'function') {\n        componentMetrics = await component.getMetrics();\n      }\n\n      // Get last error\n      const lastError = this.getLastError(componentName);\n\n      return {\n        name: componentName,\n        status,\n        uptime: this.getComponentUptime(componentName),\n        lastError,\n        metrics: componentMetrics,\n        issues,\n      };\n    } catch (error) {\n      return {\n        name: componentName,\n        status: 'unhealthy',\n        uptime: 0,\n        lastError: getErrorMessage(error),\n        issues: [\n          {\n            type: 'analysis_error',\n            severity: 'medium',\n            message: `Failed to analyze component: ${getErrorMessage(error)}`,\n            recommendation: 'Check component accessibility',\n          },\n        ],\n      };\n    }\n  }\n\n  /**\n   * Analyze system performance\n   */\n  private async analyzePerformance(config: DiagnosticConfig): Promise<PerformanceDiagnostic> {\n    const metrics = this.healthCheckManager.getCurrentMetrics();\n    const bottlenecks: string[] = [];\n    const optimization: string[] = [];\n\n    // Calculate averages from history\n    const responseTimeHistory = this.performanceHistory.get('responseTime') || [];\n    const averageResponseTime =\n      responseTimeHistory.length > 0\n        ? responseTimeHistory.reduce((sum, time) => sum + time, 0) / responseTimeHistory.length\n        : 0;\n\n    // Calculate throughput\n    const throughput = this.calculateThroughput();\n\n    // Calculate error rate\n    const errorRate = this.calculateErrorRate();\n\n    // Check for memory leaks\n    const memoryLeaks = this.detectMemoryLeaks();\n\n    // Identify bottlenecks\n    if (metrics) {\n      if (metrics.cpu > 80) {\n        bottlenecks.push('High CPU usage');\n        optimization.push('Consider distributing load across more workers');\n      }\n\n      if (metrics.memory > 80) {\n        bottlenecks.push('High memory usage');\n        optimization.push('Implement memory optimization strategies');\n      }\n\n      if (metrics.queuedTasks > metrics.activeTasks * 2) {\n        bottlenecks.push('Task queue buildup');\n        optimization.push('Increase task processing capacity');\n      }\n\n      if (errorRate > 0.05) {\n        bottlenecks.push('High error rate');\n        optimization.push('Investigate and fix recurring errors');\n      }\n    }\n\n    if (averageResponseTime > 1000) {\n      bottlenecks.push('Slow response times');\n      optimization.push('Optimize critical path operations');\n    }\n\n    return {\n      averageResponseTime,\n      throughput,\n      errorRate,\n      memoryLeaks,\n      bottlenecks,\n      optimization,\n    };\n  }\n\n  /**\n   * Generate recommendations based on analysis\n   */\n  private generateRecommendations(\n    health: SystemHealth,\n    performance: PerformanceDiagnostic,\n    components: ComponentDiagnostic[],\n  ): string[] {\n    const recommendations: string[] = [];\n\n    // System-level recommendations\n    if (health.overall === 'unhealthy') {\n      recommendations.push('System health is compromised - immediate attention required');\n    } else if (health.overall === 'warning') {\n      recommendations.push('System showing warning signs - proactive maintenance recommended');\n    }\n\n    // Performance recommendations\n    if (performance.averageResponseTime > 1000) {\n      recommendations.push('Response times are slow - consider performance optimization');\n    }\n\n    if (performance.errorRate > 0.05) {\n      recommendations.push('Error rate is high - investigate error sources');\n    }\n\n    if (performance.memoryLeaks) {\n      recommendations.push('Memory leaks detected - review memory management');\n    }\n\n    // Component-specific recommendations\n    const unhealthyComponents = components.filter((c) => c.status === 'unhealthy');\n    if (unhealthyComponents.length > 0) {\n      recommendations.push(\n        `${unhealthyComponents.length} component(s) unhealthy - restart or investigate`,\n      );\n    }\n\n    const highFailureComponents = components.filter((c) =>\n      c.issues.some((issue) => issue.type === 'high_failure_rate'),\n    );\n    if (highFailureComponents.length > 0) {\n      recommendations.push('Some components have high failure rates - check logs and dependencies');\n    }\n\n    // Add performance optimizations\n    recommendations.push(...performance.optimization);\n\n    // General recommendations\n    if (recommendations.length === 0) {\n      recommendations.push('System appears healthy - continue regular monitoring');\n    }\n\n    return recommendations;\n  }\n\n  /**\n   * Calculate overall severity\n   */\n  private calculateSeverity(\n    health: SystemHealth,\n    components: ComponentDiagnostic[],\n  ): 'low' | 'medium' | 'high' | 'critical' {\n    if (health.overall === 'unhealthy') {\n      return 'critical';\n    }\n\n    const criticalIssues = components.reduce(\n      (count, component) =>\n        count + component.issues.filter((issue) => issue.severity === 'critical').length,\n      0,\n    );\n\n    const highIssues = components.reduce(\n      (count, component) =>\n        count + component.issues.filter((issue) => issue.severity === 'high').length,\n      0,\n    );\n\n    if (criticalIssues > 0) {\n      return 'critical';\n    }\n\n    if (highIssues > 2) {\n      return 'high';\n    }\n\n    if (health.overall === 'warning' || highIssues > 0) {\n      return 'medium';\n    }\n\n    return 'low';\n  }\n\n  /**\n   * Export diagnostic report\n   */\n  private async exportReport(report: DiagnosticReport, config: DiagnosticConfig): Promise<void> {\n    const format = config.exportFormat || 'json';\n    const outputPath = config.outputPath!;\n\n    try {\n      let content: string;\n\n      switch (format) {\n        case 'json':\n          content = JSON.stringify(report, null, 2);\n          break;\n        case 'html':\n          content = this.generateHtmlReport(report);\n          break;\n        case 'text':\n          content = this.generateTextReport(report);\n          break;\n        default:\n          throw new Error(`Unsupported export format: ${format}`);\n      }\n\n      await fs.writeFile(outputPath, content, 'utf8');\n      this.logger.info(`Diagnostic report exported to: ${outputPath}`);\n    } catch (error) {\n      this.logger.error('Failed to export report:', getErrorMessage(error));\n      throw error;\n    }\n  }\n\n  /**\n   * Generate HTML report\n   */\n  private generateHtmlReport(report: DiagnosticReport): string {\n    const timestamp = new Date(report.timestamp).toISOString();\n    const severityColor = {\n      low: '#28a745',\n      medium: '#ffc107',\n      high: '#fd7e14',\n      critical: '#dc3545',\n    }[report.severity];\n\n    return `\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Claude Flow v2.0.0 Diagnostic Report</title>\n    <style>\n        body { font-family: Arial, sans-serif; margin: 40px; }\n        .header { border-bottom: 2px solid #ccc; padding-bottom: 20px; }\n        .severity { color: ${severityColor}; font-weight: bold; }\n        .section { margin: 20px 0; }\n        .component { margin: 10px 0; padding: 10px; border: 1px solid #ddd; }\n        .healthy { border-left: 4px solid #28a745; }\n        .warning { border-left: 4px solid #ffc107; }\n        .unhealthy { border-left: 4px solid #dc3545; }\n        .issue { margin: 5px 0; padding: 5px; background: #f8f9fa; }\n        .critical { background: #f8d7da; }\n        .high { background: #fff3cd; }\n        .medium { background: #cce5ff; }\n        .low { background: #d1ecf1; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>Claude Flow v2.0.0 Diagnostic Report</h1>\n        <p><strong>Generated:</strong> ${timestamp}</p>\n        <p><strong>Severity:</strong> <span class=\"severity\">${report.severity.toUpperCase()}</span></p>\n    </div>\n\n    <div class=\"section\">\n        <h2>System Health</h2>\n        <p><strong>Overall Status:</strong> ${report.systemHealth.overall}</p>\n        <p><strong>Total Components:</strong> ${report.systemHealth.metrics.totalComponents}</p>\n        <p><strong>Healthy:</strong> ${report.systemHealth.metrics.healthyComponents}</p>\n        <p><strong>Unhealthy:</strong> ${report.systemHealth.metrics.unhealthyComponents}</p>\n        <p><strong>Uptime:</strong> ${(report.systemHealth.metrics.uptime / 1000 / 60).toFixed(1)} minutes</p>\n    </div>\n\n    <div class=\"section\">\n        <h2>Components</h2>\n        ${report.components\n          .map(\n            (component) => `\n            <div class=\"component ${component.status}\">\n                <h3>${component.name}</h3>\n                <p><strong>Status:</strong> ${component.status}</p>\n                <p><strong>Uptime:</strong> ${(component.uptime / 1000 / 60).toFixed(1)} minutes</p>\n                ${component.lastError ? `<p><strong>Last Error:</strong> ${component.lastError}</p>` : ''}\n                ${\n                  component.issues.length > 0\n                    ? `\n                    <h4>Issues:</h4>\n                    ${component.issues\n                      .map(\n                        (issue) => `\n                        <div class=\"issue ${issue.severity}\">\n                            <strong>${issue.type}:</strong> ${issue.message}\n                            ${issue.recommendation ? `<br><em>Recommendation: ${issue.recommendation}</em>` : ''}\n                        </div>\n                    `,\n                      )\n                      .join('')}\n                `\n                    : '<p>No issues detected</p>'\n                }\n            </div>\n        `,\n          )\n          .join('')}\n    </div>\n\n    <div class=\"section\">\n        <h2>Performance</h2>\n        <p><strong>Average Response Time:</strong> ${report.performance.averageResponseTime.toFixed(2)}ms</p>\n        <p><strong>Throughput:</strong> ${report.performance.throughput.toFixed(2)} ops/sec</p>\n        <p><strong>Error Rate:</strong> ${(report.performance.errorRate * 100).toFixed(2)}%</p>\n        <p><strong>Memory Leaks:</strong> ${report.performance.memoryLeaks ? 'Detected' : 'None detected'}</p>\n        \n        ${\n          report.performance.bottlenecks.length > 0\n            ? `\n            <h3>Bottlenecks:</h3>\n            <ul>${report.performance.bottlenecks.map((b) => `<li>${b}</li>`).join('')}</ul>\n        `\n            : ''\n        }\n    </div>\n\n    <div class=\"section\">\n        <h2>Recommendations</h2>\n        <ol>\n            ${report.recommendations.map((rec) => `<li>${rec}</li>`).join('')}\n        </ol>\n    </div>\n</body>\n</html>`;\n  }\n\n  /**\n   * Generate text report\n   */\n  private generateTextReport(report: DiagnosticReport): string {\n    const timestamp = new Date(report.timestamp).toISOString();\n\n    let text = `\nCLAUDE FLOW v2.0.0 DIAGNOSTIC REPORT\n=====================================\n\nGenerated: ${timestamp}\nSeverity: ${report.severity.toUpperCase()}\n\nSYSTEM HEALTH\n-------------\nOverall Status: ${report.systemHealth.overall}\nTotal Components: ${report.systemHealth.metrics.totalComponents}\nHealthy: ${report.systemHealth.metrics.healthyComponents}\nUnhealthy: ${report.systemHealth.metrics.unhealthyComponents}\nUptime: ${(report.systemHealth.metrics.uptime / 1000 / 60).toFixed(1)} minutes\n\nCOMPONENTS\n----------\n`;\n\n    report.components.forEach((component) => {\n      text += `\n${component.name}\n  Status: ${component.status}\n  Uptime: ${(component.uptime / 1000 / 60).toFixed(1)} minutes\n`;\n      if (component.lastError) {\n        text += `  Last Error: ${component.lastError}\\n`;\n      }\n\n      if (component.issues.length > 0) {\n        text += `  Issues:\\n`;\n        component.issues.forEach((issue) => {\n          text += `    - ${issue.type}: ${issue.message}\\n`;\n          if (issue.recommendation) {\n            text += `      Recommendation: ${issue.recommendation}\\n`;\n          }\n        });\n      }\n    });\n\n    text += `\nPERFORMANCE\n-----------\nAverage Response Time: ${report.performance.averageResponseTime.toFixed(2)}ms\nThroughput: ${report.performance.throughput.toFixed(2)} ops/sec\nError Rate: ${(report.performance.errorRate * 100).toFixed(2)}%\nMemory Leaks: ${report.performance.memoryLeaks ? 'Detected' : 'None detected'}\n`;\n\n    if (report.performance.bottlenecks.length > 0) {\n      text += `\\nBottlenecks:\\n`;\n      report.performance.bottlenecks.forEach((bottleneck) => {\n        text += `  - ${bottleneck}\\n`;\n      });\n    }\n\n    text += `\nRECOMMENDATIONS\n---------------\n`;\n    report.recommendations.forEach((rec, index) => {\n      text += `${index + 1}. ${rec}\\n`;\n    });\n\n    return text;\n  }\n\n  // Helper methods for analysis\n  private analyzeComponentPerformance(componentName: string): DiagnosticIssue[] {\n    // Placeholder implementation\n    return [];\n  }\n\n  private checkMemoryLeaks(componentName: string): DiagnosticIssue[] {\n    // Placeholder implementation\n    return [];\n  }\n\n  private getLastError(componentName: string): string | undefined {\n    const errors = this.errorHistory.get(componentName);\n    return errors && errors.length > 0 ? errors[errors.length - 1]?.message : undefined;\n  }\n\n  private getComponentUptime(componentName: string): number {\n    // Placeholder implementation\n    return process.uptime() * 1000;\n  }\n\n  private calculateThroughput(): number {\n    // Placeholder implementation\n    return 100; // ops/sec\n  }\n\n  private calculateErrorRate(): number {\n    // Placeholder implementation\n    return 0.01; // 1%\n  }\n\n  private detectMemoryLeaks(): boolean {\n    // Placeholder implementation\n    return false;\n  }\n\n  private setupEventHandlers(): void {\n    // Track performance metrics\n    this.eventBus.on('performance:metric', (metric) => {\n      if (!this.performanceHistory.has(metric.name)) {\n        this.performanceHistory.set(metric.name, []);\n      }\n\n      const history = this.performanceHistory.get(metric.name)!;\n      history.push(metric.value);\n\n      // Keep only last 100 measurements\n      if (history.length > 100) {\n        history.shift();\n      }\n    });\n\n    // Track errors\n    this.eventBus.on('system:error', (error) => {\n      const component = error.component || 'system';\n\n      if (!this.errorHistory.has(component)) {\n        this.errorHistory.set(component, []);\n      }\n\n      const history = this.errorHistory.get(component)!;\n      history.push({\n        message: error.message || error.error,\n        timestamp: Date.now(),\n        stack: error.stack,\n      });\n\n      // Keep only last 50 errors per component\n      if (history.length > 50) {\n        history.shift();\n      }\n    });\n  }\n\n  /**\n   * Run quick diagnostic check\n   */\n  async quickDiagnostic(): Promise<{\n    status: string;\n    issues: number;\n    recommendations: string[];\n  }> {\n    const health = await this.systemIntegration.getSystemHealth();\n    const components = await this.analyzeComponents({ enableDetailedAnalysis: false });\n\n    const issues = components.reduce((count, comp) => count + comp.issues.length, 0);\n    const recommendations = this.generateRecommendations(\n      health,\n      {\n        averageResponseTime: 0,\n        throughput: 0,\n        errorRate: 0,\n        memoryLeaks: false,\n        bottlenecks: [],\n        optimization: [],\n      },\n      components,\n    ).slice(0, 3); // Top 3 recommendations\n\n    return {\n      status: health.overall,\n      issues,\n      recommendations,\n    };\n  }\n}\n"],
  "mappings": "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",
  "names": ["fs"]
}
