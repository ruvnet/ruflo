{"version":3,"sources":["../../../../../src/cli/commands/hive-mind/wizard.ts"],"sourcesContent":["#!/usr/bin/env node\r\n/**\r\n * Hive Mind Interactive Wizard\r\n *\r\n * Interactive setup and management wizard for Hive Mind swarms\r\n * with guided workflows and visual feedback.\r\n */\r\n\r\nimport { Command } from '../commander-fix.js';\r\nimport chalk from 'chalk';\r\nimport inquirer from 'inquirer';\r\nimport figlet from 'figlet';\r\nimport gradient from 'gradient-string';\r\nimport { HiveMind } from '../../../hive-mind/core/HiveMind.js';\r\nimport { DatabaseManager } from '../../../hive-mind/core/DatabaseManager.js';\r\nimport { formatSuccess, formatError, formatInfo, formatWarning } from '../../formatter.js';\r\n\r\ntype WizardAction =\r\n  | 'create_swarm'\r\n  | 'manage_agents'\r\n  | 'submit_task'\r\n  | 'view_status'\r\n  | 'configure_memory'\r\n  | 'run_simulation'\r\n  | 'export_data'\r\n  | 'switch_swarm'\r\n  | 'exit';\r\n\r\nexport const wizardCommand = new Command('wizard')\r\n  .description('Interactive Hive Mind setup and management wizard')\r\n  .option('--skip-intro', 'Skip the intro animation', false)\r\n  .action(async (options) => {\r\n    try {\r\n      // Show intro\r\n      if (!options.skipIntro) {\r\n        await showIntro();\r\n      }\r\n\r\n      // Main wizard loop\r\n      let exit = false;\r\n      while (!exit) {\r\n        const action = await selectAction();\r\n\r\n        switch (action) {\r\n          case 'create_swarm':\r\n            await createSwarmWizard();\r\n            break;\r\n          case 'manage_agents':\r\n            await manageAgentsWizard();\r\n            break;\r\n          case 'submit_task':\r\n            await submitTaskWizard();\r\n            break;\r\n          case 'view_status':\r\n            await viewStatusWizard();\r\n            break;\r\n          case 'configure_memory':\r\n            await configureMemoryWizard();\r\n            break;\r\n          case 'run_simulation':\r\n            await runSimulationWizard();\r\n            break;\r\n          case 'export_data':\r\n            await exportDataWizard();\r\n            break;\r\n          case 'switch_swarm':\r\n            await switchSwarmWizard();\r\n            break;\r\n          case 'exit':\r\n            exit = true;\r\n            break;\r\n        }\r\n\r\n        if (!exit) {\r\n          await inquirer\r\n            .prompt([\r\n              {\r\n                type: 'confirm',\r\n                name: 'continue',\r\n                message: 'Continue with another action?',\r\n                default: true,\r\n              },\r\n            ])\r\n            .then((answers) => {\r\n              exit = !answers.continue;\r\n            });\r\n        }\r\n      }\r\n\r\n      console.log('\\n' + chalk.bold.yellow('ðŸ‘‹ Thank you for using Hive Mind!'));\r\n    } catch (error) {\r\n      console.error(formatError('Wizard error: ' + (error as Error).message));\r\n      process.exit(1);\r\n    }\r\n  });\r\n\r\nasync function showIntro() {\r\n  console.clear();\r\n  const title = figlet.textSync('Hive Mind', {\r\n    font: 'Big',\r\n    horizontalLayout: 'default',\r\n    verticalLayout: 'default',\r\n  });\r\n\r\n  console.log(gradient.rainbow(title));\r\n  console.log(chalk.bold.yellow('\\nðŸ Welcome to the Hive Mind Interactive Wizard! ðŸ\\n'));\r\n  console.log(chalk.gray('Collective intelligence for autonomous task orchestration\\n'));\r\n\r\n  await new Promise((resolve) => setTimeout(resolve, 2000));\r\n}\r\n\r\nasync function selectAction(): Promise<WizardAction> {\r\n  const db = await DatabaseManager.getInstance();\r\n  const activeSwarm = await db.getActiveSwarmId();\r\n\r\n  console.log('\\n' + chalk.bold('ðŸŽ¯ What would you like to do?'));\r\n  if (activeSwarm) {\r\n    console.log(chalk.gray(`Active swarm: ${activeSwarm}`));\r\n  }\r\n\r\n  const { action } = await inquirer.prompt([\r\n    {\r\n      type: 'list',\r\n      name: 'action',\r\n      message: 'Select an action:',\r\n      choices: [\r\n        { name: 'ðŸ†• Create New Swarm', value: 'create_swarm' },\r\n        { name: 'ðŸ¤– Manage Agents', value: 'manage_agents', disabled: !activeSwarm },\r\n        { name: 'ðŸ“‹ Submit Task', value: 'submit_task', disabled: !activeSwarm },\r\n        { name: 'ðŸ“Š View Status', value: 'view_status', disabled: !activeSwarm },\r\n        { name: 'ðŸ’¾ Configure Memory', value: 'configure_memory', disabled: !activeSwarm },\r\n        { name: 'ðŸŽ® Run Simulation', value: 'run_simulation', disabled: !activeSwarm },\r\n        { name: 'ðŸ“¤ Export Data', value: 'export_data', disabled: !activeSwarm },\r\n        { name: 'ðŸ”„ Switch Swarm', value: 'switch_swarm' },\r\n        new inquirer.Separator(),\r\n        { name: 'ðŸšª Exit', value: 'exit' },\r\n      ],\r\n    },\r\n  ]);\r\n\r\n  return action;\r\n}\r\n\r\nasync function createSwarmWizard() {\r\n  console.log('\\n' + chalk.bold('ðŸ†• Create New Hive Mind Swarm'));\r\n\r\n  const answers = await inquirer.prompt([\r\n    {\r\n      type: 'input',\r\n      name: 'name',\r\n      message: 'Swarm name:',\r\n      default: `hive-mind-${Date.now()}`,\r\n      validate: (input) => input.length > 0 || 'Name is required',\r\n    },\r\n    {\r\n      type: 'list',\r\n      name: 'topology',\r\n      message: 'Select swarm topology:',\r\n      choices: [\r\n        { name: 'ðŸ›ï¸ Hierarchical - Queen-led with clear command structure', value: 'hierarchical' },\r\n        { name: 'ðŸ•¸ï¸ Mesh - Fully connected peer-to-peer network', value: 'mesh' },\r\n        { name: 'ðŸ”„ Ring - Circular communication pattern', value: 'ring' },\r\n        { name: 'â­ Star - Central hub with radiating connections', value: 'star' },\r\n      ],\r\n    },\r\n    {\r\n      type: 'list',\r\n      name: 'queenMode',\r\n      message: 'Queen coordination mode:',\r\n      choices: [\r\n        { name: 'ðŸ‘‘ Centralized - Single Queen controls all decisions', value: 'centralized' },\r\n        { name: 'ðŸ¤ Distributed - Multiple Queens share leadership', value: 'distributed' },\r\n      ],\r\n    },\r\n    {\r\n      type: 'number',\r\n      name: 'maxAgents',\r\n      message: 'Maximum number of agents:',\r\n      default: 8,\r\n      validate: (input) => (input > 0 && input <= 100) || 'Must be between 1 and 100',\r\n    },\r\n    {\r\n      type: 'number',\r\n      name: 'consensusThreshold',\r\n      message: 'Consensus threshold (0.5 - 1.0):',\r\n      default: 0.66,\r\n      validate: (input) => (input >= 0.5 && input <= 1.0) || 'Must be between 0.5 and 1.0',\r\n    },\r\n    {\r\n      type: 'confirm',\r\n      name: 'autoSpawn',\r\n      message: 'Auto-spawn initial agents?',\r\n      default: true,\r\n    },\r\n  ]);\r\n\r\n  // Advanced options\r\n  const { showAdvanced } = await inquirer.prompt([\r\n    {\r\n      type: 'confirm',\r\n      name: 'showAdvanced',\r\n      message: 'Configure advanced options?',\r\n      default: false,\r\n    },\r\n  ]);\r\n\r\n  if (showAdvanced) {\r\n    const advanced = await inquirer.prompt([\r\n      {\r\n        type: 'number',\r\n        name: 'memoryTTL',\r\n        message: 'Default memory TTL (seconds):',\r\n        default: 86400,\r\n      },\r\n      {\r\n        type: 'checkbox',\r\n        name: 'enabledFeatures',\r\n        message: 'Enable features:',\r\n        choices: [\r\n          { name: 'Neural Learning', value: 'neural', checked: true },\r\n          { name: 'Performance Monitoring', value: 'monitoring', checked: true },\r\n          { name: 'Auto-scaling', value: 'autoscale', checked: false },\r\n          { name: 'Fault Tolerance', value: 'faultTolerance', checked: true },\r\n          { name: 'Predictive Task Assignment', value: 'predictive', checked: false },\r\n        ],\r\n      },\r\n    ]);\r\n\r\n    Object.assign(answers, advanced);\r\n  }\r\n\r\n  // Create swarm\r\n  const spinner = require('ora')('Creating Hive Mind swarm...').start();\r\n\r\n  try {\r\n    const hiveMind = new HiveMind({\r\n      name: answers.name,\r\n      topology: answers.topology,\r\n      maxAgents: answers.maxAgents,\r\n      queenMode: answers.queenMode,\r\n      memoryTTL: answers.memoryTTL || 86400,\r\n      consensusThreshold: answers.consensusThreshold,\r\n      autoSpawn: answers.autoSpawn,\r\n      enabledFeatures: answers.enabledFeatures || ['neural', 'monitoring', 'faultTolerance'],\r\n      createdAt: new Date(),\r\n    });\r\n\r\n    const swarmId = await hiveMind.initialize();\r\n\r\n    spinner.succeed(formatSuccess('Hive Mind created successfully!'));\r\n    console.log(formatInfo(`Swarm ID: ${swarmId}`));\r\n\r\n    if (answers.autoSpawn) {\r\n      const agents = await hiveMind.autoSpawnAgents();\r\n      console.log(formatSuccess(`Spawned ${agents.length} initial agents`));\r\n    }\r\n  } catch (error) {\r\n    spinner.fail(formatError('Failed to create swarm'));\r\n    throw error;\r\n  }\r\n}\r\n\r\nasync function manageAgentsWizard() {\r\n  console.log('\\n' + chalk.bold('ðŸ¤– Manage Agents'));\r\n\r\n  const { action } = await inquirer.prompt([\r\n    {\r\n      type: 'list',\r\n      name: 'action',\r\n      message: 'What would you like to do?',\r\n      choices: [\r\n        { name: 'âž• Spawn New Agent', value: 'spawn' },\r\n        { name: 'ðŸ“Š View Agent List', value: 'list' },\r\n        { name: 'ðŸ”§ Modify Agent', value: 'modify' },\r\n        { name: 'ðŸ—‘ï¸ Remove Agent', value: 'remove' },\r\n        { name: 'ðŸ”„ Rebalance Agents', value: 'rebalance' },\r\n      ],\r\n    },\r\n  ]);\r\n\r\n  const db = await DatabaseManager.getInstance();\r\n  const swarmId = await db.getActiveSwarmId();\r\n  const hiveMind = await HiveMind.load(swarmId!);\r\n\r\n  switch (action) {\r\n    case 'spawn':\r\n      await spawnAgentInteractive(hiveMind);\r\n      break;\r\n    case 'list':\r\n      await listAgentsInteractive(hiveMind);\r\n      break;\r\n    case 'modify':\r\n      await modifyAgentInteractive(hiveMind);\r\n      break;\r\n    case 'remove':\r\n      await removeAgentInteractive(hiveMind);\r\n      break;\r\n    case 'rebalance':\r\n      await rebalanceAgentsInteractive(hiveMind);\r\n      break;\r\n  }\r\n}\r\n\r\nasync function spawnAgentInteractive(hiveMind: HiveMind) {\r\n  const agentTypes = [\r\n    { name: 'ðŸŽ¯ Coordinator - Task management and delegation', value: 'coordinator' },\r\n    { name: 'ðŸ”¬ Researcher - Information gathering and analysis', value: 'researcher' },\r\n    { name: 'ðŸ’» Coder - Code generation and implementation', value: 'coder' },\r\n    { name: 'ðŸ“Š Analyst - Data analysis and insights', value: 'analyst' },\r\n    { name: 'ðŸ—ï¸ Architect - System design and planning', value: 'architect' },\r\n    { name: 'ðŸ§ª Tester - Quality assurance and testing', value: 'tester' },\r\n    { name: 'ðŸ‘ï¸ Reviewer - Code and design review', value: 'reviewer' },\r\n    { name: 'âš¡ Optimizer - Performance optimization', value: 'optimizer' },\r\n    { name: 'ðŸ“ Documenter - Documentation generation', value: 'documenter' },\r\n    { name: 'ðŸ“¡ Monitor - System monitoring and alerts', value: 'monitor' },\r\n    { name: 'ðŸŽ¨ Specialist - Custom specialized agent', value: 'specialist' },\r\n  ];\r\n\r\n  const answers = await inquirer.prompt([\r\n    {\r\n      type: 'list',\r\n      name: 'type',\r\n      message: 'Select agent type:',\r\n      choices: agentTypes,\r\n    },\r\n    {\r\n      type: 'input',\r\n      name: 'name',\r\n      message: 'Agent name (optional):',\r\n      default: (answers: any) => `${answers.type}-${Date.now()}`,\r\n    },\r\n    {\r\n      type: 'number',\r\n      name: 'count',\r\n      message: 'How many agents to spawn?',\r\n      default: 1,\r\n      validate: (input) => (input > 0 && input <= 10) || 'Must be between 1 and 10',\r\n    },\r\n  ]);\r\n\r\n  const spinner = require('ora')(`Spawning ${answers.count} ${answers.type} agent(s)...`).start();\r\n\r\n  try {\r\n    const agents = [];\r\n    for (let i = 0; i < answers.count; i++) {\r\n      const agent = await hiveMind.spawnAgent({\r\n        type: answers.type,\r\n        name: answers.count > 1 ? `${answers.name}-${i}` : answers.name,\r\n      });\r\n      agents.push(agent);\r\n    }\r\n\r\n    spinner.succeed(formatSuccess(`Spawned ${agents.length} agent(s) successfully!`));\r\n  } catch (error) {\r\n    spinner.fail(formatError('Failed to spawn agents'));\r\n    throw error;\r\n  }\r\n}\r\n\r\nasync function submitTaskWizard() {\r\n  console.log('\\n' + chalk.bold('ðŸ“‹ Submit Task to Hive Mind'));\r\n\r\n  const db = await DatabaseManager.getInstance();\r\n  const swarmId = await db.getActiveSwarmId();\r\n  const hiveMind = await HiveMind.load(swarmId!);\r\n\r\n  const templates = [\r\n    { name: 'ðŸ” Research Task', value: 'research' },\r\n    { name: 'ðŸ’» Development Task', value: 'development' },\r\n    { name: 'ðŸ“Š Analysis Task', value: 'analysis' },\r\n    { name: 'ðŸ§ª Testing Task', value: 'testing' },\r\n    { name: 'ðŸ“ Documentation Task', value: 'documentation' },\r\n    { name: 'âœï¸ Custom Task', value: 'custom' },\r\n  ];\r\n\r\n  const { template } = await inquirer.prompt([\r\n    {\r\n      type: 'list',\r\n      name: 'template',\r\n      message: 'Select task template:',\r\n      choices: templates,\r\n    },\r\n  ]);\r\n\r\n  let taskDescription = '';\r\n  const taskConfig: any = {};\r\n\r\n  if (template === 'custom') {\r\n    const answers = await inquirer.prompt([\r\n      {\r\n        type: 'editor',\r\n        name: 'description',\r\n        message: 'Enter task description:',\r\n      },\r\n    ]);\r\n    taskDescription = answers.description;\r\n  } else {\r\n    // Use predefined templates\r\n    const templates = {\r\n      research: {\r\n        prompt: 'What would you like to research?',\r\n        prefix: 'Research and analyze: ',\r\n      },\r\n      development: {\r\n        prompt: 'What would you like to develop?',\r\n        prefix: 'Develop and implement: ',\r\n      },\r\n      analysis: {\r\n        prompt: 'What would you like to analyze?',\r\n        prefix: 'Analyze and provide insights on: ',\r\n      },\r\n      testing: {\r\n        prompt: 'What would you like to test?',\r\n        prefix: 'Test and validate: ',\r\n      },\r\n      documentation: {\r\n        prompt: 'What would you like to document?',\r\n        prefix: 'Create documentation for: ',\r\n      },\r\n    };\r\n\r\n    const tmpl = templates[template as keyof typeof templates];\r\n    const { detail } = await inquirer.prompt([\r\n      {\r\n        type: 'input',\r\n        name: 'detail',\r\n        message: tmpl.prompt,\r\n      },\r\n    ]);\r\n\r\n    taskDescription = tmpl.prefix + detail;\r\n  }\r\n\r\n  // Task configuration\r\n  const config = await inquirer.prompt([\r\n    {\r\n      type: 'list',\r\n      name: 'priority',\r\n      message: 'Task priority:',\r\n      choices: [\r\n        { name: 'ðŸŸ¢ Low', value: 'low' },\r\n        { name: 'ðŸŸ¡ Medium', value: 'medium' },\r\n        { name: 'ðŸŸ  High', value: 'high' },\r\n        { name: 'ðŸ”´ Critical', value: 'critical' },\r\n      ],\r\n      default: 'medium',\r\n    },\r\n    {\r\n      type: 'list',\r\n      name: 'strategy',\r\n      message: 'Execution strategy:',\r\n      choices: [\r\n        { name: 'ðŸ¤– Adaptive (AI-optimized)', value: 'adaptive' },\r\n        { name: 'âš¡ Parallel (Multiple agents)', value: 'parallel' },\r\n        { name: 'ðŸ“ Sequential (Step-by-step)', value: 'sequential' },\r\n        { name: 'ðŸ¤ Consensus (Requires agreement)', value: 'consensus' },\r\n      ],\r\n      default: 'adaptive',\r\n    },\r\n    {\r\n      type: 'confirm',\r\n      name: 'monitor',\r\n      message: 'Monitor task progress?',\r\n      default: true,\r\n    },\r\n  ]);\r\n\r\n  const spinner = require('ora')('Submitting task...').start();\r\n\r\n  try {\r\n    const task = await hiveMind.submitTask({\r\n      description: taskDescription,\r\n      priority: config.priority,\r\n      strategy: config.strategy,\r\n    });\r\n\r\n    spinner.succeed(formatSuccess('Task submitted successfully!'));\r\n    console.log(formatInfo(`Task ID: ${task.id}`));\r\n\r\n    if (config.monitor) {\r\n      console.log('\\n' + chalk.bold('Monitoring task progress...'));\r\n      // TODO: Implement real-time monitoring\r\n    }\r\n  } catch (error) {\r\n    spinner.fail(formatError('Failed to submit task'));\r\n    throw error;\r\n  }\r\n}\r\n\r\nasync function viewStatusWizard() {\r\n  const { view } = await inquirer.prompt([\r\n    {\r\n      type: 'list',\r\n      name: 'view',\r\n      message: 'What would you like to view?',\r\n      choices: [\r\n        { name: 'ðŸ“Š Overall Status', value: 'overall' },\r\n        { name: 'ðŸ¤– Agent Details', value: 'agents' },\r\n        { name: 'ðŸ“‹ Task Queue', value: 'tasks' },\r\n        { name: 'ðŸ’¾ Memory Usage', value: 'memory' },\r\n        { name: 'ðŸ“ˆ Performance Metrics', value: 'performance' },\r\n        { name: 'ðŸ“¡ Communications', value: 'communications' },\r\n      ],\r\n    },\r\n  ]);\r\n\r\n  // Execute the status command with appropriate flags\r\n  const statusCmd = require('./status').statusCommand;\r\n  const args = ['status'];\r\n\r\n  switch (view) {\r\n    case 'agents':\r\n      args.push('--detailed');\r\n      break;\r\n    case 'tasks':\r\n      args.push('--tasks');\r\n      break;\r\n    case 'memory':\r\n      args.push('--memory');\r\n      break;\r\n    case 'performance':\r\n      args.push('--performance');\r\n      break;\r\n  }\r\n\r\n  await statusCmd.parseAsync(args);\r\n}\r\n\r\n// Helper functions for other wizard actions\r\nasync function listAgentsInteractive(hiveMind: HiveMind) {\r\n  const agents = await hiveMind.getAgents();\r\n\r\n  console.log('\\n' + chalk.bold('ðŸ¤– Agent List:'));\r\n  agents.forEach((agent) => {\r\n    const statusEmoji = agent.status === 'busy' ? 'ðŸ”´' : 'ðŸŸ¢';\r\n    console.log(`${statusEmoji} ${agent.name} (${agent.type}) - ${agent.status}`);\r\n  });\r\n}\r\n\r\nasync function modifyAgentInteractive(hiveMind: HiveMind) {\r\n  // Implementation for modifying agents\r\n  console.log(formatInfo('Agent modification coming soon...'));\r\n}\r\n\r\nasync function removeAgentInteractive(hiveMind: HiveMind) {\r\n  // Implementation for removing agents\r\n  console.log(formatInfo('Agent removal coming soon...'));\r\n}\r\n\r\nasync function rebalanceAgentsInteractive(hiveMind: HiveMind) {\r\n  const spinner = require('ora')('Rebalancing agents...').start();\r\n\r\n  try {\r\n    await hiveMind.rebalanceAgents();\r\n    spinner.succeed(formatSuccess('Agents rebalanced successfully!'));\r\n  } catch (error) {\r\n    spinner.fail(formatError('Failed to rebalance agents'));\r\n    throw error;\r\n  }\r\n}\r\n\r\nasync function configureMemoryWizard() {\r\n  console.log(formatInfo('Memory configuration coming soon...'));\r\n}\r\n\r\nasync function runSimulationWizard() {\r\n  console.log(formatInfo('Simulation mode coming soon...'));\r\n}\r\n\r\nasync function exportDataWizard() {\r\n  console.log(formatInfo('Data export coming soon...'));\r\n}\r\n\r\nasync function switchSwarmWizard() {\r\n  const db = await DatabaseManager.getInstance();\r\n  const swarms = await db.getAllSwarms();\r\n\r\n  if (swarms.length === 0) {\r\n    console.log(formatWarning('No swarms found. Create one first!'));\r\n    return;\r\n  }\r\n\r\n  const { swarmId } = await inquirer.prompt([\r\n    {\r\n      type: 'list',\r\n      name: 'swarmId',\r\n      message: 'Select swarm:',\r\n      choices: swarms.map((s) => ({\r\n        name: `${s.name} (${s.topology}) - ${s.agentCount} agents`,\r\n        value: s.id,\r\n      })),\r\n    },\r\n  ]);\r\n\r\n  await db.setActiveSwarm(swarmId);\r\n  console.log(formatSuccess('Switched to swarm: ' + swarmId));\r\n}\r\n"],"names":["Command","chalk","inquirer","figlet","gradient","HiveMind","DatabaseManager","formatSuccess","formatError","formatInfo","formatWarning","wizardCommand","description","option","action","options","skipIntro","showIntro","exit","selectAction","createSwarmWizard","manageAgentsWizard","submitTaskWizard","viewStatusWizard","configureMemoryWizard","runSimulationWizard","exportDataWizard","switchSwarmWizard","prompt","type","name","message","default","then","answers","continue","console","log","bold","yellow","error","process","clear","title","textSync","font","horizontalLayout","verticalLayout","rainbow","gray","Promise","resolve","setTimeout","db","getInstance","activeSwarm","getActiveSwarmId","choices","value","disabled","Separator","Date","now","validate","input","length","showAdvanced","advanced","checked","Object","assign","spinner","require","start","hiveMind","topology","maxAgents","queenMode","memoryTTL","consensusThreshold","autoSpawn","enabledFeatures","createdAt","swarmId","initialize","succeed","agents","autoSpawnAgents","fail","load","spawnAgentInteractive","listAgentsInteractive","modifyAgentInteractive","removeAgentInteractive","rebalanceAgentsInteractive","agentTypes","count","i","agent","spawnAgent","push","templates","template","taskDescription","taskConfig","research","prefix","development","analysis","testing","documentation","tmpl","detail","config","task","submitTask","priority","strategy","id","monitor","view","statusCmd","statusCommand","args","parseAsync","getAgents","forEach","statusEmoji","status","rebalanceAgents","swarms","getAllSwarms","map","s","agentCount","setActiveSwarm"],"mappings":"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"}