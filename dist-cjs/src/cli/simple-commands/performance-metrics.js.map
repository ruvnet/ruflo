{"version":3,"sources":["../../../../src/cli/simple-commands/performance-metrics.js"],"sourcesContent":["/**\r\n * Real Performance Metrics Collection System\r\n * Tracks actual system performance, agent activity, and resource usage\r\n */\r\n\r\nimport { promises as fs } from 'fs';\r\nimport path from 'path';\r\nimport os from 'os';\r\nimport { performance } from 'perf_hooks';\r\n\r\n// Metrics storage path\r\nconst METRICS_DIR = path.join(process.cwd(), '.claude-flow', 'metrics');\r\nconst PERFORMANCE_FILE = path.join(METRICS_DIR, 'performance.json');\r\nconst AGENT_METRICS_FILE = path.join(METRICS_DIR, 'agent-metrics.json');\r\nconst TASK_METRICS_FILE = path.join(METRICS_DIR, 'task-metrics.json');\r\nconst SYSTEM_METRICS_FILE = path.join(METRICS_DIR, 'system-metrics.json');\r\n\r\n// In-memory metrics cache\r\nlet metricsCache = {\r\n  tasks: [],\r\n  agents: {},\r\n  system: [],\r\n  performance: {\r\n    // Session information\r\n    startTime: Date.now(),\r\n    sessionId: `session-${Date.now()}`,\r\n    lastActivity: Date.now(),\r\n    sessionDuration: 0,\r\n\r\n    // General task metrics\r\n    totalTasks: 0,\r\n    successfulTasks: 0,\r\n    failedTasks: 0,\r\n    totalAgents: 0,\r\n    activeAgents: 0,\r\n    neuralEvents: 0,\r\n\r\n    // Memory mode tracking\r\n    memoryMode: {\r\n      reasoningbankOperations: 0,\r\n      basicOperations: 0,\r\n      autoModeSelections: 0,\r\n      modeOverrides: 0,\r\n      currentMode: 'auto'\r\n    },\r\n\r\n    // Operation type breakdown\r\n    operations: {\r\n      store: { count: 0, totalDuration: 0, errors: 0 },\r\n      retrieve: { count: 0, totalDuration: 0, errors: 0 },\r\n      query: { count: 0, totalDuration: 0, errors: 0 },\r\n      list: { count: 0, totalDuration: 0, errors: 0 },\r\n      delete: { count: 0, totalDuration: 0, errors: 0 },\r\n      search: { count: 0, totalDuration: 0, errors: 0 },\r\n      init: { count: 0, totalDuration: 0, errors: 0 }\r\n    },\r\n\r\n    // Performance statistics\r\n    performance: {\r\n      avgOperationDuration: 0,\r\n      minOperationDuration: null,\r\n      maxOperationDuration: null,\r\n      slowOperations: 0, // Count of operations > 5s\r\n      fastOperations: 0, // Count of operations < 100ms\r\n      totalOperationTime: 0\r\n    },\r\n\r\n    // Memory storage statistics\r\n    storage: {\r\n      totalEntries: 0,\r\n      reasoningbankEntries: 0,\r\n      basicEntries: 0,\r\n      databaseSize: 0,\r\n      lastBackup: null,\r\n      growthRate: 0\r\n    },\r\n\r\n    // Error tracking\r\n    errors: {\r\n      total: 0,\r\n      byType: {},\r\n      byOperation: {},\r\n      recent: []\r\n    },\r\n\r\n    // ReasoningBank specific metrics\r\n    reasoningbank: {\r\n      semanticSearches: 0,\r\n      sqlFallbacks: 0,\r\n      embeddingGenerated: 0,\r\n      consolidations: 0,\r\n      avgQueryTime: 0,\r\n      cacheHits: 0,\r\n      cacheMisses: 0\r\n    }\r\n  }\r\n};\r\n\r\n// Store interval ID for cleanup\r\nlet systemMonitoringInterval = null;\r\n\r\n// Initialize metrics system\r\nexport async function initializeMetrics(startMonitoring = true) {\r\n  try {\r\n    await fs.mkdir(METRICS_DIR, { recursive: true });\r\n    \r\n    // Load existing metrics if available\r\n    await loadMetricsFromDisk();\r\n    \r\n    // Start system monitoring only if requested\r\n    if (startMonitoring) {\r\n      startSystemMonitoring();\r\n    }\r\n    \r\n    return true;\r\n  } catch (err) {\r\n    console.error('Failed to initialize metrics:', err);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Load metrics from disk\r\nasync function loadMetricsFromDisk() {\r\n  try {\r\n    // Load performance metrics\r\n    if (await fileExists(PERFORMANCE_FILE)) {\r\n      const data = await fs.readFile(PERFORMANCE_FILE, 'utf8');\r\n      const saved = JSON.parse(data);\r\n      metricsCache.performance = { ...metricsCache.performance, ...saved };\r\n    }\r\n    \r\n    // Load task metrics\r\n    if (await fileExists(TASK_METRICS_FILE)) {\r\n      const data = await fs.readFile(TASK_METRICS_FILE, 'utf8');\r\n      metricsCache.tasks = JSON.parse(data);\r\n    }\r\n    \r\n    // Load agent metrics\r\n    if (await fileExists(AGENT_METRICS_FILE)) {\r\n      const data = await fs.readFile(AGENT_METRICS_FILE, 'utf8');\r\n      metricsCache.agents = JSON.parse(data);\r\n    }\r\n  } catch (err) {\r\n    // Ignore errors, start fresh\r\n  }\r\n}\r\n\r\n// Save metrics to disk\r\nasync function saveMetricsToDisk() {\r\n  try {\r\n    await fs.writeFile(PERFORMANCE_FILE, JSON.stringify(metricsCache.performance, null, 2));\r\n    await fs.writeFile(TASK_METRICS_FILE, JSON.stringify(metricsCache.tasks, null, 2));\r\n    await fs.writeFile(AGENT_METRICS_FILE, JSON.stringify(metricsCache.agents, null, 2));\r\n  } catch (err) {\r\n    // Ignore save errors\r\n  }\r\n}\r\n\r\n// Track task execution\r\nexport async function trackTaskExecution(taskId, taskType, success, duration, metadata = {}) {\r\n  const task = {\r\n    id: taskId,\r\n    type: taskType,\r\n    success,\r\n    duration,\r\n    timestamp: Date.now(),\r\n    metadata\r\n  };\r\n  \r\n  metricsCache.tasks.push(task);\r\n  metricsCache.performance.totalTasks++;\r\n  \r\n  if (success) {\r\n    metricsCache.performance.successfulTasks++;\r\n  } else {\r\n    metricsCache.performance.failedTasks++;\r\n  }\r\n  \r\n  // Keep only last 1000 tasks\r\n  if (metricsCache.tasks.length > 1000) {\r\n    metricsCache.tasks = metricsCache.tasks.slice(-1000);\r\n  }\r\n  \r\n  await saveMetricsToDisk();\r\n}\r\n\r\n// Track agent activity\r\nexport async function trackAgentActivity(agentId, agentType, action, duration, success = true) {\r\n  if (!metricsCache.agents[agentType]) {\r\n    metricsCache.agents[agentType] = {\r\n      total: 0,\r\n      successful: 0,\r\n      failed: 0,\r\n      totalDuration: 0,\r\n      actions: []\r\n    };\r\n  }\r\n  \r\n  const agent = metricsCache.agents[agentType];\r\n  agent.total++;\r\n  agent.totalDuration += duration;\r\n  \r\n  if (success) {\r\n    agent.successful++;\r\n  } else {\r\n    agent.failed++;\r\n  }\r\n  \r\n  agent.actions.push({\r\n    id: agentId,\r\n    action,\r\n    duration,\r\n    success,\r\n    timestamp: Date.now()\r\n  });\r\n  \r\n  // Keep only last 100 actions per agent type\r\n  if (agent.actions.length > 100) {\r\n    agent.actions = agent.actions.slice(-100);\r\n  }\r\n  \r\n  metricsCache.performance.totalAgents = Object.keys(metricsCache.agents).length;\r\n  \r\n  await saveMetricsToDisk();\r\n}\r\n\r\n// Track neural events\r\nexport async function trackNeuralEvent(eventType, metadata = {}) {\r\n  metricsCache.performance.neuralEvents++;\r\n\r\n  await saveMetricsToDisk();\r\n}\r\n\r\n// Track memory operations\r\nexport async function trackMemoryOperation(operationType, mode, duration, success = true, errorType = null) {\r\n  // Update session activity\r\n  metricsCache.performance.lastActivity = Date.now();\r\n  metricsCache.performance.sessionDuration = Date.now() - metricsCache.performance.startTime;\r\n\r\n  // Track mode usage\r\n  if (mode === 'reasoningbank') {\r\n    metricsCache.performance.memoryMode.reasoningbankOperations++;\r\n  } else if (mode === 'basic') {\r\n    metricsCache.performance.memoryMode.basicOperations++;\r\n  }\r\n\r\n  // Track operation type\r\n  if (metricsCache.performance.operations[operationType]) {\r\n    const op = metricsCache.performance.operations[operationType];\r\n    op.count++;\r\n    op.totalDuration += duration;\r\n\r\n    if (!success) {\r\n      op.errors++;\r\n    }\r\n  }\r\n\r\n  // Update performance statistics\r\n  const perf = metricsCache.performance.performance;\r\n  perf.totalOperationTime += duration;\r\n\r\n  const totalOps = Object.values(metricsCache.performance.operations)\r\n    .reduce((sum, op) => sum + op.count, 0);\r\n\r\n  if (totalOps > 0) {\r\n    perf.avgOperationDuration = perf.totalOperationTime / totalOps;\r\n  }\r\n\r\n  if (perf.minOperationDuration === null || duration < perf.minOperationDuration) {\r\n    perf.minOperationDuration = duration;\r\n  }\r\n\r\n  if (perf.maxOperationDuration === null || duration > perf.maxOperationDuration) {\r\n    perf.maxOperationDuration = duration;\r\n  }\r\n\r\n  if (duration > 5000) {\r\n    perf.slowOperations++;\r\n  } else if (duration < 100) {\r\n    perf.fastOperations++;\r\n  }\r\n\r\n  // Track errors\r\n  if (!success && errorType) {\r\n    metricsCache.performance.errors.total++;\r\n\r\n    // Track by type\r\n    if (!metricsCache.performance.errors.byType[errorType]) {\r\n      metricsCache.performance.errors.byType[errorType] = 0;\r\n    }\r\n    metricsCache.performance.errors.byType[errorType]++;\r\n\r\n    // Track by operation\r\n    if (!metricsCache.performance.errors.byOperation[operationType]) {\r\n      metricsCache.performance.errors.byOperation[operationType] = 0;\r\n    }\r\n    metricsCache.performance.errors.byOperation[operationType]++;\r\n\r\n    // Add to recent errors (keep last 20)\r\n    metricsCache.performance.errors.recent.push({\r\n      operation: operationType,\r\n      type: errorType,\r\n      timestamp: Date.now(),\r\n      mode\r\n    });\r\n\r\n    if (metricsCache.performance.errors.recent.length > 20) {\r\n      metricsCache.performance.errors.recent = metricsCache.performance.errors.recent.slice(-20);\r\n    }\r\n  }\r\n\r\n  await saveMetricsToDisk();\r\n}\r\n\r\n// Track mode selection (auto, override)\r\nexport async function trackModeSelection(selectedMode, wasAutomatic = true) {\r\n  metricsCache.performance.memoryMode.currentMode = selectedMode;\r\n\r\n  if (wasAutomatic) {\r\n    metricsCache.performance.memoryMode.autoModeSelections++;\r\n  } else {\r\n    metricsCache.performance.memoryMode.modeOverrides++;\r\n  }\r\n\r\n  await saveMetricsToDisk();\r\n}\r\n\r\n// Track ReasoningBank specific operations\r\nexport async function trackReasoningBankOperation(operationType, duration, metadata = {}) {\r\n  const rb = metricsCache.performance.reasoningbank;\r\n\r\n  switch (operationType) {\r\n    case 'semantic_search':\r\n      rb.semanticSearches++;\r\n      break;\r\n    case 'sql_fallback':\r\n      rb.sqlFallbacks++;\r\n      break;\r\n    case 'embedding_generated':\r\n      rb.embeddingGenerated++;\r\n      break;\r\n    case 'consolidation':\r\n      rb.consolidations++;\r\n      break;\r\n    case 'cache_hit':\r\n      rb.cacheHits++;\r\n      break;\r\n    case 'cache_miss':\r\n      rb.cacheMisses++;\r\n      break;\r\n  }\r\n\r\n  // Update average query time\r\n  const totalQueries = rb.semanticSearches + rb.sqlFallbacks;\r\n  if (totalQueries > 0) {\r\n    rb.avgQueryTime = ((rb.avgQueryTime * (totalQueries - 1)) + duration) / totalQueries;\r\n  }\r\n\r\n  await saveMetricsToDisk();\r\n}\r\n\r\n// Update storage statistics\r\nexport async function updateStorageStats(totalEntries, reasoningbankEntries, basicEntries, databaseSize = 0) {\r\n  const storage = metricsCache.performance.storage;\r\n\r\n  const previousTotal = storage.totalEntries;\r\n  storage.totalEntries = totalEntries;\r\n  storage.reasoningbankEntries = reasoningbankEntries;\r\n  storage.basicEntries = basicEntries;\r\n  storage.databaseSize = databaseSize;\r\n\r\n  // Calculate growth rate (entries per hour)\r\n  if (previousTotal > 0) {\r\n    const sessionHours = metricsCache.performance.sessionDuration / (1000 * 60 * 60);\r\n    if (sessionHours > 0) {\r\n      storage.growthRate = (totalEntries - previousTotal) / sessionHours;\r\n    }\r\n  }\r\n\r\n  await saveMetricsToDisk();\r\n}\r\n\r\n// Get memory performance summary\r\nexport async function getMemoryPerformanceSummary() {\r\n  const perf = metricsCache.performance;\r\n  const totalOps = Object.values(perf.operations).reduce((sum, op) => sum + op.count, 0);\r\n  const totalErrors = Object.values(perf.operations).reduce((sum, op) => sum + op.errors, 0);\r\n\r\n  return {\r\n    session: {\r\n      sessionId: perf.sessionId,\r\n      duration: perf.sessionDuration,\r\n      startTime: new Date(perf.startTime).toISOString(),\r\n      lastActivity: new Date(perf.lastActivity).toISOString()\r\n    },\r\n    mode: {\r\n      current: perf.memoryMode.currentMode,\r\n      reasoningbankUsage: perf.memoryMode.reasoningbankOperations,\r\n      basicUsage: perf.memoryMode.basicOperations,\r\n      autoSelections: perf.memoryMode.autoModeSelections,\r\n      manualOverrides: perf.memoryMode.modeOverrides\r\n    },\r\n    operations: {\r\n      total: totalOps,\r\n      breakdown: perf.operations,\r\n      errors: totalErrors,\r\n      errorRate: totalOps > 0 ? (totalErrors / totalOps) * 100 : 0\r\n    },\r\n    performance: {\r\n      avgDuration: perf.performance.avgOperationDuration,\r\n      minDuration: perf.performance.minOperationDuration,\r\n      maxDuration: perf.performance.maxOperationDuration,\r\n      slowOps: perf.performance.slowOperations,\r\n      fastOps: perf.performance.fastOperations\r\n    },\r\n    storage: perf.storage,\r\n    reasoningbank: {\r\n      ...perf.reasoningbank,\r\n      fallbackRate: perf.reasoningbank.semanticSearches > 0\r\n        ? (perf.reasoningbank.sqlFallbacks / perf.reasoningbank.semanticSearches) * 100\r\n        : 0,\r\n      cacheHitRate: (perf.reasoningbank.cacheHits + perf.reasoningbank.cacheMisses) > 0\r\n        ? (perf.reasoningbank.cacheHits / (perf.reasoningbank.cacheHits + perf.reasoningbank.cacheMisses)) * 100\r\n        : 0\r\n    },\r\n    errors: {\r\n      total: perf.errors.total,\r\n      byType: perf.errors.byType,\r\n      byOperation: perf.errors.byOperation,\r\n      recent: perf.errors.recent.slice(-5)\r\n    }\r\n  };\r\n}\r\n\r\n// Get performance report data\r\nexport async function getPerformanceReport(timeframe = '24h') {\r\n  const now = Date.now();\r\n  const timeframeMs = parseTimeframe(timeframe);\r\n  const cutoff = now - timeframeMs;\r\n  \r\n  // Filter tasks within timeframe\r\n  const recentTasks = metricsCache.tasks.filter(task => task.timestamp >= cutoff);\r\n  \r\n  // Calculate metrics\r\n  const totalTasks = recentTasks.length;\r\n  const successfulTasks = recentTasks.filter(t => t.success).length;\r\n  const successRate = totalTasks > 0 ? (successfulTasks / totalTasks) * 100 : 0;\r\n  const avgDuration = totalTasks > 0 \r\n    ? recentTasks.reduce((sum, t) => sum + t.duration, 0) / totalTasks \r\n    : 0;\r\n  \r\n  // Agent metrics\r\n  const agentMetrics = {};\r\n  Object.entries(metricsCache.agents).forEach(([type, data]) => {\r\n    const recentActions = data.actions.filter(a => a.timestamp >= cutoff);\r\n    if (recentActions.length > 0) {\r\n      const successCount = recentActions.filter(a => a.success).length;\r\n      const avgDur = recentActions.reduce((sum, a) => sum + a.duration, 0) / recentActions.length;\r\n      \r\n      agentMetrics[type] = {\r\n        total: recentActions.length,\r\n        successRate: (successCount / recentActions.length) * 100,\r\n        avgDuration: avgDur\r\n      };\r\n    }\r\n  });\r\n  \r\n  // System metrics\r\n  const systemMetrics = await getSystemMetrics();\r\n  \r\n  // Calculate trends (compare to previous period)\r\n  const prevCutoff = cutoff - timeframeMs;\r\n  const prevTasks = metricsCache.tasks.filter(t => t.timestamp >= prevCutoff && t.timestamp < cutoff);\r\n  const prevSuccessRate = prevTasks.length > 0 \r\n    ? (prevTasks.filter(t => t.success).length / prevTasks.length) * 100 \r\n    : 0;\r\n  const prevAvgDuration = prevTasks.length > 0\r\n    ? prevTasks.reduce((sum, t) => sum + t.duration, 0) / prevTasks.length\r\n    : 0;\r\n  \r\n  const trends = {\r\n    successRateChange: successRate - prevSuccessRate,\r\n    durationChange: avgDuration - prevAvgDuration,\r\n    taskVolumeChange: totalTasks - prevTasks.length\r\n  };\r\n  \r\n  return {\r\n    timeframe,\r\n    summary: {\r\n      totalTasks,\r\n      successRate,\r\n      avgDuration: avgDuration / 1000, // Convert to seconds\r\n      agentsSpawned: Object.values(agentMetrics).reduce((sum, m) => sum + m.total, 0),\r\n      memoryEfficiency: systemMetrics.memoryEfficiency,\r\n      neuralEvents: metricsCache.performance.neuralEvents\r\n    },\r\n    agentMetrics,\r\n    systemMetrics,\r\n    trends,\r\n    tasks: recentTasks.slice(-20) // Last 20 tasks\r\n  };\r\n}\r\n\r\n// Get bottleneck analysis data\r\nexport async function getBottleneckAnalysis(scope = 'system', target = 'all') {\r\n  const bottlenecks = [];\r\n  const recommendations = [];\r\n  \r\n  // Analyze task performance\r\n  if (scope === 'system' || scope === 'task') {\r\n    const slowTasks = metricsCache.tasks\r\n      .filter(t => t.duration > 10000) // Tasks taking more than 10s\r\n      .sort((a, b) => b.duration - a.duration)\r\n      .slice(0, 5);\r\n    \r\n    if (slowTasks.length > 0) {\r\n      bottlenecks.push({\r\n        severity: 'warning',\r\n        component: 'Task execution',\r\n        metric: `${slowTasks.length} slow tasks (>10s)`,\r\n        details: slowTasks.map(t => ({\r\n          id: t.id,\r\n          type: t.type,\r\n          duration: t.duration / 1000\r\n        }))\r\n      });\r\n      recommendations.push('Optimize slow task types or break them into smaller subtasks');\r\n    }\r\n  }\r\n  \r\n  // Analyze agent performance\r\n  if (scope === 'system' || scope === 'agent') {\r\n    Object.entries(metricsCache.agents).forEach(([type, data]) => {\r\n      const successRate = data.total > 0 ? (data.successful / data.total) * 100 : 100;\r\n      const avgDuration = data.total > 0 ? data.totalDuration / data.total : 0;\r\n      \r\n      if (successRate < 80) {\r\n        bottlenecks.push({\r\n          severity: 'critical',\r\n          component: `${type} agents`,\r\n          metric: `${successRate.toFixed(1)}% success rate`,\r\n          target: type\r\n        });\r\n        recommendations.push(`Investigate ${type} agent failures and improve error handling`);\r\n      }\r\n      \r\n      if (avgDuration > 15000) {\r\n        bottlenecks.push({\r\n          severity: 'warning',\r\n          component: `${type} agents`,\r\n          metric: `${(avgDuration / 1000).toFixed(1)}s avg duration`,\r\n          target: type\r\n        });\r\n        recommendations.push(`Optimize ${type} agent performance or increase parallelization`);\r\n      }\r\n    });\r\n  }\r\n  \r\n  // Analyze system resources\r\n  if (scope === 'system' || scope === 'memory') {\r\n    const systemMetrics = await getSystemMetrics();\r\n    \r\n    if (systemMetrics.memoryUsagePercent > 80) {\r\n      bottlenecks.push({\r\n        severity: 'critical',\r\n        component: 'Memory usage',\r\n        metric: `${systemMetrics.memoryUsagePercent}% utilization`\r\n      });\r\n      recommendations.push('Implement memory optimization or increase system resources');\r\n    }\r\n    \r\n    if (systemMetrics.cpuLoad > 0.8) {\r\n      bottlenecks.push({\r\n        severity: 'warning',\r\n        component: 'CPU usage',\r\n        metric: `${(systemMetrics.cpuLoad * 100).toFixed(1)}% load`\r\n      });\r\n      recommendations.push('Consider horizontal scaling or CPU optimization');\r\n    }\r\n  }\r\n  \r\n  // Add positive indicators\r\n  if (bottlenecks.length === 0) {\r\n    bottlenecks.push({\r\n      severity: 'good',\r\n      component: 'Overall system',\r\n      metric: 'No bottlenecks detected'\r\n    });\r\n  }\r\n  \r\n  return {\r\n    scope,\r\n    target,\r\n    bottlenecks,\r\n    recommendations,\r\n    analysisDuration: performance.now(),\r\n    confidenceScore: 0.85,\r\n    issuesDetected: bottlenecks.filter(b => b.severity !== 'good').length\r\n  };\r\n}\r\n\r\n// System monitoring\r\nfunction startSystemMonitoring() {\r\n  // Clear any existing interval\r\n  if (systemMonitoringInterval) {\r\n    clearInterval(systemMonitoringInterval);\r\n  }\r\n  \r\n  // Collect system metrics every 30 seconds\r\n  systemMonitoringInterval = setInterval(async () => {\r\n    const metrics = await getSystemMetrics();\r\n    \r\n    // Store system metrics\r\n    if (!metricsCache.system) {\r\n      metricsCache.system = [];\r\n    }\r\n    \r\n    metricsCache.system.push({\r\n      timestamp: Date.now(),\r\n      ...metrics\r\n    });\r\n    \r\n    // Keep only last 24 hours of system metrics\r\n    const dayAgo = Date.now() - (24 * 60 * 60 * 1000);\r\n    metricsCache.system = metricsCache.system.filter(m => m.timestamp > dayAgo);\r\n    \r\n    // Save to disk\r\n    try {\r\n      await fs.writeFile(SYSTEM_METRICS_FILE, JSON.stringify(metricsCache.system, null, 2));\r\n    } catch (err) {\r\n      // Ignore save errors\r\n    }\r\n  }, 30000);\r\n  \r\n  // Allow process to exit even with active interval\r\n  systemMonitoringInterval.unref();\r\n}\r\n\r\n// Stop system monitoring\r\nexport function stopSystemMonitoring() {\r\n  if (systemMonitoringInterval) {\r\n    clearInterval(systemMonitoringInterval);\r\n    systemMonitoringInterval = null;\r\n  }\r\n}\r\n\r\n// Get current system metrics\r\nasync function getSystemMetrics() {\r\n  const totalMem = os.totalmem();\r\n  const freeMem = os.freemem();\r\n  const usedMem = totalMem - freeMem;\r\n  const memoryUsagePercent = (usedMem / totalMem) * 100;\r\n  \r\n  const cpuLoad = os.loadavg()[0] / os.cpus().length; // 1-minute load average\r\n  \r\n  return {\r\n    memoryTotal: totalMem,\r\n    memoryUsed: usedMem,\r\n    memoryFree: freeMem,\r\n    memoryUsagePercent,\r\n    memoryEfficiency: 100 - memoryUsagePercent,\r\n    cpuCount: os.cpus().length,\r\n    cpuLoad,\r\n    platform: os.platform(),\r\n    uptime: os.uptime()\r\n  };\r\n}\r\n\r\n// Parse timeframe string to milliseconds\r\nfunction parseTimeframe(timeframe) {\r\n  const units = {\r\n    'h': 60 * 60 * 1000,\r\n    'd': 24 * 60 * 60 * 1000\r\n  };\r\n  \r\n  const match = timeframe.match(/^(\\d+)([hd])$/);\r\n  if (match) {\r\n    const value = parseInt(match[1]);\r\n    const unit = match[2];\r\n    return value * units[unit];\r\n  }\r\n  \r\n  // Default to 24 hours\r\n  return 24 * 60 * 60 * 1000;\r\n}\r\n\r\n// Check if file exists\r\nasync function fileExists(filepath) {\r\n  try {\r\n    await fs.access(filepath);\r\n    return true;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\n// Cleanup function for graceful shutdown\r\nexport function cleanup() {\r\n  stopSystemMonitoring();\r\n}\r\n\r\n// Export metrics for reporting\r\nexport async function exportMetrics(format = 'json') {\r\n  const timestamp = Date.now();\r\n  const reportsDir = path.join(process.cwd(), 'analysis-reports');\r\n  \r\n  await fs.mkdir(reportsDir, { recursive: true });\r\n  \r\n  if (format === 'json') {\r\n    const reportPath = path.join(reportsDir, `performance-${timestamp}.json`);\r\n    const data = {\r\n      timestamp: new Date().toISOString(),\r\n      performance: metricsCache.performance,\r\n      tasks: metricsCache.tasks.slice(-100), // Last 100 tasks\r\n      agents: metricsCache.agents,\r\n      system: metricsCache.system.slice(-50) // Last 50 system snapshots\r\n    };\r\n    \r\n    await fs.writeFile(reportPath, JSON.stringify(data, null, 2));\r\n    return reportPath;\r\n  }\r\n  \r\n  if (format === 'csv') {\r\n    const reportPath = path.join(reportsDir, `performance-${timestamp}.csv`);\r\n    let csv = 'Timestamp,Type,Metric,Value\\n';\r\n    \r\n    // Add performance metrics\r\n    Object.entries(metricsCache.performance).forEach(([key, value]) => {\r\n      csv += `${new Date().toISOString()},performance,${key},${value}\\n`;\r\n    });\r\n    \r\n    // Add agent metrics\r\n    Object.entries(metricsCache.agents).forEach(([type, data]) => {\r\n      csv += `${new Date().toISOString()},agent,${type}_total,${data.total}\\n`;\r\n      csv += `${new Date().toISOString()},agent,${type}_success_rate,${data.total > 0 ? (data.successful / data.total) * 100 : 0}\\n`;\r\n      csv += `${new Date().toISOString()},agent,${type}_avg_duration,${data.total > 0 ? data.totalDuration / data.total : 0}\\n`;\r\n    });\r\n    \r\n    await fs.writeFile(reportPath, csv);\r\n    return reportPath;\r\n  }\r\n  \r\n  if (format === 'html') {\r\n    const reportPath = path.join(reportsDir, `performance-${timestamp}.html`);\r\n    const report = await getPerformanceReport('24h');\r\n    \r\n    const html = generateHTMLReport(report);\r\n    await fs.writeFile(reportPath, html);\r\n    return reportPath;\r\n  }\r\n  \r\n  throw new Error(`Unsupported format: ${format}`);\r\n}\r\n\r\n// Generate HTML report\r\nfunction generateHTMLReport(report) {\r\n  return `<!DOCTYPE html>\r\n<html>\r\n<head>\r\n  <title>Claude Flow Performance Report - ${new Date().toISOString()}</title>\r\n  <style>\r\n    body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }\r\n    .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }\r\n    h1, h2 { color: #333; }\r\n    .metric { display: inline-block; margin: 10px 20px 10px 0; }\r\n    .metric-label { color: #666; font-size: 14px; }\r\n    .metric-value { font-size: 24px; font-weight: bold; color: #2196F3; }\r\n    .trend { font-size: 14px; margin-left: 10px; }\r\n    .trend.positive { color: #4CAF50; }\r\n    .trend.negative { color: #F44336; }\r\n    table { width: 100%; border-collapse: collapse; margin: 20px 0; }\r\n    th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }\r\n    th { background: #f5f5f5; font-weight: bold; }\r\n    .chart { margin: 20px 0; height: 300px; background: #fafafa; border: 1px solid #ddd; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: #999; }\r\n  </style>\r\n</head>\r\n<body>\r\n  <div class=\"container\">\r\n    <h1>Claude Flow Performance Report</h1>\r\n    <p>Generated: ${new Date().toISOString()} | Timeframe: ${report.timeframe}</p>\r\n    \r\n    <h2>Summary Metrics</h2>\r\n    <div class=\"metrics\">\r\n      <div class=\"metric\">\r\n        <div class=\"metric-label\">Total Tasks</div>\r\n        <div class=\"metric-value\">${report.summary.totalTasks}</div>\r\n        ${report.trends.taskVolumeChange !== 0 ? `<span class=\"trend ${report.trends.taskVolumeChange > 0 ? 'positive' : 'negative'}\">${report.trends.taskVolumeChange > 0 ? '+' : ''}${report.trends.taskVolumeChange}</span>` : ''}\r\n      </div>\r\n      <div class=\"metric\">\r\n        <div class=\"metric-label\">Success Rate</div>\r\n        <div class=\"metric-value\">${report.summary.successRate.toFixed(1)}%</div>\r\n        ${report.trends.successRateChange !== 0 ? `<span class=\"trend ${report.trends.successRateChange > 0 ? 'positive' : 'negative'}\">${report.trends.successRateChange > 0 ? '+' : ''}${report.trends.successRateChange.toFixed(1)}%</span>` : ''}\r\n      </div>\r\n      <div class=\"metric\">\r\n        <div class=\"metric-label\">Avg Duration</div>\r\n        <div class=\"metric-value\">${report.summary.avgDuration.toFixed(1)}s</div>\r\n        ${report.trends.durationChange !== 0 ? `<span class=\"trend ${report.trends.durationChange < 0 ? 'positive' : 'negative'}\">${report.trends.durationChange > 0 ? '+' : ''}${(report.trends.durationChange / 1000).toFixed(1)}s</span>` : ''}\r\n      </div>\r\n      <div class=\"metric\">\r\n        <div class=\"metric-label\">Memory Efficiency</div>\r\n        <div class=\"metric-value\">${report.summary.memoryEfficiency.toFixed(0)}%</div>\r\n      </div>\r\n    </div>\r\n    \r\n    <h2>Agent Performance</h2>\r\n    <table>\r\n      <thead>\r\n        <tr>\r\n          <th>Agent Type</th>\r\n          <th>Total Actions</th>\r\n          <th>Success Rate</th>\r\n          <th>Avg Duration</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        ${Object.entries(report.agentMetrics).map(([type, metrics]) => `\r\n          <tr>\r\n            <td>${type}</td>\r\n            <td>${metrics.total}</td>\r\n            <td>${metrics.successRate.toFixed(1)}%</td>\r\n            <td>${(metrics.avgDuration / 1000).toFixed(1)}s</td>\r\n          </tr>\r\n        `).join('')}\r\n      </tbody>\r\n    </table>\r\n    \r\n    <h2>Performance Trends</h2>\r\n    <div class=\"chart\">\r\n      <p>Interactive charts would be displayed here</p>\r\n    </div>\r\n    \r\n    <h2>Recent Tasks</h2>\r\n    <table>\r\n      <thead>\r\n        <tr>\r\n          <th>Task ID</th>\r\n          <th>Type</th>\r\n          <th>Status</th>\r\n          <th>Duration</th>\r\n          <th>Timestamp</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        ${report.tasks.slice(-10).reverse().map(task => `\r\n          <tr>\r\n            <td>${task.id}</td>\r\n            <td>${task.type}</td>\r\n            <td>${task.success ? '✅ Success' : '❌ Failed'}</td>\r\n            <td>${(task.duration / 1000).toFixed(2)}s</td>\r\n            <td>${new Date(task.timestamp).toLocaleString()}</td>\r\n          </tr>\r\n        `).join('')}\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</body>\r\n</html>`;\r\n}"],"names":["promises","fs","path","os","performance","METRICS_DIR","join","process","cwd","PERFORMANCE_FILE","AGENT_METRICS_FILE","TASK_METRICS_FILE","SYSTEM_METRICS_FILE","metricsCache","tasks","agents","system","startTime","Date","now","sessionId","lastActivity","sessionDuration","totalTasks","successfulTasks","failedTasks","totalAgents","activeAgents","neuralEvents","memoryMode","reasoningbankOperations","basicOperations","autoModeSelections","modeOverrides","currentMode","operations","store","count","totalDuration","errors","retrieve","query","list","delete","search","init","avgOperationDuration","minOperationDuration","maxOperationDuration","slowOperations","fastOperations","totalOperationTime","storage","totalEntries","reasoningbankEntries","basicEntries","databaseSize","lastBackup","growthRate","total","byType","byOperation","recent","reasoningbank","semanticSearches","sqlFallbacks","embeddingGenerated","consolidations","avgQueryTime","cacheHits","cacheMisses","systemMonitoringInterval","initializeMetrics","startMonitoring","mkdir","recursive","loadMetricsFromDisk","startSystemMonitoring","err","console","error","fileExists","data","readFile","saved","JSON","parse","saveMetricsToDisk","writeFile","stringify","trackTaskExecution","taskId","taskType","success","duration","metadata","task","id","type","timestamp","push","length","slice","trackAgentActivity","agentId","agentType","action","successful","failed","actions","agent","Object","keys","trackNeuralEvent","eventType","trackMemoryOperation","operationType","mode","errorType","op","perf","totalOps","values","reduce","sum","operation","trackModeSelection","selectedMode","wasAutomatic","trackReasoningBankOperation","rb","totalQueries","updateStorageStats","previousTotal","sessionHours","getMemoryPerformanceSummary","totalErrors","session","toISOString","current","reasoningbankUsage","basicUsage","autoSelections","manualOverrides","breakdown","errorRate","avgDuration","minDuration","maxDuration","slowOps","fastOps","fallbackRate","cacheHitRate","getPerformanceReport","timeframe","timeframeMs","parseTimeframe","cutoff","recentTasks","filter","t","successRate","agentMetrics","entries","forEach","recentActions","a","successCount","avgDur","systemMetrics","getSystemMetrics","prevCutoff","prevTasks","prevSuccessRate","prevAvgDuration","trends","successRateChange","durationChange","taskVolumeChange","summary","agentsSpawned","m","memoryEfficiency","getBottleneckAnalysis","scope","target","bottlenecks","recommendations","slowTasks","sort","b","severity","component","metric","details","map","toFixed","memoryUsagePercent","cpuLoad","analysisDuration","confidenceScore","issuesDetected","clearInterval","setInterval","metrics","dayAgo","unref","stopSystemMonitoring","totalMem","totalmem","freeMem","freemem","usedMem","loadavg","cpus","memoryTotal","memoryUsed","memoryFree","cpuCount","platform","uptime","units","match","value","parseInt","unit","filepath","access","cleanup","exportMetrics","format","reportsDir","reportPath","csv","key","report","html","generateHTMLReport","Error","reverse","toLocaleString"],"mappings":"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"}