{"version":3,"sources":["../../../../src/cli/simple-commands/swarm-ui.js"],"sourcesContent":["#!/usr/bin/env node\r\n\r\n/**\r\n * Enhanced Swarm UI with real-time monitoring and control\r\n * Uses blessed for terminal UI\r\n */\r\n\r\nconst blessed = require('blessed');\r\nconst fs = require('fs').promises;\r\nconst path = require('path');\r\nconst { spawn } = require('child_process');\r\n\r\nclass SwarmUI {\r\n  constructor() {\r\n    this.screen = null;\r\n    this.swarmData = {\r\n      objectives: [],\r\n      agents: [],\r\n      tasks: [],\r\n      status: 'idle',\r\n    };\r\n    this.selectedObjective = null;\r\n    this.updateInterval = null;\r\n    this.logBuffer = [];\r\n    this.maxLogLines = 100;\r\n    this.activeProcesses = new Map(); // Track active processes for cross-platform termination\r\n  }\r\n\r\n  async init() {\r\n    // Create blessed screen\r\n    this.screen = blessed.screen({\r\n      smartCSR: true,\r\n      title: 'Claude Flow - Swarm Control Center',\r\n    });\r\n\r\n    this.createLayout();\r\n    this.bindEvents();\r\n    this.startMonitoring();\r\n\r\n    this.screen.render();\r\n  }\r\n\r\n  createLayout() {\r\n    // Main container\r\n    const mainBox = blessed.box({\r\n      parent: this.screen,\r\n      top: 0,\r\n      left: 0,\r\n      width: '100%',\r\n      height: '100%',\r\n      border: {\r\n        type: 'line',\r\n      },\r\n      style: {\r\n        border: {\r\n          fg: 'cyan',\r\n        },\r\n      },\r\n    });\r\n\r\n    // Header\r\n    this.headerBox = blessed.box({\r\n      parent: mainBox,\r\n      top: 0,\r\n      left: 0,\r\n      width: '100%',\r\n      height: 3,\r\n      content: '{center}ðŸ Claude Flow Swarm Control Center{/center}',\r\n      tags: true,\r\n      style: {\r\n        fg: 'white',\r\n        bg: 'blue',\r\n      },\r\n    });\r\n\r\n    // Status bar\r\n    this.statusBox = blessed.box({\r\n      parent: mainBox,\r\n      top: 2,\r\n      left: 0,\r\n      width: '100%',\r\n      height: 1,\r\n      content: 'Status: Initializing...',\r\n      style: {\r\n        fg: 'yellow',\r\n      },\r\n    });\r\n\r\n    // Left panel - Objectives and Agents\r\n    const leftPanel = blessed.box({\r\n      parent: mainBox,\r\n      top: 3,\r\n      left: 0,\r\n      width: '30%',\r\n      height: '70%',\r\n      border: {\r\n        type: 'line',\r\n      },\r\n      label: ' Objectives & Agents ',\r\n      style: {\r\n        border: {\r\n          fg: 'green',\r\n        },\r\n      },\r\n    });\r\n\r\n    // Objectives list\r\n    this.objectivesList = blessed.list({\r\n      parent: leftPanel,\r\n      top: 0,\r\n      left: 0,\r\n      width: '100%',\r\n      height: '50%',\r\n      label: ' Objectives ',\r\n      items: ['No objectives'],\r\n      keys: true,\r\n      vi: true,\r\n      mouse: true,\r\n      style: {\r\n        selected: {\r\n          bg: 'blue',\r\n        },\r\n        item: {\r\n          fg: 'white',\r\n        },\r\n      },\r\n    });\r\n\r\n    // Agents list\r\n    this.agentsList = blessed.list({\r\n      parent: leftPanel,\r\n      top: '50%',\r\n      left: 0,\r\n      width: '100%',\r\n      height: '50%',\r\n      label: ' Agents ',\r\n      items: ['No agents'],\r\n      keys: true,\r\n      vi: true,\r\n      mouse: true,\r\n      style: {\r\n        selected: {\r\n          bg: 'green',\r\n        },\r\n        item: {\r\n          fg: 'white',\r\n        },\r\n      },\r\n    });\r\n\r\n    // Center panel - Tasks and Details\r\n    const centerPanel = blessed.box({\r\n      parent: mainBox,\r\n      top: 3,\r\n      left: '30%',\r\n      width: '40%',\r\n      height: '70%',\r\n      border: {\r\n        type: 'line',\r\n      },\r\n      label: ' Tasks & Details ',\r\n      style: {\r\n        border: {\r\n          fg: 'yellow',\r\n        },\r\n      },\r\n    });\r\n\r\n    // Tasks list\r\n    this.tasksList = blessed.list({\r\n      parent: centerPanel,\r\n      top: 0,\r\n      left: 0,\r\n      width: '100%',\r\n      height: '50%',\r\n      label: ' Tasks ',\r\n      items: ['No tasks'],\r\n      keys: true,\r\n      vi: true,\r\n      mouse: true,\r\n      style: {\r\n        selected: {\r\n          bg: 'yellow',\r\n          fg: 'black',\r\n        },\r\n        item: {\r\n          fg: 'white',\r\n        },\r\n      },\r\n    });\r\n\r\n    // Task details\r\n    this.taskDetails = blessed.box({\r\n      parent: centerPanel,\r\n      top: '50%',\r\n      left: 0,\r\n      width: '100%',\r\n      height: '50%',\r\n      label: ' Task Details ',\r\n      content: 'Select a task to view details',\r\n      scrollable: true,\r\n      alwaysScroll: true,\r\n      keys: true,\r\n      vi: true,\r\n      mouse: true,\r\n      style: {\r\n        fg: 'white',\r\n      },\r\n    });\r\n\r\n    // Right panel - Logs and Controls\r\n    const rightPanel = blessed.box({\r\n      parent: mainBox,\r\n      top: 3,\r\n      left: '70%',\r\n      width: '30%',\r\n      height: '70%',\r\n      border: {\r\n        type: 'line',\r\n      },\r\n      label: ' Logs & Controls ',\r\n      style: {\r\n        border: {\r\n          fg: 'magenta',\r\n        },\r\n      },\r\n    });\r\n\r\n    // Activity logs\r\n    this.logBox = blessed.log({\r\n      parent: rightPanel,\r\n      top: 0,\r\n      left: 0,\r\n      width: '100%',\r\n      height: '60%',\r\n      label: ' Activity Log ',\r\n      tags: true,\r\n      mouse: true,\r\n      scrollable: true,\r\n      alwaysScroll: true,\r\n      style: {\r\n        fg: 'white',\r\n      },\r\n    });\r\n\r\n    // Control buttons\r\n    this.controlBox = blessed.box({\r\n      parent: rightPanel,\r\n      top: '60%',\r\n      left: 0,\r\n      width: '100%',\r\n      height: '40%',\r\n      label: ' Controls ',\r\n    });\r\n\r\n    // Create objective button\r\n    this.createButton = blessed.button({\r\n      parent: this.controlBox,\r\n      top: 1,\r\n      left: 1,\r\n      width: '90%',\r\n      height: 3,\r\n      content: 'Create Objective',\r\n      align: 'center',\r\n      style: {\r\n        bg: 'blue',\r\n        fg: 'white',\r\n        focus: {\r\n          bg: 'red',\r\n        },\r\n      },\r\n    });\r\n\r\n    // Stop swarm button\r\n    this.stopButton = blessed.button({\r\n      parent: this.controlBox,\r\n      top: 5,\r\n      left: 1,\r\n      width: '90%',\r\n      height: 3,\r\n      content: 'Stop Swarm',\r\n      align: 'center',\r\n      style: {\r\n        bg: 'red',\r\n        fg: 'white',\r\n        focus: {\r\n          bg: 'yellow',\r\n          fg: 'black',\r\n        },\r\n      },\r\n    });\r\n\r\n    // Bottom panel - Command input\r\n    this.commandBox = blessed.textbox({\r\n      parent: mainBox,\r\n      bottom: 0,\r\n      left: 0,\r\n      width: '100%',\r\n      height: 3,\r\n      label: ' Command Input (Press Enter to execute) ',\r\n      keys: true,\r\n      mouse: true,\r\n      inputOnFocus: true,\r\n      style: {\r\n        border: {\r\n          fg: 'cyan',\r\n        },\r\n        fg: 'white',\r\n      },\r\n    });\r\n  }\r\n\r\n  bindEvents() {\r\n    // Screen events\r\n    this.screen.key(['escape', 'q', 'C-c'], () => {\r\n      this.cleanup();\r\n      process.exit(0);\r\n    });\r\n\r\n    // Objective selection\r\n    this.objectivesList.on('select', (item, index) => {\r\n      this.selectedObjective = this.swarmData.objectives[index];\r\n      this.updateTasksList();\r\n      this.log(`Selected objective: ${this.selectedObjective?.description || 'Unknown'}`);\r\n    });\r\n\r\n    // Task selection\r\n    this.tasksList.on('select', (item, index) => {\r\n      const task = this.swarmData.tasks[index];\r\n      if (task) {\r\n        this.updateTaskDetails(task);\r\n      }\r\n    });\r\n\r\n    // Create objective button\r\n    this.createButton.on('press', () => {\r\n      this.promptCreateObjective();\r\n    });\r\n\r\n    // Stop swarm button\r\n    this.stopButton.on('press', () => {\r\n      this.stopSwarm();\r\n    });\r\n\r\n    // Command input\r\n    this.commandBox.on('submit', (value) => {\r\n      this.executeCommand(value);\r\n      this.commandBox.clearValue();\r\n      this.screen.render();\r\n    });\r\n\r\n    // Focus management\r\n    this.screen.key(['tab'], () => {\r\n      this.screen.focusNext();\r\n    });\r\n\r\n    this.screen.key(['S-tab'], () => {\r\n      this.screen.focusPrevious();\r\n    });\r\n  }\r\n\r\n  async startMonitoring() {\r\n    this.log('Starting swarm monitoring...');\r\n\r\n    // Update interval\r\n    this.updateInterval = setInterval(() => {\r\n      this.updateSwarmData();\r\n    }, 2000);\r\n\r\n    // Initial update\r\n    await this.updateSwarmData();\r\n  }\r\n\r\n  async updateSwarmData() {\r\n    try {\r\n      // Load swarm data from file system\r\n      const swarmRunsDir = './swarm-runs';\r\n\r\n      try {\r\n        const runs = await fs.readdir(swarmRunsDir);\r\n        this.swarmData.objectives = [];\r\n        this.swarmData.agents = [];\r\n        this.swarmData.tasks = [];\r\n\r\n        for (const runDir of runs) {\r\n          const configPath = path.join(swarmRunsDir, runDir, 'config.json');\r\n          try {\r\n            const configData = await fs.readFile(configPath, 'utf-8');\r\n            const config = JSON.parse(configData);\r\n\r\n            this.swarmData.objectives.push({\r\n              id: config.swarmId,\r\n              description: config.objective,\r\n              status: 'running',\r\n              startTime: config.startTime,\r\n            });\r\n\r\n            // Load agents\r\n            const agentsDir = path.join(swarmRunsDir, runDir, 'agents');\r\n            try {\r\n              const agents = await fs.readdir(agentsDir);\r\n              for (const agentDir of agents) {\r\n                const taskPath = path.join(agentsDir, agentDir, 'task.json');\r\n                try {\r\n                  const taskData = await fs.readFile(taskPath, 'utf-8');\r\n                  const task = JSON.parse(taskData);\r\n\r\n                  this.swarmData.agents.push({\r\n                    id: task.agentId,\r\n                    swarmId: config.swarmId,\r\n                    status: task.status || 'active',\r\n                    task: task.task,\r\n                  });\r\n\r\n                  this.swarmData.tasks.push(task);\r\n                } catch (e) {\r\n                  // Skip invalid task files\r\n                }\r\n              }\r\n            } catch (e) {\r\n              // No agents directory\r\n            }\r\n          } catch (e) {\r\n            // Skip invalid config files\r\n          }\r\n        }\r\n\r\n        this.updateDisplay();\r\n      } catch (e) {\r\n        // No swarm runs directory\r\n        this.swarmData.status = 'idle';\r\n      }\r\n    } catch (error) {\r\n      this.log(`Error updating swarm data: ${error.message}`, 'error');\r\n    }\r\n  }\r\n\r\n  updateDisplay() {\r\n    // Update status\r\n    const activeObjectives = this.swarmData.objectives.filter((o) => o.status === 'running').length;\r\n    const activeAgents = this.swarmData.agents.filter((a) => a.status === 'active').length;\r\n\r\n    this.statusBox.setContent(\r\n      `Status: ${this.swarmData.status} | ` +\r\n        `Objectives: ${activeObjectives} | ` +\r\n        `Agents: ${activeAgents} | ` +\r\n        `Tasks: ${this.swarmData.tasks.length}`,\r\n    );\r\n\r\n    // Update objectives list\r\n    const objectiveItems = this.swarmData.objectives.map(\r\n      (obj) => `${obj.status === 'running' ? 'ðŸŸ¢' : 'ðŸ”´'} ${obj.description.substring(0, 25)}...`,\r\n    );\r\n    this.objectivesList.setItems(objectiveItems.length > 0 ? objectiveItems : ['No objectives']);\r\n\r\n    // Update agents list\r\n    const agentItems = this.swarmData.agents.map(\r\n      (agent) => `${agent.status === 'active' ? 'ðŸ¤–' : 'ðŸ’¤'} ${agent.id.substring(0, 15)}...`,\r\n    );\r\n    this.agentsList.setItems(agentItems.length > 0 ? agentItems : ['No agents']);\r\n\r\n    // Update tasks list if objective is selected\r\n    if (this.selectedObjective) {\r\n      this.updateTasksList();\r\n    }\r\n\r\n    this.screen.render();\r\n  }\r\n\r\n  updateTasksList() {\r\n    if (!this.selectedObjective) return;\r\n\r\n    const objectiveTasks = this.swarmData.tasks.filter(\r\n      (task) => task.swarmId === this.selectedObjective.id,\r\n    );\r\n\r\n    const taskItems = objectiveTasks.map((task) => {\r\n      const statusIcon =\r\n        {\r\n          active: 'ðŸ”„',\r\n          completed: 'âœ…',\r\n          failed: 'âŒ',\r\n          pending: 'â³',\r\n        }[task.status] || 'â“';\r\n\r\n      return `${statusIcon} ${task.task?.type || 'Unknown'}: ${task.task?.description?.substring(0, 20) || 'No description'}...`;\r\n    });\r\n\r\n    this.tasksList.setItems(taskItems.length > 0 ? taskItems : ['No tasks']);\r\n    this.screen.render();\r\n  }\r\n\r\n  updateTaskDetails(task) {\r\n    const details = [\r\n      `Task ID: ${task.agentId}`,\r\n      `Swarm ID: ${task.swarmId}`,\r\n      `Type: ${task.task?.type || 'Unknown'}`,\r\n      `Description: ${task.task?.description || 'No description'}`,\r\n      `Status: ${task.status || 'Unknown'}`,\r\n      `Start Time: ${task.startTime || 'Not started'}`,\r\n      '',\r\n      'Task Data:',\r\n      JSON.stringify(task.task, null, 2),\r\n    ].join('\\n');\r\n\r\n    this.taskDetails.setContent(details);\r\n    this.screen.render();\r\n  }\r\n\r\n  promptCreateObjective() {\r\n    // Create a prompt box\r\n    const promptBox = blessed.prompt({\r\n      parent: this.screen,\r\n      top: 'center',\r\n      left: 'center',\r\n      width: 60,\r\n      height: 10,\r\n      label: ' Create New Objective ',\r\n      content: 'Enter objective description:',\r\n      border: {\r\n        type: 'line',\r\n      },\r\n      style: {\r\n        border: {\r\n          fg: 'cyan',\r\n        },\r\n      },\r\n    });\r\n\r\n    promptBox.input('Enter objective:', '', (err, value) => {\r\n      if (!err && value) {\r\n        this.createObjective(value);\r\n      }\r\n      promptBox.destroy();\r\n      this.screen.render();\r\n    });\r\n\r\n    this.screen.render();\r\n  }\r\n\r\n  async createObjective(description) {\r\n    try {\r\n      this.log(`Creating objective: ${description}`);\r\n\r\n      // Execute swarm command\r\n      const args = ['swarm', description, '--ui', '--monitor'];\r\n      const process = spawn('claude-flow', args, {\r\n        detached: true,\r\n        stdio: 'ignore',\r\n      });\r\n\r\n      process.unref();\r\n\r\n      // Track the process for later termination\r\n      const processId = `swarm-${Date.now()}`;\r\n      this.activeProcesses.set(processId, process);\r\n\r\n      this.log(`Launched swarm with PID: ${process.pid} (ID: ${processId})`);\r\n\r\n      // Update data after a delay\r\n      setTimeout(() => {\r\n        this.updateSwarmData();\r\n      }, 2000);\r\n    } catch (error) {\r\n      this.log(`Error creating objective: ${error.message}`, 'error');\r\n    }\r\n  }\r\n\r\n  async stopSwarm() {\r\n    this.log('Stopping all swarm operations...');\r\n\r\n    try {\r\n      // Cross-platform process termination\r\n      let stoppedCount = 0;\r\n\r\n      // First, try to stop tracked processes\r\n      for (const [processId, process] of this.activeProcesses) {\r\n        try {\r\n          // Use process.kill() for cross-platform compatibility\r\n          if (process.pid && !process.killed) {\r\n            process.kill('SIGTERM');\r\n            stoppedCount++;\r\n            this.log(`Stopped process ${processId} (PID: ${process.pid})`);\r\n          }\r\n        } catch (err) {\r\n          // Process might already be dead\r\n          this.log(`Process ${processId} already terminated`, 'warn');\r\n        }\r\n      }\r\n\r\n      // Clear the tracked processes\r\n      this.activeProcesses.clear();\r\n\r\n      // Also find and stop any orphaned processes\r\n      await this.stopOrphanedProcesses();\r\n\r\n      this.log(`Swarm operations stopped (${stoppedCount} processes terminated)`);\r\n\r\n      // Update display\r\n      this.swarmData.status = 'stopped';\r\n      this.updateDisplay();\r\n    } catch (error) {\r\n      this.log(`Error stopping swarm: ${error.message}`, 'error');\r\n    }\r\n  }\r\n\r\n  async stopOrphanedProcesses() {\r\n    // Cross-platform approach to find and stop orphaned processes\r\n    const { exec } = require('child_process');\r\n    const os = require('os');\r\n\r\n    if (os.platform() === 'win32') {\r\n      // Windows: Use wmic to find and kill processes\r\n      exec(\r\n        'wmic process where \"commandline like \\'%claude-flow swarm%\\'\" get processid',\r\n        (error, stdout) => {\r\n          if (!error && stdout) {\r\n            const pids = stdout\r\n              .split('\\n')\r\n              .map((line) => line.trim())\r\n              .filter((line) => /^\\d+$/.test(line));\r\n\r\n            pids.forEach((pid) => {\r\n              exec(`taskkill /F /PID ${pid}`, (killError) => {\r\n                if (!killError) {\r\n                  this.log(`Stopped orphaned process PID: ${pid}`);\r\n                }\r\n              });\r\n            });\r\n          }\r\n        },\r\n      );\r\n    } else {\r\n      // Unix-like systems: Use ps and grep\r\n      exec('ps aux | grep \"claude-flow swarm\" | grep -v grep', (error, stdout) => {\r\n        if (!error && stdout) {\r\n          const lines = stdout.split('\\n').filter((line) => line.trim());\r\n          lines.forEach((line) => {\r\n            const parts = line.split(/\\s+/);\r\n            const pid = parts[1];\r\n            if (pid && /^\\d+$/.test(pid)) {\r\n              try {\r\n                process.kill(parseInt(pid), 'SIGTERM');\r\n                this.log(`Stopped orphaned process PID: ${pid}`);\r\n              } catch (killError) {\r\n                // Process might not exist or no permission\r\n              }\r\n            }\r\n          });\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  async executeCommand(command) {\r\n    this.log(`Executing command: ${command}`);\r\n\r\n    try {\r\n      const { exec } = require('child_process');\r\n      exec(command, (error, stdout, stderr) => {\r\n        if (error) {\r\n          this.log(`Command error: ${error.message}`, 'error');\r\n        } else {\r\n          if (stdout) this.log(`Output: ${stdout.trim()}`);\r\n          if (stderr) this.log(`Error: ${stderr.trim()}`, 'warn');\r\n        }\r\n      });\r\n    } catch (error) {\r\n      this.log(`Failed to execute command: ${error.message}`, 'error');\r\n    }\r\n  }\r\n\r\n  log(message, level = 'info') {\r\n    const timestamp = new Date().toLocaleTimeString();\r\n    const levelColors = {\r\n      info: 'white',\r\n      warn: 'yellow',\r\n      error: 'red',\r\n      success: 'green',\r\n    };\r\n\r\n    const coloredMessage = `{${levelColors[level] || 'white'}-fg}[${timestamp}] ${message}{/}`;\r\n\r\n    this.logBuffer.push(coloredMessage);\r\n    if (this.logBuffer.length > this.maxLogLines) {\r\n      this.logBuffer.shift();\r\n    }\r\n\r\n    if (this.logBox) {\r\n      this.logBox.log(coloredMessage);\r\n      this.screen.render();\r\n    }\r\n  }\r\n\r\n  cleanup() {\r\n    if (this.updateInterval) {\r\n      clearInterval(this.updateInterval);\r\n    }\r\n\r\n    // Clean up any remaining processes\r\n    for (const [processId, process] of this.activeProcesses) {\r\n      try {\r\n        if (process.pid && !process.killed) {\r\n          process.kill('SIGTERM');\r\n        }\r\n      } catch (err) {\r\n        // Ignore errors during cleanup\r\n      }\r\n    }\r\n    this.activeProcesses.clear();\r\n  }\r\n}\r\n\r\n// Main execution\r\nasync function main() {\r\n  const ui = new SwarmUI();\r\n\r\n  try {\r\n    await ui.init();\r\n  } catch (error) {\r\n    console.error('Failed to initialize Swarm UI:', error);\r\n    process.exit(1);\r\n  }\r\n}\r\n\r\n// Handle uncaught exceptions\r\nprocess.on('uncaughtException', (error) => {\r\n  console.error('Uncaught exception:', error);\r\n  process.exit(1);\r\n});\r\n\r\nprocess.on('unhandledRejection', (error) => {\r\n  console.error('Unhandled rejection:', error);\r\n  process.exit(1);\r\n});\r\n\r\nif (require.main === module) {\r\n  main();\r\n}\r\n\r\nmodule.exports = SwarmUI;\r\n"],"names":["blessed","require","fs","promises","path","spawn","SwarmUI","screen","swarmData","objectives","agents","tasks","status","selectedObjective","updateInterval","logBuffer","maxLogLines","activeProcesses","Map","init","smartCSR","title","createLayout","bindEvents","startMonitoring","render","mainBox","box","parent","top","left","width","height","border","type","style","fg","headerBox","content","tags","bg","statusBox","leftPanel","label","objectivesList","list","items","keys","vi","mouse","selected","item","agentsList","centerPanel","tasksList","taskDetails","scrollable","alwaysScroll","rightPanel","logBox","log","controlBox","createButton","button","align","focus","stopButton","commandBox","textbox","bottom","inputOnFocus","key","cleanup","process","exit","on","index","updateTasksList","description","task","updateTaskDetails","promptCreateObjective","stopSwarm","value","executeCommand","clearValue","focusNext","focusPrevious","setInterval","updateSwarmData","swarmRunsDir","runs","readdir","runDir","configPath","join","configData","readFile","config","JSON","parse","push","id","swarmId","objective","startTime","agentsDir","agentDir","taskPath","taskData","agentId","e","updateDisplay","error","message","activeObjectives","filter","o","length","activeAgents","a","setContent","objectiveItems","map","obj","substring","setItems","agentItems","agent","objectiveTasks","taskItems","statusIcon","active","completed","failed","pending","details","stringify","promptBox","prompt","input","err","createObjective","destroy","args","detached","stdio","unref","processId","Date","now","set","pid","setTimeout","stoppedCount","killed","kill","clear","stopOrphanedProcesses","exec","os","platform","stdout","pids","split","line","trim","test","forEach","killError","lines","parts","parseInt","command","stderr","level","timestamp","toLocaleTimeString","levelColors","info","warn","success","coloredMessage","shift","clearInterval","main","ui","console","module","exports"],"mappings":";AAOA,MAAMA,UAAUC,QAAQ;AACxB,MAAMC,KAAKD,QAAQ,MAAME,QAAQ;AACjC,MAAMC,OAAOH,QAAQ;AACrB,MAAM,EAAEI,KAAK,EAAE,GAAGJ,QAAQ;AAE1B,IAAA,AAAMK,UAAN,MAAMA;IACJ,aAAc;QACZ,IAAI,CAACC,MAAM,GAAG;QACd,IAAI,CAACC,SAAS,GAAG;YACfC,YAAY,EAAE;YACdC,QAAQ,EAAE;YACVC,OAAO,EAAE;YACTC,QAAQ;QACV;QACA,IAAI,CAACC,iBAAiB,GAAG;QACzB,IAAI,CAACC,cAAc,GAAG;QACtB,IAAI,CAACC,SAAS,GAAG,EAAE;QACnB,IAAI,CAACC,WAAW,GAAG;QACnB,IAAI,CAACC,eAAe,GAAG,IAAIC;IAC7B;IAEA,MAAMC,OAAO;QAEX,IAAI,CAACZ,MAAM,GAAGP,QAAQO,MAAM,CAAC;YAC3Ba,UAAU;YACVC,OAAO;QACT;QAEA,IAAI,CAACC,YAAY;QACjB,IAAI,CAACC,UAAU;QACf,IAAI,CAACC,eAAe;QAEpB,IAAI,CAACjB,MAAM,CAACkB,MAAM;IACpB;IAEAH,eAAe;QAEb,MAAMI,UAAU1B,QAAQ2B,GAAG,CAAC;YAC1BC,QAAQ,IAAI,CAACrB,MAAM;YACnBsB,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRC,QAAQ;gBACNC,MAAM;YACR;YACAC,OAAO;gBACLF,QAAQ;oBACNG,IAAI;gBACN;YACF;QACF;QAGA,IAAI,CAACC,SAAS,GAAGrC,QAAQ2B,GAAG,CAAC;YAC3BC,QAAQF;YACRG,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRM,SAAS;YACTC,MAAM;YACNJ,OAAO;gBACLC,IAAI;gBACJI,IAAI;YACN;QACF;QAGA,IAAI,CAACC,SAAS,GAAGzC,QAAQ2B,GAAG,CAAC;YAC3BC,QAAQF;YACRG,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRM,SAAS;YACTH,OAAO;gBACLC,IAAI;YACN;QACF;QAGA,MAAMM,YAAY1C,QAAQ2B,GAAG,CAAC;YAC5BC,QAAQF;YACRG,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRC,QAAQ;gBACNC,MAAM;YACR;YACAS,OAAO;YACPR,OAAO;gBACLF,QAAQ;oBACNG,IAAI;gBACN;YACF;QACF;QAGA,IAAI,CAACQ,cAAc,GAAG5C,QAAQ6C,IAAI,CAAC;YACjCjB,QAAQc;YACRb,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRW,OAAO;YACPG,OAAO;gBAAC;aAAgB;YACxBC,MAAM;YACNC,IAAI;YACJC,OAAO;YACPd,OAAO;gBACLe,UAAU;oBACRV,IAAI;gBACN;gBACAW,MAAM;oBACJf,IAAI;gBACN;YACF;QACF;QAGA,IAAI,CAACgB,UAAU,GAAGpD,QAAQ6C,IAAI,CAAC;YAC7BjB,QAAQc;YACRb,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRW,OAAO;YACPG,OAAO;gBAAC;aAAY;YACpBC,MAAM;YACNC,IAAI;YACJC,OAAO;YACPd,OAAO;gBACLe,UAAU;oBACRV,IAAI;gBACN;gBACAW,MAAM;oBACJf,IAAI;gBACN;YACF;QACF;QAGA,MAAMiB,cAAcrD,QAAQ2B,GAAG,CAAC;YAC9BC,QAAQF;YACRG,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRC,QAAQ;gBACNC,MAAM;YACR;YACAS,OAAO;YACPR,OAAO;gBACLF,QAAQ;oBACNG,IAAI;gBACN;YACF;QACF;QAGA,IAAI,CAACkB,SAAS,GAAGtD,QAAQ6C,IAAI,CAAC;YAC5BjB,QAAQyB;YACRxB,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRW,OAAO;YACPG,OAAO;gBAAC;aAAW;YACnBC,MAAM;YACNC,IAAI;YACJC,OAAO;YACPd,OAAO;gBACLe,UAAU;oBACRV,IAAI;oBACJJ,IAAI;gBACN;gBACAe,MAAM;oBACJf,IAAI;gBACN;YACF;QACF;QAGA,IAAI,CAACmB,WAAW,GAAGvD,QAAQ2B,GAAG,CAAC;YAC7BC,QAAQyB;YACRxB,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRW,OAAO;YACPL,SAAS;YACTkB,YAAY;YACZC,cAAc;YACdV,MAAM;YACNC,IAAI;YACJC,OAAO;YACPd,OAAO;gBACLC,IAAI;YACN;QACF;QAGA,MAAMsB,aAAa1D,QAAQ2B,GAAG,CAAC;YAC7BC,QAAQF;YACRG,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRC,QAAQ;gBACNC,MAAM;YACR;YACAS,OAAO;YACPR,OAAO;gBACLF,QAAQ;oBACNG,IAAI;gBACN;YACF;QACF;QAGA,IAAI,CAACuB,MAAM,GAAG3D,QAAQ4D,GAAG,CAAC;YACxBhC,QAAQ8B;YACR7B,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRW,OAAO;YACPJ,MAAM;YACNU,OAAO;YACPO,YAAY;YACZC,cAAc;YACdtB,OAAO;gBACLC,IAAI;YACN;QACF;QAGA,IAAI,CAACyB,UAAU,GAAG7D,QAAQ2B,GAAG,CAAC;YAC5BC,QAAQ8B;YACR7B,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRW,OAAO;QACT;QAGA,IAAI,CAACmB,YAAY,GAAG9D,QAAQ+D,MAAM,CAAC;YACjCnC,QAAQ,IAAI,CAACiC,UAAU;YACvBhC,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRM,SAAS;YACT0B,OAAO;YACP7B,OAAO;gBACLK,IAAI;gBACJJ,IAAI;gBACJ6B,OAAO;oBACLzB,IAAI;gBACN;YACF;QACF;QAGA,IAAI,CAAC0B,UAAU,GAAGlE,QAAQ+D,MAAM,CAAC;YAC/BnC,QAAQ,IAAI,CAACiC,UAAU;YACvBhC,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRM,SAAS;YACT0B,OAAO;YACP7B,OAAO;gBACLK,IAAI;gBACJJ,IAAI;gBACJ6B,OAAO;oBACLzB,IAAI;oBACJJ,IAAI;gBACN;YACF;QACF;QAGA,IAAI,CAAC+B,UAAU,GAAGnE,QAAQoE,OAAO,CAAC;YAChCxC,QAAQF;YACR2C,QAAQ;YACRvC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRW,OAAO;YACPI,MAAM;YACNE,OAAO;YACPqB,cAAc;YACdnC,OAAO;gBACLF,QAAQ;oBACNG,IAAI;gBACN;gBACAA,IAAI;YACN;QACF;IACF;IAEAb,aAAa;QAEX,IAAI,CAAChB,MAAM,CAACgE,GAAG,CAAC;YAAC;YAAU;YAAK;SAAM,EAAE;YACtC,IAAI,CAACC,OAAO;YACZC,QAAQC,IAAI,CAAC;QACf;QAGA,IAAI,CAAC9B,cAAc,CAAC+B,EAAE,CAAC,UAAU,CAACxB,MAAMyB;YACtC,IAAI,CAAC/D,iBAAiB,GAAG,IAAI,CAACL,SAAS,CAACC,UAAU,CAACmE,MAAM;YACzD,IAAI,CAACC,eAAe;YACpB,IAAI,CAACjB,GAAG,CAAC,CAAC,oBAAoB,EAAE,IAAI,CAAC/C,iBAAiB,EAAEiE,eAAe,WAAW;QACpF;QAGA,IAAI,CAACxB,SAAS,CAACqB,EAAE,CAAC,UAAU,CAACxB,MAAMyB;YACjC,MAAMG,OAAO,IAAI,CAACvE,SAAS,CAACG,KAAK,CAACiE,MAAM;YACxC,IAAIG,MAAM;gBACR,IAAI,CAACC,iBAAiB,CAACD;YACzB;QACF;QAGA,IAAI,CAACjB,YAAY,CAACa,EAAE,CAAC,SAAS;YAC5B,IAAI,CAACM,qBAAqB;QAC5B;QAGA,IAAI,CAACf,UAAU,CAACS,EAAE,CAAC,SAAS;YAC1B,IAAI,CAACO,SAAS;QAChB;QAGA,IAAI,CAACf,UAAU,CAACQ,EAAE,CAAC,UAAU,CAACQ;YAC5B,IAAI,CAACC,cAAc,CAACD;YACpB,IAAI,CAAChB,UAAU,CAACkB,UAAU;YAC1B,IAAI,CAAC9E,MAAM,CAACkB,MAAM;QACpB;QAGA,IAAI,CAAClB,MAAM,CAACgE,GAAG,CAAC;YAAC;SAAM,EAAE;YACvB,IAAI,CAAChE,MAAM,CAAC+E,SAAS;QACvB;QAEA,IAAI,CAAC/E,MAAM,CAACgE,GAAG,CAAC;YAAC;SAAQ,EAAE;YACzB,IAAI,CAAChE,MAAM,CAACgF,aAAa;QAC3B;IACF;IAEA,MAAM/D,kBAAkB;QACtB,IAAI,CAACoC,GAAG,CAAC;QAGT,IAAI,CAAC9C,cAAc,GAAG0E,YAAY;YAChC,IAAI,CAACC,eAAe;QACtB,GAAG;QAGH,MAAM,IAAI,CAACA,eAAe;IAC5B;IAEA,MAAMA,kBAAkB;QACtB,IAAI;YAEF,MAAMC,eAAe;YAErB,IAAI;gBACF,MAAMC,OAAO,MAAMzF,GAAG0F,OAAO,CAACF;gBAC9B,IAAI,CAAClF,SAAS,CAACC,UAAU,GAAG,EAAE;gBAC9B,IAAI,CAACD,SAAS,CAACE,MAAM,GAAG,EAAE;gBAC1B,IAAI,CAACF,SAAS,CAACG,KAAK,GAAG,EAAE;gBAEzB,KAAK,MAAMkF,UAAUF,KAAM;oBACzB,MAAMG,aAAa1F,KAAK2F,IAAI,CAACL,cAAcG,QAAQ;oBACnD,IAAI;wBACF,MAAMG,aAAa,MAAM9F,GAAG+F,QAAQ,CAACH,YAAY;wBACjD,MAAMI,SAASC,KAAKC,KAAK,CAACJ;wBAE1B,IAAI,CAACxF,SAAS,CAACC,UAAU,CAAC4F,IAAI,CAAC;4BAC7BC,IAAIJ,OAAOK,OAAO;4BAClBzB,aAAaoB,OAAOM,SAAS;4BAC7B5F,QAAQ;4BACR6F,WAAWP,OAAOO,SAAS;wBAC7B;wBAGA,MAAMC,YAAYtG,KAAK2F,IAAI,CAACL,cAAcG,QAAQ;wBAClD,IAAI;4BACF,MAAMnF,SAAS,MAAMR,GAAG0F,OAAO,CAACc;4BAChC,KAAK,MAAMC,YAAYjG,OAAQ;gCAC7B,MAAMkG,WAAWxG,KAAK2F,IAAI,CAACW,WAAWC,UAAU;gCAChD,IAAI;oCACF,MAAME,WAAW,MAAM3G,GAAG+F,QAAQ,CAACW,UAAU;oCAC7C,MAAM7B,OAAOoB,KAAKC,KAAK,CAACS;oCAExB,IAAI,CAACrG,SAAS,CAACE,MAAM,CAAC2F,IAAI,CAAC;wCACzBC,IAAIvB,KAAK+B,OAAO;wCAChBP,SAASL,OAAOK,OAAO;wCACvB3F,QAAQmE,KAAKnE,MAAM,IAAI;wCACvBmE,MAAMA,KAAKA,IAAI;oCACjB;oCAEA,IAAI,CAACvE,SAAS,CAACG,KAAK,CAAC0F,IAAI,CAACtB;gCAC5B,EAAE,OAAOgC,GAAG,CAEZ;4BACF;wBACF,EAAE,OAAOA,GAAG,CAEZ;oBACF,EAAE,OAAOA,GAAG,CAEZ;gBACF;gBAEA,IAAI,CAACC,aAAa;YACpB,EAAE,OAAOD,GAAG;gBAEV,IAAI,CAACvG,SAAS,CAACI,MAAM,GAAG;YAC1B;QACF,EAAE,OAAOqG,OAAO;YACd,IAAI,CAACrD,GAAG,CAAC,CAAC,2BAA2B,EAAEqD,MAAMC,OAAO,EAAE,EAAE;QAC1D;IACF;IAEAF,gBAAgB;QAEd,MAAMG,mBAAmB,IAAI,CAAC3G,SAAS,CAACC,UAAU,CAAC2G,MAAM,CAAC,CAACC,IAAMA,EAAEzG,MAAM,KAAK,WAAW0G,MAAM;QAC/F,MAAMC,eAAe,IAAI,CAAC/G,SAAS,CAACE,MAAM,CAAC0G,MAAM,CAAC,CAACI,IAAMA,EAAE5G,MAAM,KAAK,UAAU0G,MAAM;QAEtF,IAAI,CAAC7E,SAAS,CAACgF,UAAU,CACvB,CAAC,QAAQ,EAAE,IAAI,CAACjH,SAAS,CAACI,MAAM,CAAC,GAAG,CAAC,GACnC,CAAC,YAAY,EAAEuG,iBAAiB,GAAG,CAAC,GACpC,CAAC,QAAQ,EAAEI,aAAa,GAAG,CAAC,GAC5B,CAAC,OAAO,EAAE,IAAI,CAAC/G,SAAS,CAACG,KAAK,CAAC2G,MAAM,EAAE;QAI3C,MAAMI,iBAAiB,IAAI,CAAClH,SAAS,CAACC,UAAU,CAACkH,GAAG,CAClD,CAACC,MAAQ,GAAGA,IAAIhH,MAAM,KAAK,YAAY,OAAO,KAAK,CAAC,EAAEgH,IAAI9C,WAAW,CAAC+C,SAAS,CAAC,GAAG,IAAI,GAAG,CAAC;QAE7F,IAAI,CAACjF,cAAc,CAACkF,QAAQ,CAACJ,eAAeJ,MAAM,GAAG,IAAII,iBAAiB;YAAC;SAAgB;QAG3F,MAAMK,aAAa,IAAI,CAACvH,SAAS,CAACE,MAAM,CAACiH,GAAG,CAC1C,CAACK,QAAU,GAAGA,MAAMpH,MAAM,KAAK,WAAW,OAAO,KAAK,CAAC,EAAEoH,MAAM1B,EAAE,CAACuB,SAAS,CAAC,GAAG,IAAI,GAAG,CAAC;QAEzF,IAAI,CAACzE,UAAU,CAAC0E,QAAQ,CAACC,WAAWT,MAAM,GAAG,IAAIS,aAAa;YAAC;SAAY;QAG3E,IAAI,IAAI,CAAClH,iBAAiB,EAAE;YAC1B,IAAI,CAACgE,eAAe;QACtB;QAEA,IAAI,CAACtE,MAAM,CAACkB,MAAM;IACpB;IAEAoD,kBAAkB;QAChB,IAAI,CAAC,IAAI,CAAChE,iBAAiB,EAAE;QAE7B,MAAMoH,iBAAiB,IAAI,CAACzH,SAAS,CAACG,KAAK,CAACyG,MAAM,CAChD,CAACrC,OAASA,KAAKwB,OAAO,KAAK,IAAI,CAAC1F,iBAAiB,CAACyF,EAAE;QAGtD,MAAM4B,YAAYD,eAAeN,GAAG,CAAC,CAAC5C;YACpC,MAAMoD,aACJ;gBACEC,QAAQ;gBACRC,WAAW;gBACXC,QAAQ;gBACRC,SAAS;YACX,CAAC,CAACxD,KAAKnE,MAAM,CAAC,IAAI;YAEpB,OAAO,GAAGuH,WAAW,CAAC,EAAEpD,KAAKA,IAAI,EAAE7C,QAAQ,UAAU,EAAE,EAAE6C,KAAKA,IAAI,EAAED,aAAa+C,UAAU,GAAG,OAAO,iBAAiB,GAAG,CAAC;QAC5H;QAEA,IAAI,CAACvE,SAAS,CAACwE,QAAQ,CAACI,UAAUZ,MAAM,GAAG,IAAIY,YAAY;YAAC;SAAW;QACvE,IAAI,CAAC3H,MAAM,CAACkB,MAAM;IACpB;IAEAuD,kBAAkBD,IAAI,EAAE;QACtB,MAAMyD,UAAU;YACd,CAAC,SAAS,EAAEzD,KAAK+B,OAAO,EAAE;YAC1B,CAAC,UAAU,EAAE/B,KAAKwB,OAAO,EAAE;YAC3B,CAAC,MAAM,EAAExB,KAAKA,IAAI,EAAE7C,QAAQ,WAAW;YACvC,CAAC,aAAa,EAAE6C,KAAKA,IAAI,EAAED,eAAe,kBAAkB;YAC5D,CAAC,QAAQ,EAAEC,KAAKnE,MAAM,IAAI,WAAW;YACrC,CAAC,YAAY,EAAEmE,KAAK0B,SAAS,IAAI,eAAe;YAChD;YACA;YACAN,KAAKsC,SAAS,CAAC1D,KAAKA,IAAI,EAAE,MAAM;SACjC,CAACgB,IAAI,CAAC;QAEP,IAAI,CAACxC,WAAW,CAACkE,UAAU,CAACe;QAC5B,IAAI,CAACjI,MAAM,CAACkB,MAAM;IACpB;IAEAwD,wBAAwB;QAEtB,MAAMyD,YAAY1I,QAAQ2I,MAAM,CAAC;YAC/B/G,QAAQ,IAAI,CAACrB,MAAM;YACnBsB,KAAK;YACLC,MAAM;YACNC,OAAO;YACPC,QAAQ;YACRW,OAAO;YACPL,SAAS;YACTL,QAAQ;gBACNC,MAAM;YACR;YACAC,OAAO;gBACLF,QAAQ;oBACNG,IAAI;gBACN;YACF;QACF;QAEAsG,UAAUE,KAAK,CAAC,oBAAoB,IAAI,CAACC,KAAK1D;YAC5C,IAAI,CAAC0D,OAAO1D,OAAO;gBACjB,IAAI,CAAC2D,eAAe,CAAC3D;YACvB;YACAuD,UAAUK,OAAO;YACjB,IAAI,CAACxI,MAAM,CAACkB,MAAM;QACpB;QAEA,IAAI,CAAClB,MAAM,CAACkB,MAAM;IACpB;IAEA,MAAMqH,gBAAgBhE,WAAW,EAAE;QACjC,IAAI;YACF,IAAI,CAAClB,GAAG,CAAC,CAAC,oBAAoB,EAAEkB,aAAa;YAG7C,MAAMkE,OAAO;gBAAC;gBAASlE;gBAAa;gBAAQ;aAAY;YACxD,MAAML,WAAUpE,MAAM,eAAe2I,MAAM;gBACzCC,UAAU;gBACVC,OAAO;YACT;YAEAzE,SAAQ0E,KAAK;YAGb,MAAMC,YAAY,CAAC,MAAM,EAAEC,KAAKC,GAAG,IAAI;YACvC,IAAI,CAACrI,eAAe,CAACsI,GAAG,CAACH,WAAW3E;YAEpC,IAAI,CAACb,GAAG,CAAC,CAAC,yBAAyB,EAAEa,SAAQ+E,GAAG,CAAC,MAAM,EAAEJ,UAAU,CAAC,CAAC;YAGrEK,WAAW;gBACT,IAAI,CAAChE,eAAe;YACtB,GAAG;QACL,EAAE,OAAOwB,OAAO;YACd,IAAI,CAACrD,GAAG,CAAC,CAAC,0BAA0B,EAAEqD,MAAMC,OAAO,EAAE,EAAE;QACzD;IACF;IAEA,MAAMhC,YAAY;QAChB,IAAI,CAACtB,GAAG,CAAC;QAET,IAAI;YAEF,IAAI8F,eAAe;YAGnB,KAAK,MAAM,CAACN,WAAW3E,SAAQ,IAAI,IAAI,CAACxD,eAAe,CAAE;gBACvD,IAAI;oBAEF,IAAIwD,SAAQ+E,GAAG,IAAI,CAAC/E,SAAQkF,MAAM,EAAE;wBAClClF,SAAQmF,IAAI,CAAC;wBACbF;wBACA,IAAI,CAAC9F,GAAG,CAAC,CAAC,gBAAgB,EAAEwF,UAAU,OAAO,EAAE3E,SAAQ+E,GAAG,CAAC,CAAC,CAAC;oBAC/D;gBACF,EAAE,OAAOX,KAAK;oBAEZ,IAAI,CAACjF,GAAG,CAAC,CAAC,QAAQ,EAAEwF,UAAU,mBAAmB,CAAC,EAAE;gBACtD;YACF;YAGA,IAAI,CAACnI,eAAe,CAAC4I,KAAK;YAG1B,MAAM,IAAI,CAACC,qBAAqB;YAEhC,IAAI,CAAClG,GAAG,CAAC,CAAC,0BAA0B,EAAE8F,aAAa,sBAAsB,CAAC;YAG1E,IAAI,CAAClJ,SAAS,CAACI,MAAM,GAAG;YACxB,IAAI,CAACoG,aAAa;QACpB,EAAE,OAAOC,OAAO;YACd,IAAI,CAACrD,GAAG,CAAC,CAAC,sBAAsB,EAAEqD,MAAMC,OAAO,EAAE,EAAE;QACrD;IACF;IAEA,MAAM4C,wBAAwB;QAE5B,MAAM,EAAEC,IAAI,EAAE,GAAG9J,QAAQ;QACzB,MAAM+J,KAAK/J,QAAQ;QAEnB,IAAI+J,GAAGC,QAAQ,OAAO,SAAS;YAE7BF,KACE,+EACA,CAAC9C,OAAOiD;gBACN,IAAI,CAACjD,SAASiD,QAAQ;oBACpB,MAAMC,OAAOD,OACVE,KAAK,CAAC,MACNzC,GAAG,CAAC,CAAC0C,OAASA,KAAKC,IAAI,IACvBlD,MAAM,CAAC,CAACiD,OAAS,QAAQE,IAAI,CAACF;oBAEjCF,KAAKK,OAAO,CAAC,CAAChB;wBACZO,KAAK,CAAC,iBAAiB,EAAEP,KAAK,EAAE,CAACiB;4BAC/B,IAAI,CAACA,WAAW;gCACd,IAAI,CAAC7G,GAAG,CAAC,CAAC,8BAA8B,EAAE4F,KAAK;4BACjD;wBACF;oBACF;gBACF;YACF;QAEJ,OAAO;YAELO,KAAK,oDAAoD,CAAC9C,OAAOiD;gBAC/D,IAAI,CAACjD,SAASiD,QAAQ;oBACpB,MAAMQ,QAAQR,OAAOE,KAAK,CAAC,MAAMhD,MAAM,CAAC,CAACiD,OAASA,KAAKC,IAAI;oBAC3DI,MAAMF,OAAO,CAAC,CAACH;wBACb,MAAMM,QAAQN,KAAKD,KAAK,CAAC;wBACzB,MAAMZ,MAAMmB,KAAK,CAAC,EAAE;wBACpB,IAAInB,OAAO,QAAQe,IAAI,CAACf,MAAM;4BAC5B,IAAI;gCACF/E,QAAQmF,IAAI,CAACgB,SAASpB,MAAM;gCAC5B,IAAI,CAAC5F,GAAG,CAAC,CAAC,8BAA8B,EAAE4F,KAAK;4BACjD,EAAE,OAAOiB,WAAW,CAEpB;wBACF;oBACF;gBACF;YACF;QACF;IACF;IAEA,MAAMrF,eAAeyF,OAAO,EAAE;QAC5B,IAAI,CAACjH,GAAG,CAAC,CAAC,mBAAmB,EAAEiH,SAAS;QAExC,IAAI;YACF,MAAM,EAAEd,IAAI,EAAE,GAAG9J,QAAQ;YACzB8J,KAAKc,SAAS,CAAC5D,OAAOiD,QAAQY;gBAC5B,IAAI7D,OAAO;oBACT,IAAI,CAACrD,GAAG,CAAC,CAAC,eAAe,EAAEqD,MAAMC,OAAO,EAAE,EAAE;gBAC9C,OAAO;oBACL,IAAIgD,QAAQ,IAAI,CAACtG,GAAG,CAAC,CAAC,QAAQ,EAAEsG,OAAOI,IAAI,IAAI;oBAC/C,IAAIQ,QAAQ,IAAI,CAAClH,GAAG,CAAC,CAAC,OAAO,EAAEkH,OAAOR,IAAI,IAAI,EAAE;gBAClD;YACF;QACF,EAAE,OAAOrD,OAAO;YACd,IAAI,CAACrD,GAAG,CAAC,CAAC,2BAA2B,EAAEqD,MAAMC,OAAO,EAAE,EAAE;QAC1D;IACF;IAEAtD,IAAIsD,OAAO,EAAE6D,QAAQ,MAAM,EAAE;QAC3B,MAAMC,YAAY,IAAI3B,OAAO4B,kBAAkB;QAC/C,MAAMC,cAAc;YAClBC,MAAM;YACNC,MAAM;YACNnE,OAAO;YACPoE,SAAS;QACX;QAEA,MAAMC,iBAAiB,CAAC,CAAC,EAAEJ,WAAW,CAACH,MAAM,IAAI,QAAQ,KAAK,EAAEC,UAAU,EAAE,EAAE9D,QAAQ,GAAG,CAAC;QAE1F,IAAI,CAACnG,SAAS,CAACsF,IAAI,CAACiF;QACpB,IAAI,IAAI,CAACvK,SAAS,CAACuG,MAAM,GAAG,IAAI,CAACtG,WAAW,EAAE;YAC5C,IAAI,CAACD,SAAS,CAACwK,KAAK;QACtB;QAEA,IAAI,IAAI,CAAC5H,MAAM,EAAE;YACf,IAAI,CAACA,MAAM,CAACC,GAAG,CAAC0H;YAChB,IAAI,CAAC/K,MAAM,CAACkB,MAAM;QACpB;IACF;IAEA+C,UAAU;QACR,IAAI,IAAI,CAAC1D,cAAc,EAAE;YACvB0K,cAAc,IAAI,CAAC1K,cAAc;QACnC;QAGA,KAAK,MAAM,CAACsI,WAAW3E,SAAQ,IAAI,IAAI,CAACxD,eAAe,CAAE;YACvD,IAAI;gBACF,IAAIwD,SAAQ+E,GAAG,IAAI,CAAC/E,SAAQkF,MAAM,EAAE;oBAClClF,SAAQmF,IAAI,CAAC;gBACf;YACF,EAAE,OAAOf,KAAK,CAEd;QACF;QACA,IAAI,CAAC5H,eAAe,CAAC4I,KAAK;IAC5B;AACF;AAGA,eAAe4B;IACb,MAAMC,KAAK,IAAIpL;IAEf,IAAI;QACF,MAAMoL,GAAGvK,IAAI;IACf,EAAE,OAAO8F,OAAO;QACd0E,QAAQ1E,KAAK,CAAC,kCAAkCA;QAChDxC,QAAQC,IAAI,CAAC;IACf;AACF;AAGAD,QAAQE,EAAE,CAAC,qBAAqB,CAACsC;IAC/B0E,QAAQ1E,KAAK,CAAC,uBAAuBA;IACrCxC,QAAQC,IAAI,CAAC;AACf;AAEAD,QAAQE,EAAE,CAAC,sBAAsB,CAACsC;IAChC0E,QAAQ1E,KAAK,CAAC,wBAAwBA;IACtCxC,QAAQC,IAAI,CAAC;AACf;AAEA,IAAIzE,QAAQwL,IAAI,KAAKG,QAAQ;IAC3BH;AACF;AAEAG,OAAOC,OAAO,GAAGvL"}