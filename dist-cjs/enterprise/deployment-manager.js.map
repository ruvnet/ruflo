{
  "version": 3,
  "sources": ["../../src/enterprise/deployment-manager.ts"],
  "sourcesContent": ["import { EventEmitter } from 'events';\nimport { writeFile, readFile, mkdir, readdir } from 'fs/promises';\nimport { join } from 'path';\nimport { spawn, ChildProcess } from 'child_process';\nimport { Logger } from '../core/logger.js';\nimport { ConfigManager } from '../core/config.js';\n\nexport interface DeploymentEnvironment {\n  id: string;\n  name: string;\n  type: 'development' | 'staging' | 'production' | 'testing' | 'custom';\n  status: 'active' | 'inactive' | 'maintenance' | 'error';\n  configuration: {\n    region: string;\n    provider: 'aws' | 'gcp' | 'azure' | 'kubernetes' | 'docker' | 'custom';\n    endpoints: string[];\n    secrets: Record<string, string>;\n    environment_variables: Record<string, string>;\n    resources: {\n      cpu: string;\n      memory: string;\n      storage: string;\n      replicas: number;\n    };\n  };\n  healthCheck: {\n    url: string;\n    method: 'GET' | 'POST' | 'HEAD';\n    expectedStatus: number;\n    timeout: number;\n    interval: number;\n    retries: number;\n  };\n  monitoring: {\n    enabled: boolean;\n    alerts: DeploymentAlert[];\n    metrics: string[];\n    logs: {\n      level: string;\n      retention: string;\n      aggregation: boolean;\n    };\n  };\n  security: {\n    tls: boolean;\n    authentication: boolean;\n    authorization: string[];\n    compliance: string[];\n    scanning: {\n      vulnerabilities: boolean;\n      secrets: boolean;\n      licenses: boolean;\n    };\n  };\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface DeploymentStrategy {\n  id: string;\n  name: string;\n  type: 'blue-green' | 'canary' | 'rolling' | 'recreate' | 'custom';\n  configuration: {\n    rolloutPercentage?: number;\n    maxUnavailable?: number;\n    maxSurge?: number;\n    trafficSplitPercentage?: number;\n    monitoringDuration?: number;\n    rollbackThreshold?: number;\n    approvalRequired?: boolean;\n    automatedRollback?: boolean;\n  };\n  stages: DeploymentStage[];\n  rollbackStrategy: {\n    automatic: boolean;\n    conditions: RollbackCondition[];\n    timeout: number;\n  };\n  notifications: {\n    channels: string[];\n    events: string[];\n  };\n}\n\nexport interface DeploymentStage {\n  id: string;\n  name: string;\n  order: number;\n  type: 'build' | 'test' | 'deploy' | 'verify' | 'promote' | 'rollback' | 'custom';\n  status: 'pending' | 'running' | 'success' | 'failed' | 'skipped' | 'cancelled';\n  commands: DeploymentCommand[];\n  conditions: {\n    runIf: string[];\n    skipIf: string[];\n  };\n  timeout: number;\n  retryPolicy: {\n    maxRetries: number;\n    backoffMultiplier: number;\n    initialDelay: number;\n  };\n  artifacts: {\n    inputs: string[];\n    outputs: string[];\n  };\n  startTime?: Date;\n  endTime?: Date;\n  duration?: number;\n  logs: DeploymentLog[];\n}\n\nexport interface DeploymentCommand {\n  id: string;\n  command: string;\n  args: string[];\n  workingDirectory?: string;\n  environment?: Record<string, string>;\n  timeout: number;\n  retryOnFailure: boolean;\n  successCriteria: {\n    exitCode?: number;\n    outputContains?: string[];\n    outputNotContains?: string[];\n  };\n}\n\nexport interface DeploymentLog {\n  timestamp: Date;\n  level: 'debug' | 'info' | 'warn' | 'error';\n  message: string;\n  source: string;\n  metadata?: Record<string, any>;\n}\n\nexport interface RollbackCondition {\n  metric: string;\n  threshold: number;\n  operator: '>' | '<' | '>=' | '<=' | '==' | '!=';\n  duration: number;\n  description: string;\n}\n\nexport interface DeploymentAlert {\n  id: string;\n  name: string;\n  condition: string;\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  channels: string[];\n  enabled: boolean;\n}\n\nexport interface Deployment {\n  id: string;\n  name: string;\n  version: string;\n  projectId: string;\n  environmentId: string;\n  strategyId: string;\n  status: 'pending' | 'running' | 'success' | 'failed' | 'rolled-back' | 'cancelled';\n  initiatedBy: string;\n  source: {\n    repository: string;\n    branch: string;\n    commit: string;\n    tag?: string;\n  };\n  artifacts: {\n    buildId?: string;\n    imageTag?: string;\n    packageVersion?: string;\n    files: string[];\n  };\n  metrics: {\n    startTime: Date;\n    endTime?: Date;\n    duration?: number;\n    deploymentSize: number;\n    rollbackTime?: number;\n    successRate: number;\n    errorRate: number;\n    performanceMetrics: Record<string, number>;\n  };\n  stages: DeploymentStage[];\n  rollback?: {\n    triggered: boolean;\n    reason: string;\n    timestamp: Date;\n    previousDeploymentId: string;\n    rollbackDuration: number;\n  };\n  approvals: DeploymentApproval[];\n  notifications: DeploymentNotification[];\n  auditLog: DeploymentAuditEntry[];\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface DeploymentApproval {\n  id: string;\n  stage: string;\n  requiredApprovers: string[];\n  approvals: {\n    userId: string;\n    decision: 'approved' | 'rejected';\n    reason?: string;\n    timestamp: Date;\n  }[];\n  status: 'pending' | 'approved' | 'rejected' | 'expired';\n  expiresAt: Date;\n}\n\nexport interface DeploymentNotification {\n  id: string;\n  type: 'email' | 'slack' | 'teams' | 'webhook' | 'sms';\n  recipients: string[];\n  subject: string;\n  message: string;\n  timestamp: Date;\n  status: 'sent' | 'failed' | 'pending';\n}\n\nexport interface DeploymentAuditEntry {\n  id: string;\n  timestamp: Date;\n  userId: string;\n  action: string;\n  target: string;\n  details: Record<string, any>;\n  ipAddress?: string;\n}\n\nexport interface DeploymentPipeline {\n  id: string;\n  name: string;\n  projectId: string;\n  environments: string[];\n  promotionStrategy: 'manual' | 'automatic' | 'conditional';\n  promotionRules: {\n    environmentId: string;\n    conditions: string[];\n    approvers: string[];\n  }[];\n  triggers: {\n    type: 'webhook' | 'schedule' | 'manual' | 'git';\n    configuration: Record<string, any>;\n  }[];\n  configuration: {\n    parallelDeployments: boolean;\n    rollbackOnFailure: boolean;\n    notifications: boolean;\n    qualityGates: boolean;\n  };\n  metrics: {\n    totalDeployments: number;\n    successRate: number;\n    averageDeploymentTime: number;\n    mttr: number; // Mean Time To Recovery\n    changeFailureRate: number;\n    deploymentFrequency: number;\n  };\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface DeploymentMetrics {\n  totalDeployments: number;\n  successfulDeployments: number;\n  failedDeployments: number;\n  rolledBackDeployments: number;\n  averageDeploymentTime: number;\n  deploymentFrequency: number;\n  meanTimeToRecovery: number;\n  changeFailureRate: number;\n  leadTime: number;\n  environmentMetrics: Record<\n    string,\n    {\n      deployments: number;\n      successRate: number;\n      averageTime: number;\n    }\n  >;\n  strategyMetrics: Record<\n    string,\n    {\n      deployments: number;\n      successRate: number;\n      rollbackRate: number;\n    }\n  >;\n}\n\nexport class DeploymentManager extends EventEmitter {\n  private deployments: Map<string, Deployment> = new Map();\n  private environments: Map<string, DeploymentEnvironment> = new Map();\n  private strategies: Map<string, DeploymentStrategy> = new Map();\n  private pipelines: Map<string, DeploymentPipeline> = new Map();\n  private activeProcesses: Map<string, ChildProcess> = new Map();\n  private deploymentsPath: string;\n  private logger: Logger;\n  private config: ConfigManager;\n\n  constructor(deploymentsPath: string = './deployments', logger?: Logger, config?: ConfigManager) {\n    super();\n    this.deploymentsPath = deploymentsPath;\n    this.logger = logger || new Logger({ level: 'info', format: 'text', destination: 'console' });\n    this.config = config || ConfigManager.getInstance();\n  }\n\n  async initialize(): Promise<void> {\n    try {\n      await mkdir(this.deploymentsPath, { recursive: true });\n      await mkdir(join(this.deploymentsPath, 'environments'), { recursive: true });\n      await mkdir(join(this.deploymentsPath, 'strategies'), { recursive: true });\n      await mkdir(join(this.deploymentsPath, 'pipelines'), { recursive: true });\n\n      await this.loadConfigurations();\n      await this.initializeDefaultStrategies();\n\n      this.logger.info('Deployment Manager initialized successfully');\n    } catch (error) {\n      this.logger.error('Failed to initialize Deployment Manager', { error });\n      throw error;\n    }\n  }\n\n  async createEnvironment(\n    environmentData: Partial<DeploymentEnvironment>,\n  ): Promise<DeploymentEnvironment> {\n    const environment: DeploymentEnvironment = {\n      id: environmentData.id || `env-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      name: environmentData.name || 'Unnamed Environment',\n      type: environmentData.type || 'development',\n      status: 'inactive',\n      configuration: {\n        region: 'us-east-1',\n        provider: 'aws',\n        endpoints: [],\n        secrets: {},\n        environment_variables: {},\n        resources: {\n          cpu: '1',\n          memory: '1Gi',\n          storage: '10Gi',\n          replicas: 1,\n        },\n        ...environmentData.configuration,\n      },\n      healthCheck: {\n        url: '/health',\n        method: 'GET',\n        expectedStatus: 200,\n        timeout: 30000,\n        interval: 60000,\n        retries: 3,\n        ...environmentData.healthCheck,\n      },\n      monitoring: {\n        enabled: true,\n        alerts: [],\n        metrics: ['cpu', 'memory', 'requests', 'errors'],\n        logs: {\n          level: 'info',\n          retention: '30d',\n          aggregation: true,\n        },\n        ...environmentData.monitoring,\n      },\n      security: {\n        tls: true,\n        authentication: true,\n        authorization: ['admin', 'deploy'],\n        compliance: [],\n        scanning: {\n          vulnerabilities: true,\n          secrets: true,\n          licenses: true,\n        },\n        ...environmentData.security,\n      },\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n\n    this.environments.set(environment.id, environment);\n    await this.saveEnvironment(environment);\n\n    this.emit('environment:created', environment);\n    this.logger.info(`Environment created: ${environment.name} (${environment.id})`);\n\n    return environment;\n  }\n\n  async createDeployment(deploymentData: {\n    name: string;\n    version: string;\n    projectId: string;\n    environmentId: string;\n    strategyId: string;\n    initiatedBy: string;\n    source: Deployment['source'];\n    artifacts?: Partial<Deployment['artifacts']>;\n  }): Promise<Deployment> {\n    const environment = this.environments.get(deploymentData.environmentId);\n    if (!environment) {\n      throw new Error(`Environment not found: ${deploymentData.environmentId}`);\n    }\n\n    const strategy = this.strategies.get(deploymentData.strategyId);\n    if (!strategy) {\n      throw new Error(`Strategy not found: ${deploymentData.strategyId}`);\n    }\n\n    const deployment: Deployment = {\n      id: `deploy-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      name: deploymentData.name,\n      version: deploymentData.version,\n      projectId: deploymentData.projectId,\n      environmentId: deploymentData.environmentId,\n      strategyId: deploymentData.strategyId,\n      status: 'pending',\n      initiatedBy: deploymentData.initiatedBy,\n      source: deploymentData.source,\n      artifacts: {\n        files: [],\n        ...deploymentData.artifacts,\n      },\n      metrics: {\n        startTime: new Date(),\n        deploymentSize: 0,\n        successRate: 0,\n        errorRate: 0,\n        performanceMetrics: {},\n      },\n      stages: strategy.stages.map((stage) => ({\n        ...stage,\n        status: 'pending',\n        logs: [],\n      })),\n      approvals: [],\n      notifications: [],\n      auditLog: [],\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n\n    this.addAuditEntry(deployment, deploymentData.initiatedBy, 'deployment_created', 'deployment', {\n      deploymentId: deployment.id,\n      environment: environment.name,\n      strategy: strategy.name,\n    });\n\n    this.deployments.set(deployment.id, deployment);\n    await this.saveDeployment(deployment);\n\n    this.emit('deployment:created', deployment);\n    this.logger.info(`Deployment created: ${deployment.name} (${deployment.id})`);\n\n    return deployment;\n  }\n\n  async executeDeployment(deploymentId: string): Promise<void> {\n    const deployment = this.deployments.get(deploymentId);\n    if (!deployment) {\n      throw new Error(`Deployment not found: ${deploymentId}`);\n    }\n\n    if (deployment.status !== 'pending') {\n      throw new Error(`Deployment ${deploymentId} is not in pending status`);\n    }\n\n    deployment.status = 'running';\n    deployment.metrics.startTime = new Date();\n    deployment.updatedAt = new Date();\n\n    this.addAuditEntry(deployment, 'system', 'deployment_started', 'deployment', {\n      deploymentId,\n    });\n\n    await this.saveDeployment(deployment);\n    this.emit('deployment:started', deployment);\n\n    try {\n      for (const stage of deployment.stages) {\n        await this.executeStage(deployment, stage);\n\n        if (stage.status === 'failed') {\n          await this.handleDeploymentFailure(deployment, stage);\n          return;\n        }\n      }\n\n      await this.completeDeployment(deployment);\n    } catch (error) {\n      await this.handleDeploymentError(deployment, error);\n    }\n  }\n\n  private async executeStage(deployment: Deployment, stage: DeploymentStage): Promise<void> {\n    stage.status = 'running';\n    stage.startTime = new Date();\n\n    this.addLog(stage, 'info', `Starting stage: ${stage.name}`, 'system');\n\n    try {\n      // Check conditions\n      if (!this.evaluateStageConditions(deployment, stage)) {\n        stage.status = 'skipped';\n        this.addLog(stage, 'info', 'Stage skipped due to conditions', 'system');\n        return;\n      }\n\n      // Handle approvals\n      if (stage.type === 'deploy' && (await this.requiresApproval(deployment, stage))) {\n        await this.requestApproval(deployment, stage);\n\n        // Wait for approval\n        while (await this.isPendingApproval(deployment, stage)) {\n          await new Promise((resolve) => setTimeout(resolve, 10000)); // Check every 10 seconds\n        }\n\n        if (!(await this.isApproved(deployment, stage))) {\n          stage.status = 'failed';\n          this.addLog(stage, 'error', 'Stage rejected by approver', 'system');\n          return;\n        }\n      }\n\n      // Execute commands\n      for (const command of stage.commands) {\n        await this.executeCommand(deployment, stage, command);\n      }\n\n      stage.status = 'success';\n      stage.endTime = new Date();\n      stage.duration = stage.endTime.getTime() - stage.startTime!.getTime();\n\n      this.addLog(stage, 'info', `Stage completed successfully in ${stage.duration}ms`, 'system');\n    } catch (error) {\n      stage.status = 'failed';\n      stage.endTime = new Date();\n\n      this.addLog(\n        stage,\n        'error',\n        `Stage failed: ${error instanceof Error ? error.message : String(error)}`,\n        'system',\n      );\n\n      // Retry logic\n      if (stage.retryPolicy.maxRetries > 0) {\n        await this.retryStage(deployment, stage);\n      }\n    }\n\n    await this.saveDeployment(deployment);\n    this.emit('stage:completed', { deployment, stage });\n  }\n\n  private async executeCommand(\n    deployment: Deployment,\n    stage: DeploymentStage,\n    command: DeploymentCommand,\n  ): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const environment = this.environments.get(deployment.environmentId);\n\n      const processEnv = {\n        ...process.env,\n        ...environment?.configuration.environment_variables,\n        ...command.environment,\n        DEPLOYMENT_ID: deployment.id,\n        DEPLOYMENT_VERSION: deployment.version,\n        ENVIRONMENT_ID: deployment.environmentId,\n      };\n\n      this.addLog(\n        stage,\n        'info',\n        `Executing: ${command.command} ${command.args.join(' ')}`,\n        'command',\n      );\n\n      const childProcess = spawn(command.command, command.args, {\n        cwd: command.workingDirectory || process.cwd(),\n        env: processEnv,\n        stdio: ['pipe', 'pipe', 'pipe'],\n      });\n\n      this.activeProcesses.set(`${deployment.id}-${stage.id}-${command.id}`, childProcess);\n\n      let stdout = '';\n      let stderr = '';\n\n      childProcess.stdout?.on('data', (data) => {\n        const output = data.toString();\n        stdout += output;\n        this.addLog(stage, 'info', output.trim(), 'stdout');\n      });\n\n      childProcess.stderr?.on('data', (data) => {\n        const output = data.toString();\n        stderr += output;\n        this.addLog(stage, 'error', output.trim(), 'stderr');\n      });\n\n      const timeout = setTimeout(() => {\n        childProcess.kill('SIGTERM');\n        reject(new Error(`Command timed out after ${command.timeout}ms`));\n      }, command.timeout);\n\n      childProcess.on('close', (code) => {\n        clearTimeout(timeout);\n        this.activeProcesses.delete(`${deployment.id}-${stage.id}-${command.id}`);\n\n        // Check success criteria\n        const success = this.evaluateCommandSuccess(command, code, stdout, stderr);\n\n        if (success) {\n          this.addLog(\n            stage,\n            'info',\n            `Command completed successfully (exit code: ${code})`,\n            'command',\n          );\n          resolve();\n        } else {\n          this.addLog(stage, 'error', `Command failed (exit code: ${code})`, 'command');\n          reject(new Error(`Command failed with exit code ${code}`));\n        }\n      });\n\n      childProcess.on('error', (error) => {\n        clearTimeout(timeout);\n        this.activeProcesses.delete(`${deployment.id}-${stage.id}-${command.id}`);\n        this.addLog(\n          stage,\n          'error',\n          `Command error: ${error instanceof Error ? error.message : String(error)}`,\n          'command',\n        );\n        reject(error);\n      });\n    });\n  }\n\n  async rollbackDeployment(\n    deploymentId: string,\n    reason: string,\n    userId: string = 'system',\n  ): Promise<void> {\n    const deployment = this.deployments.get(deploymentId);\n    if (!deployment) {\n      throw new Error(`Deployment not found: ${deploymentId}`);\n    }\n\n    // Find previous successful deployment\n    const previousDeployment = await this.getPreviousSuccessfulDeployment(\n      deployment.projectId,\n      deployment.environmentId,\n      deploymentId,\n    );\n\n    if (!previousDeployment) {\n      throw new Error('No previous successful deployment found for rollback');\n    }\n\n    const rollbackStartTime = new Date();\n\n    deployment.rollback = {\n      triggered: true,\n      reason,\n      timestamp: rollbackStartTime,\n      previousDeploymentId: previousDeployment.id,\n      rollbackDuration: 0,\n    };\n\n    deployment.status = 'rolled-back';\n    deployment.updatedAt = new Date();\n\n    this.addAuditEntry(deployment, userId, 'rollback_initiated', 'deployment', {\n      deploymentId,\n      previousDeploymentId: previousDeployment.id,\n      reason,\n    });\n\n    try {\n      // Execute rollback strategy\n      await this.executeRollbackStrategy(deployment, previousDeployment);\n\n      deployment.rollback.rollbackDuration = Date.now() - rollbackStartTime.getTime();\n\n      this.addAuditEntry(deployment, userId, 'rollback_completed', 'deployment', {\n        deploymentId,\n        rollbackDuration: deployment.rollback.rollbackDuration,\n      });\n\n      this.emit('deployment:rolled-back', deployment);\n      this.logger.info(`Deployment rolled back: ${deploymentId}`);\n    } catch (error) {\n      this.addAuditEntry(deployment, userId, 'rollback_failed', 'deployment', {\n        deploymentId,\n        error: error instanceof Error ? error.message : String(error),\n      });\n\n      this.logger.error(`Rollback failed for deployment ${deploymentId}`, { error });\n      throw error;\n    }\n\n    await this.saveDeployment(deployment);\n  }\n\n  async getDeploymentMetrics(filters?: {\n    projectId?: string;\n    environmentId?: string;\n    strategyId?: string;\n    timeRange?: { start: Date; end: Date };\n  }): Promise<DeploymentMetrics> {\n    let deployments = Array.from(this.deployments.values());\n\n    // Apply filters\n    if (filters) {\n      if (filters.projectId) {\n        deployments = deployments.filter((d) => d.projectId === filters.projectId);\n      }\n      if (filters.environmentId) {\n        deployments = deployments.filter((d) => d.environmentId === filters.environmentId);\n      }\n      if (filters.strategyId) {\n        deployments = deployments.filter((d) => d.strategyId === filters.strategyId);\n      }\n      if (filters.timeRange) {\n        deployments = deployments.filter(\n          (d) => d.createdAt >= filters.timeRange!.start && d.createdAt <= filters.timeRange!.end,\n        );\n      }\n    }\n\n    const totalDeployments = deployments.length;\n    const successfulDeployments = deployments.filter((d) => d.status === 'success').length;\n    const failedDeployments = deployments.filter((d) => d.status === 'failed').length;\n    const rolledBackDeployments = deployments.filter((d) => d.status === 'rolled-back').length;\n\n    const completedDeployments = deployments.filter(\n      (d) => d.metrics.endTime && d.metrics.startTime,\n    );\n\n    const averageDeploymentTime =\n      completedDeployments.length > 0\n        ? completedDeployments.reduce(\n            (sum, d) => sum + (d.metrics.endTime!.getTime() - d.metrics.startTime.getTime()),\n            0,\n          ) / completedDeployments.length\n        : 0;\n\n    // Calculate environment metrics\n    const environmentMetrics: Record<string, any> = {};\n    for (const env of this.environments.values()) {\n      const envDeployments = deployments.filter((d) => d.environmentId === env.id);\n      const envSuccessful = envDeployments.filter((d) => d.status === 'success').length;\n\n      environmentMetrics[env.id] = {\n        deployments: envDeployments.length,\n        successRate: envDeployments.length > 0 ? (envSuccessful / envDeployments.length) * 100 : 0,\n        averageTime:\n          envDeployments.length > 0\n            ? envDeployments.reduce((sum, d) => sum + (d.metrics.duration || 0), 0) /\n              envDeployments.length\n            : 0,\n      };\n    }\n\n    // Calculate strategy metrics\n    const strategyMetrics: Record<string, any> = {};\n    for (const strategy of this.strategies.values()) {\n      const strategyDeployments = deployments.filter((d) => d.strategyId === strategy.id);\n      const strategySuccessful = strategyDeployments.filter((d) => d.status === 'success').length;\n      const strategyRolledBack = strategyDeployments.filter(\n        (d) => d.status === 'rolled-back',\n      ).length;\n\n      strategyMetrics[strategy.id] = {\n        deployments: strategyDeployments.length,\n        successRate:\n          strategyDeployments.length > 0\n            ? (strategySuccessful / strategyDeployments.length) * 100\n            : 0,\n        rollbackRate:\n          strategyDeployments.length > 0\n            ? (strategyRolledBack / strategyDeployments.length) * 100\n            : 0,\n      };\n    }\n\n    return {\n      totalDeployments,\n      successfulDeployments,\n      failedDeployments,\n      rolledBackDeployments,\n      averageDeploymentTime,\n      deploymentFrequency: this.calculateDeploymentFrequency(deployments),\n      meanTimeToRecovery: this.calculateMTTR(deployments),\n      changeFailureRate:\n        ((failedDeployments + rolledBackDeployments) / Math.max(totalDeployments, 1)) * 100,\n      leadTime: this.calculateLeadTime(deployments),\n      environmentMetrics,\n      strategyMetrics,\n    };\n  }\n\n  // Private helper methods\n  private async loadConfigurations(): Promise<void> {\n    // Load environments, strategies, and pipelines from disk\n    try {\n      const envFiles = await readdir(join(this.deploymentsPath, 'environments'));\n      for (const file of envFiles.filter((f) => f.endsWith('.json'))) {\n        const content = await readFile(join(this.deploymentsPath, 'environments', file), 'utf-8');\n        const env: DeploymentEnvironment = JSON.parse(content);\n        this.environments.set(env.id, env);\n      }\n\n      const strategyFiles = await readdir(join(this.deploymentsPath, 'strategies'));\n      for (const file of strategyFiles.filter((f) => f.endsWith('.json'))) {\n        const content = await readFile(join(this.deploymentsPath, 'strategies', file), 'utf-8');\n        const strategy: DeploymentStrategy = JSON.parse(content);\n        this.strategies.set(strategy.id, strategy);\n      }\n\n      const pipelineFiles = await readdir(join(this.deploymentsPath, 'pipelines'));\n      for (const file of pipelineFiles.filter((f) => f.endsWith('.json'))) {\n        const content = await readFile(join(this.deploymentsPath, 'pipelines', file), 'utf-8');\n        const pipeline: DeploymentPipeline = JSON.parse(content);\n        this.pipelines.set(pipeline.id, pipeline);\n      }\n\n      this.logger.info(\n        `Loaded ${this.environments.size} environments, ${this.strategies.size} strategies, ${this.pipelines.size} pipelines`,\n      );\n    } catch (error) {\n      this.logger.warn('Failed to load some configurations', { error });\n    }\n  }\n\n  private async initializeDefaultStrategies(): Promise<void> {\n    const defaultStrategies: Partial<DeploymentStrategy>[] = [\n      {\n        name: 'Blue-Green Deployment',\n        type: 'blue-green',\n        configuration: {\n          monitoringDuration: 300000, // 5 minutes\n          automatedRollback: true,\n          rollbackThreshold: 5,\n        },\n        stages: [\n          {\n            id: 'build',\n            name: 'Build',\n            order: 1,\n            type: 'build',\n            status: 'pending',\n            commands: [],\n            conditions: { runIf: [], skipIf: [] },\n            timeout: 600000,\n            retryPolicy: { maxRetries: 2, backoffMultiplier: 2, initialDelay: 1000 },\n            artifacts: { inputs: [], outputs: [] },\n            logs: [],\n          },\n          {\n            id: 'deploy-green',\n            name: 'Deploy to Green',\n            order: 2,\n            type: 'deploy',\n            status: 'pending',\n            commands: [],\n            conditions: { runIf: [], skipIf: [] },\n            timeout: 900000,\n            retryPolicy: { maxRetries: 1, backoffMultiplier: 2, initialDelay: 5000 },\n            artifacts: { inputs: [], outputs: [] },\n            logs: [],\n          },\n          {\n            id: 'verify',\n            name: 'Verify Green',\n            order: 3,\n            type: 'verify',\n            status: 'pending',\n            commands: [],\n            conditions: { runIf: [], skipIf: [] },\n            timeout: 300000,\n            retryPolicy: { maxRetries: 3, backoffMultiplier: 1.5, initialDelay: 2000 },\n            artifacts: { inputs: [], outputs: [] },\n            logs: [],\n          },\n          {\n            id: 'switch-traffic',\n            name: 'Switch Traffic',\n            order: 4,\n            type: 'promote',\n            status: 'pending',\n            commands: [],\n            conditions: { runIf: [], skipIf: [] },\n            timeout: 60000,\n            retryPolicy: { maxRetries: 1, backoffMultiplier: 1, initialDelay: 1000 },\n            artifacts: { inputs: [], outputs: [] },\n            logs: [],\n          },\n        ],\n        rollbackStrategy: {\n          automatic: true,\n          conditions: [\n            {\n              metric: 'error_rate',\n              threshold: 5,\n              operator: '>',\n              duration: 60000,\n              description: 'Error rate exceeds 5%',\n            },\n          ],\n          timeout: 300000,\n        },\n      },\n      {\n        name: 'Canary Deployment',\n        type: 'canary',\n        configuration: {\n          trafficSplitPercentage: 10,\n          monitoringDuration: 600000, // 10 minutes\n          automatedRollback: true,\n          rollbackThreshold: 2,\n        },\n        stages: [\n          {\n            id: 'build',\n            name: 'Build',\n            order: 1,\n            type: 'build',\n            status: 'pending',\n            commands: [],\n            conditions: { runIf: [], skipIf: [] },\n            timeout: 600000,\n            retryPolicy: { maxRetries: 2, backoffMultiplier: 2, initialDelay: 1000 },\n            artifacts: { inputs: [], outputs: [] },\n            logs: [],\n          },\n          {\n            id: 'deploy-canary',\n            name: 'Deploy Canary (10%)',\n            order: 2,\n            type: 'deploy',\n            status: 'pending',\n            commands: [],\n            conditions: { runIf: [], skipIf: [] },\n            timeout: 900000,\n            retryPolicy: { maxRetries: 1, backoffMultiplier: 2, initialDelay: 5000 },\n            artifacts: { inputs: [], outputs: [] },\n            logs: [],\n          },\n          {\n            id: 'monitor-canary',\n            name: 'Monitor Canary',\n            order: 3,\n            type: 'verify',\n            status: 'pending',\n            commands: [],\n            conditions: { runIf: [], skipIf: [] },\n            timeout: 600000,\n            retryPolicy: { maxRetries: 1, backoffMultiplier: 1, initialDelay: 10000 },\n            artifacts: { inputs: [], outputs: [] },\n            logs: [],\n          },\n          {\n            id: 'promote-full',\n            name: 'Promote to 100%',\n            order: 4,\n            type: 'promote',\n            status: 'pending',\n            commands: [],\n            conditions: { runIf: [], skipIf: [] },\n            timeout: 300000,\n            retryPolicy: { maxRetries: 1, backoffMultiplier: 1, initialDelay: 1000 },\n            artifacts: { inputs: [], outputs: [] },\n            logs: [],\n          },\n        ],\n        rollbackStrategy: {\n          automatic: true,\n          conditions: [\n            {\n              metric: 'error_rate',\n              threshold: 2,\n              operator: '>',\n              duration: 120000,\n              description: 'Canary error rate exceeds 2%',\n            },\n            {\n              metric: 'response_time',\n              threshold: 500,\n              operator: '>',\n              duration: 180000,\n              description: 'Response time exceeds 500ms',\n            },\n          ],\n          timeout: 180000,\n        },\n      },\n      {\n        name: 'Rolling Deployment',\n        type: 'rolling',\n        configuration: {\n          maxUnavailable: 1,\n          maxSurge: 1,\n          monitoringDuration: 120000,\n          automatedRollback: false,\n        },\n        stages: [\n          {\n            id: 'build',\n            name: 'Build',\n            order: 1,\n            type: 'build',\n            status: 'pending',\n            commands: [],\n            conditions: { runIf: [], skipIf: [] },\n            timeout: 600000,\n            retryPolicy: { maxRetries: 2, backoffMultiplier: 2, initialDelay: 1000 },\n            artifacts: { inputs: [], outputs: [] },\n            logs: [],\n          },\n          {\n            id: 'rolling-update',\n            name: 'Rolling Update',\n            order: 2,\n            type: 'deploy',\n            status: 'pending',\n            commands: [],\n            conditions: { runIf: [], skipIf: [] },\n            timeout: 1200000,\n            retryPolicy: { maxRetries: 1, backoffMultiplier: 2, initialDelay: 5000 },\n            artifacts: { inputs: [], outputs: [] },\n            logs: [],\n          },\n          {\n            id: 'health-check',\n            name: 'Health Check',\n            order: 3,\n            type: 'verify',\n            status: 'pending',\n            commands: [],\n            conditions: { runIf: [], skipIf: [] },\n            timeout: 300000,\n            retryPolicy: { maxRetries: 3, backoffMultiplier: 1.5, initialDelay: 5000 },\n            artifacts: { inputs: [], outputs: [] },\n            logs: [],\n          },\n        ],\n        rollbackStrategy: {\n          automatic: false,\n          conditions: [],\n          timeout: 600000,\n        },\n      },\n    ];\n\n    for (const strategyData of defaultStrategies) {\n      if (!Array.from(this.strategies.values()).some((s) => s.name === strategyData.name)) {\n        const strategy: DeploymentStrategy = {\n          id: `strategy-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n          notifications: {\n            channels: [],\n            events: ['deployment:started', 'deployment:completed', 'deployment:failed'],\n          },\n          ...strategyData,\n        } as DeploymentStrategy;\n\n        this.strategies.set(strategy.id, strategy);\n        await this.saveStrategy(strategy);\n      }\n    }\n  }\n\n  private async saveEnvironment(environment: DeploymentEnvironment): Promise<void> {\n    const filePath = join(this.deploymentsPath, 'environments', `${environment.id}.json`);\n    await writeFile(filePath, JSON.stringify(environment, null, 2));\n  }\n\n  private async saveStrategy(strategy: DeploymentStrategy): Promise<void> {\n    const filePath = join(this.deploymentsPath, 'strategies', `${strategy.id}.json`);\n    await writeFile(filePath, JSON.stringify(strategy, null, 2));\n  }\n\n  private async saveDeployment(deployment: Deployment): Promise<void> {\n    const filePath = join(this.deploymentsPath, `${deployment.id}.json`);\n    await writeFile(filePath, JSON.stringify(deployment, null, 2));\n  }\n\n  private addAuditEntry(\n    deployment: Deployment,\n    userId: string,\n    action: string,\n    target: string,\n    details: Record<string, any>,\n  ): void {\n    const entry: DeploymentAuditEntry = {\n      id: `audit-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      timestamp: new Date(),\n      userId,\n      action,\n      target,\n      details,\n    };\n\n    deployment.auditLog.push(entry);\n  }\n\n  private addLog(\n    stage: DeploymentStage,\n    level: DeploymentLog['level'],\n    message: string,\n    source: string,\n    metadata?: Record<string, any>,\n  ): void {\n    const log: DeploymentLog = {\n      timestamp: new Date(),\n      level,\n      message,\n      source,\n      metadata,\n    };\n\n    stage.logs.push(log);\n  }\n\n  private evaluateStageConditions(deployment: Deployment, stage: DeploymentStage): boolean {\n    // Implement condition evaluation logic\n    return true; // Simplified for now\n  }\n\n  private async requiresApproval(deployment: Deployment, stage: DeploymentStage): Promise<boolean> {\n    const strategy = this.strategies.get(deployment.strategyId);\n    return strategy?.configuration.approvalRequired || false;\n  }\n\n  private async requestApproval(deployment: Deployment, stage: DeploymentStage): Promise<void> {\n    // Implement approval request logic\n    this.emit('approval:requested', { deployment, stage });\n  }\n\n  private async isPendingApproval(\n    deployment: Deployment,\n    stage: DeploymentStage,\n  ): Promise<boolean> {\n    // Check if there are pending approvals for this stage\n    return false; // Simplified for now\n  }\n\n  private async isApproved(deployment: Deployment, stage: DeploymentStage): Promise<boolean> {\n    // Check if stage is approved\n    return true; // Simplified for now\n  }\n\n  private evaluateCommandSuccess(\n    command: DeploymentCommand,\n    exitCode: number | null,\n    stdout: string,\n    stderr: string,\n  ): boolean {\n    if (\n      command.successCriteria.exitCode !== undefined &&\n      exitCode !== command.successCriteria.exitCode\n    ) {\n      return false;\n    }\n\n    if (command.successCriteria.outputContains) {\n      for (const pattern of command.successCriteria.outputContains) {\n        if (!stdout.includes(pattern)) {\n          return false;\n        }\n      }\n    }\n\n    if (command.successCriteria.outputNotContains) {\n      for (const pattern of command.successCriteria.outputNotContains) {\n        if (stdout.includes(pattern) || stderr.includes(pattern)) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  }\n\n  private async retryStage(deployment: Deployment, stage: DeploymentStage): Promise<void> {\n    // Implement retry logic\n    this.logger.info(`Retrying stage: ${stage.name}`);\n  }\n\n  private async handleDeploymentFailure(\n    deployment: Deployment,\n    failedStage: DeploymentStage,\n  ): Promise<void> {\n    deployment.status = 'failed';\n    deployment.metrics.endTime = new Date();\n    deployment.updatedAt = new Date();\n\n    this.addAuditEntry(deployment, 'system', 'deployment_failed', 'deployment', {\n      deploymentId: deployment.id,\n      failedStage: failedStage.name,\n      reason: 'Stage execution failed',\n    });\n\n    await this.saveDeployment(deployment);\n    this.emit('deployment:failed', { deployment, failedStage });\n\n    // Check if automatic rollback is enabled\n    const strategy = this.strategies.get(deployment.strategyId);\n    if (strategy?.rollbackStrategy.automatic) {\n      await this.rollbackDeployment(deployment.id, 'Automatic rollback due to deployment failure');\n    }\n  }\n\n  private async handleDeploymentError(deployment: Deployment, error: any): Promise<void> {\n    deployment.status = 'failed';\n    deployment.metrics.endTime = new Date();\n    deployment.updatedAt = new Date();\n\n    this.addAuditEntry(deployment, 'system', 'deployment_error', 'deployment', {\n      deploymentId: deployment.id,\n      error: error instanceof Error ? error.message : String(error),\n    });\n\n    await this.saveDeployment(deployment);\n    this.emit('deployment:error', { deployment, error });\n\n    this.logger.error(`Deployment error: ${deployment.id}`, { error });\n  }\n\n  private async completeDeployment(deployment: Deployment): Promise<void> {\n    deployment.status = 'success';\n    deployment.metrics.endTime = new Date();\n    deployment.metrics.duration =\n      deployment.metrics.endTime.getTime() - deployment.metrics.startTime.getTime();\n    deployment.updatedAt = new Date();\n\n    this.addAuditEntry(deployment, 'system', 'deployment_completed', 'deployment', {\n      deploymentId: deployment.id,\n      duration: deployment.metrics.duration,\n    });\n\n    await this.saveDeployment(deployment);\n    this.emit('deployment:completed', deployment);\n\n    this.logger.info(`Deployment completed: ${deployment.id} in ${deployment.metrics.duration}ms`);\n  }\n\n  private async getPreviousSuccessfulDeployment(\n    projectId: string,\n    environmentId: string,\n    currentDeploymentId: string,\n  ): Promise<Deployment | null> {\n    const deployments = Array.from(this.deployments.values())\n      .filter(\n        (d) =>\n          d.projectId === projectId &&\n          d.environmentId === environmentId &&\n          d.status === 'success' &&\n          d.id !== currentDeploymentId,\n      )\n      .sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime());\n\n    return deployments[0] || null;\n  }\n\n  private async executeRollbackStrategy(\n    deployment: Deployment,\n    previousDeployment: Deployment,\n  ): Promise<void> {\n    // Implement rollback execution logic\n    this.logger.info(`Executing rollback from ${deployment.id} to ${previousDeployment.id}`);\n\n    // This would typically involve:\n    // 1. Switching traffic back to previous version\n    // 2. Updating load balancer configuration\n    // 3. Rolling back container deployments\n    // 4. Reverting database migrations if needed\n    // 5. Updating DNS records\n\n    this.emit('rollback:executed', { deployment, previousDeployment });\n  }\n\n  private calculateDeploymentFrequency(deployments: Deployment[]): number {\n    if (deployments.length === 0) return 0;\n\n    const sortedDeployments = deployments.sort(\n      (a, b) => a.createdAt.getTime() - b.createdAt.getTime(),\n    );\n\n    const firstDeployment = sortedDeployments[0];\n    const lastDeployment = sortedDeployments[sortedDeployments.length - 1];\n\n    const timeSpan = lastDeployment.createdAt.getTime() - firstDeployment.createdAt.getTime();\n    const days = timeSpan / (1000 * 60 * 60 * 24);\n\n    return deployments.length / Math.max(days, 1);\n  }\n\n  private calculateMTTR(deployments: Deployment[]): number {\n    const failedDeployments = deployments.filter(\n      (d) => d.status === 'failed' || d.status === 'rolled-back',\n    );\n\n    if (failedDeployments.length === 0) return 0;\n\n    const recoveryTimes = failedDeployments\n      .map((d) => d.rollback?.rollbackDuration || 0)\n      .filter((time) => time > 0);\n\n    if (recoveryTimes.length === 0) return 0;\n\n    return recoveryTimes.reduce((sum, time) => sum + time, 0) / recoveryTimes.length;\n  }\n\n  private calculateLeadTime(deployments: Deployment[]): number {\n    // This would typically calculate from commit to production\n    // For now, return average deployment time\n    const completedDeployments = deployments.filter((d) => d.metrics.duration);\n\n    if (completedDeployments.length === 0) return 0;\n\n    return (\n      completedDeployments.reduce((sum, d) => sum + (d.metrics.duration || 0), 0) /\n      completedDeployments.length\n    );\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
