{"version":3,"sources":["../../../src/swarm/direct-executor.ts"],"sourcesContent":["import { dirname } from 'node:path';\r\nimport { fileURLToPath } from 'node:url';\r\nconst __dirname = dirname(fileURLToPath(import.meta.url));\r\nimport { getErrorMessage } from '../utils/error-handler.js';\r\n/**\r\n * Direct Task Executor for Swarm\r\n * Executes tasks directly without relying on Claude CLI\r\n * Works in both local development and npm installed environments\r\n */\r\n\r\nimport type { TaskDefinition, AgentState, TaskResult } from './types.js';\r\nimport * as fs from 'node:fs/promises';\r\nimport * as path from 'node:path';\r\nimport { Logger } from '../core/logger.js';\r\n\r\nexport interface DirectExecutorConfig {\r\n  logger?: Logger;\r\n  timeout?: number;\r\n}\r\n\r\nexport class DirectTaskExecutor {\r\n  private logger: Logger;\r\n  private timeout: number;\r\n\r\n  constructor(config: DirectExecutorConfig = {}) {\r\n    this.logger =\r\n      config.logger ||\r\n      new Logger(\r\n        { level: 'info', format: 'text', destination: 'console' },\r\n        { component: 'DirectTaskExecutor' },\r\n      );\r\n    this.timeout = config.timeout || 300000; // 5 minutes default\r\n  }\r\n\r\n  async executeTask(\r\n    task: TaskDefinition,\r\n    agent: AgentState,\r\n    targetDir?: string,\r\n  ): Promise<TaskResult> {\r\n    this.logger.info('Executing task directly', {\r\n      taskId: task.id.id,\r\n      taskName: task.name,\r\n      agentType: agent.type,\r\n      targetDir,\r\n    });\r\n\r\n    const startTime = Date.now();\r\n\r\n    try {\r\n      // Ensure target directory exists\r\n      if (targetDir) {\r\n        await fs.mkdir(targetDir, { recursive: true });\r\n      }\r\n\r\n      // Execute based on task type and objective\r\n      const result = await this.executeTaskByType(task, agent, targetDir);\r\n\r\n      const endTime = Date.now();\r\n      const executionTime = endTime - startTime;\r\n\r\n      return {\r\n        output: result,\r\n        artifacts: {},\r\n        metadata: {\r\n          agentId: agent.id.id,\r\n          agentType: agent.type,\r\n          executionTime,\r\n          targetDir,\r\n        },\r\n        quality: 1.0,\r\n        completeness: 1.0,\r\n        accuracy: 1.0,\r\n        executionTime,\r\n        resourcesUsed: {\r\n          cpuTime: executionTime,\r\n          maxMemory: 0,\r\n          diskIO: 0,\r\n          networkIO: 0,\r\n          fileHandles: 0,\r\n        },\r\n        validated: true,\r\n      };\r\n    } catch (error) {\r\n      this.logger.error('Task execution failed', {\r\n        taskId: task.id.id,\r\n        error: error instanceof Error ? error.message : String(error),\r\n      });\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  private async executeTaskByType(\r\n    task: TaskDefinition,\r\n    agent: AgentState,\r\n    targetDir?: string,\r\n  ): Promise<any> {\r\n    const objective = task.description.toLowerCase();\r\n\r\n    // Extract key information from the task\r\n    const isRestAPI = objective.includes('rest api') || objective.includes('crud');\r\n    const isTodo = objective.includes('todo');\r\n    const isChat = objective.includes('chat') || objective.includes('websocket');\r\n    const isAuth = objective.includes('auth') || objective.includes('jwt');\r\n    const isHelloWorld = objective.includes('hello world');\r\n    const isCalculator = objective.includes('calculator') || objective.includes('calc');\r\n    const isAnalysis = task.type === 'analysis' || objective.includes('analyze');\r\n    const isResearch = task.type === 'research' || objective.includes('research');\r\n\r\n    // Route to appropriate implementation based on agent type and task\r\n    switch (agent.type) {\r\n      case 'analyst':\r\n        return this.executeAnalyzerTask(task, targetDir);\r\n\r\n      case 'coder':\r\n        if (isRestAPI) return this.createRestAPI(targetDir, task);\r\n        if (isTodo) return this.createTodoApp(targetDir, task);\r\n        if (isChat) return this.createChatApp(targetDir, task);\r\n        if (isAuth) return this.createAuthService(targetDir, task);\r\n        if (isHelloWorld) return this.createHelloWorld(targetDir, task);\r\n        if (isCalculator) return this.createCalculator(targetDir, task);\r\n        return this.createGenericApp(targetDir, task);\r\n\r\n      case 'tester':\r\n        return this.executeTestingTask(task, targetDir);\r\n\r\n      case 'reviewer':\r\n        if (\r\n          task.name.toLowerCase().includes('analyze') ||\r\n          task.name.toLowerCase().includes('plan')\r\n        ) {\r\n          return this.executeAnalyzerTask(task, targetDir);\r\n        }\r\n        return this.executeReviewTask(task, targetDir);\r\n\r\n      case 'documenter':\r\n        return this.executeDocumentationTask(task, targetDir);\r\n\r\n      case 'researcher':\r\n        return this.executeResearchTask(task, targetDir);\r\n\r\n      case 'coordinator':\r\n        return this.executeCoordinationTask(task, targetDir);\r\n\r\n      default:\r\n        return this.executeGenericTask(task, targetDir);\r\n    }\r\n  }\r\n\r\n  private async executeAnalyzerTask(task: TaskDefinition, targetDir?: string): Promise<any> {\r\n    this.logger.info('Executing analyzer task', { taskName: task.name });\r\n\r\n    const analysis = {\r\n      taskName: task.name,\r\n      objective: task.description,\r\n      analysis: {\r\n        requirements: this.extractRequirements(task.description),\r\n        components: this.identifyComponents(task.description),\r\n        technologies: this.suggestTechnologies(task.description),\r\n        architecture: this.suggestArchitecture(task.description),\r\n      },\r\n      recommendations: [],\r\n      executionPlan: [],\r\n    };\r\n\r\n    if (targetDir) {\r\n      await fs.writeFile(path.join(targetDir, 'analysis.json'), JSON.stringify(analysis, null, 2));\r\n    }\r\n\r\n    return analysis;\r\n  }\r\n\r\n  private async createRestAPI(targetDir: string, task: TaskDefinition): Promise<any> {\r\n    this.logger.info('Creating REST API', { targetDir });\r\n\r\n    const files = {\r\n      'server.js': this.generateRestAPIServer(task),\r\n      'package.json': this.generatePackageJson('rest-api', ['express', 'cors', 'dotenv']),\r\n      'README.md': this.generateReadme('REST API', task),\r\n      '.env.example': 'PORT=3000\\nDATABASE_URL=',\r\n      '.gitignore': 'node_modules/\\n.env\\n*.log',\r\n    };\r\n\r\n    // Create middleware and routes directories\r\n    await fs.mkdir(path.join(targetDir, 'routes'), { recursive: true });\r\n    await fs.mkdir(path.join(targetDir, 'middleware'), { recursive: true });\r\n    await fs.mkdir(path.join(targetDir, 'models'), { recursive: true });\r\n\r\n    // Write all files\r\n    for (const [filename, content] of Object.entries(files)) {\r\n      await fs.writeFile(path.join(targetDir, filename), content);\r\n    }\r\n\r\n    // Add route files\r\n    await fs.writeFile(path.join(targetDir, 'routes', 'users.js'), this.generateUserRoutes());\r\n\r\n    return {\r\n      filesCreated: Object.keys(files).length + 1,\r\n      structure: 'REST API with Express',\r\n      targetDir,\r\n    };\r\n  }\r\n\r\n  private async createTodoApp(targetDir: string, task: TaskDefinition): Promise<any> {\r\n    this.logger.info('Creating Todo App', { targetDir });\r\n\r\n    const files = {\r\n      'app.js': this.generateTodoApp(task),\r\n      'package.json': this.generatePackageJson('todo-app', ['commander', 'chalk']),\r\n      'README.md': this.generateReadme('Todo List Application', task),\r\n      'todos.json': '[]',\r\n    };\r\n\r\n    for (const [filename, content] of Object.entries(files)) {\r\n      await fs.writeFile(path.join(targetDir, filename), content);\r\n    }\r\n\r\n    return {\r\n      filesCreated: Object.keys(files).length,\r\n      structure: 'CLI Todo Application',\r\n      targetDir,\r\n    };\r\n  }\r\n\r\n  private async createChatApp(targetDir: string, task: TaskDefinition): Promise<any> {\r\n    this.logger.info('Creating Chat Application', { targetDir });\r\n\r\n    const files = {\r\n      'server.js': this.generateChatServer(task),\r\n      'index.html': this.generateChatHTML(),\r\n      'client.js': this.generateChatClient(),\r\n      'package.json': this.generatePackageJson('chat-app', ['express', 'socket.io']),\r\n      'README.md': this.generateReadme('Real-time Chat Application', task),\r\n    };\r\n\r\n    await fs.mkdir(path.join(targetDir, 'public'), { recursive: true });\r\n\r\n    await fs.writeFile(path.join(targetDir, 'server.js'), files['server.js']);\r\n    await fs.writeFile(path.join(targetDir, 'package.json'), files['package.json']);\r\n    await fs.writeFile(path.join(targetDir, 'README.md'), files['README.md']);\r\n    await fs.writeFile(path.join(targetDir, 'public', 'index.html'), files['index.html']);\r\n    await fs.writeFile(path.join(targetDir, 'public', 'client.js'), files['client.js']);\r\n\r\n    return {\r\n      filesCreated: Object.keys(files).length,\r\n      structure: 'WebSocket Chat Application',\r\n      targetDir,\r\n    };\r\n  }\r\n\r\n  private async createAuthService(targetDir: string, task: TaskDefinition): Promise<any> {\r\n    this.logger.info('Creating Auth Service', { targetDir });\r\n\r\n    const files = {\r\n      'server.js': this.generateAuthServer(task),\r\n      'auth.js': this.generateAuthMiddleware(),\r\n      'package.json': this.generatePackageJson('auth-service', [\r\n        'express',\r\n        'jsonwebtoken',\r\n        'bcrypt',\r\n      ]),\r\n      'README.md': this.generateReadme('Authentication Service', task),\r\n      '.env.example': 'JWT_SECRET=your-secret-key\\nPORT=3000',\r\n    };\r\n\r\n    await fs.mkdir(path.join(targetDir, 'middleware'), { recursive: true });\r\n\r\n    await fs.writeFile(path.join(targetDir, 'server.js'), files['server.js']);\r\n    await fs.writeFile(path.join(targetDir, 'middleware', 'auth.js'), files['auth.js']);\r\n    await fs.writeFile(path.join(targetDir, 'package.json'), files['package.json']);\r\n    await fs.writeFile(path.join(targetDir, 'README.md'), files['README.md']);\r\n    await fs.writeFile(path.join(targetDir, '.env.example'), files['.env.example']);\r\n\r\n    return {\r\n      filesCreated: Object.keys(files).length,\r\n      structure: 'JWT Authentication Service',\r\n      targetDir,\r\n    };\r\n  }\r\n\r\n  private async createCalculator(targetDir: string, task: TaskDefinition): Promise<any> {\r\n    this.logger.info('Creating Calculator', { targetDir });\r\n\r\n    const files = {\r\n      'calculator.js': `class Calculator {\r\n  add(a, b) {\r\n    return a + b;\r\n  }\r\n\r\n  subtract(a, b) {\r\n    return a - b;\r\n  }\r\n\r\n  multiply(a, b) {\r\n    return a * b;\r\n  }\r\n\r\n  divide(a, b) {\r\n    if (b === 0) {\r\n      throw new Error('Division by zero');\r\n    }\r\n    return a / b;\r\n  }\r\n\r\n  power(base, exponent) {\r\n    return Math.pow(base, exponent);\r\n  }\r\n\r\n  sqrt(n) {\r\n    if (n < 0) {\r\n      throw new Error('Cannot calculate square root of negative number');\r\n    }\r\n    return Math.sqrt(n);\r\n  }\r\n}\r\n\r\nmodule.exports = Calculator;\r\n`,\r\n      'cli.js': `#!/usr/bin/env node\r\nconst Calculator = require('./calculator');\r\nconst readline = require('readline');\r\n\r\nconst calc = new Calculator();\r\nconst rl = readline.createInterface({\r\n  input: process.stdin,\r\n  output: process.stdout\r\n});\r\n\r\nconsole.log('Simple Calculator');\r\nconsole.log('Available operations: add, subtract, multiply, divide, power, sqrt');\r\nconsole.log('Type \"exit\" to quit\\\\n');\r\n\r\nfunction prompt() {\r\n  rl.question('Enter operation: ', (operation) => {\r\n    if (operation === 'exit') {\r\n      rl.close();\r\n      return;\r\n    }\r\n\r\n    if (operation === 'sqrt') {\r\n      rl.question('Enter number: ', (num) => {\r\n        try {\r\n          const result = calc.sqrt(parseFloat(num));\r\n          console.log(\\`Result: \\${result}\\\\n\\`);\r\n        } catch (error) {\r\n          console.log(\\`Error: \\${(error instanceof Error ? error.message : String(error))}\\\\n\\`);\r\n        }\r\n        prompt();\r\n      });\r\n    } else {\r\n      rl.question('Enter first number: ', (num1) => {\r\n        rl.question('Enter second number: ', (num2) => {\r\n          try {\r\n            const a = parseFloat(num1);\r\n            const b = parseFloat(num2);\r\n            let result;\r\n\r\n            switch (operation) {\r\n              case 'add':\r\n                result = calc.add(a, b);\r\n                break;\r\n              case 'subtract':\r\n                result = calc.subtract(a, b);\r\n                break;\r\n              case 'multiply':\r\n                result = calc.multiply(a, b);\r\n                break;\r\n              case 'divide':\r\n                result = calc.divide(a, b);\r\n                break;\r\n              case 'power':\r\n                result = calc.power(a, b);\r\n                break;\r\n              default:\r\n                console.log('Invalid operation\\\\n');\r\n                prompt();\r\n                return;\r\n            }\r\n\r\n            console.log(\\`Result: \\${result}\\\\n\\`);\r\n          } catch (error) {\r\n            console.log(\\`Error: \\${(error instanceof Error ? error.message : String(error))}\\\\n\\`);\r\n          }\r\n          prompt();\r\n        });\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\nprompt();\r\n`,\r\n      'test.js': `const Calculator = require('./calculator');\r\nconst assert = require('assert');\r\n\r\nconst calc = new Calculator();\r\n\r\n// Test addition\r\nassert.strictEqual(calc.add(2, 3), 5);\r\nassert.strictEqual(calc.add(-1, 1), 0);\r\n\r\n// Test subtraction\r\nassert.strictEqual(calc.subtract(5, 3), 2);\r\nassert.strictEqual(calc.subtract(0, 5), -5);\r\n\r\n// Test multiplication\r\nassert.strictEqual(calc.multiply(3, 4), 12);\r\nassert.strictEqual(calc.multiply(-2, 3), -6);\r\n\r\n// Test division\r\nassert.strictEqual(calc.divide(10, 2), 5);\r\nassert.strictEqual(calc.divide(7, 2), 3.5);\r\n\r\n// Test division by zero\r\nassert.throws(() => calc.divide(5, 0), /Division by zero/);\r\n\r\n// Test power\r\nassert.strictEqual(calc.power(2, 3), 8);\r\nassert.strictEqual(calc.power(5, 0), 1);\r\n\r\n// Test square root\r\nassert.strictEqual(calc.sqrt(16), 4);\r\nassert.strictEqual(calc.sqrt(2), Math.sqrt(2));\r\n\r\n// Test negative square root\r\nassert.throws(() => calc.sqrt(-1), /Cannot calculate square root of negative number/);\r\n\r\nconsole.log('All tests passed! ✅');\r\n`,\r\n      'package.json': this.generatePackageJson('calculator-app', []),\r\n      'README.md': `# Calculator Application\r\n\r\nA simple calculator with basic mathematical operations.\r\n\r\n## Features\r\n- Addition\r\n- Subtraction\r\n- Multiplication\r\n- Division\r\n- Power\r\n- Square Root\r\n\r\n## Installation\r\n\\`\\`\\`bash\r\nnpm install\r\n\\`\\`\\`\r\n\r\n## Usage\r\n\r\n### CLI Mode\r\n\\`\\`\\`bash\r\nnode cli.js\r\n\\`\\`\\`\r\n\r\n### Programmatic Usage\r\n\\`\\`\\`javascript\r\nconst Calculator = require('./calculator');\r\nconst calc = new Calculator();\r\n\r\nconsole.log(calc.add(5, 3)); // 8\r\nconsole.log(calc.multiply(4, 7)); // 28\r\n\\`\\`\\`\r\n\r\n## Testing\r\n\\`\\`\\`bash\r\nnpm test\r\n\\`\\`\\`\r\n\r\nCreated by Claude Flow Swarm\r\n`,\r\n    };\r\n\r\n    // Update package.json with test script\r\n    const pkgJson = JSON.parse(files['package.json']);\r\n    pkgJson.scripts.test = 'node test.js';\r\n    pkgJson.main = 'calculator.js';\r\n    files['package.json'] = JSON.stringify(pkgJson, null, 2);\r\n\r\n    for (const [filename, content] of Object.entries(files)) {\r\n      await fs.writeFile(path.join(targetDir, filename), content);\r\n    }\r\n\r\n    return {\r\n      filesCreated: Object.keys(files).length,\r\n      structure: 'Calculator with CLI and tests',\r\n      targetDir,\r\n    };\r\n  }\r\n\r\n  private async createHelloWorld(targetDir: string, task: TaskDefinition): Promise<any> {\r\n    this.logger.info('Creating Hello World', { targetDir });\r\n\r\n    const files = {\r\n      'index.js': `#!/usr/bin/env node\r\nconsole.log('Hello, World!');\r\nconsole.log('Created by Claude Flow Swarm');\r\n`,\r\n      'package.json': this.generatePackageJson('hello-world', []),\r\n      'README.md': this.generateReadme('Hello World Application', task),\r\n    };\r\n\r\n    for (const [filename, content] of Object.entries(files)) {\r\n      await fs.writeFile(path.join(targetDir, filename), content);\r\n    }\r\n\r\n    return {\r\n      filesCreated: Object.keys(files).length,\r\n      structure: 'Simple Hello World',\r\n      targetDir,\r\n    };\r\n  }\r\n\r\n  private async createGenericApp(targetDir: string, task: TaskDefinition): Promise<any> {\r\n    this.logger.info('Creating generic application', { targetDir });\r\n\r\n    const files = {\r\n      'app.js': this.generateGenericApp(task),\r\n      'package.json': this.generatePackageJson('app', []),\r\n      'README.md': this.generateReadme('Application', task),\r\n    };\r\n\r\n    for (const [filename, content] of Object.entries(files)) {\r\n      await fs.writeFile(path.join(targetDir, filename), content);\r\n    }\r\n\r\n    return {\r\n      filesCreated: Object.keys(files).length,\r\n      structure: 'Generic Application',\r\n      targetDir,\r\n    };\r\n  }\r\n\r\n  private async executeTestingTask(task: TaskDefinition, targetDir?: string): Promise<any> {\r\n    this.logger.info('Executing testing task', { taskName: task.name });\r\n\r\n    const testPlan = {\r\n      taskName: task.name,\r\n      testStrategy: 'Comprehensive testing approach',\r\n      testCases: [\r\n        'Unit tests for core functionality',\r\n        'Integration tests for API endpoints',\r\n        'Performance tests for scalability',\r\n        'Security tests for vulnerabilities',\r\n      ],\r\n      coverage: 'Target 80% code coverage',\r\n    };\r\n\r\n    if (targetDir) {\r\n      await fs.writeFile(path.join(targetDir, 'test-plan.json'), JSON.stringify(testPlan, null, 2));\r\n    }\r\n\r\n    return testPlan;\r\n  }\r\n\r\n  private async executeReviewTask(task: TaskDefinition, targetDir?: string): Promise<any> {\r\n    this.logger.info('Executing review task', { taskName: task.name });\r\n\r\n    const review = {\r\n      taskName: task.name,\r\n      reviewType: 'Code Quality Review',\r\n      findings: [\r\n        'Code follows best practices',\r\n        'Proper error handling implemented',\r\n        'Documentation is comprehensive',\r\n      ],\r\n      recommendations: [\r\n        'Consider adding more unit tests',\r\n        'Optimize database queries',\r\n        'Add input validation',\r\n      ],\r\n    };\r\n\r\n    if (targetDir) {\r\n      await fs.writeFile(path.join(targetDir, 'review.json'), JSON.stringify(review, null, 2));\r\n    }\r\n\r\n    return review;\r\n  }\r\n\r\n  private async executeDocumentationTask(task: TaskDefinition, targetDir?: string): Promise<any> {\r\n    this.logger.info('Executing documentation task', { taskName: task.name });\r\n\r\n    const docs = `# Documentation\r\n\r\n## Overview\r\n${task.description}\r\n\r\n## Installation\r\n\\`\\`\\`bash\r\nnpm install\r\n\\`\\`\\`\r\n\r\n## Usage\r\nFollow the instructions in the README file.\r\n\r\n## API Reference\r\nSee the generated API documentation.\r\n`;\r\n\r\n    if (targetDir) {\r\n      await fs.writeFile(path.join(targetDir, 'DOCS.md'), docs);\r\n    }\r\n\r\n    return { documentation: 'Created', location: targetDir };\r\n  }\r\n\r\n  private async executeResearchTask(task: TaskDefinition, targetDir?: string): Promise<any> {\r\n    this.logger.info('Executing research task', { taskName: task.name });\r\n\r\n    const research = {\r\n      taskName: task.name,\r\n      findings: [\r\n        'Best practices identified',\r\n        'Similar implementations analyzed',\r\n        'Performance benchmarks reviewed',\r\n      ],\r\n      recommendations: [\r\n        'Use established patterns',\r\n        'Follow industry standards',\r\n        'Implement security best practices',\r\n      ],\r\n    };\r\n\r\n    if (targetDir) {\r\n      await fs.writeFile(path.join(targetDir, 'research.json'), JSON.stringify(research, null, 2));\r\n    }\r\n\r\n    return research;\r\n  }\r\n\r\n  private async executeCoordinationTask(task: TaskDefinition, targetDir?: string): Promise<any> {\r\n    this.logger.info('Executing coordination task', { taskName: task.name });\r\n\r\n    return {\r\n      taskName: task.name,\r\n      coordination: 'Task coordination completed',\r\n      subtasks: 'All subtasks have been delegated',\r\n    };\r\n  }\r\n\r\n  private async executeGenericTask(task: TaskDefinition, targetDir?: string): Promise<any> {\r\n    this.logger.info('Executing generic task', { taskName: task.name });\r\n\r\n    return {\r\n      taskName: task.name,\r\n      status: 'Completed',\r\n      description: task.description,\r\n    };\r\n  }\r\n\r\n  // Helper methods for generating code\r\n  private generateRestAPIServer(task: TaskDefinition): string {\r\n    return `const express = require('express');\r\nconst cors = require('cors');\r\nrequire('dotenv').config();\r\n\r\nconst app = express();\r\nconst port = process.env.PORT || 3000;\r\n\r\n// Middleware\r\napp.use(cors());\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: true }));\r\n\r\n// Routes\r\napp.use('/api/users', require('./routes/users'));\r\n\r\n// Health check\r\napp.get('/health', (req, res) => {\r\n  res.json({ status: 'healthy', service: 'REST API' });\r\n});\r\n\r\n// Error handling\r\napp.use((err, req, res, next) => {\r\n  console.error(err.stack);\r\n  res.status(500).json({ error: 'Internal server error' });\r\n});\r\n\r\napp.listen(port, () => {\r\n  console.log(\\`Server running on port \\${port}\\`);\r\n});\r\n\r\nmodule.exports = app;\r\n`;\r\n  }\r\n\r\n  private generateUserRoutes(): string {\r\n    return `const express = require('express');\r\nconst router = express.Router();\r\n\r\n// In-memory storage (replace with database)\r\nlet users = [];\r\nlet nextId = 1;\r\n\r\n// GET all users\r\nrouter.get('/', (req, res) => {\r\n  res.json(users);\r\n});\r\n\r\n// GET user by ID\r\nrouter.get('/:id', (req, res) => {\r\n  const user = users.find(u => u.id === parseInt(req.params.id));\r\n  if (!user) return res.status(404).json({ error: 'User not found' });\r\n  res.json(user);\r\n});\r\n\r\n// POST create user\r\nrouter.post('/', (req, res) => {\r\n  const user = {\r\n    id: nextId++,\r\n    ...req.body,\r\n    createdAt: new Date()\r\n  };\r\n  users.push(user);\r\n  res.status(201).json(user);\r\n});\r\n\r\n// PUT update user\r\nrouter.put('/:id', (req, res) => {\r\n  const index = users.findIndex(u => u.id === parseInt(req.params.id));\r\n  if (index === -1) return res.status(404).json({ error: 'User not found' });\r\n  \r\n  users[index] = {\r\n    ...users[index],\r\n    ...req.body,\r\n    updatedAt: new Date()\r\n  };\r\n  res.json(users[index]);\r\n});\r\n\r\n// DELETE user\r\nrouter.delete('/:id', (req, res) => {\r\n  const index = users.findIndex(u => u.id === parseInt(req.params.id));\r\n  if (index === -1) return res.status(404).json({ error: 'User not found' });\r\n  \r\n  users.splice(index, 1);\r\n  res.status(204).send();\r\n});\r\n\r\nmodule.exports = router;\r\n`;\r\n  }\r\n\r\n  private generateTodoApp(task: TaskDefinition): string {\r\n    return `#!/usr/bin/env node\r\nconst { program } = require('commander');\r\nconst chalk = require('chalk');\r\nconst fs = require('fs').promises;\r\nconst path = require('path');\r\n\r\nconst TODO_FILE = path.join(__dirname, 'todos.json');\r\n\r\n// Load todos\r\nasync function loadTodos() {\r\n  try {\r\n    const data = await fs.readFile(TODO_FILE, 'utf8');\r\n    return JSON.parse(data);\r\n  } catch {\r\n    return [];\r\n  }\r\n}\r\n\r\n// Save todos\r\nasync function saveTodos(todos) {\r\n  await fs.writeFile(TODO_FILE, JSON.stringify(todos, null, 2));\r\n}\r\n\r\n// Add todo\r\nprogram\r\n  .command('add <task>')\r\n  .description('Add a new todo')\r\n  .action(async (task) => {\r\n    const todos = await loadTodos();\r\n    const todo = {\r\n      id: Date.now(),\r\n      task,\r\n      completed: false,\r\n      createdAt: new Date()\r\n    };\r\n    todos.push(todo);\r\n    await saveTodos(todos);\r\n    console.log(chalk.green('✓ Todo added:', task));\r\n  });\r\n\r\n// List todos\r\nprogram\r\n  .command('list')\r\n  .description('List all todos')\r\n  .action(async () => {\r\n    const todos = await loadTodos();\r\n    if (todos.length === 0) {\r\n      console.log(chalk.yellow('No todos found'));\r\n      return;\r\n    }\r\n    \r\n    todos.forEach((todo, index) => {\r\n      const status = todo.completed ? chalk.green('✓') : chalk.red('✗');\r\n      console.log(\\`\\${index + 1}. \\${status} \\${todo.task}\\`);\r\n    });\r\n  });\r\n\r\n// Remove todo\r\nprogram\r\n  .command('remove <id>')\r\n  .description('Remove a todo by ID')\r\n  .action(async (id) => {\r\n    const todos = await loadTodos();\r\n    const index = parseInt(id) - 1;\r\n    if (index < 0 || index >= todos.length) {\r\n      console.log(chalk.red('Invalid todo ID'));\r\n      return;\r\n    }\r\n    \r\n    const removed = todos.splice(index, 1);\r\n    await saveTodos(todos);\r\n    console.log(chalk.green('✓ Todo removed:', removed[0].task));\r\n  });\r\n\r\n// Complete todo\r\nprogram\r\n  .command('done <id>')\r\n  .description('Mark todo as completed')\r\n  .action(async (id) => {\r\n    const todos = await loadTodos();\r\n    const index = parseInt(id) - 1;\r\n    if (index < 0 || index >= todos.length) {\r\n      console.log(chalk.red('Invalid todo ID'));\r\n      return;\r\n    }\r\n    \r\n    todos[index].completed = true;\r\n    todos[index].completedAt = new Date();\r\n    await saveTodos(todos);\r\n    console.log(chalk.green('✓ Todo completed:', todos[index].task));\r\n  });\r\n\r\nprogram.parse(process.argv);\r\n`;\r\n  }\r\n\r\n  private generateChatServer(task: TaskDefinition): string {\r\n    return `const express = require('express');\r\nconst http = require('http');\r\nconst socketIo = require('socket.io');\r\nconst path = require('path');\r\n\r\nconst app = express();\r\nconst server = http.createServer(app);\r\nconst io = socketIo(server);\r\n\r\napp.use(express.static('public'));\r\n\r\nconst messages = [];\r\nconst users = new Map();\r\n\r\nio.on('connection', (socket) => {\r\n  console.log('New user connected');\r\n  \r\n  socket.on('join', (username) => {\r\n    users.set(socket.id, username);\r\n    socket.emit('history', messages);\r\n    io.emit('userJoined', { username, userCount: users.size });\r\n  });\r\n  \r\n  socket.on('message', (data) => {\r\n    const message = {\r\n      id: Date.now(),\r\n      username: users.get(socket.id) || 'Anonymous',\r\n      text: data.text,\r\n      timestamp: new Date()\r\n    };\r\n    \r\n    messages.push(message);\r\n    if (messages.length > 100) messages.shift(); // Keep last 100 messages\r\n    \r\n    io.emit('message', message);\r\n  });\r\n  \r\n  socket.on('disconnect', () => {\r\n    const username = users.get(socket.id);\r\n    users.delete(socket.id);\r\n    if (username) {\r\n      io.emit('userLeft', { username, userCount: users.size });\r\n    }\r\n  });\r\n});\r\n\r\nconst PORT = process.env.PORT || 3000;\r\nserver.listen(PORT, () => {\r\n  console.log(\\`Chat server running on port \\${PORT}\\`);\r\n});\r\n`;\r\n  }\r\n\r\n  private generateChatHTML(): string {\r\n    return `<!DOCTYPE html>\r\n<html>\r\n<head>\r\n  <title>Chat App</title>\r\n  <style>\r\n    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }\r\n    #messages { height: 400px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }\r\n    .message { margin-bottom: 10px; }\r\n    .timestamp { color: #666; font-size: 0.8em; }\r\n    #messageForm { display: flex; gap: 10px; }\r\n    #messageInput { flex: 1; padding: 10px; }\r\n    button { padding: 10px 20px; }\r\n  </style>\r\n</head>\r\n<body>\r\n  <h1>Real-time Chat</h1>\r\n  <div id=\"userCount\">Users: 0</div>\r\n  <div id=\"messages\"></div>\r\n  <form id=\"messageForm\">\r\n    <input type=\"text\" id=\"messageInput\" placeholder=\"Type a message...\" required>\r\n    <button type=\"submit\">Send</button>\r\n  </form>\r\n  <script src=\"/socket.io/socket.io.js\"></script>\r\n  <script src=\"client.js\"></script>\r\n</body>\r\n</html>\r\n`;\r\n  }\r\n\r\n  private generateChatClient(): string {\r\n    return `const socket = io();\r\nconst messagesDiv = document.getElementById('messages');\r\nconst messageForm = document.getElementById('messageForm');\r\nconst messageInput = document.getElementById('messageInput');\r\nconst userCountDiv = document.getElementById('userCount');\r\n\r\nconst username = prompt('Enter your username:') || 'Anonymous';\r\nsocket.emit('join', username);\r\n\r\nsocket.on('history', (messages) => {\r\n  messages.forEach(displayMessage);\r\n});\r\n\r\nsocket.on('message', displayMessage);\r\n\r\nsocket.on('userJoined', ({ username, userCount }) => {\r\n  displaySystemMessage(\\`\\${username} joined the chat\\`);\r\n  updateUserCount(userCount);\r\n});\r\n\r\nsocket.on('userLeft', ({ username, userCount }) => {\r\n  displaySystemMessage(\\`\\${username} left the chat\\`);\r\n  updateUserCount(userCount);\r\n});\r\n\r\nmessageForm.addEventListener('submit', (e) => {\r\n  e.preventDefault();\r\n  const text = messageInput.value.trim();\r\n  if (text) {\r\n    socket.emit('message', { text });\r\n    messageInput.value = '';\r\n  }\r\n});\r\n\r\nfunction displayMessage(message) {\r\n  const div = document.createElement('div');\r\n  div.className = 'message';\r\n  div.innerHTML = \\`\r\n    <strong>\\${message.username}:</strong> \\${message.text}\r\n    <span class=\"timestamp\">\\${new Date(message.timestamp).toLocaleTimeString()}</span>\r\n  \\`;\r\n  messagesDiv.appendChild(div);\r\n  messagesDiv.scrollTop = messagesDiv.scrollHeight;\r\n}\r\n\r\nfunction displaySystemMessage(text) {\r\n  const div = document.createElement('div');\r\n  div.className = 'message system';\r\n  div.style.fontStyle = 'italic';\r\n  div.style.color = '#666';\r\n  div.textContent = text;\r\n  messagesDiv.appendChild(div);\r\n  messagesDiv.scrollTop = messagesDiv.scrollHeight;\r\n}\r\n\r\nfunction updateUserCount(count) {\r\n  userCountDiv.textContent = \\`Users: \\${count}\\`;\r\n}\r\n`;\r\n  }\r\n\r\n  private generateAuthServer(task: TaskDefinition): string {\r\n    return `const express = require('express');\r\nconst jwt = require('jsonwebtoken');\r\nconst bcrypt = require('bcrypt');\r\nrequire('dotenv').config();\r\n\r\nconst app = express();\r\nconst port = process.env.PORT || 3000;\r\n\r\napp.use(express.json());\r\n\r\n// In-memory user storage (use database in production)\r\nconst users = [];\r\n\r\n// Register endpoint\r\napp.post('/api/register', async (req, res) => {\r\n  try {\r\n    const { username, password } = req.body;\r\n    \r\n    // Check if user exists\r\n    if (users.find(u => u.username === username)) {\r\n      return res.status(400).json({ error: 'User already exists' });\r\n    }\r\n    \r\n    // Hash password\r\n    const hashedPassword = await bcrypt.hash(password, 10);\r\n    \r\n    // Create user\r\n    const user = {\r\n      id: users.length + 1,\r\n      username,\r\n      password: hashedPassword\r\n    };\r\n    \r\n    users.push(user);\r\n    \r\n    // Generate token\r\n    const token = jwt.sign(\r\n      { id: user.id, username: user.username },\r\n      process.env.JWT_SECRET || 'default-secret',\r\n      { expiresIn: '24h' }\r\n    );\r\n    \r\n    res.status(201).json({ token, user: { id: user.id, username: user.username } });\r\n  } catch (error) {\r\n    res.status(500).json({ error: 'Registration failed' });\r\n  }\r\n});\r\n\r\n// Login endpoint\r\napp.post('/api/login', async (req, res) => {\r\n  try {\r\n    const { username, password } = req.body;\r\n    \r\n    // Find user\r\n    const user = users.find(u => u.username === username);\r\n    if (!user) {\r\n      return res.status(401).json({ error: 'Invalid credentials' });\r\n    }\r\n    \r\n    // Verify password\r\n    const validPassword = await bcrypt.compare(password, user.password);\r\n    if (!validPassword) {\r\n      return res.status(401).json({ error: 'Invalid credentials' });\r\n    }\r\n    \r\n    // Generate token\r\n    const token = jwt.sign(\r\n      { id: user.id, username: user.username },\r\n      process.env.JWT_SECRET || 'default-secret',\r\n      { expiresIn: '24h' }\r\n    );\r\n    \r\n    res.json({ token, user: { id: user.id, username: user.username } });\r\n  } catch (error) {\r\n    res.status(500).json({ error: 'Login failed' });\r\n  }\r\n});\r\n\r\n// Protected route example\r\napp.get('/api/profile', require('./middleware/auth'), (req, res) => {\r\n  res.json({ user: req.user });\r\n});\r\n\r\napp.listen(port, () => {\r\n  console.log(\\`Auth service running on port \\${port}\\`);\r\n});\r\n`;\r\n  }\r\n\r\n  private generateAuthMiddleware(): string {\r\n    return `const jwt = require('jsonwebtoken');\r\n\r\nmodule.exports = (req, res, next) => {\r\n  const token = req.header('Authorization')?.replace('Bearer ', '');\r\n  \r\n  if (!token) {\r\n    return res.status(401).json({ error: 'Access denied' });\r\n  }\r\n  \r\n  try {\r\n    const verified = jwt.verify(token, process.env.JWT_SECRET || 'default-secret');\r\n    req.user = verified;\r\n    next();\r\n  } catch (error) {\r\n    res.status(401).json({ error: 'Invalid token' });\r\n  }\r\n};\r\n`;\r\n  }\r\n\r\n  private generatePackageJson(name: string, dependencies: string[]): string {\r\n    const deps: Record<string, string> = {};\r\n    dependencies.forEach((dep) => {\r\n      deps[dep] = '^latest';\r\n    });\r\n\r\n    const pkg = {\r\n      name,\r\n      version: '1.0.0',\r\n      description: `${name} created by Claude Flow Swarm`,\r\n      main: 'server.js',\r\n      scripts: {\r\n        start: 'node server.js',\r\n        dev: 'nodemon server.js',\r\n        test: 'echo \"No tests yet\"',\r\n      },\r\n      keywords: ['swarm', 'claude-flow'],\r\n      author: 'Claude Flow Swarm',\r\n      license: 'MIT',\r\n      dependencies: deps,\r\n    };\r\n\r\n    return JSON.stringify(pkg, null, 2);\r\n  }\r\n\r\n  private generateReadme(title: string, task: TaskDefinition): string {\r\n    return `# ${title}\r\n\r\nCreated by Claude Flow Swarm\r\n\r\n## Overview\r\n${task.description}\r\n\r\n## Installation\r\n\\`\\`\\`bash\r\nnpm install\r\n\\`\\`\\`\r\n\r\n## Usage\r\n\\`\\`\\`bash\r\nnpm start\r\n\\`\\`\\`\r\n\r\n## Development\r\n\\`\\`\\`bash\r\nnpm run dev\r\n\\`\\`\\`\r\n\r\n## Task Details\r\n- Task ID: ${task.id.id}\r\n- Task Type: ${task.type}\r\n- Created: ${new Date().toISOString()}\r\n`;\r\n  }\r\n\r\n  private generateGenericApp(task: TaskDefinition): string {\r\n    return `// Application created by Claude Flow Swarm\r\n// Task: ${task.name}\r\n// Description: ${task.description}\r\n\r\nfunction main() {\r\n  console.log('Executing: ${task.description}');\r\n  // Implementation goes here\r\n}\r\n\r\nif (require.main === module) {\r\n  main();\r\n}\r\n\r\nmodule.exports = { main };\r\n`;\r\n  }\r\n\r\n  // Analysis helper methods\r\n  private extractRequirements(description: string): string[] {\r\n    const requirements = [];\r\n\r\n    if (description.includes('rest api') || description.includes('crud')) {\r\n      requirements.push('RESTful API endpoints', 'CRUD operations', 'Data validation');\r\n    }\r\n    if (description.includes('auth')) {\r\n      requirements.push('User authentication', 'JWT tokens', 'Password hashing');\r\n    }\r\n    if (description.includes('real-time') || description.includes('websocket')) {\r\n      requirements.push('WebSocket support', 'Real-time communication', 'Message broadcasting');\r\n    }\r\n    if (description.includes('todo')) {\r\n      requirements.push('Task management', 'CRUD for todos', 'Status tracking');\r\n    }\r\n\r\n    return requirements;\r\n  }\r\n\r\n  private identifyComponents(description: string): string[] {\r\n    const components = [];\r\n\r\n    if (description.includes('api')) components.push('API Server', 'Route Handlers');\r\n    if (description.includes('auth')) components.push('Auth Middleware', 'Token Manager');\r\n    if (description.includes('database')) components.push('Database Models', 'Data Access Layer');\r\n    if (description.includes('frontend')) components.push('UI Components', 'Client Application');\r\n\r\n    return components;\r\n  }\r\n\r\n  private suggestTechnologies(description: string): string[] {\r\n    const tech = [];\r\n\r\n    if (description.includes('rest') || description.includes('api')) {\r\n      tech.push('Express.js', 'Node.js');\r\n    }\r\n    if (description.includes('real-time') || description.includes('chat')) {\r\n      tech.push('Socket.io', 'WebSockets');\r\n    }\r\n    if (description.includes('auth')) {\r\n      tech.push('JWT', 'bcrypt');\r\n    }\r\n    if (description.includes('database')) {\r\n      tech.push('MongoDB', 'PostgreSQL');\r\n    }\r\n\r\n    return tech;\r\n  }\r\n\r\n  private suggestArchitecture(description: string): string {\r\n    if (description.includes('microservice')) {\r\n      return 'Microservices architecture with API Gateway';\r\n    }\r\n    if (description.includes('real-time')) {\r\n      return 'Event-driven architecture with WebSocket layer';\r\n    }\r\n    if (description.includes('crud') || description.includes('rest')) {\r\n      return 'RESTful architecture with MVC pattern';\r\n    }\r\n    return 'Modular monolithic architecture';\r\n  }\r\n}\r\n"],"names":["dirname","fileURLToPath","__dirname","url","fs","path","Logger","DirectTaskExecutor","logger","timeout","config","level","format","destination","component","executeTask","task","agent","targetDir","info","taskId","id","taskName","name","agentType","type","startTime","Date","now","mkdir","recursive","result","executeTaskByType","endTime","executionTime","output","artifacts","metadata","agentId","quality","completeness","accuracy","resourcesUsed","cpuTime","maxMemory","diskIO","networkIO","fileHandles","validated","error","Error","message","String","objective","description","toLowerCase","isRestAPI","includes","isTodo","isChat","isAuth","isHelloWorld","isCalculator","isAnalysis","isResearch","executeAnalyzerTask","createRestAPI","createTodoApp","createChatApp","createAuthService","createHelloWorld","createCalculator","createGenericApp","executeTestingTask","executeReviewTask","executeDocumentationTask","executeResearchTask","executeCoordinationTask","executeGenericTask","analysis","requirements","extractRequirements","components","identifyComponents","technologies","suggestTechnologies","architecture","suggestArchitecture","recommendations","executionPlan","writeFile","join","JSON","stringify","files","generateRestAPIServer","generatePackageJson","generateReadme","filename","content","Object","entries","generateUserRoutes","filesCreated","keys","length","structure","generateTodoApp","generateChatServer","generateChatHTML","generateChatClient","generateAuthServer","generateAuthMiddleware","pkgJson","parse","scripts","test","main","generateGenericApp","testPlan","testStrategy","testCases","coverage","review","reviewType","findings","docs","documentation","location","research","coordination","subtasks","status","dependencies","deps","forEach","dep","pkg","version","start","dev","keywords","author","license","title","toISOString","push","tech"],"mappings":"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"}