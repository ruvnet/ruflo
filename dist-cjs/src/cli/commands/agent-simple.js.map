{"version":3,"sources":["../../../../src/cli/commands/agent-simple.ts"],"sourcesContent":["/**\r\n * Comprehensive Agent management commands - Simplified version\r\n */\r\n\r\nimport { AgentManager } from '../../agents/agent-manager.js';\r\nimport { AgentRegistry } from '../../agents/agent-registry.js';\r\nimport { DistributedMemorySystem } from '../../memory/distributed-memory.js';\r\nimport { EventBus } from '../../core/event-bus.js';\r\nimport { Logger } from '../../core/logger.js';\r\n\r\n// Global instances\r\nlet agentManager: AgentManager | null = null;\r\nlet agentRegistry: AgentRegistry | null = null;\r\n\r\n// Initialize agent management system\r\nasync function initializeAgentSystem(): Promise<{\r\n  manager: AgentManager;\r\n  registry: AgentRegistry;\r\n}> {\r\n  if (agentManager && agentRegistry) {\r\n    return { manager: agentManager, registry: agentRegistry };\r\n  }\r\n\r\n  try {\r\n    const logger = new Logger({\r\n      level: 'info',\r\n      format: 'text',\r\n      destination: 'console',\r\n    });\r\n\r\n    const eventBus = EventBus.getInstance();\r\n\r\n    const memorySystem = new DistributedMemorySystem(\r\n      {\r\n        namespace: 'agents',\r\n        distributed: false,\r\n        consistency: 'eventual',\r\n        replicationFactor: 1,\r\n        syncInterval: 60000,\r\n        maxMemorySize: 100,\r\n        compressionEnabled: false,\r\n        encryptionEnabled: false,\r\n        backupEnabled: true,\r\n        persistenceEnabled: true,\r\n        shardingEnabled: false,\r\n        cacheSize: 50,\r\n        cacheTtl: 300000,\r\n      },\r\n      logger,\r\n      eventBus,\r\n    );\r\n\r\n    await memorySystem.initialize();\r\n\r\n    agentRegistry = new AgentRegistry(memorySystem, 'agents');\r\n    await agentRegistry.initialize();\r\n\r\n    agentManager = new AgentManager(\r\n      {\r\n        maxAgents: 50,\r\n        defaultTimeout: 60000,\r\n        heartbeatInterval: 15000,\r\n        healthCheckInterval: 30000,\r\n        autoRestart: true,\r\n        resourceLimits: {\r\n          memory: 1024 * 1024 * 1024, // 1GB\r\n          cpu: 2.0,\r\n          disk: 2 * 1024 * 1024 * 1024, // 2GB\r\n        },\r\n      },\r\n      logger,\r\n      eventBus,\r\n      memorySystem,\r\n    );\r\n\r\n    await agentManager.initialize();\r\n\r\n    return { manager: agentManager, registry: agentRegistry };\r\n  } catch (error) {\r\n    throw new Error(\r\n      `Failed to initialize agent system: ${error instanceof Error ? error.message : String(error)}`,\r\n    );\r\n  }\r\n}\r\n\r\n// Agent Management Commands\r\nexport const agentCommands = {\r\n  async spawn(args: string[], options: Record<string, any> = {}): Promise<void> {\r\n    try {\r\n      const { manager } = await initializeAgentSystem();\r\n\r\n      const templateName = args[0] || 'researcher';\r\n      const name = options.name || `${templateName}-${Date.now().toString(36)}`;\r\n\r\n      console.log(`üöÄ Creating agent with template: ${templateName}`);\r\n\r\n      const agentId = await manager.createAgent(templateName, {\r\n        name,\r\n        config: {\r\n          autonomyLevel: options.autonomy || 0.7,\r\n          maxConcurrentTasks: options.maxTasks || 5,\r\n          timeoutThreshold: options.timeout || 300000,\r\n        },\r\n      });\r\n\r\n      if (options.start !== false) {\r\n        console.log('‚ö° Starting agent...');\r\n        await manager.startAgent(agentId);\r\n      }\r\n\r\n      console.log('‚úÖ Agent created successfully!');\r\n      console.log(`   ID: ${agentId}`);\r\n      console.log(`   Name: ${name}`);\r\n      console.log(`   Template: ${templateName}`);\r\n    } catch (error) {\r\n      console.error(\r\n        '‚ùå Error creating agent:',\r\n        error instanceof Error ? error.message : String(error),\r\n      );\r\n    }\r\n  },\r\n\r\n  async list(args: string[], options: Record<string, any> = {}): Promise<void> {\r\n    try {\r\n      const { manager } = await initializeAgentSystem();\r\n\r\n      let agents = manager.getAllAgents();\r\n\r\n      // Apply filters\r\n      if (options.type) {\r\n        agents = agents.filter((agent) => agent.type === options.type);\r\n      }\r\n\r\n      if (options.status) {\r\n        agents = agents.filter((agent) => agent.status === options.status);\r\n      }\r\n\r\n      if (options.unhealthy) {\r\n        agents = agents.filter((agent) => agent.health < 0.7);\r\n      }\r\n\r\n      if (agents.length === 0) {\r\n        console.log('üìã No agents found matching the criteria');\r\n        return;\r\n      }\r\n\r\n      console.log(`ü§ñ Agent List (${agents.length} agents)`);\r\n      console.log('='.repeat(60));\r\n\r\n      for (const agent of agents) {\r\n        const healthEmoji = agent.health > 0.8 ? 'üü¢' : agent.health > 0.5 ? 'üü°' : 'üî¥';\r\n        const statusEmoji =\r\n          agent.status === 'idle'\r\n            ? '‚≠ï'\r\n            : agent.status === 'busy'\r\n              ? 'üîµ'\r\n              : agent.status === 'error'\r\n                ? 'üî¥'\r\n                : '‚ö™';\r\n\r\n        console.log(`${healthEmoji} ${agent.name}`);\r\n        console.log(`   ID: ${agent.id.id.slice(-8)}`);\r\n        console.log(`   Type: ${agent.type}`);\r\n        console.log(`   Status: ${statusEmoji} ${agent.status.toUpperCase()}`);\r\n        console.log(`   Health: ${Math.round(agent.health * 100)}%`);\r\n        console.log(`   Workload: ${agent.workload} tasks`);\r\n\r\n        if (options.detailed) {\r\n          console.log(`   Tasks Completed: ${agent.metrics.tasksCompleted}`);\r\n          console.log(`   Success Rate: ${Math.round(agent.metrics.successRate * 100)}%`);\r\n          console.log(`   Memory: ${Math.round(agent.metrics.memoryUsage / 1024 / 1024)}MB`);\r\n        }\r\n\r\n        console.log('');\r\n      }\r\n\r\n      // System stats\r\n      const stats = manager.getSystemStats();\r\n      console.log('üìä System Overview:');\r\n      console.log(\r\n        `   Total: ${stats.totalAgents} | Active: ${stats.activeAgents} | Healthy: ${stats.healthyAgents}`,\r\n      );\r\n      console.log(`   Average Health: ${Math.round(stats.averageHealth * 100)}%`);\r\n    } catch (error) {\r\n      console.error(\r\n        '‚ùå Error listing agents:',\r\n        error instanceof Error ? error.message : String(error),\r\n      );\r\n    }\r\n  },\r\n\r\n  async info(args: string[], options: Record<string, any> = {}): Promise<void> {\r\n    try {\r\n      const { manager } = await initializeAgentSystem();\r\n\r\n      const agentId = args[0];\r\n      if (!agentId) {\r\n        console.error('‚ùå Agent ID is required');\r\n        console.log('Usage: agent info <agent-id>');\r\n        return;\r\n      }\r\n\r\n      const agent = manager.getAgent(agentId);\r\n      if (!agent) {\r\n        console.error(`‚ùå Agent '${agentId}' not found`);\r\n\r\n        // Suggest similar agents\r\n        const allAgents = manager.getAllAgents();\r\n        const similar = allAgents.filter(\r\n          (a) => a.id.id.includes(agentId) || a.name.toLowerCase().includes(agentId.toLowerCase()),\r\n        );\r\n\r\n        if (similar.length > 0) {\r\n          console.log('\\\\nDid you mean one of these agents?');\r\n          similar.forEach((a) => console.log(`  ${a.id.id} - ${a.name}`));\r\n        }\r\n        return;\r\n      }\r\n\r\n      console.log(`ü§ñ Agent Information: ${agent.name}`);\r\n      console.log('='.repeat(50));\r\n\r\n      // Basic info\r\n      console.log(`ID: ${agent.id.id}`);\r\n      console.log(`Name: ${agent.name}`);\r\n      console.log(`Type: ${agent.type}`);\r\n      console.log(`Status: ${agent.status.toUpperCase()}`);\r\n      console.log(`Health: ${Math.round(agent.health * 100)}%`);\r\n      console.log(`Workload: ${agent.workload} active tasks`);\r\n\r\n      // Configuration\r\n      console.log('\\\\n‚öôÔ∏è Configuration:');\r\n      console.log(`  Autonomy Level: ${agent.config.autonomyLevel}`);\r\n      console.log(`  Max Concurrent Tasks: ${agent.config.maxConcurrentTasks}`);\r\n      console.log(`  Timeout Threshold: ${agent.config.timeoutThreshold}ms`);\r\n      console.log(`  Runtime: ${agent.environment.runtime}`);\r\n\r\n      // Metrics\r\n      console.log('\\\\nüìä Performance Metrics:');\r\n      console.log(`  Tasks Completed: ${agent.metrics.tasksCompleted}`);\r\n      console.log(`  Tasks Failed: ${agent.metrics.tasksFailed}`);\r\n      console.log(`  Success Rate: ${Math.round(agent.metrics.successRate * 100)}%`);\r\n      console.log(`  Average Execution Time: ${agent.metrics.averageExecutionTime}ms`);\r\n      console.log(`  Memory Usage: ${Math.round(agent.metrics.memoryUsage / 1024 / 1024)}MB`);\r\n      console.log(`  CPU Usage: ${Math.round(agent.metrics.cpuUsage * 100)}%`);\r\n\r\n      // Health details\r\n      const health = manager.getAgentHealth(agentId);\r\n      if (health) {\r\n        console.log('\\\\nüè• Health Details:');\r\n        console.log(`  Responsiveness: ${Math.round(health.components.responsiveness * 100)}%`);\r\n        console.log(`  Performance: ${Math.round(health.components.performance * 100)}%`);\r\n        console.log(`  Reliability: ${Math.round(health.components.reliability * 100)}%`);\r\n        console.log(`  Resource Usage: ${Math.round(health.components.resourceUsage * 100)}%`);\r\n\r\n        if (health.issues.length > 0) {\r\n          console.log('\\\\n‚ö†Ô∏è Active Issues:');\r\n          health.issues.forEach((issue, index) => {\r\n            console.log(`  ${index + 1}. [${issue.severity.toUpperCase()}] ${issue.message}`);\r\n          });\r\n        }\r\n      }\r\n\r\n      // Capabilities\r\n      console.log('\\\\nüõ†Ô∏è Capabilities:');\r\n      console.log(`  Code Generation: ${agent.capabilities.codeGeneration ? '‚úÖ' : '‚ùå'}`);\r\n      console.log(`  Code Review: ${agent.capabilities.codeReview ? '‚úÖ' : '‚ùå'}`);\r\n      console.log(`  Testing: ${agent.capabilities.testing ? '‚úÖ' : '‚ùå'}`);\r\n      console.log(`  Research: ${agent.capabilities.research ? '‚úÖ' : '‚ùå'}`);\r\n      console.log(`  Web Search: ${agent.capabilities.webSearch ? '‚úÖ' : '‚ùå'}`);\r\n\r\n      if (agent.capabilities.languages.length > 0) {\r\n        console.log(`  Languages: ${agent.capabilities.languages.join(', ')}`);\r\n      }\r\n\r\n      if (agent.capabilities.frameworks.length > 0) {\r\n        console.log(`  Frameworks: ${agent.capabilities.frameworks.join(', ')}`);\r\n      }\r\n    } catch (error) {\r\n      console.error(\r\n        '‚ùå Error getting agent info:',\r\n        error instanceof Error ? error.message : String(error),\r\n      );\r\n    }\r\n  },\r\n\r\n  async terminate(args: string[], options: Record<string, any> = {}): Promise<void> {\r\n    try {\r\n      const { manager } = await initializeAgentSystem();\r\n\r\n      const agentId = args[0];\r\n      if (!agentId) {\r\n        console.error('‚ùå Agent ID is required');\r\n        console.log('Usage: agent terminate <agent-id>');\r\n        return;\r\n      }\r\n\r\n      const agent = manager.getAgent(agentId);\r\n      if (!agent) {\r\n        console.error(`‚ùå Agent '${agentId}' not found`);\r\n        return;\r\n      }\r\n\r\n      console.log(`üõë Terminating agent: ${agent.name} (${agentId})`);\r\n\r\n      const reason = options.reason || 'user_request';\r\n\r\n      // Graceful or force termination\r\n      if (options.force) {\r\n        console.log('‚ö° Force terminating agent...');\r\n      } else {\r\n        console.log('üîÑ Gracefully shutting down agent...');\r\n      }\r\n\r\n      await manager.stopAgent(agentId, reason);\r\n\r\n      if (options.cleanup) {\r\n        console.log('üßπ Cleaning up agent data...');\r\n        await manager.removeAgent(agentId);\r\n      }\r\n\r\n      console.log('‚úÖ Agent terminated successfully');\r\n\r\n      // Show final stats\r\n      if (agent.metrics) {\r\n        console.log('\\\\nüìà Final Statistics:');\r\n        console.log(`  Tasks Completed: ${agent.metrics.tasksCompleted}`);\r\n        console.log(`  Success Rate: ${Math.round(agent.metrics.successRate * 100)}%`);\r\n        console.log(`  Total Uptime: ${Math.round(agent.metrics.totalUptime / 1000)}s`);\r\n      }\r\n    } catch (error) {\r\n      console.error(\r\n        '‚ùå Error terminating agent:',\r\n        error instanceof Error ? error.message : String(error),\r\n      );\r\n    }\r\n  },\r\n\r\n  async start(args: string[], options: Record<string, any> = {}): Promise<void> {\r\n    try {\r\n      const { manager } = await initializeAgentSystem();\r\n\r\n      const agentId = args[0];\r\n      if (!agentId) {\r\n        console.error('‚ùå Agent ID is required');\r\n        console.log('Usage: agent start <agent-id>');\r\n        return;\r\n      }\r\n\r\n      console.log(`üöÄ Starting agent ${agentId}...`);\r\n      await manager.startAgent(agentId);\r\n      console.log('‚úÖ Agent started successfully');\r\n    } catch (error) {\r\n      console.error(\r\n        '‚ùå Error starting agent:',\r\n        error instanceof Error ? error.message : String(error),\r\n      );\r\n    }\r\n  },\r\n\r\n  async restart(args: string[], options: Record<string, any> = {}): Promise<void> {\r\n    try {\r\n      const { manager } = await initializeAgentSystem();\r\n\r\n      const agentId = args[0];\r\n      if (!agentId) {\r\n        console.error('‚ùå Agent ID is required');\r\n        console.log('Usage: agent restart <agent-id>');\r\n        return;\r\n      }\r\n\r\n      console.log(`üîÑ Restarting agent ${agentId}...`);\r\n      const reason = options.reason || 'manual_restart';\r\n      await manager.restartAgent(agentId, reason);\r\n      console.log('‚úÖ Agent restarted successfully');\r\n    } catch (error) {\r\n      console.error(\r\n        '‚ùå Error restarting agent:',\r\n        error instanceof Error ? error.message : String(error),\r\n      );\r\n    }\r\n  },\r\n\r\n  async health(args: string[], options: Record<string, any> = {}): Promise<void> {\r\n    try {\r\n      const { manager } = await initializeAgentSystem();\r\n\r\n      const agents = manager.getAllAgents();\r\n      const stats = manager.getSystemStats();\r\n      const threshold = options.threshold || 0.7;\r\n\r\n      console.log('üè• Agent Health Dashboard');\r\n      console.log('='.repeat(50));\r\n      console.log(`Time: ${new Date().toLocaleString()}`);\r\n      console.log(\r\n        `Total Agents: ${stats.totalAgents} | Active: ${stats.activeAgents} | Healthy: ${stats.healthyAgents}`,\r\n      );\r\n      console.log(`Average Health: ${Math.round(stats.averageHealth * 100)}%`);\r\n\r\n      const unhealthyAgents = agents.filter((a) => a.health < threshold);\r\n      if (unhealthyAgents.length > 0) {\r\n        console.log(\r\n          `\\\\n‚ö†Ô∏è ${unhealthyAgents.length} agents below health threshold (${Math.round(threshold * 100)}%):`,\r\n        );\r\n        unhealthyAgents.forEach((agent) => {\r\n          const healthPercent = Math.round(agent.health * 100);\r\n          console.log(`  üî¥ ${agent.name}: ${healthPercent}% (${agent.status})`);\r\n        });\r\n      } else {\r\n        console.log('\\\\n‚úÖ All agents are healthy!');\r\n      }\r\n\r\n      // Resource utilization\r\n      console.log('\\\\nüíª Resource Utilization:');\r\n      console.log(`  CPU: ${Math.round(stats.resourceUtilization.cpu * 100)}%`);\r\n      console.log(`  Memory: ${Math.round(stats.resourceUtilization.memory / 1024 / 1024)}MB`);\r\n      console.log(`  Disk: ${Math.round(stats.resourceUtilization.disk / 1024 / 1024)}MB`);\r\n    } catch (error) {\r\n      console.error(\r\n        '‚ùå Error getting health status:',\r\n        error instanceof Error ? error.message : String(error),\r\n      );\r\n    }\r\n  },\r\n\r\n  async help(): Promise<void> {\r\n    console.log('ü§ñ Agent Management Commands:');\r\n    console.log('');\r\n    console.log('Available commands:');\r\n    console.log('  spawn <template>     - Create and start new agents');\r\n    console.log('  list                 - Display all agents with status');\r\n    console.log('  info <agent-id>      - Get detailed agent information');\r\n    console.log('  terminate <agent-id> - Safely terminate agents');\r\n    console.log('  start <agent-id>     - Start a created agent');\r\n    console.log('  restart <agent-id>   - Restart an agent');\r\n    console.log('  health               - Monitor agent health');\r\n    console.log('');\r\n    console.log('Common options:');\r\n    console.log('  --type <type>        - Filter by agent type');\r\n    console.log('  --status <status>    - Filter by agent status');\r\n    console.log('  --detailed           - Show detailed information');\r\n    console.log('  --force              - Force operation');\r\n    console.log('  --cleanup            - Clean up data after operation');\r\n    console.log('');\r\n    console.log('Examples:');\r\n    console.log('  agent spawn researcher --name \"research-bot\"');\r\n    console.log('  agent list --type researcher --detailed');\r\n    console.log('  agent info agent-123');\r\n    console.log('  agent terminate agent-123 --cleanup');\r\n    console.log('  agent health --threshold 0.8');\r\n  },\r\n};\r\n\r\n// Export individual command functions for use in CLI\r\nexport const {\r\n  spawn: spawnAgent,\r\n  list: listAgents,\r\n  info: agentInfo,\r\n  terminate: terminateAgent,\r\n  start: startAgent,\r\n  restart: restartAgent,\r\n  health: agentHealth,\r\n} = agentCommands;\r\n"],"names":["AgentManager","AgentRegistry","DistributedMemorySystem","EventBus","Logger","agentManager","agentRegistry","initializeAgentSystem","manager","registry","logger","level","format","destination","eventBus","getInstance","memorySystem","namespace","distributed","consistency","replicationFactor","syncInterval","maxMemorySize","compressionEnabled","encryptionEnabled","backupEnabled","persistenceEnabled","shardingEnabled","cacheSize","cacheTtl","initialize","maxAgents","defaultTimeout","heartbeatInterval","healthCheckInterval","autoRestart","resourceLimits","memory","cpu","disk","error","Error","message","String","agentCommands","spawn","args","options","templateName","name","Date","now","toString","console","log","agentId","createAgent","config","autonomyLevel","autonomy","maxConcurrentTasks","maxTasks","timeoutThreshold","timeout","start","startAgent","list","agents","getAllAgents","type","filter","agent","status","unhealthy","health","length","repeat","healthEmoji","statusEmoji","id","slice","toUpperCase","Math","round","workload","detailed","metrics","tasksCompleted","successRate","memoryUsage","stats","getSystemStats","totalAgents","activeAgents","healthyAgents","averageHealth","info","getAgent","allAgents","similar","a","includes","toLowerCase","forEach","environment","runtime","tasksFailed","averageExecutionTime","cpuUsage","getAgentHealth","components","responsiveness","performance","reliability","resourceUsage","issues","issue","index","severity","capabilities","codeGeneration","codeReview","testing","research","webSearch","languages","join","frameworks","terminate","reason","force","stopAgent","cleanup","removeAgent","totalUptime","restart","restartAgent","threshold","toLocaleString","unhealthyAgents","healthPercent","resourceUtilization","help","spawnAgent","listAgents","agentInfo","terminateAgent","agentHealth"],"mappings":"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"}