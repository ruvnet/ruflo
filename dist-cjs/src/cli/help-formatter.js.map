{"version":3,"sources":["../../../src/cli/help-formatter.ts"],"sourcesContent":["/**\r\n * Standardized CLI Help Formatter\r\n * Follows Unix/Linux conventions for help output\r\n */\r\n\r\nexport interface CommandInfo {\r\n  name: string;\r\n  description: string;\r\n  usage?: string;\r\n  commands?: CommandItem[];\r\n  options?: OptionItem[];\r\n  examples?: string[];\r\n  globalOptions?: OptionItem[];\r\n}\r\n\r\nexport interface CommandItem {\r\n  name: string;\r\n  description: string;\r\n  aliases?: string[];\r\n}\r\n\r\nexport interface OptionItem {\r\n  flags: string;\r\n  description: string;\r\n  defaultValue?: string;\r\n  validValues?: string[];\r\n}\r\n\r\nexport class HelpFormatter {\r\n  private static readonly INDENT = '    ';\r\n  private static readonly COLUMN_GAP = 2;\r\n  private static readonly MIN_DESCRIPTION_COLUMN = 25;\r\n\r\n  /**\r\n   * Format main command help\r\n   */\r\n  static formatHelp(info: CommandInfo): string {\r\n    const sections: string[] = [];\r\n\r\n    // NAME section\r\n    sections.push(this.formatSection('NAME', [`${info.name} - ${info.description}`]));\r\n\r\n    // SYNOPSIS section\r\n    if (info.usage) {\r\n      sections.push(this.formatSection('SYNOPSIS', [info.usage]));\r\n    }\r\n\r\n    // COMMANDS section\r\n    if (info.commands && info.commands.length > 0) {\r\n      sections.push(this.formatSection('COMMANDS', this.formatCommands(info.commands)));\r\n    }\r\n\r\n    // OPTIONS section\r\n    if (info.options && info.options.length > 0) {\r\n      sections.push(this.formatSection('OPTIONS', this.formatOptions(info.options)));\r\n    }\r\n\r\n    // GLOBAL OPTIONS section\r\n    if (info.globalOptions && info.globalOptions.length > 0) {\r\n      sections.push(this.formatSection('GLOBAL OPTIONS', this.formatOptions(info.globalOptions)));\r\n    }\r\n\r\n    // EXAMPLES section\r\n    if (info.examples && info.examples.length > 0) {\r\n      sections.push(this.formatSection('EXAMPLES', info.examples));\r\n    }\r\n\r\n    // Footer\r\n    if (info.commands && info.commands.length > 0) {\r\n      sections.push(`Run '${info.name} <command> --help' for more information on a command.`);\r\n    }\r\n\r\n    return sections.join('\\n\\n');\r\n  }\r\n\r\n  /**\r\n   * Format error message with usage hint\r\n   */\r\n  static formatError(error: string, command: string, usage?: string): string {\r\n    const lines: string[] = [`Error: ${error}`, ''];\r\n\r\n    if (usage) {\r\n      lines.push(`Usage: ${usage}`);\r\n    }\r\n\r\n    lines.push(`Try '${command} --help' for more information.`);\r\n\r\n    return lines.join('\\n');\r\n  }\r\n\r\n  /**\r\n   * Format validation error with valid options\r\n   */\r\n  static formatValidationError(\r\n    value: string,\r\n    paramName: string,\r\n    validOptions: string[],\r\n    command: string,\r\n  ): string {\r\n    return this.formatError(\r\n      `'${value}' is not a valid ${paramName}. Valid options are: ${validOptions.join(', ')}.`,\r\n      command,\r\n    );\r\n  }\r\n\r\n  private static formatSection(title: string, content: string[]): string {\r\n    return `${title}\\n${content.map((line) => `${this.INDENT}${line}`).join('\\n')}`;\r\n  }\r\n\r\n  private static formatCommands(commands: CommandItem[]): string[] {\r\n    const maxNameLength = Math.max(\r\n      this.MIN_DESCRIPTION_COLUMN,\r\n      ...commands.map((cmd) => {\r\n        const nameLength = cmd.name.length;\r\n        const aliasLength = cmd.aliases ? ` (${cmd.aliases.join(', ')})`.length : 0;\r\n        return nameLength + aliasLength;\r\n      }),\r\n    );\r\n\r\n    return commands.map((cmd) => {\r\n      let name = cmd.name;\r\n      if (cmd.aliases && cmd.aliases.length > 0) {\r\n        name += ` (${cmd.aliases.join(', ')})`;\r\n      }\r\n      const padding = ' '.repeat(maxNameLength - name.length + this.COLUMN_GAP);\r\n      return `${name}${padding}${cmd.description}`;\r\n    });\r\n  }\r\n\r\n  private static formatOptions(options: OptionItem[]): string[] {\r\n    const maxFlagsLength = Math.max(\r\n      this.MIN_DESCRIPTION_COLUMN,\r\n      ...options.map((opt) => opt.flags.length),\r\n    );\r\n\r\n    return options.map((opt) => {\r\n      const padding = ' '.repeat(maxFlagsLength - opt.flags.length + this.COLUMN_GAP);\r\n      let description = opt.description;\r\n\r\n      // Add default value\r\n      if (opt.defaultValue !== undefined) {\r\n        description += ` [default: ${opt.defaultValue}]`;\r\n      }\r\n\r\n      // Add valid values on next line if present\r\n      if (opt.validValues && opt.validValues.length > 0) {\r\n        const validValuesLine =\r\n          ' '.repeat(maxFlagsLength + this.COLUMN_GAP) + `Valid: ${opt.validValues.join(', ')}`;\r\n        return `${opt.flags}${padding}${description}\\n${this.INDENT}${validValuesLine}`;\r\n      }\r\n\r\n      return `${opt.flags}${padding}${description}`;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Strip ANSI color codes and emojis from text\r\n   */\r\n  static stripFormatting(text: string): string {\r\n    // Remove ANSI color codes\r\n    text = text.replace(/\\x1b\\[[0-9;]*m/g, '');\r\n\r\n    // Remove common emojis used in the CLI\r\n    const emojiPattern =\r\n      /[\\u{1F300}-\\u{1F9FF}]|[\\u{2600}-\\u{27BF}]|[\\u{1F000}-\\u{1F6FF}]|[\\u{1F680}-\\u{1F6FF}]/gu;\r\n    text = text.replace(emojiPattern, '').trim();\r\n\r\n    // Remove multiple spaces\r\n    text = text.replace(/\\s+/g, ' ');\r\n\r\n    return text;\r\n  }\r\n}\r\n"],"names":["HelpFormatter","INDENT","COLUMN_GAP","MIN_DESCRIPTION_COLUMN","formatHelp","info","sections","push","formatSection","name","description","usage","commands","length","formatCommands","options","formatOptions","globalOptions","examples","join","formatError","error","command","lines","formatValidationError","value","paramName","validOptions","title","content","map","line","maxNameLength","Math","max","cmd","nameLength","aliasLength","aliases","padding","repeat","maxFlagsLength","opt","flags","defaultValue","undefined","validValues","validValuesLine","stripFormatting","text","replace","emojiPattern","trim"],"mappings":"AA4BA,OAAO,MAAMA;IACX,OAAwBC,SAAS,OAAO;IACxC,OAAwBC,aAAa,EAAE;IACvC,OAAwBC,yBAAyB,GAAG;IAKpD,OAAOC,WAAWC,IAAiB,EAAU;QAC3C,MAAMC,WAAqB,EAAE;QAG7BA,SAASC,IAAI,CAAC,IAAI,CAACC,aAAa,CAAC,QAAQ;YAAC,GAAGH,KAAKI,IAAI,CAAC,GAAG,EAAEJ,KAAKK,WAAW,EAAE;SAAC;QAG/E,IAAIL,KAAKM,KAAK,EAAE;YACdL,SAASC,IAAI,CAAC,IAAI,CAACC,aAAa,CAAC,YAAY;gBAACH,KAAKM,KAAK;aAAC;QAC3D;QAGA,IAAIN,KAAKO,QAAQ,IAAIP,KAAKO,QAAQ,CAACC,MAAM,GAAG,GAAG;YAC7CP,SAASC,IAAI,CAAC,IAAI,CAACC,aAAa,CAAC,YAAY,IAAI,CAACM,cAAc,CAACT,KAAKO,QAAQ;QAChF;QAGA,IAAIP,KAAKU,OAAO,IAAIV,KAAKU,OAAO,CAACF,MAAM,GAAG,GAAG;YAC3CP,SAASC,IAAI,CAAC,IAAI,CAACC,aAAa,CAAC,WAAW,IAAI,CAACQ,aAAa,CAACX,KAAKU,OAAO;QAC7E;QAGA,IAAIV,KAAKY,aAAa,IAAIZ,KAAKY,aAAa,CAACJ,MAAM,GAAG,GAAG;YACvDP,SAASC,IAAI,CAAC,IAAI,CAACC,aAAa,CAAC,kBAAkB,IAAI,CAACQ,aAAa,CAACX,KAAKY,aAAa;QAC1F;QAGA,IAAIZ,KAAKa,QAAQ,IAAIb,KAAKa,QAAQ,CAACL,MAAM,GAAG,GAAG;YAC7CP,SAASC,IAAI,CAAC,IAAI,CAACC,aAAa,CAAC,YAAYH,KAAKa,QAAQ;QAC5D;QAGA,IAAIb,KAAKO,QAAQ,IAAIP,KAAKO,QAAQ,CAACC,MAAM,GAAG,GAAG;YAC7CP,SAASC,IAAI,CAAC,CAAC,KAAK,EAAEF,KAAKI,IAAI,CAAC,qDAAqD,CAAC;QACxF;QAEA,OAAOH,SAASa,IAAI,CAAC;IACvB;IAKA,OAAOC,YAAYC,KAAa,EAAEC,OAAe,EAAEX,KAAc,EAAU;QACzE,MAAMY,QAAkB;YAAC,CAAC,OAAO,EAAEF,OAAO;YAAE;SAAG;QAE/C,IAAIV,OAAO;YACTY,MAAMhB,IAAI,CAAC,CAAC,OAAO,EAAEI,OAAO;QAC9B;QAEAY,MAAMhB,IAAI,CAAC,CAAC,KAAK,EAAEe,QAAQ,8BAA8B,CAAC;QAE1D,OAAOC,MAAMJ,IAAI,CAAC;IACpB;IAKA,OAAOK,sBACLC,KAAa,EACbC,SAAiB,EACjBC,YAAsB,EACtBL,OAAe,EACP;QACR,OAAO,IAAI,CAACF,WAAW,CACrB,CAAC,CAAC,EAAEK,MAAM,iBAAiB,EAAEC,UAAU,qBAAqB,EAAEC,aAAaR,IAAI,CAAC,MAAM,CAAC,CAAC,EACxFG;IAEJ;IAEA,OAAed,cAAcoB,KAAa,EAAEC,OAAiB,EAAU;QACrE,OAAO,GAAGD,MAAM,EAAE,EAAEC,QAAQC,GAAG,CAAC,CAACC,OAAS,GAAG,IAAI,CAAC9B,MAAM,GAAG8B,MAAM,EAAEZ,IAAI,CAAC,OAAO;IACjF;IAEA,OAAeL,eAAeF,QAAuB,EAAY;QAC/D,MAAMoB,gBAAgBC,KAAKC,GAAG,CAC5B,IAAI,CAAC/B,sBAAsB,KACxBS,SAASkB,GAAG,CAAC,CAACK;YACf,MAAMC,aAAaD,IAAI1B,IAAI,CAACI,MAAM;YAClC,MAAMwB,cAAcF,IAAIG,OAAO,GAAG,CAAC,EAAE,EAAEH,IAAIG,OAAO,CAACnB,IAAI,CAAC,MAAM,CAAC,CAAC,CAACN,MAAM,GAAG;YAC1E,OAAOuB,aAAaC;QACtB;QAGF,OAAOzB,SAASkB,GAAG,CAAC,CAACK;YACnB,IAAI1B,OAAO0B,IAAI1B,IAAI;YACnB,IAAI0B,IAAIG,OAAO,IAAIH,IAAIG,OAAO,CAACzB,MAAM,GAAG,GAAG;gBACzCJ,QAAQ,CAAC,EAAE,EAAE0B,IAAIG,OAAO,CAACnB,IAAI,CAAC,MAAM,CAAC,CAAC;YACxC;YACA,MAAMoB,UAAU,IAAIC,MAAM,CAACR,gBAAgBvB,KAAKI,MAAM,GAAG,IAAI,CAACX,UAAU;YACxE,OAAO,GAAGO,OAAO8B,UAAUJ,IAAIzB,WAAW,EAAE;QAC9C;IACF;IAEA,OAAeM,cAAcD,OAAqB,EAAY;QAC5D,MAAM0B,iBAAiBR,KAAKC,GAAG,CAC7B,IAAI,CAAC/B,sBAAsB,KACxBY,QAAQe,GAAG,CAAC,CAACY,MAAQA,IAAIC,KAAK,CAAC9B,MAAM;QAG1C,OAAOE,QAAQe,GAAG,CAAC,CAACY;YAClB,MAAMH,UAAU,IAAIC,MAAM,CAACC,iBAAiBC,IAAIC,KAAK,CAAC9B,MAAM,GAAG,IAAI,CAACX,UAAU;YAC9E,IAAIQ,cAAcgC,IAAIhC,WAAW;YAGjC,IAAIgC,IAAIE,YAAY,KAAKC,WAAW;gBAClCnC,eAAe,CAAC,WAAW,EAAEgC,IAAIE,YAAY,CAAC,CAAC,CAAC;YAClD;YAGA,IAAIF,IAAII,WAAW,IAAIJ,IAAII,WAAW,CAACjC,MAAM,GAAG,GAAG;gBACjD,MAAMkC,kBACJ,IAAIP,MAAM,CAACC,iBAAiB,IAAI,CAACvC,UAAU,IAAI,CAAC,OAAO,EAAEwC,IAAII,WAAW,CAAC3B,IAAI,CAAC,OAAO;gBACvF,OAAO,GAAGuB,IAAIC,KAAK,GAAGJ,UAAU7B,YAAY,EAAE,EAAE,IAAI,CAACT,MAAM,GAAG8C,iBAAiB;YACjF;YAEA,OAAO,GAAGL,IAAIC,KAAK,GAAGJ,UAAU7B,aAAa;QAC/C;IACF;IAKA,OAAOsC,gBAAgBC,IAAY,EAAU;QAE3CA,OAAOA,KAAKC,OAAO,CAAC,mBAAmB;QAGvC,MAAMC,eACJ;QACFF,OAAOA,KAAKC,OAAO,CAACC,cAAc,IAAIC,IAAI;QAG1CH,OAAOA,KAAKC,OAAO,CAAC,QAAQ;QAE5B,OAAOD;IACT;AACF"}