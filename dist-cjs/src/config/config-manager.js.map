{"version":3,"sources":["../../../src/config/config-manager.ts"],"sourcesContent":["/**\r\n * Node.js-compatible Configuration management for Claude-Flow\r\n */\r\n\r\nimport { promises as fs } from 'fs';\r\nimport path from 'path';\r\nimport os from 'os';\r\n\r\nexport interface Config {\r\n  orchestrator: {\r\n    maxConcurrentAgents: number;\r\n    taskQueueSize: number;\r\n    healthCheckInterval: number;\r\n    shutdownTimeout: number;\r\n  };\r\n  terminal: {\r\n    type: 'auto' | 'vscode' | 'native';\r\n    poolSize: number;\r\n    recycleAfter: number;\r\n    healthCheckInterval: number;\r\n    commandTimeout: number;\r\n  };\r\n  memory: {\r\n    backend: 'sqlite' | 'markdown' | 'hybrid';\r\n    cacheSizeMB: number;\r\n    syncInterval: number;\r\n    conflictResolution: 'crdt' | 'timestamp' | 'manual';\r\n    retentionDays: number;\r\n  };\r\n  coordination: {\r\n    maxRetries: number;\r\n    retryDelay: number;\r\n    deadlockDetection: boolean;\r\n    resourceTimeout: number;\r\n    messageTimeout: number;\r\n  };\r\n  mcp: {\r\n    transport: 'stdio' | 'http' | 'websocket';\r\n    port: number;\r\n    tlsEnabled: boolean;\r\n  };\r\n  logging: {\r\n    level: 'debug' | 'info' | 'warn' | 'error';\r\n    format: 'json' | 'text';\r\n    destination: 'console' | 'file';\r\n  };\r\n  ruvSwarm: {\r\n    enabled: boolean;\r\n    defaultTopology: 'mesh' | 'hierarchical' | 'ring' | 'star';\r\n    maxAgents: number;\r\n    defaultStrategy: 'balanced' | 'specialized' | 'adaptive';\r\n    autoInit: boolean;\r\n    enableHooks: boolean;\r\n    enablePersistence: boolean;\r\n    enableNeuralTraining: boolean;\r\n    configPath?: string;\r\n  };\r\n  claude?: {\r\n    apiKey?: string;\r\n    model?:\r\n      | 'claude-3-opus-20240229'\r\n      | 'claude-3-sonnet-20240229'\r\n      | 'claude-3-haiku-20240307'\r\n      | 'claude-2.1'\r\n      | 'claude-2.0'\r\n      | 'claude-instant-1.2';\r\n    temperature?: number;\r\n    maxTokens?: number;\r\n    topP?: number;\r\n    topK?: number;\r\n    systemPrompt?: string;\r\n    timeout?: number;\r\n    retryAttempts?: number;\r\n    retryDelay?: number;\r\n  };\r\n}\r\n\r\n/**\r\n * Default configuration values\r\n */\r\nconst DEFAULT_CONFIG: Config = {\r\n  orchestrator: {\r\n    maxConcurrentAgents: 10,\r\n    taskQueueSize: 100,\r\n    healthCheckInterval: 30000,\r\n    shutdownTimeout: 30000,\r\n  },\r\n  terminal: {\r\n    type: 'auto',\r\n    poolSize: 5,\r\n    recycleAfter: 10,\r\n    healthCheckInterval: 60000,\r\n    commandTimeout: 300000,\r\n  },\r\n  memory: {\r\n    backend: 'hybrid',\r\n    cacheSizeMB: 100,\r\n    syncInterval: 5000,\r\n    conflictResolution: 'crdt',\r\n    retentionDays: 30,\r\n  },\r\n  coordination: {\r\n    maxRetries: 3,\r\n    retryDelay: 1000,\r\n    deadlockDetection: true,\r\n    resourceTimeout: 60000,\r\n    messageTimeout: 30000,\r\n  },\r\n  mcp: {\r\n    transport: 'stdio',\r\n    port: 3000,\r\n    tlsEnabled: false,\r\n  },\r\n  logging: {\r\n    level: 'info',\r\n    format: 'json',\r\n    destination: 'console',\r\n  },\r\n  ruvSwarm: {\r\n    enabled: true,\r\n    defaultTopology: 'mesh',\r\n    maxAgents: 8,\r\n    defaultStrategy: 'adaptive',\r\n    autoInit: true,\r\n    enableHooks: true,\r\n    enablePersistence: true,\r\n    enableNeuralTraining: true,\r\n    configPath: '.claude/ruv-swarm-config.json',\r\n  },\r\n  claude: {\r\n    model: 'claude-3-sonnet-20240229',\r\n    temperature: 0.7,\r\n    maxTokens: 4096,\r\n    topP: 1,\r\n    timeout: 60000,\r\n    retryAttempts: 3,\r\n    retryDelay: 1000,\r\n  },\r\n};\r\n\r\n/**\r\n * Configuration validation error\r\n */\r\nexport class ConfigError extends Error {\r\n  constructor(message: string) {\r\n    super(message);\r\n    this.name = 'ConfigError';\r\n  }\r\n}\r\n\r\n/**\r\n * Configuration manager for Node.js\r\n */\r\nexport class ConfigManager {\r\n  private static instance: ConfigManager;\r\n  private config: Config;\r\n  private configPath?: string;\r\n  private userConfigDir: string;\r\n\r\n  private constructor() {\r\n    this.config = this.deepClone(DEFAULT_CONFIG);\r\n    this.userConfigDir = path.join(os.homedir(), '.claude-flow');\r\n  }\r\n\r\n  /**\r\n   * Gets the singleton instance\r\n   */\r\n  static getInstance(): ConfigManager {\r\n    if (!ConfigManager.instance) {\r\n      ConfigManager.instance = new ConfigManager();\r\n    }\r\n    return ConfigManager.instance;\r\n  }\r\n\r\n  /**\r\n   * Initialize configuration from file or create default\r\n   */\r\n  async init(configPath = 'claude-flow.config.json'): Promise<void> {\r\n    try {\r\n      await this.load(configPath);\r\n      console.log(`✅ Configuration loaded from: ${configPath}`);\r\n    } catch (error) {\r\n      // Create default config file if it doesn't exist\r\n      await this.createDefaultConfig(configPath);\r\n      console.log(`✅ Default configuration created: ${configPath}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Creates a default configuration file\r\n   */\r\n  async createDefaultConfig(configPath: string): Promise<void> {\r\n    const config = this.deepClone(DEFAULT_CONFIG);\r\n    const content = JSON.stringify(config, null, 2);\r\n    await fs.writeFile(configPath, content, 'utf8');\r\n    this.configPath = configPath;\r\n  }\r\n\r\n  /**\r\n   * Loads configuration from file\r\n   */\r\n  async load(configPath?: string): Promise<Config> {\r\n    if (configPath) {\r\n      this.configPath = configPath;\r\n    }\r\n\r\n    if (!this.configPath) {\r\n      throw new ConfigError('No configuration file path specified');\r\n    }\r\n\r\n    try {\r\n      const content = await fs.readFile(this.configPath, 'utf8');\r\n      const fileConfig = JSON.parse(content) as Partial<Config>;\r\n\r\n      // Merge with defaults\r\n      this.config = this.deepMerge(DEFAULT_CONFIG, fileConfig);\r\n\r\n      // Load environment variables\r\n      this.loadFromEnv();\r\n\r\n      // Validate\r\n      this.validate(this.config);\r\n\r\n      return this.config;\r\n    } catch (error) {\r\n      if ((error as NodeJS.ErrnoException).code === 'ENOENT') {\r\n        throw new ConfigError(`Configuration file not found: ${this.configPath}`);\r\n      }\r\n      throw new ConfigError(`Failed to load configuration: ${(error as Error).message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Shows current configuration\r\n   */\r\n  show(): Config {\r\n    return this.deepClone(this.config);\r\n  }\r\n\r\n  /**\r\n   * Gets a configuration value by path\r\n   */\r\n  get(path: string): any {\r\n    const keys = path.split('.');\r\n    let current: any = this.config;\r\n\r\n    for (const key of keys) {\r\n      if (current && typeof current === 'object' && key in current) {\r\n        current = current[key];\r\n      } else {\r\n        return undefined;\r\n      }\r\n    }\r\n\r\n    return current;\r\n  }\r\n\r\n  /**\r\n   * Sets a configuration value by path\r\n   */\r\n  set(path: string, value: any): void {\r\n    const keys = path.split('.');\r\n    let current: any = this.config;\r\n\r\n    for (let i = 0; i < keys.length - 1; i++) {\r\n      const key = keys[i];\r\n      if (!(key in current)) {\r\n        current[key] = {};\r\n      }\r\n      current = current[key];\r\n    }\r\n\r\n    const lastKey = keys[keys.length - 1];\r\n    current[lastKey] = value;\r\n\r\n    // Validate after setting\r\n    this.validate(this.config);\r\n  }\r\n\r\n  /**\r\n   * Saves current configuration to file\r\n   */\r\n  async save(configPath?: string): Promise<void> {\r\n    const savePath = configPath || this.configPath;\r\n    if (!savePath) {\r\n      throw new ConfigError('No configuration file path specified');\r\n    }\r\n\r\n    const content = JSON.stringify(this.config, null, 2);\r\n    await fs.writeFile(savePath, content, 'utf8');\r\n  }\r\n\r\n  /**\r\n   * Validates the configuration\r\n   */\r\n  validate(config: Config): void {\r\n    // Orchestrator validation\r\n    if (\r\n      config.orchestrator.maxConcurrentAgents < 1 ||\r\n      config.orchestrator.maxConcurrentAgents > 100\r\n    ) {\r\n      throw new ConfigError('orchestrator.maxConcurrentAgents must be between 1 and 100');\r\n    }\r\n    if (config.orchestrator.taskQueueSize < 1 || config.orchestrator.taskQueueSize > 10000) {\r\n      throw new ConfigError('orchestrator.taskQueueSize must be between 1 and 10000');\r\n    }\r\n\r\n    // Terminal validation\r\n    if (!['auto', 'vscode', 'native'].includes(config.terminal.type)) {\r\n      throw new ConfigError('terminal.type must be one of: auto, vscode, native');\r\n    }\r\n    if (config.terminal.poolSize < 1 || config.terminal.poolSize > 50) {\r\n      throw new ConfigError('terminal.poolSize must be between 1 and 50');\r\n    }\r\n\r\n    // Memory validation\r\n    if (!['sqlite', 'markdown', 'hybrid'].includes(config.memory.backend)) {\r\n      throw new ConfigError('memory.backend must be one of: sqlite, markdown, hybrid');\r\n    }\r\n    if (config.memory.cacheSizeMB < 1 || config.memory.cacheSizeMB > 10000) {\r\n      throw new ConfigError('memory.cacheSizeMB must be between 1 and 10000');\r\n    }\r\n\r\n    // Coordination validation\r\n    if (config.coordination.maxRetries < 0 || config.coordination.maxRetries > 100) {\r\n      throw new ConfigError('coordination.maxRetries must be between 0 and 100');\r\n    }\r\n\r\n    // MCP validation\r\n    if (!['stdio', 'http', 'websocket'].includes(config.mcp.transport)) {\r\n      throw new ConfigError('mcp.transport must be one of: stdio, http, websocket');\r\n    }\r\n    if (config.mcp.port < 1 || config.mcp.port > 65535) {\r\n      throw new ConfigError('mcp.port must be between 1 and 65535');\r\n    }\r\n\r\n    // Logging validation\r\n    if (!['debug', 'info', 'warn', 'error'].includes(config.logging.level)) {\r\n      throw new ConfigError('logging.level must be one of: debug, info, warn, error');\r\n    }\r\n    if (!['json', 'text'].includes(config.logging.format)) {\r\n      throw new ConfigError('logging.format must be one of: json, text');\r\n    }\r\n    if (!['console', 'file'].includes(config.logging.destination)) {\r\n      throw new ConfigError('logging.destination must be one of: console, file');\r\n    }\r\n\r\n    // ruv-swarm validation\r\n    if (!['mesh', 'hierarchical', 'ring', 'star'].includes(config.ruvSwarm.defaultTopology)) {\r\n      throw new ConfigError(\r\n        'ruvSwarm.defaultTopology must be one of: mesh, hierarchical, ring, star',\r\n      );\r\n    }\r\n    if (config.ruvSwarm.maxAgents < 1 || config.ruvSwarm.maxAgents > 100) {\r\n      throw new ConfigError('ruvSwarm.maxAgents must be between 1 and 100');\r\n    }\r\n    if (!['balanced', 'specialized', 'adaptive'].includes(config.ruvSwarm.defaultStrategy)) {\r\n      throw new ConfigError(\r\n        'ruvSwarm.defaultStrategy must be one of: balanced, specialized, adaptive',\r\n      );\r\n    }\r\n\r\n    // Claude API validation\r\n    if (config.claude) {\r\n      if (config.claude.model) {\r\n        const validModels = [\r\n          'claude-3-opus-20240229',\r\n          'claude-3-sonnet-20240229',\r\n          'claude-3-haiku-20240307',\r\n          'claude-2.1',\r\n          'claude-2.0',\r\n          'claude-instant-1.2',\r\n        ];\r\n        if (!validModels.includes(config.claude.model)) {\r\n          throw new ConfigError(`claude.model must be one of: ${validModels.join(', ')}`);\r\n        }\r\n      }\r\n      if (config.claude.temperature !== undefined) {\r\n        if (config.claude.temperature < 0 || config.claude.temperature > 1) {\r\n          throw new ConfigError('claude.temperature must be between 0 and 1');\r\n        }\r\n      }\r\n      if (config.claude.maxTokens !== undefined) {\r\n        if (config.claude.maxTokens < 1 || config.claude.maxTokens > 100000) {\r\n          throw new ConfigError('claude.maxTokens must be between 1 and 100000');\r\n        }\r\n      }\r\n      if (config.claude.topP !== undefined) {\r\n        if (config.claude.topP < 0 || config.claude.topP > 1) {\r\n          throw new ConfigError('claude.topP must be between 0 and 1');\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Loads configuration from environment variables\r\n   */\r\n  private loadFromEnv(): void {\r\n    // Orchestrator settings\r\n    const maxAgents = process.env.CLAUDE_FLOW_MAX_AGENTS;\r\n    if (maxAgents) {\r\n      this.config.orchestrator.maxConcurrentAgents = parseInt(maxAgents, 10);\r\n    }\r\n\r\n    // Terminal settings\r\n    const terminalType = process.env.CLAUDE_FLOW_TERMINAL_TYPE;\r\n    if (terminalType === 'vscode' || terminalType === 'native' || terminalType === 'auto') {\r\n      this.config.terminal.type = terminalType;\r\n    }\r\n\r\n    // Memory settings\r\n    const memoryBackend = process.env.CLAUDE_FLOW_MEMORY_BACKEND;\r\n    if (memoryBackend === 'sqlite' || memoryBackend === 'markdown' || memoryBackend === 'hybrid') {\r\n      this.config.memory.backend = memoryBackend;\r\n    }\r\n\r\n    // MCP settings\r\n    const mcpTransport = process.env.CLAUDE_FLOW_MCP_TRANSPORT;\r\n    if (mcpTransport === 'stdio' || mcpTransport === 'http' || mcpTransport === 'websocket') {\r\n      this.config.mcp.transport = mcpTransport;\r\n    }\r\n\r\n    const mcpPort = process.env.CLAUDE_FLOW_MCP_PORT;\r\n    if (mcpPort) {\r\n      this.config.mcp.port = parseInt(mcpPort, 10);\r\n    }\r\n\r\n    // Logging settings\r\n    const logLevel = process.env.CLAUDE_FLOW_LOG_LEVEL;\r\n    if (\r\n      logLevel === 'debug' ||\r\n      logLevel === 'info' ||\r\n      logLevel === 'warn' ||\r\n      logLevel === 'error'\r\n    ) {\r\n      this.config.logging.level = logLevel;\r\n    }\r\n\r\n    // ruv-swarm settings\r\n    const ruvSwarmEnabled = process.env.CLAUDE_FLOW_RUV_SWARM_ENABLED;\r\n    if (ruvSwarmEnabled === 'true' || ruvSwarmEnabled === 'false') {\r\n      this.config.ruvSwarm.enabled = ruvSwarmEnabled === 'true';\r\n    }\r\n\r\n    const ruvSwarmTopology = process.env.CLAUDE_FLOW_RUV_SWARM_TOPOLOGY;\r\n    if (\r\n      ruvSwarmTopology === 'mesh' ||\r\n      ruvSwarmTopology === 'hierarchical' ||\r\n      ruvSwarmTopology === 'ring' ||\r\n      ruvSwarmTopology === 'star'\r\n    ) {\r\n      this.config.ruvSwarm.defaultTopology = ruvSwarmTopology;\r\n    }\r\n\r\n    const ruvSwarmMaxAgents = process.env.CLAUDE_FLOW_RUV_SWARM_MAX_AGENTS;\r\n    if (ruvSwarmMaxAgents) {\r\n      this.config.ruvSwarm.maxAgents = parseInt(ruvSwarmMaxAgents, 10);\r\n    }\r\n\r\n    // Claude API settings\r\n    if (!this.config.claude) {\r\n      this.config.claude = {};\r\n    }\r\n\r\n    const claudeApiKey = process.env.ANTHROPIC_API_KEY;\r\n    if (claudeApiKey) {\r\n      this.config.claude.apiKey = claudeApiKey;\r\n    }\r\n\r\n    const claudeModel = process.env.CLAUDE_MODEL;\r\n    if (claudeModel) {\r\n      this.config.claude.model = claudeModel as any;\r\n    }\r\n\r\n    const claudeTemperature = process.env.CLAUDE_TEMPERATURE;\r\n    if (claudeTemperature) {\r\n      this.config.claude.temperature = parseFloat(claudeTemperature);\r\n    }\r\n\r\n    const claudeMaxTokens = process.env.CLAUDE_MAX_TOKENS;\r\n    if (claudeMaxTokens) {\r\n      this.config.claude.maxTokens = parseInt(claudeMaxTokens, 10);\r\n    }\r\n\r\n    const claudeTopP = process.env.CLAUDE_TOP_P;\r\n    if (claudeTopP) {\r\n      this.config.claude.topP = parseFloat(claudeTopP);\r\n    }\r\n\r\n    const claudeTopK = process.env.CLAUDE_TOP_K;\r\n    if (claudeTopK) {\r\n      this.config.claude.topK = parseInt(claudeTopK, 10);\r\n    }\r\n\r\n    const claudeSystemPrompt = process.env.CLAUDE_SYSTEM_PROMPT;\r\n    if (claudeSystemPrompt) {\r\n      this.config.claude.systemPrompt = claudeSystemPrompt;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Deep clone helper\r\n   */\r\n  private deepClone<T>(obj: T): T {\r\n    return JSON.parse(JSON.stringify(obj));\r\n  }\r\n\r\n  /**\r\n   * Get ruv-swarm specific configuration\r\n   */\r\n  getRuvSwarmConfig() {\r\n    return this.deepClone(this.config.ruvSwarm);\r\n  }\r\n\r\n  /**\r\n   * Get available configuration templates\r\n   */\r\n  getAvailableTemplates(): string[] {\r\n    return ['default', 'development', 'production', 'testing'];\r\n  }\r\n\r\n  /**\r\n   * Create a configuration template\r\n   */\r\n  createTemplate(name: string, config: any): void {\r\n    // Implementation for creating templates\r\n    console.log(`Creating template: ${name}`, config);\r\n  }\r\n\r\n  /**\r\n   * Get format parsers\r\n   */\r\n  getFormatParsers(): Record<string, any> {\r\n    return {\r\n      json: { extension: '.json', parse: JSON.parse, stringify: JSON.stringify },\r\n      yaml: {\r\n        extension: '.yaml',\r\n        parse: (content: string) => content,\r\n        stringify: (obj: any) => JSON.stringify(obj),\r\n      },\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Validate configuration file\r\n   */\r\n  validateFile(path: string): boolean {\r\n    try {\r\n      // Basic validation - file exists and is valid JSON\r\n      require('fs').readFileSync(path, 'utf8');\r\n      return true;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get path history\r\n   */\r\n  getPathHistory(): any[] {\r\n    return []; // Mock implementation\r\n  }\r\n\r\n  /**\r\n   * Get change history\r\n   */\r\n  getChangeHistory(): any[] {\r\n    return []; // Mock implementation\r\n  }\r\n\r\n  /**\r\n   * Backup configuration\r\n   */\r\n  async backup(path: string): Promise<void> {\r\n    const backupPath = `${path}.backup.${Date.now()}`;\r\n    const content = JSON.stringify(this.config, null, 2);\r\n    await fs.writeFile(backupPath, content, 'utf8');\r\n    console.log(`Configuration backed up to: ${backupPath}`);\r\n  }\r\n\r\n  /**\r\n   * Restore configuration from backup\r\n   */\r\n  async restore(path: string): Promise<void> {\r\n    const content = await fs.readFile(path, 'utf8');\r\n    this.config = JSON.parse(content);\r\n    console.log(`Configuration restored from: ${path}`);\r\n  }\r\n\r\n  /**\r\n   * Update ruv-swarm configuration\r\n   */\r\n  setRuvSwarmConfig(updates: Partial<Config['ruvSwarm']>): void {\r\n    this.config.ruvSwarm = { ...this.config.ruvSwarm, ...updates };\r\n    this.validate(this.config);\r\n  }\r\n\r\n  /**\r\n   * Check if ruv-swarm is enabled\r\n   */\r\n  isRuvSwarmEnabled(): boolean {\r\n    return this.config.ruvSwarm.enabled;\r\n  }\r\n\r\n  /**\r\n   * Generate ruv-swarm command arguments from configuration\r\n   */\r\n  getRuvSwarmArgs(): string[] {\r\n    const args: string[] = [];\r\n    const config = this.config.ruvSwarm;\r\n\r\n    if (!config.enabled) {\r\n      return args;\r\n    }\r\n\r\n    args.push('--topology', config.defaultTopology);\r\n    args.push('--max-agents', String(config.maxAgents));\r\n    args.push('--strategy', config.defaultStrategy);\r\n\r\n    if (config.enableHooks) {\r\n      args.push('--enable-hooks');\r\n    }\r\n\r\n    if (config.enablePersistence) {\r\n      args.push('--enable-persistence');\r\n    }\r\n\r\n    if (config.enableNeuralTraining) {\r\n      args.push('--enable-training');\r\n    }\r\n\r\n    if (config.configPath) {\r\n      args.push('--config-path', config.configPath);\r\n    }\r\n\r\n    return args;\r\n  }\r\n\r\n  /**\r\n   * Get Claude API configuration\r\n   */\r\n  getClaudeConfig() {\r\n    return this.deepClone(this.config.claude || {});\r\n  }\r\n\r\n  /**\r\n   * Update Claude API configuration\r\n   */\r\n  setClaudeConfig(updates: Partial<Config['claude']>): void {\r\n    if (!this.config.claude) {\r\n      this.config.claude = {};\r\n    }\r\n    this.config.claude = { ...this.config.claude, ...updates };\r\n    this.validate(this.config);\r\n  }\r\n\r\n  /**\r\n   * Check if Claude API is configured\r\n   */\r\n  isClaudeAPIConfigured(): boolean {\r\n    return !!(this.config.claude?.apiKey || process.env.ANTHROPIC_API_KEY);\r\n  }\r\n\r\n  /**\r\n   * Deep merge helper\r\n   */\r\n  private deepMerge(target: Config, source: Partial<Config>): Config {\r\n    const result = this.deepClone(target);\r\n\r\n    if (source.orchestrator) {\r\n      result.orchestrator = { ...result.orchestrator, ...source.orchestrator };\r\n    }\r\n    if (source.terminal) {\r\n      result.terminal = { ...result.terminal, ...source.terminal };\r\n    }\r\n    if (source.memory) {\r\n      result.memory = { ...result.memory, ...source.memory };\r\n    }\r\n    if (source.coordination) {\r\n      result.coordination = { ...result.coordination, ...source.coordination };\r\n    }\r\n    if (source.mcp) {\r\n      result.mcp = { ...result.mcp, ...source.mcp };\r\n    }\r\n    if (source.logging) {\r\n      result.logging = { ...result.logging, ...source.logging };\r\n    }\r\n    if (source.ruvSwarm) {\r\n      result.ruvSwarm = { ...result.ruvSwarm, ...source.ruvSwarm };\r\n    }\r\n    if (source.claude) {\r\n      result.claude = { ...result.claude, ...source.claude };\r\n    }\r\n\r\n    return result;\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const configManager = ConfigManager.getInstance();\r\n"],"names":["promises","fs","path","os","DEFAULT_CONFIG","orchestrator","maxConcurrentAgents","taskQueueSize","healthCheckInterval","shutdownTimeout","terminal","type","poolSize","recycleAfter","commandTimeout","memory","backend","cacheSizeMB","syncInterval","conflictResolution","retentionDays","coordination","maxRetries","retryDelay","deadlockDetection","resourceTimeout","messageTimeout","mcp","transport","port","tlsEnabled","logging","level","format","destination","ruvSwarm","enabled","defaultTopology","maxAgents","defaultStrategy","autoInit","enableHooks","enablePersistence","enableNeuralTraining","configPath","claude","model","temperature","maxTokens","topP","timeout","retryAttempts","ConfigError","Error","message","name","ConfigManager","instance","config","userConfigDir","deepClone","join","homedir","getInstance","init","load","console","log","error","createDefaultConfig","content","JSON","stringify","writeFile","readFile","fileConfig","parse","deepMerge","loadFromEnv","validate","code","show","get","keys","split","current","key","undefined","set","value","i","length","lastKey","save","savePath","includes","validModels","process","env","CLAUDE_FLOW_MAX_AGENTS","parseInt","terminalType","CLAUDE_FLOW_TERMINAL_TYPE","memoryBackend","CLAUDE_FLOW_MEMORY_BACKEND","mcpTransport","CLAUDE_FLOW_MCP_TRANSPORT","mcpPort","CLAUDE_FLOW_MCP_PORT","logLevel","CLAUDE_FLOW_LOG_LEVEL","ruvSwarmEnabled","CLAUDE_FLOW_RUV_SWARM_ENABLED","ruvSwarmTopology","CLAUDE_FLOW_RUV_SWARM_TOPOLOGY","ruvSwarmMaxAgents","CLAUDE_FLOW_RUV_SWARM_MAX_AGENTS","claudeApiKey","ANTHROPIC_API_KEY","apiKey","claudeModel","CLAUDE_MODEL","claudeTemperature","CLAUDE_TEMPERATURE","parseFloat","claudeMaxTokens","CLAUDE_MAX_TOKENS","claudeTopP","CLAUDE_TOP_P","claudeTopK","CLAUDE_TOP_K","topK","claudeSystemPrompt","CLAUDE_SYSTEM_PROMPT","systemPrompt","obj","getRuvSwarmConfig","getAvailableTemplates","createTemplate","getFormatParsers","json","extension","yaml","validateFile","require","readFileSync","getPathHistory","getChangeHistory","backup","backupPath","Date","now","restore","setRuvSwarmConfig","updates","isRuvSwarmEnabled","getRuvSwarmArgs","args","push","String","getClaudeConfig","setClaudeConfig","isClaudeAPIConfigured","target","source","result","configManager"],"mappings":"AAIA,SAASA,YAAYC,EAAE,QAAQ,KAAK;AACpC,OAAOC,UAAU,OAAO;AACxB,OAAOC,QAAQ,KAAK;AA0EpB,MAAMC,iBAAyB;IAC7BC,cAAc;QACZC,qBAAqB;QACrBC,eAAe;QACfC,qBAAqB;QACrBC,iBAAiB;IACnB;IACAC,UAAU;QACRC,MAAM;QACNC,UAAU;QACVC,cAAc;QACdL,qBAAqB;QACrBM,gBAAgB;IAClB;IACAC,QAAQ;QACNC,SAAS;QACTC,aAAa;QACbC,cAAc;QACdC,oBAAoB;QACpBC,eAAe;IACjB;IACAC,cAAc;QACZC,YAAY;QACZC,YAAY;QACZC,mBAAmB;QACnBC,iBAAiB;QACjBC,gBAAgB;IAClB;IACAC,KAAK;QACHC,WAAW;QACXC,MAAM;QACNC,YAAY;IACd;IACAC,SAAS;QACPC,OAAO;QACPC,QAAQ;QACRC,aAAa;IACf;IACAC,UAAU;QACRC,SAAS;QACTC,iBAAiB;QACjBC,WAAW;QACXC,iBAAiB;QACjBC,UAAU;QACVC,aAAa;QACbC,mBAAmB;QACnBC,sBAAsB;QACtBC,YAAY;IACd;IACAC,QAAQ;QACNC,OAAO;QACPC,aAAa;QACbC,WAAW;QACXC,MAAM;QACNC,SAAS;QACTC,eAAe;QACf5B,YAAY;IACd;AACF;AAKA,OAAO,MAAM6B,oBAAoBC;IAC/B,YAAYC,OAAe,CAAE;QAC3B,KAAK,CAACA;QACN,IAAI,CAACC,IAAI,GAAG;IACd;AACF;AAKA,OAAO,MAAMC;IACX,OAAeC,SAAwB;IAC/BC,OAAe;IACfd,WAAoB;IACpBe,cAAsB;IAE9B,aAAsB;QACpB,IAAI,CAACD,MAAM,GAAG,IAAI,CAACE,SAAS,CAACxD;QAC7B,IAAI,CAACuD,aAAa,GAAGzD,KAAK2D,IAAI,CAAC1D,GAAG2D,OAAO,IAAI;IAC/C;IAKA,OAAOC,cAA6B;QAClC,IAAI,CAACP,cAAcC,QAAQ,EAAE;YAC3BD,cAAcC,QAAQ,GAAG,IAAID;QAC/B;QACA,OAAOA,cAAcC,QAAQ;IAC/B;IAKA,MAAMO,KAAKpB,aAAa,yBAAyB,EAAiB;QAChE,IAAI;YACF,MAAM,IAAI,CAACqB,IAAI,CAACrB;YAChBsB,QAAQC,GAAG,CAAC,CAAC,6BAA6B,EAAEvB,YAAY;QAC1D,EAAE,OAAOwB,OAAO;YAEd,MAAM,IAAI,CAACC,mBAAmB,CAACzB;YAC/BsB,QAAQC,GAAG,CAAC,CAAC,iCAAiC,EAAEvB,YAAY;QAC9D;IACF;IAKA,MAAMyB,oBAAoBzB,UAAkB,EAAiB;QAC3D,MAAMc,SAAS,IAAI,CAACE,SAAS,CAACxD;QAC9B,MAAMkE,UAAUC,KAAKC,SAAS,CAACd,QAAQ,MAAM;QAC7C,MAAMzD,GAAGwE,SAAS,CAAC7B,YAAY0B,SAAS;QACxC,IAAI,CAAC1B,UAAU,GAAGA;IACpB;IAKA,MAAMqB,KAAKrB,UAAmB,EAAmB;QAC/C,IAAIA,YAAY;YACd,IAAI,CAACA,UAAU,GAAGA;QACpB;QAEA,IAAI,CAAC,IAAI,CAACA,UAAU,EAAE;YACpB,MAAM,IAAIQ,YAAY;QACxB;QAEA,IAAI;YACF,MAAMkB,UAAU,MAAMrE,GAAGyE,QAAQ,CAAC,IAAI,CAAC9B,UAAU,EAAE;YACnD,MAAM+B,aAAaJ,KAAKK,KAAK,CAACN;YAG9B,IAAI,CAACZ,MAAM,GAAG,IAAI,CAACmB,SAAS,CAACzE,gBAAgBuE;YAG7C,IAAI,CAACG,WAAW;YAGhB,IAAI,CAACC,QAAQ,CAAC,IAAI,CAACrB,MAAM;YAEzB,OAAO,IAAI,CAACA,MAAM;QACpB,EAAE,OAAOU,OAAO;YACd,IAAI,AAACA,MAAgCY,IAAI,KAAK,UAAU;gBACtD,MAAM,IAAI5B,YAAY,CAAC,8BAA8B,EAAE,IAAI,CAACR,UAAU,EAAE;YAC1E;YACA,MAAM,IAAIQ,YAAY,CAAC,8BAA8B,EAAE,AAACgB,MAAgBd,OAAO,EAAE;QACnF;IACF;IAKA2B,OAAe;QACb,OAAO,IAAI,CAACrB,SAAS,CAAC,IAAI,CAACF,MAAM;IACnC;IAKAwB,IAAIhF,IAAY,EAAO;QACrB,MAAMiF,OAAOjF,KAAKkF,KAAK,CAAC;QACxB,IAAIC,UAAe,IAAI,CAAC3B,MAAM;QAE9B,KAAK,MAAM4B,OAAOH,KAAM;YACtB,IAAIE,WAAW,OAAOA,YAAY,YAAYC,OAAOD,SAAS;gBAC5DA,UAAUA,OAAO,CAACC,IAAI;YACxB,OAAO;gBACL,OAAOC;YACT;QACF;QAEA,OAAOF;IACT;IAKAG,IAAItF,IAAY,EAAEuF,KAAU,EAAQ;QAClC,MAAMN,OAAOjF,KAAKkF,KAAK,CAAC;QACxB,IAAIC,UAAe,IAAI,CAAC3B,MAAM;QAE9B,IAAK,IAAIgC,IAAI,GAAGA,IAAIP,KAAKQ,MAAM,GAAG,GAAGD,IAAK;YACxC,MAAMJ,MAAMH,IAAI,CAACO,EAAE;YACnB,IAAI,CAAEJ,CAAAA,OAAOD,OAAM,GAAI;gBACrBA,OAAO,CAACC,IAAI,GAAG,CAAC;YAClB;YACAD,UAAUA,OAAO,CAACC,IAAI;QACxB;QAEA,MAAMM,UAAUT,IAAI,CAACA,KAAKQ,MAAM,GAAG,EAAE;QACrCN,OAAO,CAACO,QAAQ,GAAGH;QAGnB,IAAI,CAACV,QAAQ,CAAC,IAAI,CAACrB,MAAM;IAC3B;IAKA,MAAMmC,KAAKjD,UAAmB,EAAiB;QAC7C,MAAMkD,WAAWlD,cAAc,IAAI,CAACA,UAAU;QAC9C,IAAI,CAACkD,UAAU;YACb,MAAM,IAAI1C,YAAY;QACxB;QAEA,MAAMkB,UAAUC,KAAKC,SAAS,CAAC,IAAI,CAACd,MAAM,EAAE,MAAM;QAClD,MAAMzD,GAAGwE,SAAS,CAACqB,UAAUxB,SAAS;IACxC;IAKAS,SAASrB,MAAc,EAAQ;QAE7B,IACEA,OAAOrD,YAAY,CAACC,mBAAmB,GAAG,KAC1CoD,OAAOrD,YAAY,CAACC,mBAAmB,GAAG,KAC1C;YACA,MAAM,IAAI8C,YAAY;QACxB;QACA,IAAIM,OAAOrD,YAAY,CAACE,aAAa,GAAG,KAAKmD,OAAOrD,YAAY,CAACE,aAAa,GAAG,OAAO;YACtF,MAAM,IAAI6C,YAAY;QACxB;QAGA,IAAI,CAAC;YAAC;YAAQ;YAAU;SAAS,CAAC2C,QAAQ,CAACrC,OAAOhD,QAAQ,CAACC,IAAI,GAAG;YAChE,MAAM,IAAIyC,YAAY;QACxB;QACA,IAAIM,OAAOhD,QAAQ,CAACE,QAAQ,GAAG,KAAK8C,OAAOhD,QAAQ,CAACE,QAAQ,GAAG,IAAI;YACjE,MAAM,IAAIwC,YAAY;QACxB;QAGA,IAAI,CAAC;YAAC;YAAU;YAAY;SAAS,CAAC2C,QAAQ,CAACrC,OAAO3C,MAAM,CAACC,OAAO,GAAG;YACrE,MAAM,IAAIoC,YAAY;QACxB;QACA,IAAIM,OAAO3C,MAAM,CAACE,WAAW,GAAG,KAAKyC,OAAO3C,MAAM,CAACE,WAAW,GAAG,OAAO;YACtE,MAAM,IAAImC,YAAY;QACxB;QAGA,IAAIM,OAAOrC,YAAY,CAACC,UAAU,GAAG,KAAKoC,OAAOrC,YAAY,CAACC,UAAU,GAAG,KAAK;YAC9E,MAAM,IAAI8B,YAAY;QACxB;QAGA,IAAI,CAAC;YAAC;YAAS;YAAQ;SAAY,CAAC2C,QAAQ,CAACrC,OAAO/B,GAAG,CAACC,SAAS,GAAG;YAClE,MAAM,IAAIwB,YAAY;QACxB;QACA,IAAIM,OAAO/B,GAAG,CAACE,IAAI,GAAG,KAAK6B,OAAO/B,GAAG,CAACE,IAAI,GAAG,OAAO;YAClD,MAAM,IAAIuB,YAAY;QACxB;QAGA,IAAI,CAAC;YAAC;YAAS;YAAQ;YAAQ;SAAQ,CAAC2C,QAAQ,CAACrC,OAAO3B,OAAO,CAACC,KAAK,GAAG;YACtE,MAAM,IAAIoB,YAAY;QACxB;QACA,IAAI,CAAC;YAAC;YAAQ;SAAO,CAAC2C,QAAQ,CAACrC,OAAO3B,OAAO,CAACE,MAAM,GAAG;YACrD,MAAM,IAAImB,YAAY;QACxB;QACA,IAAI,CAAC;YAAC;YAAW;SAAO,CAAC2C,QAAQ,CAACrC,OAAO3B,OAAO,CAACG,WAAW,GAAG;YAC7D,MAAM,IAAIkB,YAAY;QACxB;QAGA,IAAI,CAAC;YAAC;YAAQ;YAAgB;YAAQ;SAAO,CAAC2C,QAAQ,CAACrC,OAAOvB,QAAQ,CAACE,eAAe,GAAG;YACvF,MAAM,IAAIe,YACR;QAEJ;QACA,IAAIM,OAAOvB,QAAQ,CAACG,SAAS,GAAG,KAAKoB,OAAOvB,QAAQ,CAACG,SAAS,GAAG,KAAK;YACpE,MAAM,IAAIc,YAAY;QACxB;QACA,IAAI,CAAC;YAAC;YAAY;YAAe;SAAW,CAAC2C,QAAQ,CAACrC,OAAOvB,QAAQ,CAACI,eAAe,GAAG;YACtF,MAAM,IAAIa,YACR;QAEJ;QAGA,IAAIM,OAAOb,MAAM,EAAE;YACjB,IAAIa,OAAOb,MAAM,CAACC,KAAK,EAAE;gBACvB,MAAMkD,cAAc;oBAClB;oBACA;oBACA;oBACA;oBACA;oBACA;iBACD;gBACD,IAAI,CAACA,YAAYD,QAAQ,CAACrC,OAAOb,MAAM,CAACC,KAAK,GAAG;oBAC9C,MAAM,IAAIM,YAAY,CAAC,6BAA6B,EAAE4C,YAAYnC,IAAI,CAAC,OAAO;gBAChF;YACF;YACA,IAAIH,OAAOb,MAAM,CAACE,WAAW,KAAKwC,WAAW;gBAC3C,IAAI7B,OAAOb,MAAM,CAACE,WAAW,GAAG,KAAKW,OAAOb,MAAM,CAACE,WAAW,GAAG,GAAG;oBAClE,MAAM,IAAIK,YAAY;gBACxB;YACF;YACA,IAAIM,OAAOb,MAAM,CAACG,SAAS,KAAKuC,WAAW;gBACzC,IAAI7B,OAAOb,MAAM,CAACG,SAAS,GAAG,KAAKU,OAAOb,MAAM,CAACG,SAAS,GAAG,QAAQ;oBACnE,MAAM,IAAII,YAAY;gBACxB;YACF;YACA,IAAIM,OAAOb,MAAM,CAACI,IAAI,KAAKsC,WAAW;gBACpC,IAAI7B,OAAOb,MAAM,CAACI,IAAI,GAAG,KAAKS,OAAOb,MAAM,CAACI,IAAI,GAAG,GAAG;oBACpD,MAAM,IAAIG,YAAY;gBACxB;YACF;QACF;IACF;IAKQ0B,cAAoB;QAE1B,MAAMxC,YAAY2D,QAAQC,GAAG,CAACC,sBAAsB;QACpD,IAAI7D,WAAW;YACb,IAAI,CAACoB,MAAM,CAACrD,YAAY,CAACC,mBAAmB,GAAG8F,SAAS9D,WAAW;QACrE;QAGA,MAAM+D,eAAeJ,QAAQC,GAAG,CAACI,yBAAyB;QAC1D,IAAID,iBAAiB,YAAYA,iBAAiB,YAAYA,iBAAiB,QAAQ;YACrF,IAAI,CAAC3C,MAAM,CAAChD,QAAQ,CAACC,IAAI,GAAG0F;QAC9B;QAGA,MAAME,gBAAgBN,QAAQC,GAAG,CAACM,0BAA0B;QAC5D,IAAID,kBAAkB,YAAYA,kBAAkB,cAAcA,kBAAkB,UAAU;YAC5F,IAAI,CAAC7C,MAAM,CAAC3C,MAAM,CAACC,OAAO,GAAGuF;QAC/B;QAGA,MAAME,eAAeR,QAAQC,GAAG,CAACQ,yBAAyB;QAC1D,IAAID,iBAAiB,WAAWA,iBAAiB,UAAUA,iBAAiB,aAAa;YACvF,IAAI,CAAC/C,MAAM,CAAC/B,GAAG,CAACC,SAAS,GAAG6E;QAC9B;QAEA,MAAME,UAAUV,QAAQC,GAAG,CAACU,oBAAoB;QAChD,IAAID,SAAS;YACX,IAAI,CAACjD,MAAM,CAAC/B,GAAG,CAACE,IAAI,GAAGuE,SAASO,SAAS;QAC3C;QAGA,MAAME,WAAWZ,QAAQC,GAAG,CAACY,qBAAqB;QAClD,IACED,aAAa,WACbA,aAAa,UACbA,aAAa,UACbA,aAAa,SACb;YACA,IAAI,CAACnD,MAAM,CAAC3B,OAAO,CAACC,KAAK,GAAG6E;QAC9B;QAGA,MAAME,kBAAkBd,QAAQC,GAAG,CAACc,6BAA6B;QACjE,IAAID,oBAAoB,UAAUA,oBAAoB,SAAS;YAC7D,IAAI,CAACrD,MAAM,CAACvB,QAAQ,CAACC,OAAO,GAAG2E,oBAAoB;QACrD;QAEA,MAAME,mBAAmBhB,QAAQC,GAAG,CAACgB,8BAA8B;QACnE,IACED,qBAAqB,UACrBA,qBAAqB,kBACrBA,qBAAqB,UACrBA,qBAAqB,QACrB;YACA,IAAI,CAACvD,MAAM,CAACvB,QAAQ,CAACE,eAAe,GAAG4E;QACzC;QAEA,MAAME,oBAAoBlB,QAAQC,GAAG,CAACkB,gCAAgC;QACtE,IAAID,mBAAmB;YACrB,IAAI,CAACzD,MAAM,CAACvB,QAAQ,CAACG,SAAS,GAAG8D,SAASe,mBAAmB;QAC/D;QAGA,IAAI,CAAC,IAAI,CAACzD,MAAM,CAACb,MAAM,EAAE;YACvB,IAAI,CAACa,MAAM,CAACb,MAAM,GAAG,CAAC;QACxB;QAEA,MAAMwE,eAAepB,QAAQC,GAAG,CAACoB,iBAAiB;QAClD,IAAID,cAAc;YAChB,IAAI,CAAC3D,MAAM,CAACb,MAAM,CAAC0E,MAAM,GAAGF;QAC9B;QAEA,MAAMG,cAAcvB,QAAQC,GAAG,CAACuB,YAAY;QAC5C,IAAID,aAAa;YACf,IAAI,CAAC9D,MAAM,CAACb,MAAM,CAACC,KAAK,GAAG0E;QAC7B;QAEA,MAAME,oBAAoBzB,QAAQC,GAAG,CAACyB,kBAAkB;QACxD,IAAID,mBAAmB;YACrB,IAAI,CAAChE,MAAM,CAACb,MAAM,CAACE,WAAW,GAAG6E,WAAWF;QAC9C;QAEA,MAAMG,kBAAkB5B,QAAQC,GAAG,CAAC4B,iBAAiB;QACrD,IAAID,iBAAiB;YACnB,IAAI,CAACnE,MAAM,CAACb,MAAM,CAACG,SAAS,GAAGoD,SAASyB,iBAAiB;QAC3D;QAEA,MAAME,aAAa9B,QAAQC,GAAG,CAAC8B,YAAY;QAC3C,IAAID,YAAY;YACd,IAAI,CAACrE,MAAM,CAACb,MAAM,CAACI,IAAI,GAAG2E,WAAWG;QACvC;QAEA,MAAME,aAAahC,QAAQC,GAAG,CAACgC,YAAY;QAC3C,IAAID,YAAY;YACd,IAAI,CAACvE,MAAM,CAACb,MAAM,CAACsF,IAAI,GAAG/B,SAAS6B,YAAY;QACjD;QAEA,MAAMG,qBAAqBnC,QAAQC,GAAG,CAACmC,oBAAoB;QAC3D,IAAID,oBAAoB;YACtB,IAAI,CAAC1E,MAAM,CAACb,MAAM,CAACyF,YAAY,GAAGF;QACpC;IACF;IAKQxE,UAAa2E,GAAM,EAAK;QAC9B,OAAOhE,KAAKK,KAAK,CAACL,KAAKC,SAAS,CAAC+D;IACnC;IAKAC,oBAAoB;QAClB,OAAO,IAAI,CAAC5E,SAAS,CAAC,IAAI,CAACF,MAAM,CAACvB,QAAQ;IAC5C;IAKAsG,wBAAkC;QAChC,OAAO;YAAC;YAAW;YAAe;YAAc;SAAU;IAC5D;IAKAC,eAAenF,IAAY,EAAEG,MAAW,EAAQ;QAE9CQ,QAAQC,GAAG,CAAC,CAAC,mBAAmB,EAAEZ,MAAM,EAAEG;IAC5C;IAKAiF,mBAAwC;QACtC,OAAO;YACLC,MAAM;gBAAEC,WAAW;gBAASjE,OAAOL,KAAKK,KAAK;gBAAEJ,WAAWD,KAAKC,SAAS;YAAC;YACzEsE,MAAM;gBACJD,WAAW;gBACXjE,OAAO,CAACN,UAAoBA;gBAC5BE,WAAW,CAAC+D,MAAahE,KAAKC,SAAS,CAAC+D;YAC1C;QACF;IACF;IAKAQ,aAAa7I,IAAY,EAAW;QAClC,IAAI;YAEF8I,QAAQ,MAAMC,YAAY,CAAC/I,MAAM;YACjC,OAAO;QACT,EAAE,OAAM;YACN,OAAO;QACT;IACF;IAKAgJ,iBAAwB;QACtB,OAAO,EAAE;IACX;IAKAC,mBAA0B;QACxB,OAAO,EAAE;IACX;IAKA,MAAMC,OAAOlJ,IAAY,EAAiB;QACxC,MAAMmJ,aAAa,GAAGnJ,KAAK,QAAQ,EAAEoJ,KAAKC,GAAG,IAAI;QACjD,MAAMjF,UAAUC,KAAKC,SAAS,CAAC,IAAI,CAACd,MAAM,EAAE,MAAM;QAClD,MAAMzD,GAAGwE,SAAS,CAAC4E,YAAY/E,SAAS;QACxCJ,QAAQC,GAAG,CAAC,CAAC,4BAA4B,EAAEkF,YAAY;IACzD;IAKA,MAAMG,QAAQtJ,IAAY,EAAiB;QACzC,MAAMoE,UAAU,MAAMrE,GAAGyE,QAAQ,CAACxE,MAAM;QACxC,IAAI,CAACwD,MAAM,GAAGa,KAAKK,KAAK,CAACN;QACzBJ,QAAQC,GAAG,CAAC,CAAC,6BAA6B,EAAEjE,MAAM;IACpD;IAKAuJ,kBAAkBC,OAAoC,EAAQ;QAC5D,IAAI,CAAChG,MAAM,CAACvB,QAAQ,GAAG;YAAE,GAAG,IAAI,CAACuB,MAAM,CAACvB,QAAQ;YAAE,GAAGuH,OAAO;QAAC;QAC7D,IAAI,CAAC3E,QAAQ,CAAC,IAAI,CAACrB,MAAM;IAC3B;IAKAiG,oBAA6B;QAC3B,OAAO,IAAI,CAACjG,MAAM,CAACvB,QAAQ,CAACC,OAAO;IACrC;IAKAwH,kBAA4B;QAC1B,MAAMC,OAAiB,EAAE;QACzB,MAAMnG,SAAS,IAAI,CAACA,MAAM,CAACvB,QAAQ;QAEnC,IAAI,CAACuB,OAAOtB,OAAO,EAAE;YACnB,OAAOyH;QACT;QAEAA,KAAKC,IAAI,CAAC,cAAcpG,OAAOrB,eAAe;QAC9CwH,KAAKC,IAAI,CAAC,gBAAgBC,OAAOrG,OAAOpB,SAAS;QACjDuH,KAAKC,IAAI,CAAC,cAAcpG,OAAOnB,eAAe;QAE9C,IAAImB,OAAOjB,WAAW,EAAE;YACtBoH,KAAKC,IAAI,CAAC;QACZ;QAEA,IAAIpG,OAAOhB,iBAAiB,EAAE;YAC5BmH,KAAKC,IAAI,CAAC;QACZ;QAEA,IAAIpG,OAAOf,oBAAoB,EAAE;YAC/BkH,KAAKC,IAAI,CAAC;QACZ;QAEA,IAAIpG,OAAOd,UAAU,EAAE;YACrBiH,KAAKC,IAAI,CAAC,iBAAiBpG,OAAOd,UAAU;QAC9C;QAEA,OAAOiH;IACT;IAKAG,kBAAkB;QAChB,OAAO,IAAI,CAACpG,SAAS,CAAC,IAAI,CAACF,MAAM,CAACb,MAAM,IAAI,CAAC;IAC/C;IAKAoH,gBAAgBP,OAAkC,EAAQ;QACxD,IAAI,CAAC,IAAI,CAAChG,MAAM,CAACb,MAAM,EAAE;YACvB,IAAI,CAACa,MAAM,CAACb,MAAM,GAAG,CAAC;QACxB;QACA,IAAI,CAACa,MAAM,CAACb,MAAM,GAAG;YAAE,GAAG,IAAI,CAACa,MAAM,CAACb,MAAM;YAAE,GAAG6G,OAAO;QAAC;QACzD,IAAI,CAAC3E,QAAQ,CAAC,IAAI,CAACrB,MAAM;IAC3B;IAKAwG,wBAAiC;QAC/B,OAAO,CAAC,CAAE,CAAA,IAAI,CAACxG,MAAM,CAACb,MAAM,EAAE0E,UAAUtB,QAAQC,GAAG,CAACoB,iBAAiB,AAAD;IACtE;IAKQzC,UAAUsF,MAAc,EAAEC,MAAuB,EAAU;QACjE,MAAMC,SAAS,IAAI,CAACzG,SAAS,CAACuG;QAE9B,IAAIC,OAAO/J,YAAY,EAAE;YACvBgK,OAAOhK,YAAY,GAAG;gBAAE,GAAGgK,OAAOhK,YAAY;gBAAE,GAAG+J,OAAO/J,YAAY;YAAC;QACzE;QACA,IAAI+J,OAAO1J,QAAQ,EAAE;YACnB2J,OAAO3J,QAAQ,GAAG;gBAAE,GAAG2J,OAAO3J,QAAQ;gBAAE,GAAG0J,OAAO1J,QAAQ;YAAC;QAC7D;QACA,IAAI0J,OAAOrJ,MAAM,EAAE;YACjBsJ,OAAOtJ,MAAM,GAAG;gBAAE,GAAGsJ,OAAOtJ,MAAM;gBAAE,GAAGqJ,OAAOrJ,MAAM;YAAC;QACvD;QACA,IAAIqJ,OAAO/I,YAAY,EAAE;YACvBgJ,OAAOhJ,YAAY,GAAG;gBAAE,GAAGgJ,OAAOhJ,YAAY;gBAAE,GAAG+I,OAAO/I,YAAY;YAAC;QACzE;QACA,IAAI+I,OAAOzI,GAAG,EAAE;YACd0I,OAAO1I,GAAG,GAAG;gBAAE,GAAG0I,OAAO1I,GAAG;gBAAE,GAAGyI,OAAOzI,GAAG;YAAC;QAC9C;QACA,IAAIyI,OAAOrI,OAAO,EAAE;YAClBsI,OAAOtI,OAAO,GAAG;gBAAE,GAAGsI,OAAOtI,OAAO;gBAAE,GAAGqI,OAAOrI,OAAO;YAAC;QAC1D;QACA,IAAIqI,OAAOjI,QAAQ,EAAE;YACnBkI,OAAOlI,QAAQ,GAAG;gBAAE,GAAGkI,OAAOlI,QAAQ;gBAAE,GAAGiI,OAAOjI,QAAQ;YAAC;QAC7D;QACA,IAAIiI,OAAOvH,MAAM,EAAE;YACjBwH,OAAOxH,MAAM,GAAG;gBAAE,GAAGwH,OAAOxH,MAAM;gBAAE,GAAGuH,OAAOvH,MAAM;YAAC;QACvD;QAEA,OAAOwH;IACT;AACF;AAGA,OAAO,MAAMC,gBAAgB9G,cAAcO,WAAW,GAAG"}