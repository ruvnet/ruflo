{"version":3,"sources":["../../../src/cli/repl.ts"],"sourcesContent":["import { promises as fs } from 'node:fs';\r\n/**\r\n * Enhanced Interactive REPL for Claude-Flow\r\n */\r\n\r\nimport inquirer from 'inquirer';\r\nimport chalk from 'chalk';\r\nimport Table from 'cli-table3';\r\nimport type { AgentProfile, Task } from '../utils/types.js';\r\nimport { generateId } from '../utils/helpers.js';\r\nimport { formatStatusIndicator, formatDuration, formatProgressBar } from './formatter.js';\r\n\r\ninterface REPLCommand {\r\n  name: string;\r\n  aliases?: string[];\r\n  description: string;\r\n  usage?: string;\r\n  examples?: string[];\r\n  handler: (args: string[], context: REPLContext) => Promise<void>;\r\n}\r\n\r\ninterface REPLContext {\r\n  options: any;\r\n  history: string[];\r\n  workingDirectory: string;\r\n  currentSession?: string;\r\n  connectionStatus: 'connected' | 'disconnected' | 'connecting';\r\n  lastActivity: Date;\r\n}\r\n\r\nclass CommandHistory {\r\n  private history: string[] = [];\r\n  private maxSize = 1000;\r\n  private historyFile: string;\r\n\r\n  constructor(historyFile?: string) {\r\n    this.historyFile = historyFile || '.claude-flow-history';\r\n    this.loadHistory();\r\n  }\r\n\r\n  add(command: string): void {\r\n    if (command.trim() && command !== this.history[this.history.length - 1]) {\r\n      this.history.push(command);\r\n      if (this.history.length > this.maxSize) {\r\n        this.history = this.history.slice(-this.maxSize);\r\n      }\r\n      this.saveHistory();\r\n    }\r\n  }\r\n\r\n  get(): string[] {\r\n    return [...this.history];\r\n  }\r\n\r\n  search(query: string): string[] {\r\n    return this.history.filter((cmd) => cmd.includes(query));\r\n  }\r\n\r\n  private async loadHistory(): Promise<void> {\r\n    try {\r\n      const content = await fs.readFile(this.historyFile, 'utf-8');\r\n      this.history = content.split('\\n').filter((line: string) => line.trim());\r\n    } catch {\r\n      // History file doesn't exist yet\r\n    }\r\n  }\r\n\r\n  private async saveHistory(): Promise<void> {\r\n    try {\r\n      await fs.writeFile(this.historyFile, this.history.join('\\n'));\r\n    } catch {\r\n      // Ignore save errors\r\n    }\r\n  }\r\n}\r\n\r\nclass CommandCompleter {\r\n  private commands: Map<string, REPLCommand> = new Map();\r\n\r\n  setCommands(commands: REPLCommand[]): void {\r\n    this.commands.clear();\r\n    for (const cmd of commands) {\r\n      this.commands.set(cmd.name, cmd);\r\n      if (cmd.aliases) {\r\n        for (const alias of cmd.aliases) {\r\n          this.commands.set(alias, cmd);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  complete(input: string): string[] {\r\n    const parts = input.trim().split(/\\s+/);\r\n\r\n    if (parts.length === 1) {\r\n      // Complete command names\r\n      const prefix = parts[0];\r\n      return Array.from(this.commands.keys())\r\n        .filter((name) => name.startsWith(prefix))\r\n        .sort();\r\n    }\r\n\r\n    // Complete subcommands and arguments\r\n    const commandName = parts[0];\r\n    const command = this.commands.get(commandName);\r\n\r\n    if (command) {\r\n      return this.completeForCommand(command, parts.slice(1));\r\n    }\r\n\r\n    return [];\r\n  }\r\n\r\n  private completeForCommand(command: REPLCommand, args: string[]): string[] {\r\n    // Basic completion for known commands\r\n    switch (command.name) {\r\n      case 'agent':\r\n        if (args.length === 1) {\r\n          return ['spawn', 'list', 'terminate', 'info'].filter((sub) => sub.startsWith(args[0]));\r\n        }\r\n        if (args[0] === 'spawn' && args.length === 2) {\r\n          return ['coordinator', 'researcher', 'implementer', 'analyst', 'custom'].filter((type) =>\r\n            type.startsWith(args[1]),\r\n          );\r\n        }\r\n        break;\r\n\r\n      case 'task':\r\n        if (args.length === 1) {\r\n          return ['create', 'list', 'status', 'cancel', 'workflow'].filter((sub) =>\r\n            sub.startsWith(args[0]),\r\n          );\r\n        }\r\n        if (args[0] === 'create' && args.length === 2) {\r\n          return ['research', 'implementation', 'analysis', 'coordination'].filter((type) =>\r\n            type.startsWith(args[1]),\r\n          );\r\n        }\r\n        break;\r\n\r\n      case 'session':\r\n        if (args.length === 1) {\r\n          return ['list', 'save', 'restore', 'delete', 'export', 'import'].filter((sub) =>\r\n            sub.startsWith(args[0]),\r\n          );\r\n        }\r\n        break;\r\n\r\n      case 'workflow':\r\n        if (args.length === 1) {\r\n          return ['run', 'validate', 'list', 'status', 'stop', 'template'].filter((sub) =>\r\n            sub.startsWith(args[0]),\r\n          );\r\n        }\r\n        break;\r\n    }\r\n\r\n    return [];\r\n  }\r\n}\r\n\r\n/**\r\n * Start the enhanced interactive REPL\r\n */\r\nexport async function startREPL(options: any = {}): Promise<void> {\r\n  const context: REPLContext = {\r\n    options,\r\n    history: [],\r\n    workingDirectory: process.cwd(),\r\n    connectionStatus: 'disconnected',\r\n    lastActivity: new Date(),\r\n  };\r\n\r\n  const history = new CommandHistory(options.historyFile);\r\n  const completer = new CommandCompleter();\r\n\r\n  const commands: REPLCommand[] = [\r\n    {\r\n      name: 'help',\r\n      aliases: ['h', '?'],\r\n      description: 'Show available commands or help for a specific command',\r\n      usage: 'help [command]',\r\n      examples: ['help', 'help agent', 'help task create'],\r\n      handler: async (args) => {\r\n        if (args.length === 0) {\r\n          showHelp(commands);\r\n        } else {\r\n          showCommandHelp(commands, args[0]);\r\n        }\r\n      },\r\n    },\r\n    {\r\n      name: 'status',\r\n      aliases: ['st'],\r\n      description: 'Show system status and connection info',\r\n      usage: 'status [component]',\r\n      examples: ['status', 'status orchestrator'],\r\n      handler: async (args, ctx) => {\r\n        await showSystemStatus(ctx, args[0]);\r\n      },\r\n    },\r\n    {\r\n      name: 'connect',\r\n      aliases: ['conn'],\r\n      description: 'Connect to Claude-Flow orchestrator',\r\n      usage: 'connect [host:port]',\r\n      examples: ['connect', 'connect localhost:3000'],\r\n      handler: async (args, ctx) => {\r\n        await connectToOrchestrator(ctx, args[0]);\r\n      },\r\n    },\r\n    {\r\n      name: 'agent',\r\n      description: 'Agent management (spawn, list, terminate, info)',\r\n      usage: 'agent <subcommand> [options]',\r\n      examples: [\r\n        'agent list',\r\n        'agent spawn researcher --name \"Research Agent\"',\r\n        'agent info agent-001',\r\n        'agent terminate agent-001',\r\n      ],\r\n      handler: async (args, ctx) => {\r\n        await handleAgentCommand(args, ctx);\r\n      },\r\n    },\r\n    {\r\n      name: 'task',\r\n      description: 'Task management (create, list, status, cancel)',\r\n      usage: 'task <subcommand> [options]',\r\n      examples: [\r\n        'task list',\r\n        'task create research \"Find quantum computing papers\"',\r\n        'task status task-001',\r\n        'task cancel task-001',\r\n      ],\r\n      handler: async (args, ctx) => {\r\n        await handleTaskCommand(args, ctx);\r\n      },\r\n    },\r\n    {\r\n      name: 'memory',\r\n      description: 'Memory operations (query, stats, export)',\r\n      usage: 'memory <subcommand> [options]',\r\n      examples: ['memory stats', 'memory query --agent agent-001', 'memory export memory.json'],\r\n      handler: async (args, ctx) => {\r\n        await handleMemoryCommand(args, ctx);\r\n      },\r\n    },\r\n    {\r\n      name: 'session',\r\n      description: 'Session management (save, restore, list)',\r\n      usage: 'session <subcommand> [options]',\r\n      examples: [\r\n        'session list',\r\n        'session save \"Development Session\"',\r\n        'session restore session-001',\r\n      ],\r\n      handler: async (args, ctx) => {\r\n        await handleSessionCommand(args, ctx);\r\n      },\r\n    },\r\n    {\r\n      name: 'workflow',\r\n      description: 'Workflow operations (run, list, status)',\r\n      usage: 'workflow <subcommand> [options]',\r\n      examples: ['workflow list', 'workflow run workflow.json', 'workflow status workflow-001'],\r\n      handler: async (args, ctx) => {\r\n        await handleWorkflowCommand(args, ctx);\r\n      },\r\n    },\r\n    {\r\n      name: 'monitor',\r\n      aliases: ['mon'],\r\n      description: 'Start monitoring mode',\r\n      usage: 'monitor [--interval seconds]',\r\n      examples: ['monitor', 'monitor --interval 5'],\r\n      handler: async (args) => {\r\n        console.log(chalk.cyan('Starting monitor mode...'));\r\n        console.log(chalk.gray('(This would start the live dashboard)'));\r\n      },\r\n    },\r\n    {\r\n      name: 'history',\r\n      aliases: ['hist'],\r\n      description: 'Show command history',\r\n      usage: 'history [--search query]',\r\n      examples: ['history', 'history --search agent'],\r\n      handler: async (args) => {\r\n        const searchQuery =\r\n          args.indexOf('--search') >= 0 ? args[args.indexOf('--search') + 1] : null;\r\n        const historyItems = searchQuery ? history.search(searchQuery) : history.get();\r\n\r\n        console.log(\r\n          chalk.cyan.bold(`Command History${searchQuery ? ` (search: ${searchQuery})` : ''}`),\r\n        );\r\n        console.log('─'.repeat(50));\r\n\r\n        if (historyItems.length === 0) {\r\n          console.log(chalk.gray('No commands in history'));\r\n          return;\r\n        }\r\n\r\n        const recent = historyItems.slice(-20); // Show last 20\r\n        recent.forEach((cmd, i) => {\r\n          const lineNumber = historyItems.length - recent.length + i + 1;\r\n          console.log(`${chalk.gray(lineNumber.toString().padStart(3))} ${cmd}`);\r\n        });\r\n      },\r\n    },\r\n    {\r\n      name: 'clear',\r\n      aliases: ['cls'],\r\n      description: 'Clear the screen',\r\n      handler: async () => {\r\n        console.clear();\r\n      },\r\n    },\r\n    {\r\n      name: 'cd',\r\n      description: 'Change working directory',\r\n      usage: 'cd <directory>',\r\n      examples: ['cd /path/to/project', 'cd ..'],\r\n      handler: async (args, ctx) => {\r\n        if (args.length === 0) {\r\n          console.log(ctx.workingDirectory);\r\n          return;\r\n        }\r\n\r\n        try {\r\n          const newDir = args[0] === '~' ? process.env['HOME'] || '/' : args[0];\r\n          process.chdir(newDir);\r\n          ctx.workingDirectory = process.cwd();\r\n          console.log(chalk.gray(`Changed to: ${ctx.workingDirectory}`));\r\n        } catch (error) {\r\n          console.error(\r\n            chalk.red('Error:'),\r\n            error instanceof Error ? error.message : String(error),\r\n          );\r\n        }\r\n      },\r\n    },\r\n    {\r\n      name: 'pwd',\r\n      description: 'Print working directory',\r\n      handler: async (_, ctx) => {\r\n        console.log(ctx.workingDirectory);\r\n      },\r\n    },\r\n    {\r\n      name: 'echo',\r\n      description: 'Echo arguments',\r\n      usage: 'echo <text>',\r\n      examples: ['echo \"Hello, world!\"'],\r\n      handler: async (args) => {\r\n        console.log(args.join(' '));\r\n      },\r\n    },\r\n    {\r\n      name: 'exit',\r\n      aliases: ['quit', 'q'],\r\n      description: 'Exit the REPL',\r\n      handler: async () => {\r\n        console.log(chalk.gray('Goodbye!'));\r\n        process.exit(0);\r\n      },\r\n    },\r\n  ];\r\n\r\n  // Set up command completion\r\n  completer.setCommands(commands);\r\n\r\n  // Show initial status\r\n  if (!options.quiet) {\r\n    await showSystemStatus(context);\r\n    console.log(chalk.gray('Type \"help\" for available commands or \"exit\" to quit.\\n'));\r\n  }\r\n\r\n  // Main REPL loop\r\n  while (true) {\r\n    try {\r\n      const promptString = createPrompt(context);\r\n      const { input } = await inquirer.prompt([\r\n        {\r\n          type: 'input',\r\n          name: 'input',\r\n          message: promptString,\r\n          transformer: (input: string) => input,\r\n        },\r\n      ]);\r\n\r\n      if (!input.trim()) {\r\n        continue;\r\n      }\r\n\r\n      // Add to history\r\n      history.add(input);\r\n      context.history.push(input);\r\n      context.lastActivity = new Date();\r\n\r\n      // Parse command\r\n      const args = parseCommand(input);\r\n      const [commandName, ...commandArgs] = args;\r\n\r\n      // Find and execute command\r\n      const command = commands.find(\r\n        (c) => c.name === commandName || (c.aliases && c.aliases.includes(commandName)),\r\n      );\r\n\r\n      if (command) {\r\n        try {\r\n          await command.handler(commandArgs, context);\r\n        } catch (error) {\r\n          console.error(\r\n            chalk.red('Command failed:'),\r\n            error instanceof Error ? error.message : String(error),\r\n          );\r\n        }\r\n      } else {\r\n        console.log(chalk.red(`Unknown command: ${commandName}`));\r\n        console.log(chalk.gray('Type \"help\" for available commands'));\r\n\r\n        // Suggest similar commands\r\n        const suggestions = findSimilarCommands(commandName, commands);\r\n        if (suggestions.length > 0) {\r\n          console.log(\r\n            chalk.gray('Did you mean:'),\r\n            suggestions.map((s) => chalk.cyan(s)).join(', '),\r\n          );\r\n        }\r\n      }\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : String(error);\r\n      if (errorMessage.includes('EOF') || errorMessage.includes('interrupted')) {\r\n        // Ctrl+D or Ctrl+C pressed\r\n        console.log('\\n' + chalk.gray('Goodbye!'));\r\n        break;\r\n      }\r\n      console.error(chalk.red('REPL Error:'), errorMessage);\r\n    }\r\n  }\r\n}\r\n\r\nfunction createPrompt(context: REPLContext): string {\r\n  const statusIcon = getConnectionStatusIcon(context.connectionStatus);\r\n  const dir = context.workingDirectory.split('/').pop() || '/';\r\n\r\n  return `${statusIcon} ${chalk.cyan('claude-flow')}:${chalk.yellow(dir)}${chalk.white('>')} `;\r\n}\r\n\r\nfunction getConnectionStatusIcon(status: string): string {\r\n  switch (status) {\r\n    case 'connected':\r\n      return chalk.green('●');\r\n    case 'connecting':\r\n      return chalk.yellow('◐');\r\n    case 'disconnected':\r\n      return chalk.red('○');\r\n    default:\r\n      return chalk.gray('?');\r\n  }\r\n}\r\n\r\nfunction parseCommand(input: string): string[] {\r\n  // Simple command parsing - handle quoted strings\r\n  const args: string[] = [];\r\n  let current = '';\r\n  let inQuotes = false;\r\n  let quoteChar = '';\r\n\r\n  for (let i = 0; i < input.length; i++) {\r\n    const char = input[i];\r\n\r\n    if (inQuotes) {\r\n      if (char === quoteChar) {\r\n        inQuotes = false;\r\n        quoteChar = '';\r\n      } else {\r\n        current += char;\r\n      }\r\n    } else {\r\n      if (char === '\"' || char === \"'\") {\r\n        inQuotes = true;\r\n        quoteChar = char;\r\n      } else if (char === ' ' || char === '\\t') {\r\n        if (current.trim()) {\r\n          args.push(current.trim());\r\n          current = '';\r\n        }\r\n      } else {\r\n        current += char;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (current.trim()) {\r\n    args.push(current.trim());\r\n  }\r\n\r\n  return args;\r\n}\r\n\r\nfunction showHelp(commands: REPLCommand[]): void {\r\n  console.log(chalk.cyan.bold('Claude-Flow Interactive REPL'));\r\n  console.log('─'.repeat(50));\r\n  console.log();\r\n\r\n  console.log(chalk.white.bold('Available Commands:'));\r\n  console.log();\r\n\r\n  const table = new Table({\r\n    head: ['Command', 'Aliases', 'Description'],\r\n    style: { 'padding-left': 0, 'padding-right': 1, border: [] },\r\n  });\r\n\r\n  for (const cmd of commands) {\r\n    table.push([\r\n      chalk.cyan(cmd.name),\r\n      cmd.aliases ? chalk.gray(cmd.aliases.join(', ')) : '',\r\n      cmd.description,\r\n    ]);\r\n  }\r\n\r\n  console.log(table.toString());\r\n  console.log();\r\n\r\n  console.log(chalk.gray('Tips:'));\r\n  console.log(chalk.gray('• Use TAB for command completion'));\r\n  console.log(chalk.gray('• Use \"help <command>\" for detailed help'));\r\n  console.log(chalk.gray('• Use UP/DOWN arrows for command history'));\r\n  console.log(chalk.gray('• Use Ctrl+C or \"exit\" to quit'));\r\n}\r\n\r\nfunction showCommandHelp(commands: REPLCommand[], commandName: string): void {\r\n  const command = commands.find(\r\n    (c) => c.name === commandName || (c.aliases && c.aliases.includes(commandName)),\r\n  );\r\n\r\n  if (!command) {\r\n    console.log(chalk.red(`Unknown command: ${commandName}`));\r\n    return;\r\n  }\r\n\r\n  console.log(chalk.cyan.bold(`Command: ${command.name}`));\r\n  console.log('─'.repeat(30));\r\n  console.log(`${chalk.white('Description:')} ${command.description}`);\r\n\r\n  if (command.aliases) {\r\n    console.log(`${chalk.white('Aliases:')} ${command.aliases.join(', ')}`);\r\n  }\r\n\r\n  if (command.usage) {\r\n    console.log(`${chalk.white('Usage:')} ${command.usage}`);\r\n  }\r\n\r\n  if (command.examples) {\r\n    console.log();\r\n    console.log(chalk.white.bold('Examples:'));\r\n    for (const example of command.examples) {\r\n      console.log(`  ${chalk.gray('$')} ${chalk.cyan(example)}`);\r\n    }\r\n  }\r\n}\r\n\r\nasync function showSystemStatus(context: REPLContext, component?: string): Promise<void> {\r\n  console.log(chalk.cyan.bold('System Status'));\r\n  console.log('─'.repeat(30));\r\n\r\n  const statusIcon = formatStatusIndicator(\r\n    context.connectionStatus === 'connected' ? 'success' : 'error',\r\n  );\r\n  console.log(`${statusIcon} Connection: ${context.connectionStatus}`);\r\n  console.log(`${chalk.white('Working Directory:')} ${context.workingDirectory}`);\r\n  console.log(`${chalk.white('Last Activity:')} ${context.lastActivity.toLocaleTimeString()}`);\r\n\r\n  if (context.currentSession) {\r\n    console.log(`${chalk.white('Current Session:')} ${context.currentSession}`);\r\n  }\r\n\r\n  console.log(`${chalk.white('Commands in History:')} ${context.history.length}`);\r\n\r\n  if (context.connectionStatus === 'disconnected') {\r\n    console.log();\r\n    console.log(chalk.yellow('⚠ Not connected to orchestrator'));\r\n    console.log(chalk.gray('Use \"connect\" command to establish connection'));\r\n  }\r\n}\r\n\r\nasync function connectToOrchestrator(context: REPLContext, target?: string): Promise<void> {\r\n  const host = target || 'localhost:3000';\r\n\r\n  console.log(chalk.yellow(`Connecting to ${host}...`));\r\n  context.connectionStatus = 'connecting';\r\n\r\n  // Mock connection attempt\r\n  await new Promise((resolve) => setTimeout(resolve, 1000));\r\n\r\n  // Simulate connection result\r\n  const success = Math.random() > 0.3; // 70% success rate\r\n\r\n  if (success) {\r\n    context.connectionStatus = 'connected';\r\n    console.log(chalk.green('✓ Connected successfully'));\r\n  } else {\r\n    context.connectionStatus = 'disconnected';\r\n    console.log(chalk.red('✗ Connection failed'));\r\n    console.log(chalk.gray('Make sure Claude-Flow is running with: claude-flow start'));\r\n  }\r\n}\r\n\r\nasync function handleAgentCommand(args: string[], context: REPLContext): Promise<void> {\r\n  if (context.connectionStatus !== 'connected') {\r\n    console.log(chalk.yellow('⚠ Not connected to orchestrator'));\r\n    console.log(chalk.gray('Use \"connect\" to establish connection first'));\r\n    return;\r\n  }\r\n\r\n  if (args.length === 0) {\r\n    console.log(chalk.gray('Usage: agent <spawn|list|terminate|info> [options]'));\r\n    return;\r\n  }\r\n\r\n  const subcommand = args[0];\r\n  switch (subcommand) {\r\n    case 'list':\r\n      await showAgentList();\r\n      break;\r\n    case 'spawn':\r\n      await handleAgentSpawn(args.slice(1));\r\n      break;\r\n    case 'terminate':\r\n      if (args.length < 2) {\r\n        console.log(chalk.red('Please specify agent ID'));\r\n      } else {\r\n        await handleAgentTerminate(args[1]);\r\n      }\r\n      break;\r\n    case 'info':\r\n      if (args.length < 2) {\r\n        console.log(chalk.red('Please specify agent ID'));\r\n      } else {\r\n        await showAgentInfo(args[1]);\r\n      }\r\n      break;\r\n    default:\r\n      console.log(chalk.red(`Unknown agent subcommand: ${subcommand}`));\r\n  }\r\n}\r\n\r\nasync function showAgentList(): Promise<void> {\r\n  // Mock agent data\r\n  const agents = [\r\n    { id: 'agent-001', name: 'Coordinator', type: 'coordinator', status: 'active', tasks: 2 },\r\n    { id: 'agent-002', name: 'Researcher', type: 'researcher', status: 'active', tasks: 5 },\r\n    { id: 'agent-003', name: 'Implementer', type: 'implementer', status: 'idle', tasks: 0 },\r\n  ];\r\n\r\n  console.log(chalk.cyan.bold(`Active Agents (${agents.length})`));\r\n  console.log('─'.repeat(50));\r\n\r\n  const table = new Table({\r\n    head: ['ID', 'Name', 'Type', 'Status', 'Tasks'],\r\n  });\r\n\r\n  for (const agent of agents) {\r\n    const statusIcon = formatStatusIndicator(agent.status);\r\n\r\n    table.push([\r\n      chalk.gray(agent.id),\r\n      chalk.white(agent.name),\r\n      chalk.cyan(agent.type),\r\n      `${statusIcon} ${agent.status}`,\r\n      agent.tasks.toString(),\r\n    ]);\r\n  }\r\n\r\n  console.log(table.toString());\r\n}\r\n\r\nasync function handleAgentSpawn(args: string[]): Promise<void> {\r\n  if (args.length === 0) {\r\n    console.log(chalk.gray('Usage: agent spawn <type> [name]'));\r\n    console.log(chalk.gray('Types: coordinator, researcher, implementer, analyst, custom'));\r\n    return;\r\n  }\r\n\r\n  const type = args[0];\r\n  const name =\r\n    args[1] ||\r\n    (await inquirer.prompt([\r\n      {\r\n        type: 'input',\r\n        name: 'name',\r\n        message: 'Agent name:',\r\n        default: `${type}-agent`,\r\n      },\r\n    ])).name;\r\n\r\n  console.log(chalk.yellow('Spawning agent...'));\r\n\r\n  // Mock spawning\r\n  await new Promise((resolve) => setTimeout(resolve, 1000));\r\n\r\n  const agentId = generateId('agent');\r\n  console.log(chalk.green('✓ Agent spawned successfully'));\r\n  console.log(`${chalk.white('ID:')} ${agentId}`);\r\n  console.log(`${chalk.white('Name:')} ${name}`);\r\n  console.log(`${chalk.white('Type:')} ${type}`);\r\n}\r\n\r\nasync function handleAgentTerminate(agentId: string): Promise<void> {\r\n  const { confirmed } = await inquirer.prompt([\r\n    {\r\n      type: 'confirm',\r\n      name: 'confirmed',\r\n      message: `Terminate agent ${agentId}?`,\r\n      default: false,\r\n    },\r\n  ]);\r\n\r\n  if (!confirmed) {\r\n    console.log(chalk.gray('Termination cancelled'));\r\n    return;\r\n  }\r\n\r\n  console.log(chalk.yellow('Terminating agent...'));\r\n  await new Promise((resolve) => setTimeout(resolve, 500));\r\n  console.log(chalk.green('✓ Agent terminated'));\r\n}\r\n\r\nasync function showAgentInfo(agentId: string): Promise<void> {\r\n  // Mock agent info\r\n  console.log(chalk.cyan.bold('Agent Information'));\r\n  console.log('─'.repeat(30));\r\n  console.log(`${chalk.white('ID:')} ${agentId}`);\r\n  console.log(`${chalk.white('Name:')} Research Agent`);\r\n  console.log(`${chalk.white('Type:')} researcher`);\r\n  console.log(`${chalk.white('Status:')} ${formatStatusIndicator('success')} active`);\r\n  console.log(`${chalk.white('Uptime:')} ${formatDuration(3600000)}`);\r\n  console.log(`${chalk.white('Active Tasks:')} 3`);\r\n  console.log(`${chalk.white('Completed Tasks:')} 12`);\r\n}\r\n\r\nasync function handleTaskCommand(args: string[], context: REPLContext): Promise<void> {\r\n  if (context.connectionStatus !== 'connected') {\r\n    console.log(chalk.yellow('⚠ Not connected to orchestrator'));\r\n    return;\r\n  }\r\n\r\n  if (args.length === 0) {\r\n    console.log(chalk.gray('Usage: task <create|list|status|cancel> [options]'));\r\n    return;\r\n  }\r\n\r\n  const subcommand = args[0];\r\n  switch (subcommand) {\r\n    case 'list':\r\n      await showTaskList();\r\n      break;\r\n    case 'create':\r\n      await handleTaskCreate(args.slice(1));\r\n      break;\r\n    case 'status':\r\n      if (args.length < 2) {\r\n        console.log(chalk.red('Please specify task ID'));\r\n      } else {\r\n        await showTaskStatus(args[1]);\r\n      }\r\n      break;\r\n    case 'cancel':\r\n      if (args.length < 2) {\r\n        console.log(chalk.red('Please specify task ID'));\r\n      } else {\r\n        await handleTaskCancel(args[1]);\r\n      }\r\n      break;\r\n    default:\r\n      console.log(chalk.red(`Unknown task subcommand: ${subcommand}`));\r\n  }\r\n}\r\n\r\nasync function showTaskList(): Promise<void> {\r\n  // Mock task data\r\n  const tasks = [\r\n    {\r\n      id: 'task-001',\r\n      type: 'research',\r\n      description: 'Research quantum computing',\r\n      status: 'running',\r\n      agent: 'agent-002',\r\n    },\r\n    {\r\n      id: 'task-002',\r\n      type: 'analysis',\r\n      description: 'Analyze research results',\r\n      status: 'pending',\r\n      agent: null,\r\n    },\r\n    {\r\n      id: 'task-003',\r\n      type: 'implementation',\r\n      description: 'Implement solution',\r\n      status: 'completed',\r\n      agent: 'agent-003',\r\n    },\r\n  ];\r\n\r\n  console.log(chalk.cyan.bold(`Tasks (${tasks.length})`));\r\n  console.log('─'.repeat(60));\r\n\r\n  const table = new Table({\r\n    head: ['ID', 'Type', 'Description', 'Status', 'Agent'],\r\n  });\r\n\r\n  for (const task of tasks) {\r\n    const statusIcon = formatStatusIndicator(task.status);\r\n\r\n    table.push([\r\n      chalk.gray(task.id),\r\n      chalk.white(task.type),\r\n      task.description.substring(0, 30) + (task.description.length > 30 ? '...' : ''),\r\n      `${statusIcon} ${task.status}`,\r\n      task.agent ? chalk.cyan(task.agent) : '-',\r\n    ]);\r\n  }\r\n\r\n  console.log(table.toString());\r\n}\r\n\r\nasync function handleTaskCreate(args: string[]): Promise<void> {\r\n  if (args.length < 2) {\r\n    console.log(chalk.gray('Usage: task create <type> <description>'));\r\n    return;\r\n  }\r\n\r\n  const type = args[0];\r\n  const description = args.slice(1).join(' ');\r\n\r\n  console.log(chalk.yellow('Creating task...'));\r\n  await new Promise((resolve) => setTimeout(resolve, 500));\r\n\r\n  const taskId = generateId('task');\r\n  console.log(chalk.green('✓ Task created successfully'));\r\n  console.log(`${chalk.white('ID:')} ${taskId}`);\r\n  console.log(`${chalk.white('Type:')} ${type}`);\r\n  console.log(`${chalk.white('Description:')} ${description}`);\r\n}\r\n\r\nasync function showTaskStatus(taskId: string): Promise<void> {\r\n  console.log(chalk.cyan.bold('Task Status'));\r\n  console.log('─'.repeat(30));\r\n  console.log(`${chalk.white('ID:')} ${taskId}`);\r\n  console.log(`${chalk.white('Type:')} research`);\r\n  console.log(`${chalk.white('Status:')} ${formatStatusIndicator('running')} running`);\r\n  console.log(`${chalk.white('Progress:')} ${formatProgressBar(65, 100, 20)} 65%`);\r\n  console.log(`${chalk.white('Agent:')} agent-002`);\r\n  console.log(`${chalk.white('Started:')} ${new Date().toLocaleTimeString()}`);\r\n}\r\n\r\nasync function handleTaskCancel(taskId: string): Promise<void> {\r\n  const { confirmed } = await inquirer.prompt([\r\n    {\r\n      type: 'confirm',\r\n      name: 'confirmed',\r\n      message: `Cancel task ${taskId}?`,\r\n      default: false,\r\n    },\r\n  ]);\r\n\r\n  if (!confirmed) {\r\n    console.log(chalk.gray('Cancellation cancelled'));\r\n    return;\r\n  }\r\n\r\n  console.log(chalk.yellow('Cancelling task...'));\r\n  await new Promise((resolve) => setTimeout(resolve, 500));\r\n  console.log(chalk.green('✓ Task cancelled'));\r\n}\r\n\r\nasync function handleMemoryCommand(args: string[], context: REPLContext): Promise<void> {\r\n  if (context.connectionStatus !== 'connected') {\r\n    console.log(chalk.yellow('⚠ Not connected to orchestrator'));\r\n    return;\r\n  }\r\n\r\n  if (args.length === 0) {\r\n    console.log(chalk.gray('Usage: memory <query|stats|export> [options]'));\r\n    return;\r\n  }\r\n\r\n  const subcommand = args[0];\r\n  switch (subcommand) {\r\n    case 'stats':\r\n      await showMemoryStats();\r\n      break;\r\n    case 'query':\r\n      console.log(chalk.yellow('Memory query functionality not yet implemented in REPL'));\r\n      break;\r\n    case 'export':\r\n      console.log(chalk.yellow('Memory export functionality not yet implemented in REPL'));\r\n      break;\r\n    default:\r\n      console.log(chalk.red(`Unknown memory subcommand: ${subcommand}`));\r\n  }\r\n}\r\n\r\nasync function showMemoryStats(): Promise<void> {\r\n  console.log(chalk.cyan.bold('Memory Statistics'));\r\n  console.log('─'.repeat(30));\r\n  console.log(`${chalk.white('Total Entries:')} 1,247`);\r\n  console.log(`${chalk.white('Cache Size:')} 95 MB`);\r\n  console.log(`${chalk.white('Hit Rate:')} 94.2%`);\r\n  console.log(`${chalk.white('Backend:')} SQLite + Markdown`);\r\n}\r\n\r\nasync function handleSessionCommand(args: string[], context: REPLContext): Promise<void> {\r\n  if (args.length === 0) {\r\n    console.log(chalk.gray('Usage: session <list|save|restore> [options]'));\r\n    return;\r\n  }\r\n\r\n  const subcommand = args[0];\r\n  switch (subcommand) {\r\n    case 'list':\r\n      await showSessionList();\r\n      break;\r\n    case 'save':\r\n      await handleSessionSave(args.slice(1));\r\n      break;\r\n    case 'restore':\r\n      if (args.length < 2) {\r\n        console.log(chalk.red('Please specify session ID'));\r\n      } else {\r\n        await handleSessionRestore(args[1]);\r\n      }\r\n      break;\r\n    default:\r\n      console.log(chalk.red(`Unknown session subcommand: ${subcommand}`));\r\n  }\r\n}\r\n\r\nasync function showSessionList(): Promise<void> {\r\n  // Mock session data\r\n  const sessions = [\r\n    { id: 'session-001', name: 'Research Project', date: '2024-01-15', agents: 3, tasks: 8 },\r\n    { id: 'session-002', name: 'Development', date: '2024-01-14', agents: 2, tasks: 5 },\r\n  ];\r\n\r\n  console.log(chalk.cyan.bold(`Saved Sessions (${sessions.length})`));\r\n  console.log('─'.repeat(50));\r\n\r\n  const table = new Table({\r\n    head: ['ID', 'Name', 'Date', 'Agents', 'Tasks'],\r\n  });\r\n\r\n  for (const session of sessions) {\r\n    table.push([\r\n      chalk.gray(session.id),\r\n      chalk.white(session.name),\r\n      session.date,\r\n      session.agents.toString(),\r\n      session.tasks.toString(),\r\n    ]);\r\n  }\r\n\r\n  console.log(table.toString());\r\n}\r\n\r\nasync function handleSessionSave(args: string[]): Promise<void> {\r\n  const name =\r\n    args.length > 0\r\n      ? args.join(' ')\r\n      : (await inquirer.prompt([\r\n          {\r\n            type: 'input',\r\n            name: 'name',\r\n            message: 'Session name:',\r\n            default: `session-${new Date().toISOString().split('T')[0]}`,\r\n          },\r\n        ])).name;\r\n\r\n  console.log(chalk.yellow('Saving session...'));\r\n  await new Promise((resolve) => setTimeout(resolve, 1000));\r\n\r\n  const sessionId = generateId('session');\r\n  console.log(chalk.green('✓ Session saved successfully'));\r\n  console.log(`${chalk.white('ID:')} ${sessionId}`);\r\n  console.log(`${chalk.white('Name:')} ${name}`);\r\n}\r\n\r\nasync function handleSessionRestore(sessionId: string): Promise<void> {\r\n  const { confirmed } = await inquirer.prompt([\r\n    {\r\n      type: 'confirm',\r\n      name: 'confirmed',\r\n      message: `Restore session ${sessionId}?`,\r\n      default: false,\r\n    },\r\n  ]);\r\n\r\n  if (!confirmed) {\r\n    console.log(chalk.gray('Restore cancelled'));\r\n    return;\r\n  }\r\n\r\n  console.log(chalk.yellow('Restoring session...'));\r\n  await new Promise((resolve) => setTimeout(resolve, 1500));\r\n  console.log(chalk.green('✓ Session restored successfully'));\r\n}\r\n\r\nasync function handleWorkflowCommand(args: string[], context: REPLContext): Promise<void> {\r\n  if (context.connectionStatus !== 'connected') {\r\n    console.log(chalk.yellow('⚠ Not connected to orchestrator'));\r\n    return;\r\n  }\r\n\r\n  if (args.length === 0) {\r\n    console.log(chalk.gray('Usage: workflow <list|run|status> [options]'));\r\n    return;\r\n  }\r\n\r\n  const subcommand = args[0];\r\n  switch (subcommand) {\r\n    case 'list':\r\n      await showWorkflowList();\r\n      break;\r\n    case 'run':\r\n      if (args.length < 2) {\r\n        console.log(chalk.red('Please specify workflow file'));\r\n      } else {\r\n        await handleWorkflowRun(args[1]);\r\n      }\r\n      break;\r\n    case 'status':\r\n      if (args.length < 2) {\r\n        console.log(chalk.red('Please specify workflow ID'));\r\n      } else {\r\n        await showWorkflowStatus(args[1]);\r\n      }\r\n      break;\r\n    default:\r\n      console.log(chalk.red(`Unknown workflow subcommand: ${subcommand}`));\r\n  }\r\n}\r\n\r\nasync function showWorkflowList(): Promise<void> {\r\n  // Mock workflow data\r\n  const workflows = [\r\n    { id: 'workflow-001', name: 'Research Pipeline', status: 'running', progress: 60 },\r\n    { id: 'workflow-002', name: 'Data Analysis', status: 'completed', progress: 100 },\r\n  ];\r\n\r\n  console.log(chalk.cyan.bold(`Workflows (${workflows.length})`));\r\n  console.log('─'.repeat(50));\r\n\r\n  const table = new Table({\r\n    head: ['ID', 'Name', 'Status', 'Progress'],\r\n  });\r\n\r\n  for (const workflow of workflows) {\r\n    const statusIcon = formatStatusIndicator(workflow.status);\r\n    const progressBar = formatProgressBar(workflow.progress, 100, 15);\r\n\r\n    table.push([\r\n      chalk.gray(workflow.id),\r\n      chalk.white(workflow.name),\r\n      `${statusIcon} ${workflow.status}`,\r\n      `${progressBar} ${workflow.progress}%`,\r\n    ]);\r\n  }\r\n\r\n  console.log(table.toString());\r\n}\r\n\r\nasync function handleWorkflowRun(filename: string): Promise<void> {\r\n  try {\r\n    await fs.stat(filename);\r\n    console.log(chalk.yellow(`Running workflow: ${filename}`));\r\n    await new Promise((resolve) => setTimeout(resolve, 1000));\r\n\r\n    const workflowId = generateId('workflow');\r\n    console.log(chalk.green('✓ Workflow started successfully'));\r\n    console.log(`${chalk.white('ID:')} ${workflowId}`);\r\n  } catch {\r\n    console.log(chalk.red(`Workflow file not found: ${filename}`));\r\n  }\r\n}\r\n\r\nasync function showWorkflowStatus(workflowId: string): Promise<void> {\r\n  console.log(chalk.cyan.bold('Workflow Status'));\r\n  console.log('─'.repeat(30));\r\n  console.log(`${chalk.white('ID:')} ${workflowId}`);\r\n  console.log(`${chalk.white('Name:')} Research Pipeline`);\r\n  console.log(`${chalk.white('Status:')} ${formatStatusIndicator('running')} running`);\r\n  console.log(`${chalk.white('Progress:')} ${formatProgressBar(75, 100, 20)} 75%`);\r\n  console.log(`${chalk.white('Tasks:')} 6/8 completed`);\r\n  console.log(`${chalk.white('Started:')} ${new Date().toLocaleTimeString()}`);\r\n}\r\n\r\nfunction findSimilarCommands(input: string, commands: REPLCommand[]): string[] {\r\n  const allNames = commands.flatMap((c) => [c.name, ...(c.aliases || [])]);\r\n\r\n  return allNames\r\n    .filter((name) => {\r\n      // Simple similarity check - could use Levenshtein distance\r\n      const commonChars = input.split('').filter((char) => name.includes(char)).length;\r\n      return commonChars >= Math.min(2, input.length / 2);\r\n    })\r\n    .slice(0, 3); // Top 3 suggestions\r\n}\r\n"],"names":["promises","fs","inquirer","chalk","Table","generateId","formatStatusIndicator","formatDuration","formatProgressBar","CommandHistory","history","maxSize","historyFile","loadHistory","add","command","trim","length","push","slice","saveHistory","get","search","query","filter","cmd","includes","content","readFile","split","line","writeFile","join","CommandCompleter","commands","Map","setCommands","clear","set","name","aliases","alias","complete","input","parts","prefix","Array","from","keys","startsWith","sort","commandName","completeForCommand","args","sub","type","startREPL","options","context","workingDirectory","process","cwd","connectionStatus","lastActivity","Date","completer","description","usage","examples","handler","showHelp","showCommandHelp","ctx","showSystemStatus","connectToOrchestrator","handleAgentCommand","handleTaskCommand","handleMemoryCommand","handleSessionCommand","handleWorkflowCommand","console","log","cyan","gray","searchQuery","indexOf","historyItems","bold","repeat","recent","forEach","i","lineNumber","toString","padStart","newDir","env","chdir","error","red","Error","message","String","_","exit","quiet","promptString","createPrompt","prompt","transformer","parseCommand","commandArgs","find","c","suggestions","findSimilarCommands","map","s","errorMessage","statusIcon","getConnectionStatusIcon","dir","pop","yellow","white","status","green","current","inQuotes","quoteChar","char","table","head","style","border","example","component","toLocaleTimeString","currentSession","target","host","Promise","resolve","setTimeout","success","Math","random","subcommand","showAgentList","handleAgentSpawn","handleAgentTerminate","showAgentInfo","agents","id","tasks","agent","default","agentId","confirmed","showTaskList","handleTaskCreate","showTaskStatus","handleTaskCancel","task","substring","taskId","showMemoryStats","showSessionList","handleSessionSave","handleSessionRestore","sessions","date","session","toISOString","sessionId","showWorkflowList","handleWorkflowRun","showWorkflowStatus","workflows","progress","workflow","progressBar","filename","stat","workflowId","allNames","flatMap","commonChars","min"],"mappings":"AAAA,SAASA,YAAYC,EAAE,QAAQ,UAAU;AAKzC,OAAOC,cAAc,WAAW;AAChC,OAAOC,WAAW,QAAQ;AAC1B,OAAOC,WAAW,aAAa;AAE/B,SAASC,UAAU,QAAQ,sBAAsB;AACjD,SAASC,qBAAqB,EAAEC,cAAc,EAAEC,iBAAiB,QAAQ,iBAAiB;AAoB1F,IAAA,AAAMC,iBAAN,MAAMA;IACIC,UAAoB,EAAE,CAAC;IACvBC,UAAU,KAAK;IACfC,YAAoB;IAE5B,YAAYA,WAAoB,CAAE;QAChC,IAAI,CAACA,WAAW,GAAGA,eAAe;QAClC,IAAI,CAACC,WAAW;IAClB;IAEAC,IAAIC,OAAe,EAAQ;QACzB,IAAIA,QAAQC,IAAI,MAAMD,YAAY,IAAI,CAACL,OAAO,CAAC,IAAI,CAACA,OAAO,CAACO,MAAM,GAAG,EAAE,EAAE;YACvE,IAAI,CAACP,OAAO,CAACQ,IAAI,CAACH;YAClB,IAAI,IAAI,CAACL,OAAO,CAACO,MAAM,GAAG,IAAI,CAACN,OAAO,EAAE;gBACtC,IAAI,CAACD,OAAO,GAAG,IAAI,CAACA,OAAO,CAACS,KAAK,CAAC,CAAC,IAAI,CAACR,OAAO;YACjD;YACA,IAAI,CAACS,WAAW;QAClB;IACF;IAEAC,MAAgB;QACd,OAAO;eAAI,IAAI,CAACX,OAAO;SAAC;IAC1B;IAEAY,OAAOC,KAAa,EAAY;QAC9B,OAAO,IAAI,CAACb,OAAO,CAACc,MAAM,CAAC,CAACC,MAAQA,IAAIC,QAAQ,CAACH;IACnD;IAEA,MAAcV,cAA6B;QACzC,IAAI;YACF,MAAMc,UAAU,MAAM1B,GAAG2B,QAAQ,CAAC,IAAI,CAAChB,WAAW,EAAE;YACpD,IAAI,CAACF,OAAO,GAAGiB,QAAQE,KAAK,CAAC,MAAML,MAAM,CAAC,CAACM,OAAiBA,KAAKd,IAAI;QACvE,EAAE,OAAM,CAER;IACF;IAEA,MAAcI,cAA6B;QACzC,IAAI;YACF,MAAMnB,GAAG8B,SAAS,CAAC,IAAI,CAACnB,WAAW,EAAE,IAAI,CAACF,OAAO,CAACsB,IAAI,CAAC;QACzD,EAAE,OAAM,CAER;IACF;AACF;AAEA,IAAA,AAAMC,mBAAN,MAAMA;IACIC,WAAqC,IAAIC,MAAM;IAEvDC,YAAYF,QAAuB,EAAQ;QACzC,IAAI,CAACA,QAAQ,CAACG,KAAK;QACnB,KAAK,MAAMZ,OAAOS,SAAU;YAC1B,IAAI,CAACA,QAAQ,CAACI,GAAG,CAACb,IAAIc,IAAI,EAAEd;YAC5B,IAAIA,IAAIe,OAAO,EAAE;gBACf,KAAK,MAAMC,SAAShB,IAAIe,OAAO,CAAE;oBAC/B,IAAI,CAACN,QAAQ,CAACI,GAAG,CAACG,OAAOhB;gBAC3B;YACF;QACF;IACF;IAEAiB,SAASC,KAAa,EAAY;QAChC,MAAMC,QAAQD,MAAM3B,IAAI,GAAGa,KAAK,CAAC;QAEjC,IAAIe,MAAM3B,MAAM,KAAK,GAAG;YAEtB,MAAM4B,SAASD,KAAK,CAAC,EAAE;YACvB,OAAOE,MAAMC,IAAI,CAAC,IAAI,CAACb,QAAQ,CAACc,IAAI,IACjCxB,MAAM,CAAC,CAACe,OAASA,KAAKU,UAAU,CAACJ,SACjCK,IAAI;QACT;QAGA,MAAMC,cAAcP,KAAK,CAAC,EAAE;QAC5B,MAAM7B,UAAU,IAAI,CAACmB,QAAQ,CAACb,GAAG,CAAC8B;QAElC,IAAIpC,SAAS;YACX,OAAO,IAAI,CAACqC,kBAAkB,CAACrC,SAAS6B,MAAMzB,KAAK,CAAC;QACtD;QAEA,OAAO,EAAE;IACX;IAEQiC,mBAAmBrC,OAAoB,EAAEsC,IAAc,EAAY;QAEzE,OAAQtC,QAAQwB,IAAI;YAClB,KAAK;gBACH,IAAIc,KAAKpC,MAAM,KAAK,GAAG;oBACrB,OAAO;wBAAC;wBAAS;wBAAQ;wBAAa;qBAAO,CAACO,MAAM,CAAC,CAAC8B,MAAQA,IAAIL,UAAU,CAACI,IAAI,CAAC,EAAE;gBACtF;gBACA,IAAIA,IAAI,CAAC,EAAE,KAAK,WAAWA,KAAKpC,MAAM,KAAK,GAAG;oBAC5C,OAAO;wBAAC;wBAAe;wBAAc;wBAAe;wBAAW;qBAAS,CAACO,MAAM,CAAC,CAAC+B,OAC/EA,KAAKN,UAAU,CAACI,IAAI,CAAC,EAAE;gBAE3B;gBACA;YAEF,KAAK;gBACH,IAAIA,KAAKpC,MAAM,KAAK,GAAG;oBACrB,OAAO;wBAAC;wBAAU;wBAAQ;wBAAU;wBAAU;qBAAW,CAACO,MAAM,CAAC,CAAC8B,MAChEA,IAAIL,UAAU,CAACI,IAAI,CAAC,EAAE;gBAE1B;gBACA,IAAIA,IAAI,CAAC,EAAE,KAAK,YAAYA,KAAKpC,MAAM,KAAK,GAAG;oBAC7C,OAAO;wBAAC;wBAAY;wBAAkB;wBAAY;qBAAe,CAACO,MAAM,CAAC,CAAC+B,OACxEA,KAAKN,UAAU,CAACI,IAAI,CAAC,EAAE;gBAE3B;gBACA;YAEF,KAAK;gBACH,IAAIA,KAAKpC,MAAM,KAAK,GAAG;oBACrB,OAAO;wBAAC;wBAAQ;wBAAQ;wBAAW;wBAAU;wBAAU;qBAAS,CAACO,MAAM,CAAC,CAAC8B,MACvEA,IAAIL,UAAU,CAACI,IAAI,CAAC,EAAE;gBAE1B;gBACA;YAEF,KAAK;gBACH,IAAIA,KAAKpC,MAAM,KAAK,GAAG;oBACrB,OAAO;wBAAC;wBAAO;wBAAY;wBAAQ;wBAAU;wBAAQ;qBAAW,CAACO,MAAM,CAAC,CAAC8B,MACvEA,IAAIL,UAAU,CAACI,IAAI,CAAC,EAAE;gBAE1B;gBACA;QACJ;QAEA,OAAO,EAAE;IACX;AACF;AAKA,OAAO,eAAeG,UAAUC,UAAe,CAAC,CAAC;IAC/C,MAAMC,UAAuB;QAC3BD;QACA/C,SAAS,EAAE;QACXiD,kBAAkBC,QAAQC,GAAG;QAC7BC,kBAAkB;QAClBC,cAAc,IAAIC;IACpB;IAEA,MAAMtD,UAAU,IAAID,eAAegD,QAAQ7C,WAAW;IACtD,MAAMqD,YAAY,IAAIhC;IAEtB,MAAMC,WAA0B;QAC9B;YACEK,MAAM;YACNC,SAAS;gBAAC;gBAAK;aAAI;YACnB0B,aAAa;YACbC,OAAO;YACPC,UAAU;gBAAC;gBAAQ;gBAAc;aAAmB;YACpDC,SAAS,OAAOhB;gBACd,IAAIA,KAAKpC,MAAM,KAAK,GAAG;oBACrBqD,SAASpC;gBACX,OAAO;oBACLqC,gBAAgBrC,UAAUmB,IAAI,CAAC,EAAE;gBACnC;YACF;QACF;QACA;YACEd,MAAM;YACNC,SAAS;gBAAC;aAAK;YACf0B,aAAa;YACbC,OAAO;YACPC,UAAU;gBAAC;gBAAU;aAAsB;YAC3CC,SAAS,OAAOhB,MAAMmB;gBACpB,MAAMC,iBAAiBD,KAAKnB,IAAI,CAAC,EAAE;YACrC;QACF;QACA;YACEd,MAAM;YACNC,SAAS;gBAAC;aAAO;YACjB0B,aAAa;YACbC,OAAO;YACPC,UAAU;gBAAC;gBAAW;aAAyB;YAC/CC,SAAS,OAAOhB,MAAMmB;gBACpB,MAAME,sBAAsBF,KAAKnB,IAAI,CAAC,EAAE;YAC1C;QACF;QACA;YACEd,MAAM;YACN2B,aAAa;YACbC,OAAO;YACPC,UAAU;gBACR;gBACA;gBACA;gBACA;aACD;YACDC,SAAS,OAAOhB,MAAMmB;gBACpB,MAAMG,mBAAmBtB,MAAMmB;YACjC;QACF;QACA;YACEjC,MAAM;YACN2B,aAAa;YACbC,OAAO;YACPC,UAAU;gBACR;gBACA;gBACA;gBACA;aACD;YACDC,SAAS,OAAOhB,MAAMmB;gBACpB,MAAMI,kBAAkBvB,MAAMmB;YAChC;QACF;QACA;YACEjC,MAAM;YACN2B,aAAa;YACbC,OAAO;YACPC,UAAU;gBAAC;gBAAgB;gBAAkC;aAA4B;YACzFC,SAAS,OAAOhB,MAAMmB;gBACpB,MAAMK,oBAAoBxB,MAAMmB;YAClC;QACF;QACA;YACEjC,MAAM;YACN2B,aAAa;YACbC,OAAO;YACPC,UAAU;gBACR;gBACA;gBACA;aACD;YACDC,SAAS,OAAOhB,MAAMmB;gBACpB,MAAMM,qBAAqBzB,MAAMmB;YACnC;QACF;QACA;YACEjC,MAAM;YACN2B,aAAa;YACbC,OAAO;YACPC,UAAU;gBAAC;gBAAiB;gBAA8B;aAA+B;YACzFC,SAAS,OAAOhB,MAAMmB;gBACpB,MAAMO,sBAAsB1B,MAAMmB;YACpC;QACF;QACA;YACEjC,MAAM;YACNC,SAAS;gBAAC;aAAM;YAChB0B,aAAa;YACbC,OAAO;YACPC,UAAU;gBAAC;gBAAW;aAAuB;YAC7CC,SAAS,OAAOhB;gBACd2B,QAAQC,GAAG,CAAC9E,MAAM+E,IAAI,CAAC;gBACvBF,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;YACzB;QACF;QACA;YACE5C,MAAM;YACNC,SAAS;gBAAC;aAAO;YACjB0B,aAAa;YACbC,OAAO;YACPC,UAAU;gBAAC;gBAAW;aAAyB;YAC/CC,SAAS,OAAOhB;gBACd,MAAM+B,cACJ/B,KAAKgC,OAAO,CAAC,eAAe,IAAIhC,IAAI,CAACA,KAAKgC,OAAO,CAAC,cAAc,EAAE,GAAG;gBACvE,MAAMC,eAAeF,cAAc1E,QAAQY,MAAM,CAAC8D,eAAe1E,QAAQW,GAAG;gBAE5E2D,QAAQC,GAAG,CACT9E,MAAM+E,IAAI,CAACK,IAAI,CAAC,CAAC,eAAe,EAAEH,cAAc,CAAC,UAAU,EAAEA,YAAY,CAAC,CAAC,GAAG,IAAI;gBAEpFJ,QAAQC,GAAG,CAAC,IAAIO,MAAM,CAAC;gBAEvB,IAAIF,aAAarE,MAAM,KAAK,GAAG;oBAC7B+D,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;oBACvB;gBACF;gBAEA,MAAMM,SAASH,aAAanE,KAAK,CAAC,CAAC;gBACnCsE,OAAOC,OAAO,CAAC,CAACjE,KAAKkE;oBACnB,MAAMC,aAAaN,aAAarE,MAAM,GAAGwE,OAAOxE,MAAM,GAAG0E,IAAI;oBAC7DX,QAAQC,GAAG,CAAC,GAAG9E,MAAMgF,IAAI,CAACS,WAAWC,QAAQ,GAAGC,QAAQ,CAAC,IAAI,CAAC,EAAErE,KAAK;gBACvE;YACF;QACF;QACA;YACEc,MAAM;YACNC,SAAS;gBAAC;aAAM;YAChB0B,aAAa;YACbG,SAAS;gBACPW,QAAQ3C,KAAK;YACf;QACF;QACA;YACEE,MAAM;YACN2B,aAAa;YACbC,OAAO;YACPC,UAAU;gBAAC;gBAAuB;aAAQ;YAC1CC,SAAS,OAAOhB,MAAMmB;gBACpB,IAAInB,KAAKpC,MAAM,KAAK,GAAG;oBACrB+D,QAAQC,GAAG,CAACT,IAAIb,gBAAgB;oBAChC;gBACF;gBAEA,IAAI;oBACF,MAAMoC,SAAS1C,IAAI,CAAC,EAAE,KAAK,MAAMO,QAAQoC,GAAG,CAAC,OAAO,IAAI,MAAM3C,IAAI,CAAC,EAAE;oBACrEO,QAAQqC,KAAK,CAACF;oBACdvB,IAAIb,gBAAgB,GAAGC,QAAQC,GAAG;oBAClCmB,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC,CAAC,YAAY,EAAEX,IAAIb,gBAAgB,EAAE;gBAC9D,EAAE,OAAOuC,OAAO;oBACdlB,QAAQkB,KAAK,CACX/F,MAAMgG,GAAG,CAAC,WACVD,iBAAiBE,QAAQF,MAAMG,OAAO,GAAGC,OAAOJ;gBAEpD;YACF;QACF;QACA;YACE3D,MAAM;YACN2B,aAAa;YACbG,SAAS,OAAOkC,GAAG/B;gBACjBQ,QAAQC,GAAG,CAACT,IAAIb,gBAAgB;YAClC;QACF;QACA;YACEpB,MAAM;YACN2B,aAAa;YACbC,OAAO;YACPC,UAAU;gBAAC;aAAuB;YAClCC,SAAS,OAAOhB;gBACd2B,QAAQC,GAAG,CAAC5B,KAAKrB,IAAI,CAAC;YACxB;QACF;QACA;YACEO,MAAM;YACNC,SAAS;gBAAC;gBAAQ;aAAI;YACtB0B,aAAa;YACbG,SAAS;gBACPW,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;gBACvBvB,QAAQ4C,IAAI,CAAC;YACf;QACF;KACD;IAGDvC,UAAU7B,WAAW,CAACF;IAGtB,IAAI,CAACuB,QAAQgD,KAAK,EAAE;QAClB,MAAMhC,iBAAiBf;QACvBsB,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;IACzB;IAGA,MAAO,KAAM;QACX,IAAI;YACF,MAAMuB,eAAeC,aAAajD;YAClC,MAAM,EAAEf,KAAK,EAAE,GAAG,MAAMzC,SAAS0G,MAAM,CAAC;gBACtC;oBACErD,MAAM;oBACNhB,MAAM;oBACN8D,SAASK;oBACTG,aAAa,CAAClE,QAAkBA;gBAClC;aACD;YAED,IAAI,CAACA,MAAM3B,IAAI,IAAI;gBACjB;YACF;YAGAN,QAAQI,GAAG,CAAC6B;YACZe,QAAQhD,OAAO,CAACQ,IAAI,CAACyB;YACrBe,QAAQK,YAAY,GAAG,IAAIC;YAG3B,MAAMX,OAAOyD,aAAanE;YAC1B,MAAM,CAACQ,aAAa,GAAG4D,YAAY,GAAG1D;YAGtC,MAAMtC,UAAUmB,SAAS8E,IAAI,CAC3B,CAACC,IAAMA,EAAE1E,IAAI,KAAKY,eAAgB8D,EAAEzE,OAAO,IAAIyE,EAAEzE,OAAO,CAACd,QAAQ,CAACyB;YAGpE,IAAIpC,SAAS;gBACX,IAAI;oBACF,MAAMA,QAAQsD,OAAO,CAAC0C,aAAarD;gBACrC,EAAE,OAAOwC,OAAO;oBACdlB,QAAQkB,KAAK,CACX/F,MAAMgG,GAAG,CAAC,oBACVD,iBAAiBE,QAAQF,MAAMG,OAAO,GAAGC,OAAOJ;gBAEpD;YACF,OAAO;gBACLlB,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC,CAAC,iBAAiB,EAAEhD,aAAa;gBACvD6B,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;gBAGvB,MAAM+B,cAAcC,oBAAoBhE,aAAajB;gBACrD,IAAIgF,YAAYjG,MAAM,GAAG,GAAG;oBAC1B+D,QAAQC,GAAG,CACT9E,MAAMgF,IAAI,CAAC,kBACX+B,YAAYE,GAAG,CAAC,CAACC,IAAMlH,MAAM+E,IAAI,CAACmC,IAAIrF,IAAI,CAAC;gBAE/C;YACF;QACF,EAAE,OAAOkE,OAAO;YACd,MAAMoB,eAAepB,iBAAiBE,QAAQF,MAAMG,OAAO,GAAGC,OAAOJ;YACrE,IAAIoB,aAAa5F,QAAQ,CAAC,UAAU4F,aAAa5F,QAAQ,CAAC,gBAAgB;gBAExEsD,QAAQC,GAAG,CAAC,OAAO9E,MAAMgF,IAAI,CAAC;gBAC9B;YACF;YACAH,QAAQkB,KAAK,CAAC/F,MAAMgG,GAAG,CAAC,gBAAgBmB;QAC1C;IACF;AACF;AAEA,SAASX,aAAajD,OAAoB;IACxC,MAAM6D,aAAaC,wBAAwB9D,QAAQI,gBAAgB;IACnE,MAAM2D,MAAM/D,QAAQC,gBAAgB,CAAC9B,KAAK,CAAC,KAAK6F,GAAG,MAAM;IAEzD,OAAO,GAAGH,WAAW,CAAC,EAAEpH,MAAM+E,IAAI,CAAC,eAAe,CAAC,EAAE/E,MAAMwH,MAAM,CAACF,OAAOtH,MAAMyH,KAAK,CAAC,KAAK,CAAC,CAAC;AAC9F;AAEA,SAASJ,wBAAwBK,MAAc;IAC7C,OAAQA;QACN,KAAK;YACH,OAAO1H,MAAM2H,KAAK,CAAC;QACrB,KAAK;YACH,OAAO3H,MAAMwH,MAAM,CAAC;QACtB,KAAK;YACH,OAAOxH,MAAMgG,GAAG,CAAC;QACnB;YACE,OAAOhG,MAAMgF,IAAI,CAAC;IACtB;AACF;AAEA,SAAS2B,aAAanE,KAAa;IAEjC,MAAMU,OAAiB,EAAE;IACzB,IAAI0E,UAAU;IACd,IAAIC,WAAW;IACf,IAAIC,YAAY;IAEhB,IAAK,IAAItC,IAAI,GAAGA,IAAIhD,MAAM1B,MAAM,EAAE0E,IAAK;QACrC,MAAMuC,OAAOvF,KAAK,CAACgD,EAAE;QAErB,IAAIqC,UAAU;YACZ,IAAIE,SAASD,WAAW;gBACtBD,WAAW;gBACXC,YAAY;YACd,OAAO;gBACLF,WAAWG;YACb;QACF,OAAO;YACL,IAAIA,SAAS,OAAOA,SAAS,KAAK;gBAChCF,WAAW;gBACXC,YAAYC;YACd,OAAO,IAAIA,SAAS,OAAOA,SAAS,MAAM;gBACxC,IAAIH,QAAQ/G,IAAI,IAAI;oBAClBqC,KAAKnC,IAAI,CAAC6G,QAAQ/G,IAAI;oBACtB+G,UAAU;gBACZ;YACF,OAAO;gBACLA,WAAWG;YACb;QACF;IACF;IAEA,IAAIH,QAAQ/G,IAAI,IAAI;QAClBqC,KAAKnC,IAAI,CAAC6G,QAAQ/G,IAAI;IACxB;IAEA,OAAOqC;AACT;AAEA,SAASiB,SAASpC,QAAuB;IACvC8C,QAAQC,GAAG,CAAC9E,MAAM+E,IAAI,CAACK,IAAI,CAAC;IAC5BP,QAAQC,GAAG,CAAC,IAAIO,MAAM,CAAC;IACvBR,QAAQC,GAAG;IAEXD,QAAQC,GAAG,CAAC9E,MAAMyH,KAAK,CAACrC,IAAI,CAAC;IAC7BP,QAAQC,GAAG;IAEX,MAAMkD,QAAQ,IAAI/H,MAAM;QACtBgI,MAAM;YAAC;YAAW;YAAW;SAAc;QAC3CC,OAAO;YAAE,gBAAgB;YAAG,iBAAiB;YAAGC,QAAQ,EAAE;QAAC;IAC7D;IAEA,KAAK,MAAM7G,OAAOS,SAAU;QAC1BiG,MAAMjH,IAAI,CAAC;YACTf,MAAM+E,IAAI,CAACzD,IAAIc,IAAI;YACnBd,IAAIe,OAAO,GAAGrC,MAAMgF,IAAI,CAAC1D,IAAIe,OAAO,CAACR,IAAI,CAAC,SAAS;YACnDP,IAAIyC,WAAW;SAChB;IACH;IAEAc,QAAQC,GAAG,CAACkD,MAAMtC,QAAQ;IAC1Bb,QAAQC,GAAG;IAEXD,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;IACvBH,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;IACvBH,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;IACvBH,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;IACvBH,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;AACzB;AAEA,SAASZ,gBAAgBrC,QAAuB,EAAEiB,WAAmB;IACnE,MAAMpC,UAAUmB,SAAS8E,IAAI,CAC3B,CAACC,IAAMA,EAAE1E,IAAI,KAAKY,eAAgB8D,EAAEzE,OAAO,IAAIyE,EAAEzE,OAAO,CAACd,QAAQ,CAACyB;IAGpE,IAAI,CAACpC,SAAS;QACZiE,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC,CAAC,iBAAiB,EAAEhD,aAAa;QACvD;IACF;IAEA6B,QAAQC,GAAG,CAAC9E,MAAM+E,IAAI,CAACK,IAAI,CAAC,CAAC,SAAS,EAAExE,QAAQwB,IAAI,EAAE;IACtDyC,QAAQC,GAAG,CAAC,IAAIO,MAAM,CAAC;IACvBR,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,gBAAgB,CAAC,EAAE7G,QAAQmD,WAAW,EAAE;IAEnE,IAAInD,QAAQyB,OAAO,EAAE;QACnBwC,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,YAAY,CAAC,EAAE7G,QAAQyB,OAAO,CAACR,IAAI,CAAC,OAAO;IACxE;IAEA,IAAIjB,QAAQoD,KAAK,EAAE;QACjBa,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,UAAU,CAAC,EAAE7G,QAAQoD,KAAK,EAAE;IACzD;IAEA,IAAIpD,QAAQqD,QAAQ,EAAE;QACpBY,QAAQC,GAAG;QACXD,QAAQC,GAAG,CAAC9E,MAAMyH,KAAK,CAACrC,IAAI,CAAC;QAC7B,KAAK,MAAMgD,WAAWxH,QAAQqD,QAAQ,CAAE;YACtCY,QAAQC,GAAG,CAAC,CAAC,EAAE,EAAE9E,MAAMgF,IAAI,CAAC,KAAK,CAAC,EAAEhF,MAAM+E,IAAI,CAACqD,UAAU;QAC3D;IACF;AACF;AAEA,eAAe9D,iBAAiBf,OAAoB,EAAE8E,SAAkB;IACtExD,QAAQC,GAAG,CAAC9E,MAAM+E,IAAI,CAACK,IAAI,CAAC;IAC5BP,QAAQC,GAAG,CAAC,IAAIO,MAAM,CAAC;IAEvB,MAAM+B,aAAajH,sBACjBoD,QAAQI,gBAAgB,KAAK,cAAc,YAAY;IAEzDkB,QAAQC,GAAG,CAAC,GAAGsC,WAAW,aAAa,EAAE7D,QAAQI,gBAAgB,EAAE;IACnEkB,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,sBAAsB,CAAC,EAAElE,QAAQC,gBAAgB,EAAE;IAC9EqB,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,kBAAkB,CAAC,EAAElE,QAAQK,YAAY,CAAC0E,kBAAkB,IAAI;IAE3F,IAAI/E,QAAQgF,cAAc,EAAE;QAC1B1D,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,oBAAoB,CAAC,EAAElE,QAAQgF,cAAc,EAAE;IAC5E;IAEA1D,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,wBAAwB,CAAC,EAAElE,QAAQhD,OAAO,CAACO,MAAM,EAAE;IAE9E,IAAIyC,QAAQI,gBAAgB,KAAK,gBAAgB;QAC/CkB,QAAQC,GAAG;QACXD,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC;QACzB3C,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;IACzB;AACF;AAEA,eAAeT,sBAAsBhB,OAAoB,EAAEiF,MAAe;IACxE,MAAMC,OAAOD,UAAU;IAEvB3D,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC,CAAC,cAAc,EAAEiB,KAAK,GAAG,CAAC;IACnDlF,QAAQI,gBAAgB,GAAG;IAG3B,MAAM,IAAI+E,QAAQ,CAACC,UAAYC,WAAWD,SAAS;IAGnD,MAAME,UAAUC,KAAKC,MAAM,KAAK;IAEhC,IAAIF,SAAS;QACXtF,QAAQI,gBAAgB,GAAG;QAC3BkB,QAAQC,GAAG,CAAC9E,MAAM2H,KAAK,CAAC;IAC1B,OAAO;QACLpE,QAAQI,gBAAgB,GAAG;QAC3BkB,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC;QACtBnB,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;IACzB;AACF;AAEA,eAAeR,mBAAmBtB,IAAc,EAAEK,OAAoB;IACpE,IAAIA,QAAQI,gBAAgB,KAAK,aAAa;QAC5CkB,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC;QACzB3C,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;QACvB;IACF;IAEA,IAAI9B,KAAKpC,MAAM,KAAK,GAAG;QACrB+D,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;QACvB;IACF;IAEA,MAAMgE,aAAa9F,IAAI,CAAC,EAAE;IAC1B,OAAQ8F;QACN,KAAK;YACH,MAAMC;YACN;QACF,KAAK;YACH,MAAMC,iBAAiBhG,KAAKlC,KAAK,CAAC;YAClC;QACF,KAAK;YACH,IAAIkC,KAAKpC,MAAM,GAAG,GAAG;gBACnB+D,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC;YACxB,OAAO;gBACL,MAAMmD,qBAAqBjG,IAAI,CAAC,EAAE;YACpC;YACA;QACF,KAAK;YACH,IAAIA,KAAKpC,MAAM,GAAG,GAAG;gBACnB+D,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC;YACxB,OAAO;gBACL,MAAMoD,cAAclG,IAAI,CAAC,EAAE;YAC7B;YACA;QACF;YACE2B,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC,CAAC,0BAA0B,EAAEgD,YAAY;IACnE;AACF;AAEA,eAAeC;IAEb,MAAMI,SAAS;QACb;YAAEC,IAAI;YAAalH,MAAM;YAAegB,MAAM;YAAesE,QAAQ;YAAU6B,OAAO;QAAE;QACxF;YAAED,IAAI;YAAalH,MAAM;YAAcgB,MAAM;YAAcsE,QAAQ;YAAU6B,OAAO;QAAE;QACtF;YAAED,IAAI;YAAalH,MAAM;YAAegB,MAAM;YAAesE,QAAQ;YAAQ6B,OAAO;QAAE;KACvF;IAED1E,QAAQC,GAAG,CAAC9E,MAAM+E,IAAI,CAACK,IAAI,CAAC,CAAC,eAAe,EAAEiE,OAAOvI,MAAM,CAAC,CAAC,CAAC;IAC9D+D,QAAQC,GAAG,CAAC,IAAIO,MAAM,CAAC;IAEvB,MAAM2C,QAAQ,IAAI/H,MAAM;QACtBgI,MAAM;YAAC;YAAM;YAAQ;YAAQ;YAAU;SAAQ;IACjD;IAEA,KAAK,MAAMuB,SAASH,OAAQ;QAC1B,MAAMjC,aAAajH,sBAAsBqJ,MAAM9B,MAAM;QAErDM,MAAMjH,IAAI,CAAC;YACTf,MAAMgF,IAAI,CAACwE,MAAMF,EAAE;YACnBtJ,MAAMyH,KAAK,CAAC+B,MAAMpH,IAAI;YACtBpC,MAAM+E,IAAI,CAACyE,MAAMpG,IAAI;YACrB,GAAGgE,WAAW,CAAC,EAAEoC,MAAM9B,MAAM,EAAE;YAC/B8B,MAAMD,KAAK,CAAC7D,QAAQ;SACrB;IACH;IAEAb,QAAQC,GAAG,CAACkD,MAAMtC,QAAQ;AAC5B;AAEA,eAAewD,iBAAiBhG,IAAc;IAC5C,IAAIA,KAAKpC,MAAM,KAAK,GAAG;QACrB+D,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;QACvBH,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;QACvB;IACF;IAEA,MAAM5B,OAAOF,IAAI,CAAC,EAAE;IACpB,MAAMd,OACJc,IAAI,CAAC,EAAE,IACP,AAAC,CAAA,MAAMnD,SAAS0G,MAAM,CAAC;QACrB;YACErD,MAAM;YACNhB,MAAM;YACN8D,SAAS;YACTuD,SAAS,GAAGrG,KAAK,MAAM,CAAC;QAC1B;KACD,CAAA,EAAGhB,IAAI;IAEVyC,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC;IAGzB,MAAM,IAAIkB,QAAQ,CAACC,UAAYC,WAAWD,SAAS;IAEnD,MAAMe,UAAUxJ,WAAW;IAC3B2E,QAAQC,GAAG,CAAC9E,MAAM2H,KAAK,CAAC;IACxB9C,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,OAAO,CAAC,EAAEiC,SAAS;IAC9C7E,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,SAAS,CAAC,EAAErF,MAAM;IAC7CyC,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,SAAS,CAAC,EAAErE,MAAM;AAC/C;AAEA,eAAe+F,qBAAqBO,OAAe;IACjD,MAAM,EAAEC,SAAS,EAAE,GAAG,MAAM5J,SAAS0G,MAAM,CAAC;QAC1C;YACErD,MAAM;YACNhB,MAAM;YACN8D,SAAS,CAAC,gBAAgB,EAAEwD,QAAQ,CAAC,CAAC;YACtCD,SAAS;QACX;KACD;IAED,IAAI,CAACE,WAAW;QACd9E,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;QACvB;IACF;IAEAH,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC;IACzB,MAAM,IAAIkB,QAAQ,CAACC,UAAYC,WAAWD,SAAS;IACnD9D,QAAQC,GAAG,CAAC9E,MAAM2H,KAAK,CAAC;AAC1B;AAEA,eAAeyB,cAAcM,OAAe;IAE1C7E,QAAQC,GAAG,CAAC9E,MAAM+E,IAAI,CAACK,IAAI,CAAC;IAC5BP,QAAQC,GAAG,CAAC,IAAIO,MAAM,CAAC;IACvBR,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,OAAO,CAAC,EAAEiC,SAAS;IAC9C7E,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,SAAS,eAAe,CAAC;IACpD5C,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,SAAS,WAAW,CAAC;IAChD5C,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,WAAW,CAAC,EAAEtH,sBAAsB,WAAW,OAAO,CAAC;IAClF0E,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,WAAW,CAAC,EAAErH,eAAe,UAAU;IAClEyE,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,iBAAiB,EAAE,CAAC;IAC/C5C,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,oBAAoB,GAAG,CAAC;AACrD;AAEA,eAAehD,kBAAkBvB,IAAc,EAAEK,OAAoB;IACnE,IAAIA,QAAQI,gBAAgB,KAAK,aAAa;QAC5CkB,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC;QACzB;IACF;IAEA,IAAItE,KAAKpC,MAAM,KAAK,GAAG;QACrB+D,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;QACvB;IACF;IAEA,MAAMgE,aAAa9F,IAAI,CAAC,EAAE;IAC1B,OAAQ8F;QACN,KAAK;YACH,MAAMY;YACN;QACF,KAAK;YACH,MAAMC,iBAAiB3G,KAAKlC,KAAK,CAAC;YAClC;QACF,KAAK;YACH,IAAIkC,KAAKpC,MAAM,GAAG,GAAG;gBACnB+D,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC;YACxB,OAAO;gBACL,MAAM8D,eAAe5G,IAAI,CAAC,EAAE;YAC9B;YACA;QACF,KAAK;YACH,IAAIA,KAAKpC,MAAM,GAAG,GAAG;gBACnB+D,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC;YACxB,OAAO;gBACL,MAAM+D,iBAAiB7G,IAAI,CAAC,EAAE;YAChC;YACA;QACF;YACE2B,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC,CAAC,yBAAyB,EAAEgD,YAAY;IAClE;AACF;AAEA,eAAeY;IAEb,MAAML,QAAQ;QACZ;YACED,IAAI;YACJlG,MAAM;YACNW,aAAa;YACb2D,QAAQ;YACR8B,OAAO;QACT;QACA;YACEF,IAAI;YACJlG,MAAM;YACNW,aAAa;YACb2D,QAAQ;YACR8B,OAAO;QACT;QACA;YACEF,IAAI;YACJlG,MAAM;YACNW,aAAa;YACb2D,QAAQ;YACR8B,OAAO;QACT;KACD;IAED3E,QAAQC,GAAG,CAAC9E,MAAM+E,IAAI,CAACK,IAAI,CAAC,CAAC,OAAO,EAAEmE,MAAMzI,MAAM,CAAC,CAAC,CAAC;IACrD+D,QAAQC,GAAG,CAAC,IAAIO,MAAM,CAAC;IAEvB,MAAM2C,QAAQ,IAAI/H,MAAM;QACtBgI,MAAM;YAAC;YAAM;YAAQ;YAAe;YAAU;SAAQ;IACxD;IAEA,KAAK,MAAM+B,QAAQT,MAAO;QACxB,MAAMnC,aAAajH,sBAAsB6J,KAAKtC,MAAM;QAEpDM,MAAMjH,IAAI,CAAC;YACTf,MAAMgF,IAAI,CAACgF,KAAKV,EAAE;YAClBtJ,MAAMyH,KAAK,CAACuC,KAAK5G,IAAI;YACrB4G,KAAKjG,WAAW,CAACkG,SAAS,CAAC,GAAG,MAAOD,CAAAA,KAAKjG,WAAW,CAACjD,MAAM,GAAG,KAAK,QAAQ,EAAC;YAC7E,GAAGsG,WAAW,CAAC,EAAE4C,KAAKtC,MAAM,EAAE;YAC9BsC,KAAKR,KAAK,GAAGxJ,MAAM+E,IAAI,CAACiF,KAAKR,KAAK,IAAI;SACvC;IACH;IAEA3E,QAAQC,GAAG,CAACkD,MAAMtC,QAAQ;AAC5B;AAEA,eAAemE,iBAAiB3G,IAAc;IAC5C,IAAIA,KAAKpC,MAAM,GAAG,GAAG;QACnB+D,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;QACvB;IACF;IAEA,MAAM5B,OAAOF,IAAI,CAAC,EAAE;IACpB,MAAMa,cAAcb,KAAKlC,KAAK,CAAC,GAAGa,IAAI,CAAC;IAEvCgD,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC;IACzB,MAAM,IAAIkB,QAAQ,CAACC,UAAYC,WAAWD,SAAS;IAEnD,MAAMuB,SAAShK,WAAW;IAC1B2E,QAAQC,GAAG,CAAC9E,MAAM2H,KAAK,CAAC;IACxB9C,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,OAAO,CAAC,EAAEyC,QAAQ;IAC7CrF,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,SAAS,CAAC,EAAErE,MAAM;IAC7CyB,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,gBAAgB,CAAC,EAAE1D,aAAa;AAC7D;AAEA,eAAe+F,eAAeI,MAAc;IAC1CrF,QAAQC,GAAG,CAAC9E,MAAM+E,IAAI,CAACK,IAAI,CAAC;IAC5BP,QAAQC,GAAG,CAAC,IAAIO,MAAM,CAAC;IACvBR,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,OAAO,CAAC,EAAEyC,QAAQ;IAC7CrF,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,SAAS,SAAS,CAAC;IAC9C5C,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,WAAW,CAAC,EAAEtH,sBAAsB,WAAW,QAAQ,CAAC;IACnF0E,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,aAAa,CAAC,EAAEpH,kBAAkB,IAAI,KAAK,IAAI,IAAI,CAAC;IAC/EwE,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,UAAU,UAAU,CAAC;IAChD5C,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,YAAY,CAAC,EAAE,IAAI5D,OAAOyE,kBAAkB,IAAI;AAC7E;AAEA,eAAeyB,iBAAiBG,MAAc;IAC5C,MAAM,EAAEP,SAAS,EAAE,GAAG,MAAM5J,SAAS0G,MAAM,CAAC;QAC1C;YACErD,MAAM;YACNhB,MAAM;YACN8D,SAAS,CAAC,YAAY,EAAEgE,OAAO,CAAC,CAAC;YACjCT,SAAS;QACX;KACD;IAED,IAAI,CAACE,WAAW;QACd9E,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;QACvB;IACF;IAEAH,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC;IACzB,MAAM,IAAIkB,QAAQ,CAACC,UAAYC,WAAWD,SAAS;IACnD9D,QAAQC,GAAG,CAAC9E,MAAM2H,KAAK,CAAC;AAC1B;AAEA,eAAejD,oBAAoBxB,IAAc,EAAEK,OAAoB;IACrE,IAAIA,QAAQI,gBAAgB,KAAK,aAAa;QAC5CkB,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC;QACzB;IACF;IAEA,IAAItE,KAAKpC,MAAM,KAAK,GAAG;QACrB+D,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;QACvB;IACF;IAEA,MAAMgE,aAAa9F,IAAI,CAAC,EAAE;IAC1B,OAAQ8F;QACN,KAAK;YACH,MAAMmB;YACN;QACF,KAAK;YACHtF,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC;YACzB;QACF,KAAK;YACH3C,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC;YACzB;QACF;YACE3C,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC,CAAC,2BAA2B,EAAEgD,YAAY;IACpE;AACF;AAEA,eAAemB;IACbtF,QAAQC,GAAG,CAAC9E,MAAM+E,IAAI,CAACK,IAAI,CAAC;IAC5BP,QAAQC,GAAG,CAAC,IAAIO,MAAM,CAAC;IACvBR,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,kBAAkB,MAAM,CAAC;IACpD5C,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,eAAe,MAAM,CAAC;IACjD5C,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,aAAa,MAAM,CAAC;IAC/C5C,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,YAAY,kBAAkB,CAAC;AAC5D;AAEA,eAAe9C,qBAAqBzB,IAAc,EAAEK,OAAoB;IACtE,IAAIL,KAAKpC,MAAM,KAAK,GAAG;QACrB+D,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;QACvB;IACF;IAEA,MAAMgE,aAAa9F,IAAI,CAAC,EAAE;IAC1B,OAAQ8F;QACN,KAAK;YACH,MAAMoB;YACN;QACF,KAAK;YACH,MAAMC,kBAAkBnH,KAAKlC,KAAK,CAAC;YACnC;QACF,KAAK;YACH,IAAIkC,KAAKpC,MAAM,GAAG,GAAG;gBACnB+D,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC;YACxB,OAAO;gBACL,MAAMsE,qBAAqBpH,IAAI,CAAC,EAAE;YACpC;YACA;QACF;YACE2B,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC,CAAC,4BAA4B,EAAEgD,YAAY;IACrE;AACF;AAEA,eAAeoB;IAEb,MAAMG,WAAW;QACf;YAAEjB,IAAI;YAAelH,MAAM;YAAoBoI,MAAM;YAAcnB,QAAQ;YAAGE,OAAO;QAAE;QACvF;YAAED,IAAI;YAAelH,MAAM;YAAeoI,MAAM;YAAcnB,QAAQ;YAAGE,OAAO;QAAE;KACnF;IAED1E,QAAQC,GAAG,CAAC9E,MAAM+E,IAAI,CAACK,IAAI,CAAC,CAAC,gBAAgB,EAAEmF,SAASzJ,MAAM,CAAC,CAAC,CAAC;IACjE+D,QAAQC,GAAG,CAAC,IAAIO,MAAM,CAAC;IAEvB,MAAM2C,QAAQ,IAAI/H,MAAM;QACtBgI,MAAM;YAAC;YAAM;YAAQ;YAAQ;YAAU;SAAQ;IACjD;IAEA,KAAK,MAAMwC,WAAWF,SAAU;QAC9BvC,MAAMjH,IAAI,CAAC;YACTf,MAAMgF,IAAI,CAACyF,QAAQnB,EAAE;YACrBtJ,MAAMyH,KAAK,CAACgD,QAAQrI,IAAI;YACxBqI,QAAQD,IAAI;YACZC,QAAQpB,MAAM,CAAC3D,QAAQ;YACvB+E,QAAQlB,KAAK,CAAC7D,QAAQ;SACvB;IACH;IAEAb,QAAQC,GAAG,CAACkD,MAAMtC,QAAQ;AAC5B;AAEA,eAAe2E,kBAAkBnH,IAAc;IAC7C,MAAMd,OACJc,KAAKpC,MAAM,GAAG,IACVoC,KAAKrB,IAAI,CAAC,OACV,AAAC,CAAA,MAAM9B,SAAS0G,MAAM,CAAC;QACrB;YACErD,MAAM;YACNhB,MAAM;YACN8D,SAAS;YACTuD,SAAS,CAAC,QAAQ,EAAE,IAAI5F,OAAO6G,WAAW,GAAGhJ,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE;QAC9D;KACD,CAAA,EAAGU,IAAI;IAEdyC,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC;IACzB,MAAM,IAAIkB,QAAQ,CAACC,UAAYC,WAAWD,SAAS;IAEnD,MAAMgC,YAAYzK,WAAW;IAC7B2E,QAAQC,GAAG,CAAC9E,MAAM2H,KAAK,CAAC;IACxB9C,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,OAAO,CAAC,EAAEkD,WAAW;IAChD9F,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,SAAS,CAAC,EAAErF,MAAM;AAC/C;AAEA,eAAekI,qBAAqBK,SAAiB;IACnD,MAAM,EAAEhB,SAAS,EAAE,GAAG,MAAM5J,SAAS0G,MAAM,CAAC;QAC1C;YACErD,MAAM;YACNhB,MAAM;YACN8D,SAAS,CAAC,gBAAgB,EAAEyE,UAAU,CAAC,CAAC;YACxClB,SAAS;QACX;KACD;IAED,IAAI,CAACE,WAAW;QACd9E,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;QACvB;IACF;IAEAH,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC;IACzB,MAAM,IAAIkB,QAAQ,CAACC,UAAYC,WAAWD,SAAS;IACnD9D,QAAQC,GAAG,CAAC9E,MAAM2H,KAAK,CAAC;AAC1B;AAEA,eAAe/C,sBAAsB1B,IAAc,EAAEK,OAAoB;IACvE,IAAIA,QAAQI,gBAAgB,KAAK,aAAa;QAC5CkB,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC;QACzB;IACF;IAEA,IAAItE,KAAKpC,MAAM,KAAK,GAAG;QACrB+D,QAAQC,GAAG,CAAC9E,MAAMgF,IAAI,CAAC;QACvB;IACF;IAEA,MAAMgE,aAAa9F,IAAI,CAAC,EAAE;IAC1B,OAAQ8F;QACN,KAAK;YACH,MAAM4B;YACN;QACF,KAAK;YACH,IAAI1H,KAAKpC,MAAM,GAAG,GAAG;gBACnB+D,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC;YACxB,OAAO;gBACL,MAAM6E,kBAAkB3H,IAAI,CAAC,EAAE;YACjC;YACA;QACF,KAAK;YACH,IAAIA,KAAKpC,MAAM,GAAG,GAAG;gBACnB+D,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC;YACxB,OAAO;gBACL,MAAM8E,mBAAmB5H,IAAI,CAAC,EAAE;YAClC;YACA;QACF;YACE2B,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC,CAAC,6BAA6B,EAAEgD,YAAY;IACtE;AACF;AAEA,eAAe4B;IAEb,MAAMG,YAAY;QAChB;YAAEzB,IAAI;YAAgBlH,MAAM;YAAqBsF,QAAQ;YAAWsD,UAAU;QAAG;QACjF;YAAE1B,IAAI;YAAgBlH,MAAM;YAAiBsF,QAAQ;YAAasD,UAAU;QAAI;KACjF;IAEDnG,QAAQC,GAAG,CAAC9E,MAAM+E,IAAI,CAACK,IAAI,CAAC,CAAC,WAAW,EAAE2F,UAAUjK,MAAM,CAAC,CAAC,CAAC;IAC7D+D,QAAQC,GAAG,CAAC,IAAIO,MAAM,CAAC;IAEvB,MAAM2C,QAAQ,IAAI/H,MAAM;QACtBgI,MAAM;YAAC;YAAM;YAAQ;YAAU;SAAW;IAC5C;IAEA,KAAK,MAAMgD,YAAYF,UAAW;QAChC,MAAM3D,aAAajH,sBAAsB8K,SAASvD,MAAM;QACxD,MAAMwD,cAAc7K,kBAAkB4K,SAASD,QAAQ,EAAE,KAAK;QAE9DhD,MAAMjH,IAAI,CAAC;YACTf,MAAMgF,IAAI,CAACiG,SAAS3B,EAAE;YACtBtJ,MAAMyH,KAAK,CAACwD,SAAS7I,IAAI;YACzB,GAAGgF,WAAW,CAAC,EAAE6D,SAASvD,MAAM,EAAE;YAClC,GAAGwD,YAAY,CAAC,EAAED,SAASD,QAAQ,CAAC,CAAC,CAAC;SACvC;IACH;IAEAnG,QAAQC,GAAG,CAACkD,MAAMtC,QAAQ;AAC5B;AAEA,eAAemF,kBAAkBM,QAAgB;IAC/C,IAAI;QACF,MAAMrL,GAAGsL,IAAI,CAACD;QACdtG,QAAQC,GAAG,CAAC9E,MAAMwH,MAAM,CAAC,CAAC,kBAAkB,EAAE2D,UAAU;QACxD,MAAM,IAAIzC,QAAQ,CAACC,UAAYC,WAAWD,SAAS;QAEnD,MAAM0C,aAAanL,WAAW;QAC9B2E,QAAQC,GAAG,CAAC9E,MAAM2H,KAAK,CAAC;QACxB9C,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,OAAO,CAAC,EAAE4D,YAAY;IACnD,EAAE,OAAM;QACNxG,QAAQC,GAAG,CAAC9E,MAAMgG,GAAG,CAAC,CAAC,yBAAyB,EAAEmF,UAAU;IAC9D;AACF;AAEA,eAAeL,mBAAmBO,UAAkB;IAClDxG,QAAQC,GAAG,CAAC9E,MAAM+E,IAAI,CAACK,IAAI,CAAC;IAC5BP,QAAQC,GAAG,CAAC,IAAIO,MAAM,CAAC;IACvBR,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,OAAO,CAAC,EAAE4D,YAAY;IACjDxG,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,SAAS,kBAAkB,CAAC;IACvD5C,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,WAAW,CAAC,EAAEtH,sBAAsB,WAAW,QAAQ,CAAC;IACnF0E,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,aAAa,CAAC,EAAEpH,kBAAkB,IAAI,KAAK,IAAI,IAAI,CAAC;IAC/EwE,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,UAAU,cAAc,CAAC;IACpD5C,QAAQC,GAAG,CAAC,GAAG9E,MAAMyH,KAAK,CAAC,YAAY,CAAC,EAAE,IAAI5D,OAAOyE,kBAAkB,IAAI;AAC7E;AAEA,SAAStB,oBAAoBxE,KAAa,EAAET,QAAuB;IACjE,MAAMuJ,WAAWvJ,SAASwJ,OAAO,CAAC,CAACzE,IAAM;YAACA,EAAE1E,IAAI;eAAM0E,EAAEzE,OAAO,IAAI,EAAE;SAAE;IAEvE,OAAOiJ,SACJjK,MAAM,CAAC,CAACe;QAEP,MAAMoJ,cAAchJ,MAAMd,KAAK,CAAC,IAAIL,MAAM,CAAC,CAAC0G,OAAS3F,KAAKb,QAAQ,CAACwG,OAAOjH,MAAM;QAChF,OAAO0K,eAAe1C,KAAK2C,GAAG,CAAC,GAAGjJ,MAAM1B,MAAM,GAAG;IACnD,GACCE,KAAK,CAAC,GAAG;AACd"}