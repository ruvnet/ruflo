{"version":3,"sources":["../../../../../src/cli/simple-commands/sparc-modes/debug.js"],"sourcesContent":["// debug.js - Debugger mode orchestration template\r\nexport function getDebugOrchestration(taskDescription, memoryNamespace) {\r\n  return `\r\n## Task Orchestration Steps\r\n\r\n1. **Issue Analysis & Reproduction** (10 mins)\r\n   - Understand the reported issue: \"${taskDescription}\"\r\n   - Query relevant context and previous issues:\r\n     \\`\\`\\`bash\r\n     npx claude-flow memory query ${memoryNamespace}_bugs\r\n     npx claude-flow memory query ${memoryNamespace}_implementation\r\n     npx claude-flow memory query ${memoryNamespace}_tests\r\n     \\`\\`\\`\r\n   - Set up debugging environment:\r\n     - Enable verbose logging\r\n     - Configure debugging tools\r\n     - Prepare monitoring setup\r\n   - Reproduce the issue consistently\r\n   - Collect error messages, stack traces, and logs\r\n   - Identify affected components and dependencies\r\n   - Store findings: \\`npx claude-flow memory store ${memoryNamespace}_issue_analysis \"Issue: ${taskDescription}. Reproduction: Steps 1-3. Error: Stack trace at line X. Affected: auth-service, user-repository.\"\\`\r\n\r\n2. **Root Cause Investigation** (20 mins)\r\n   - Add strategic debug logging:\r\n     - Entry/exit points of suspect functions\r\n     - State before/after transformations\r\n     - External service call results\r\n   - Use debugging tools:\r\n     - Debugger breakpoints\r\n     - Memory profilers (if memory issue)\r\n     - Network analyzers (if API issue)\r\n   - Trace execution flow systematically:\r\n     - Follow data through the system\r\n     - Check assumptions at each step\r\n     - Verify external dependencies\r\n   - Analyze patterns:\r\n     - When does it fail? (timing, load, specific data)\r\n     - What changed recently? (code, config, dependencies)\r\n   - Avoid changing env configuration directly\r\n   - Store investigation: \\`npx claude-flow memory store ${memoryNamespace}_root_cause \"Root cause: Race condition in auth token refresh. Occurs under high load when token expires during request processing. Fix approach: Implement token refresh mutex.\"\\`\r\n\r\n3. **Solution Development** (15 mins)\r\n   - Develop targeted fix approach:\r\n     - Minimal change to resolve issue\r\n     - Maintain backward compatibility\r\n     - Consider edge cases\r\n   - Implement the solution:\r\n     - Keep changes modular\r\n     - Don't exceed 500 lines per file\r\n     - Add inline comments explaining the fix\r\n   - Add regression tests:\r\n     - Test the specific failure scenario\r\n     - Test related edge cases\r\n     - Ensure fix doesn't break existing tests\r\n   - Implement defensive coding:\r\n     - Add validation where missing\r\n     - Improve error messages\r\n     - Add circuit breakers if needed\r\n   - Store solution: \\`npx claude-flow memory store ${memoryNamespace}_solution \"Fix: Added mutex lock for token refresh. Tests: 3 regression tests added. Validation: Added token expiry check. No breaking changes.\"\\`\r\n\r\n4. **Validation & Performance Check** (10 mins)\r\n   - Run comprehensive test suite:\r\n     \\`\\`\\`bash\r\n     npm test\r\n     npm run test:integration\r\n     npm run test:e2e\r\n     \\`\\`\\`\r\n   - Verify original issue is resolved\r\n   - Check performance impact:\r\n     - Run performance benchmarks\r\n     - Monitor memory usage\r\n     - Check response times\r\n   - Test in conditions that triggered the bug\r\n   - Verify no new issues introduced\r\n   - Document the fix with context\r\n   - Store validation: \\`npx claude-flow memory store ${memoryNamespace}_debug_validation \"All tests passing. Performance impact: <5ms latency increase. Memory usage unchanged. Original issue resolved.\"\\`\r\n\r\n5. **Documentation & Cleanup** (5 mins)\r\n   - Create detailed fix documentation\r\n   - Remove debug logging (keep useful ones)\r\n   - Update error handling guides\r\n   - Create runbook for similar issues\r\n   - Submit for code review\r\n\r\n## Deliverables\r\n- Fixed code with:\r\n  - Inline comments explaining the fix\r\n  - Improved error messages\r\n  - Defensive coding additions\r\n- tests/regression/\r\n  - Test cases for the specific bug\r\n  - Edge case coverage\r\n- docs/\r\n  - DEBUG_REPORT.md (root cause analysis)\r\n  - FIX_DOCUMENTATION.md (what was changed and why)\r\n  - RUNBOOK.md (guide for similar issues)\r\n- Performance comparison report\r\n\r\n## Debugging Best Practices\r\n- Use structured logging with correlation IDs\r\n- Avoid changing production env during debugging\r\n- Keep debug changes isolated and reversible\r\n- Test fixes under same conditions as bug\r\n- Document investigation process for future reference\r\n- Consider using feature flags for gradual rollout\r\n\r\n## Next Steps\r\nAfter debugging completes:\r\n- \\`npx claude-flow sparc run security-review \"Review security impact of ${taskDescription} fix\" --non-interactive\\`\r\n- \\`npx claude-flow sparc run refinement-optimization-mode \"Refactor affected modules for better maintainability\" --non-interactive\\`\r\n- \\`npx claude-flow sparc run post-deployment-monitoring-mode \"Monitor ${taskDescription} fix in production\" --non-interactive\\``;\r\n}\r\n"],"names":["getDebugOrchestration","taskDescription","memoryNamespace"],"mappings":"AACA,OAAO,SAASA,sBAAsBC,eAAe,EAAEC,eAAe;IACpE,OAAO,CAAC;;;;qCAI2B,EAAED,gBAAgB;;;kCAGrB,EAAEC,gBAAgB;kCAClB,EAAEA,gBAAgB;kCAClB,EAAEA,gBAAgB;;;;;;;;;oDASA,EAAEA,gBAAgB,wBAAwB,EAAED,gBAAgB;;;;;;;;;;;;;;;;;;;yDAmBvD,EAAEC,gBAAgB;;;;;;;;;;;;;;;;;;;oDAmBvB,EAAEA,gBAAgB;;;;;;;;;;;;;;;;;sDAiBhB,EAAEA,gBAAgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;yEAiCC,EAAED,gBAAgB;;uEAEpB,EAAEA,gBAAgB,uCAAuC,CAAC;AACjI"}