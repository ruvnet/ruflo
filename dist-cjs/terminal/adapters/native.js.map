{
  "version": 3,
  "sources": ["../../../src/terminal/adapters/native.ts"],
  "sourcesContent": ["import * as process from 'node:process';\n/**\n * Native terminal adapter implementation\n */\n\nimport { spawn, ChildProcess } from 'child_process';\nimport { platform } from 'os';\nimport type { ITerminalAdapter, Terminal } from './base.js';\nimport type { ILogger } from '../../core/logger.js';\nimport { TerminalError, TerminalCommandError } from '../../utils/errors.js';\nimport { generateId, delay, timeout, createDeferred } from '../../utils/helpers.js';\n\n/**\n * Platform-specific shell configuration\n */\ninterface ShellConfig {\n  path: string;\n  args: string[];\n  env?: Record<string, string>;\n}\n\n/**\n * Native terminal implementation using Deno subprocess\n */\nclass NativeTerminal implements Terminal {\n  id: string;\n  pid?: number;\n  private process?: ChildProcess | undefined;\n  private encoder = new TextEncoder();\n  private decoder = new TextDecoder();\n  private shell: string;\n  private outputBuffer = '';\n  private errorBuffer = '';\n  private commandMarker: string;\n  private commandDeferred?: ReturnType<typeof createDeferred<string>> | undefined;\n  private outputListeners = new Set<(data: string) => void>();\n  private alive = true;\n  private stdoutData = '';\n  private stderrData = '';\n\n  constructor(\n    shell: string,\n    private logger: ILogger,\n  ) {\n    this.id = generateId('native-term');\n    this.shell = shell;\n    this.commandMarker = `__CLAUDE_FLOW_${this.id}__`;\n  }\n\n  async initialize(): Promise<void> {\n    try {\n      const shellConfig = this.getShellConfig();\n\n      // Start shell process\n      this.process = spawn(shellConfig.path, shellConfig.args, {\n        stdio: ['pipe', 'pipe', 'pipe'],\n        env: {\n          ...process.env,\n          ...shellConfig.env,\n          CLAUDE_FLOW_TERMINAL: 'true',\n          CLAUDE_FLOW_TERMINAL_ID: this.id,\n        },\n      });\n\n      // Get PID\n      this.pid = this.process.pid;\n\n      // Set up output handlers\n      this.setupOutputHandlers();\n\n      // Monitor process status\n      this.monitorProcess();\n\n      // Wait for shell to be ready\n      await this.waitForReady();\n\n      this.logger.debug('Native terminal initialized', {\n        id: this.id,\n        pid: this.pid,\n        shell: this.shell,\n      });\n    } catch (error) {\n      this.alive = false;\n      throw new TerminalError('Failed to create native terminal', { error });\n    }\n  }\n\n  async executeCommand(command: string): Promise<string> {\n    if (!this.process || !this.isAlive()) {\n      throw new TerminalError('Terminal is not alive');\n    }\n\n    try {\n      // Create deferred for this command\n      this.commandDeferred = createDeferred<string>();\n\n      // Clear output buffer\n      this.outputBuffer = '';\n\n      // Send command with marker\n      const markedCommand = this.wrapCommand(command);\n      await this.write(markedCommand + '\\n');\n\n      // Wait for command to complete\n      const output = await timeout(\n        this.commandDeferred.promise,\n        30000,\n        'Command execution timeout',\n      );\n\n      return output;\n    } catch (error) {\n      throw new TerminalCommandError('Failed to execute command', { command, error });\n    }\n  }\n\n  async write(data: string): Promise<void> {\n    if (!this.process || !this.isAlive()) {\n      throw new TerminalError('Terminal is not alive');\n    }\n\n    return new Promise((resolve, reject) => {\n      if (!this.process?.stdin) {\n        reject(new TerminalError('Process stdin not available'));\n        return;\n      }\n\n      this.process.stdin.write(data, (error) => {\n        if (error) {\n          reject(error);\n        } else {\n          resolve();\n        }\n      });\n    });\n  }\n\n  async read(): Promise<string> {\n    if (!this.process || !this.isAlive()) {\n      throw new TerminalError('Terminal is not alive');\n    }\n\n    // Return buffered output\n    const output = this.outputBuffer;\n    this.outputBuffer = '';\n    return output;\n  }\n\n  isAlive(): boolean {\n    return this.alive && this.process !== undefined;\n  }\n\n  async kill(): Promise<void> {\n    if (!this.process) return;\n\n    try {\n      this.alive = false;\n\n      // Close streams\n      if (this.process.stdin && !this.process.stdin.destroyed) {\n        this.process.stdin.end();\n      }\n\n      // Try graceful shutdown first\n      try {\n        await this.write('exit\\n');\n        await delay(500);\n      } catch {\n        // Ignore write errors during shutdown\n      }\n\n      // Force kill if still alive\n      try {\n        this.process.kill('SIGTERM');\n        await delay(500);\n\n        // Use SIGKILL if SIGTERM didn't work\n        if (!this.process.killed) {\n          this.process.kill('SIGKILL');\n        }\n      } catch {\n        // Process might already be dead\n      }\n    } catch (error) {\n      this.logger.warn('Error killing native terminal', { id: this.id, error });\n    } finally {\n      this.process = undefined;\n    }\n  }\n\n  /**\n   * Add output listener\n   */\n  addOutputListener(listener: (data: string) => void): void {\n    this.outputListeners.add(listener);\n  }\n\n  /**\n   * Remove output listener\n   */\n  removeOutputListener(listener: (data: string) => void): void {\n    this.outputListeners.delete(listener);\n  }\n\n  private getShellConfig(): ShellConfig {\n    const osplatform = platform();\n\n    switch (this.shell) {\n      case 'bash':\n        return {\n          path: osplatform === 'win32' ? 'C:\\\\Program Files\\\\Git\\\\bin\\\\bash.exe' : '/bin/bash',\n          args: ['--norc', '--noprofile'],\n          env: { PS1: '$ ' },\n        };\n\n      case 'zsh':\n        return {\n          path: '/bin/zsh',\n          args: ['--no-rcs'],\n          env: { PS1: '$ ' },\n        };\n\n      case 'powershell':\n        return {\n          path: osplatform === 'win32' ? 'powershell.exe' : 'pwsh',\n          args: ['-NoProfile', '-NonInteractive', '-NoLogo'],\n        };\n\n      case 'cmd':\n        return {\n          path: 'cmd.exe',\n          args: ['/Q', '/K', 'prompt $G'],\n        };\n\n      case 'sh':\n      default:\n        return {\n          path: '/bin/sh',\n          args: [],\n          env: { PS1: '$ ' },\n        };\n    }\n  }\n\n  private wrapCommand(command: string): string {\n    const osplatform = platform();\n\n    if (this.shell === 'powershell') {\n      // PowerShell command wrapping\n      return `${command}; Write-Host \"${this.commandMarker}\"`;\n    } else if (this.shell === 'cmd' && osplatform === 'win32') {\n      // Windows CMD command wrapping\n      return `${command} & echo ${this.commandMarker}`;\n    } else {\n      // Unix-like shell command wrapping\n      return `${command} && echo \"${this.commandMarker}\" || (echo \"${this.commandMarker}\"; false)`;\n    }\n  }\n\n  private setupOutputHandlers(): void {\n    if (!this.process) return;\n\n    // Handle stdout\n    this.process.stdout?.on('data', (data: Buffer) => {\n      const text = data.toString();\n      this.processOutput(text);\n    });\n\n    // Handle stderr\n    this.process.stderr?.on('data', (data: Buffer) => {\n      const text = data.toString();\n      this.errorBuffer += text;\n\n      // Also send stderr to output listeners\n      this.notifyListeners(text);\n    });\n\n    // Handle process errors\n    this.process.on('error', (error) => {\n      if (this.alive) {\n        this.logger.error('Process error', { id: this.id, error });\n      }\n    });\n  }\n\n  private processOutput(text: string): void {\n    this.outputBuffer += text;\n\n    // Notify listeners\n    this.notifyListeners(text);\n\n    // Check for command completion marker\n    const markerIndex = this.outputBuffer.indexOf(this.commandMarker);\n    if (markerIndex !== -1 && this.commandDeferred) {\n      // Extract output before marker\n      const output = this.outputBuffer.substring(0, markerIndex).trim();\n\n      // Include any stderr output\n      const fullOutput = this.errorBuffer ? `${output}\\n${this.errorBuffer}` : output;\n      this.errorBuffer = '';\n\n      // Clear buffer up to after marker\n      this.outputBuffer = this.outputBuffer\n        .substring(markerIndex + this.commandMarker.length)\n        .trim();\n\n      // Resolve pending command\n      this.commandDeferred.resolve(fullOutput);\n      this.commandDeferred = undefined;\n    }\n  }\n\n  private notifyListeners(data: string): void {\n    this.outputListeners.forEach((listener) => {\n      try {\n        listener(data);\n      } catch (error) {\n        this.logger.error('Error in output listener', { id: this.id, error });\n      }\n    });\n  }\n\n  private async monitorProcess(): Promise<void> {\n    if (!this.process) return;\n\n    this.process.on('exit', (code, signal) => {\n      this.logger.info('Terminal process exited', {\n        id: this.id,\n        code,\n        signal,\n      });\n      this.alive = false;\n\n      // Reject any pending command\n      if (this.commandDeferred) {\n        this.commandDeferred.reject(new Error('Terminal process exited'));\n      }\n    });\n\n    this.process.on('error', (error) => {\n      this.logger.error('Error monitoring process', { id: this.id, error });\n      this.alive = false;\n\n      // Reject any pending command\n      if (this.commandDeferred) {\n        this.commandDeferred.reject(error);\n      }\n    });\n  }\n\n  private async waitForReady(): Promise<void> {\n    // Send a test command to ensure shell is ready\n    const testCommand = this.shell === 'powershell' ? 'Write-Host \"READY\"' : 'echo \"READY\"';\n\n    await this.write(testCommand + '\\n');\n\n    const startTime = Date.now();\n    while (Date.now() - startTime < 5000) {\n      if (this.outputBuffer.includes('READY')) {\n        this.outputBuffer = '';\n        return;\n      }\n      await delay(100);\n    }\n\n    throw new TerminalError('Terminal failed to become ready');\n  }\n}\n\n/**\n * Native terminal adapter\n */\nexport class NativeAdapter implements ITerminalAdapter {\n  private terminals = new Map<string, NativeTerminal>();\n  private shell: string;\n\n  constructor(private logger: ILogger) {\n    // Detect available shell\n    this.shell = this.detectShell();\n  }\n\n  async initialize(): Promise<void> {\n    this.logger.info('Initializing native terminal adapter', { shell: this.shell });\n\n    // Verify shell is available\n    try {\n      const testConfig = this.getTestCommand();\n      const { spawnSync } = require('child_process');\n      const result = spawnSync(testConfig.cmd, testConfig.args, { stdio: 'ignore' });\n\n      if (result.status !== 0) {\n        throw new Error('Shell test failed');\n      }\n    } catch (error) {\n      this.logger.warn(`Shell ${this.shell} not available, falling back to sh`, { error });\n      this.shell = 'sh';\n    }\n  }\n\n  async shutdown(): Promise<void> {\n    this.logger.info('Shutting down native terminal adapter');\n\n    // Kill all terminals\n    const terminals = Array.from(this.terminals.values());\n    await Promise.all(terminals.map((term) => term.kill()));\n\n    this.terminals.clear();\n  }\n\n  async createTerminal(): Promise<Terminal> {\n    const terminal = new NativeTerminal(this.shell, this.logger);\n\n    await terminal.initialize();\n    this.terminals.set(terminal.id, terminal);\n\n    return terminal;\n  }\n\n  async destroyTerminal(terminal: Terminal): Promise<void> {\n    await terminal.kill();\n    this.terminals.delete(terminal.id);\n  }\n\n  private detectShell(): string {\n    const osplatform = platform();\n\n    if (osplatform === 'win32') {\n      // Windows shell detection\n      const comspec = process.env.COMSPEC;\n      if (comspec?.toLowerCase().includes('powershell')) {\n        return 'powershell';\n      }\n\n      // Check if PowerShell is available\n      try {\n        const { spawnSync } = require('child_process');\n        const result = spawnSync('powershell', ['-Version'], { stdio: 'ignore' });\n        if (result.status === 0) {\n          return 'powershell';\n        }\n      } catch {\n        // PowerShell not available\n      }\n\n      return 'cmd';\n    } else {\n      // Unix-like shell detection\n      const shell = process.env.SHELL;\n      if (shell) {\n        const shellName = shell.split('/').pop();\n        if (shellName && this.isShellSupported(shellName)) {\n          return shellName;\n        }\n      }\n\n      // Try common shells in order of preference\n      const shells = ['bash', 'zsh', 'sh'];\n      for (const shell of shells) {\n        try {\n          const { spawnSync } = require('child_process');\n          const result = spawnSync('which', [shell], { stdio: 'ignore' });\n          if (result.status === 0) {\n            return shell;\n          }\n        } catch {\n          // Continue to next shell\n        }\n      }\n\n      // Default to sh\n      return 'sh';\n    }\n  }\n\n  private isShellSupported(shell: string): boolean {\n    return ['bash', 'zsh', 'sh', 'fish', 'dash', 'powershell', 'cmd'].includes(shell);\n  }\n\n  private getTestCommand(): { cmd: string; args: string[] } {\n    switch (this.shell) {\n      case 'powershell':\n        return { cmd: 'powershell', args: ['-Version'] };\n      case 'cmd':\n        return { cmd: 'cmd', args: ['/C', 'echo test'] };\n      default:\n        return { cmd: this.shell, args: ['--version'] };\n    }\n  }\n}\n"],
  "mappings": "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",
  "names": ["shell"]
}
