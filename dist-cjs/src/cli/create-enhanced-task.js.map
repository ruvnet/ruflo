{"version":3,"sources":["../../../src/cli/create-enhanced-task.js"],"sourcesContent":["/**\r\n * Creates an enhanced task prompt with Claude-Flow guidance\r\n * @param {string} task - The original task description\r\n * @param {Object} flags - Command flags/options\r\n * @param {string} instanceId - Unique instance identifier\r\n * @param {string} tools - Comma-separated list of available tools\r\n * @returns {string} Enhanced task prompt\r\n */\r\nexport function createEnhancedTask(task, flags, instanceId, tools) {\r\n  let enhancedTask = `# Claude-Flow Enhanced Task\r\n\r\n## Your Task\r\n${task}\r\n\r\n## Claude-Flow System Context\r\n\r\nYou are running within the Claude-Flow orchestration system, which provides powerful features for complex task management.\r\n\r\n### Configuration\r\n- Instance ID: ${instanceId}\r\n- Mode: ${flags.mode || 'full'}\r\n- Coverage Target: ${flags.coverage || 80}%\r\n- Commit Strategy: ${flags.commit || 'phase'}\r\n${flags.config ? `- MCP Config: ${flags.config}` : ''}\r\n\r\n### Available Features\r\n\r\n1. **Memory Bank** (Always Available)\r\n   - Store data: \\`npx claude-flow memory store <key> \"<value>\"\\` - Save important data, findings, or progress\r\n   - Retrieve data: \\`npx claude-flow memory query <key>\\` - Access previously stored information\r\n   - Export memory: \\`npx claude-flow memory export <file>\\` - Export memory to file\r\n   - Import memory: \\`npx claude-flow memory import <file>\\` - Import memory from file\r\n   - Memory stats: \\`npx claude-flow memory stats\\` - Show memory usage statistics\r\n\r\n2. **System Management**\r\n   - Check status: \\`npx claude-flow status\\` - View current system/task status\r\n   - Monitor system: \\`npx claude-flow monitor\\` - Real-time system monitoring\r\n   - List agents: \\`npx claude-flow agent list\\` - See active agents\r\n   - List tasks: \\`npx claude-flow task list\\` - See active tasks\r\n\r\n3. **Tool Access**\r\n   - You have access to these tools: ${tools}\r\n   ${flags.tools ? `- Custom tools specified: ${flags.tools}` : ''}`;\r\n\r\n  if (flags.parallel) {\r\n    enhancedTask += `\r\n   - **Parallel Execution Enabled**: Use \\`npx claude-flow agent spawn <type> --name <name>\\` to spawn sub-agents\r\n   - Create tasks: \\`npx claude-flow task create <type> \"<description>\"\\`\r\n   - Assign tasks: \\`npx claude-flow task assign <task-id> <agent-id>\\`\r\n   - Break down complex tasks and delegate to specialized agents`;\r\n  }\r\n\r\n  if (flags.research) {\r\n    enhancedTask += `\r\n   - **Research Mode**: Use \\`WebFetchTool\\` for web research and information gathering`;\r\n  }\r\n\r\n  enhancedTask += `\r\n\r\n### Workflow Guidelines\r\n\r\n1. **Before Starting**:\r\n   - Check memory: \\`npx claude-flow memory query previous_work\\`\r\n   - Check memory stats: \\`npx claude-flow memory stats\\`\r\n   - Check system status: \\`npx claude-flow status\\`\r\n   - List active agents: \\`npx claude-flow agent list\\`\r\n   - List active tasks: \\`npx claude-flow task list\\`\r\n   ${flags.mode === 'backend-only' ? '- Focus on backend implementation without frontend concerns' : ''}\r\n   ${flags.mode === 'frontend-only' ? '- Focus on frontend implementation without backend concerns' : ''}\r\n   ${flags.mode === 'api-only' ? '- Focus on API design and implementation' : ''}\r\n\r\n2. **During Execution**:\r\n   - Store findings: \\`npx claude-flow memory store findings \"your data here\"\\`\r\n   - Save checkpoints: \\`npx claude-flow memory store progress_${task.replace(/\\s+/g, '_')} \"current status\"\\`\r\n   ${flags.parallel ? '- Spawn agents: `npx claude-flow agent spawn researcher --name \"research-agent\"`' : ''}\r\n   ${flags.parallel ? '- Create tasks: `npx claude-flow task create implementation \"implement feature X\"`' : ''}\r\n   ${flags.parallel ? '- Assign tasks: `npx claude-flow task assign <task-id> <agent-id>`' : ''}\r\n   ${flags.coverage ? `- Ensure test coverage meets ${flags.coverage}% target` : ''}\r\n   ${flags.commit === 'phase' ? '- Commit changes after completing each major phase' : ''}\r\n   ${flags.commit === 'feature' ? '- Commit changes after each feature is complete' : ''}\r\n   ${flags.commit === 'manual' ? '- Only commit when explicitly requested' : ''}\r\n\r\n3. **Best Practices**:\r\n   - Use the Bash tool to run \\`npx claude-flow\\` commands\r\n   - Store data as JSON strings for complex structures\r\n   - Query memory before starting to check for existing work\r\n   - Use descriptive keys for memory storage\r\n   - Monitor progress: \\`npx claude-flow monitor\\`\r\n   ${flags.parallel ? '- Coordinate with other agents through shared memory' : ''}\r\n   ${flags.research ? '- Store research findings: `npx claude-flow memory store research_findings \"data\"`' : ''}\r\n   ${flags.noPermissions ? '- Running with --no-permissions, all operations will execute without prompts' : ''}\r\n   ${flags.verbose ? '- Verbose mode enabled, provide detailed output and explanations' : ''}\r\n\r\n## Example Commands\r\n\r\nTo interact with Claude-Flow, use the Bash tool:\r\n\r\n\\`\\`\\`bash\r\n# Memory Operations\r\nBash(\"npx claude-flow memory query previous_work\")\r\nBash(\"npx claude-flow memory store task_analysis '{\\\\\"status\\\\\": \\\\\"completed\\\\\", \\\\\"findings\\\\\": [...]}'\")\r\nBash(\"npx claude-flow memory stats\")\r\nBash(\"npx claude-flow memory export backup.json\")\r\n\r\n# System Management\r\nBash(\"npx claude-flow status\")\r\nBash(\"npx claude-flow monitor\")  # Real-time monitoring\r\nBash(\"npx claude-flow agent list\")\r\nBash(\"npx claude-flow task list --verbose\")\r\n${\r\n  flags.parallel\r\n    ? `\r\n# Parallel Execution (enabled for this instance)\r\nBash(\"npx claude-flow agent spawn researcher --name research-bot\")\r\nBash(\"npx claude-flow agent spawn coder --name code-bot\")\r\nBash(\"npx claude-flow task create research 'Analyze best practices'\")\r\nBash(\"npx claude-flow task create implementation 'Implement auth module'\")\r\nBash(\"npx claude-flow task assign task-123 agent-456\")`\r\n    : ''\r\n}\r\n${\r\n  flags.research\r\n    ? `\r\n# Research Operations (research mode enabled)\r\n# Use WebFetchTool for web research, then store findings\r\nBash(\"npx claude-flow memory store web_research_urls '[\\\\\"url1\\\\\", \\\\\"url2\\\\\"]'\")\r\nBash(\"npx claude-flow memory store research_summary 'Key findings from research...'\")`\r\n    : ''\r\n}\r\n\r\n# Configuration Management\r\nBash(\"npx claude-flow config show\")\r\nBash(\"npx claude-flow config get orchestrator.maxConcurrentTasks\")\r\nBash(\"npx claude-flow config set orchestrator.maxConcurrentTasks 20\")\r\n\r\n# Workflow Execution\r\nBash(\"npx claude-flow workflow examples/development-config.json\")\r\nBash(\"npx claude-flow workflow examples/research-workflow.json --async\")\r\n\\`\\`\\`\r\n\r\n## Mode-Specific Guidelines\r\n${\r\n  flags.mode === 'backend-only'\r\n    ? `\r\n### Backend-Only Mode\r\n- Focus exclusively on server-side implementation\r\n- Prioritize API design, database schemas, and business logic\r\n- Ignore frontend/UI considerations\r\n- Test coverage should emphasize unit and integration tests`\r\n    : ''\r\n}\r\n${\r\n  flags.mode === 'frontend-only'\r\n    ? `\r\n### Frontend-Only Mode\r\n- Focus exclusively on client-side implementation\r\n- Prioritize UI/UX, component design, and user interactions\r\n- Assume backend APIs are already available\r\n- Test coverage should emphasize component and E2E tests`\r\n    : ''\r\n}\r\n${\r\n  flags.mode === 'api-only'\r\n    ? `\r\n### API-Only Mode\r\n- Focus exclusively on API design and implementation\r\n- Prioritize RESTful principles, documentation, and contracts\r\n- Include comprehensive API documentation\r\n- Test coverage should emphasize API endpoint testing`\r\n    : ''\r\n}\r\n${\r\n  flags.mode === 'full' || !flags.mode\r\n    ? `\r\n### Full Stack Mode (Default)\r\n- Consider both frontend and backend requirements\r\n- Ensure proper integration between all layers\r\n- Balance test coverage across all components\r\n- Document both API contracts and user interfaces`\r\n    : ''\r\n}\r\n\r\n## Commit Strategy\r\n${flags.commit === 'phase' ? `- **Phase Commits**: Commit after completing major phases (planning, implementation, testing)` : ''}\r\n${flags.commit === 'feature' ? `- **Feature Commits**: Commit after each feature or module is complete` : ''}\r\n${flags.commit === 'manual' ? `- **Manual Commits**: Only commit when explicitly requested by the user` : ''}\r\n${!flags.commit ? `- **Default (Phase)**: Commit after completing major phases` : ''}\r\n\r\n## Additional Guidelines\r\n${\r\n  flags.noPermissions\r\n    ? `\r\n### No-Permissions Mode\r\n- All file operations will execute without confirmation prompts\r\n- Be extra careful with destructive operations\r\n- Ensure all changes are intentional and well-tested`\r\n    : ''\r\n}\r\n${\r\n  flags.verbose\r\n    ? `\r\n### Verbose Mode\r\n- Provide detailed explanations for all actions\r\n- Include reasoning behind technical decisions\r\n- Show intermediate steps and thought processes\r\n- Log all command outputs comprehensively`\r\n    : ''\r\n}\r\n\r\nNow, please proceed with the task: ${task}`;\r\n\r\n  return enhancedTask;\r\n}\r\n"],"names":["createEnhancedTask","task","flags","instanceId","tools","enhancedTask","mode","coverage","commit","config","parallel","research","replace","noPermissions","verbose"],"mappings":"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"}