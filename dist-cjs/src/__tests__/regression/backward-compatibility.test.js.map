{"version":3,"sources":["../../../../src/__tests__/regression/backward-compatibility.test.ts"],"sourcesContent":["/**\r\n * Backward Compatibility Regression Tests\r\n * Phase 7: Comprehensive Testing & Validation\r\n *\r\n * Ensures existing functionality still works with SDK integration\r\n */\r\n\r\nimport { describe, it, expect, beforeEach } from '@jest/globals';\r\nimport { ClaudeFlowSDKAdapter } from '../../sdk/sdk-config.js';\r\nimport { SDKCompatibilityLayer } from '../../sdk/compatibility-layer.js';\r\nimport { TaskExecutorSDK } from '../../swarm/executor-sdk.js';\r\nimport { ClaudeClientV25 } from '../../api/claude-client-v2.5.js';\r\n\r\ndescribe('Backward Compatibility Tests', () => {\r\n  let adapter: ClaudeFlowSDKAdapter;\r\n  let compatibility: SDKCompatibilityLayer;\r\n\r\n  beforeEach(() => {\r\n    adapter = new ClaudeFlowSDKAdapter({\r\n      apiKey: 'test-api-key',\r\n      swarmMode: true,\r\n    });\r\n    compatibility = new SDKCompatibilityLayer(adapter);\r\n  });\r\n\r\n  describe('Legacy API Compatibility', () => {\r\n    it('should support legacy model names', () => {\r\n      const legacyModels = [\r\n        'claude-2.1',\r\n        'claude-2.0',\r\n        'claude-instant-1.2',\r\n        'claude-3-opus-20240229',\r\n        'claude-3-sonnet-20240229',\r\n        'claude-3-haiku-20240307',\r\n      ];\r\n\r\n      legacyModels.forEach((model) => {\r\n        const request = compatibility.mapLegacyRequest({\r\n          model,\r\n          messages: [{ role: 'user', content: 'test' }],\r\n          max_tokens: 1024,\r\n        });\r\n\r\n        expect(request.model).toBeDefined();\r\n        expect(request.messages).toHaveLength(1);\r\n      });\r\n    });\r\n\r\n    it('should maintain legacy request format', () => {\r\n      const legacyRequest = {\r\n        model: 'claude-2.1',\r\n        messages: [{ role: 'user', content: 'test' }],\r\n        max_tokens: 1024,\r\n        temperature: 0.7,\r\n        top_p: 0.9,\r\n        top_k: 5,\r\n        system: 'You are a helpful assistant',\r\n        metadata: { user_id: 'user-123' },\r\n        stop_sequences: ['STOP'],\r\n      };\r\n\r\n      const sdkRequest = compatibility.mapLegacyRequest(legacyRequest);\r\n\r\n      expect(sdkRequest.model).toBe('claude-2.1');\r\n      expect(sdkRequest.messages).toEqual(legacyRequest.messages);\r\n      expect(sdkRequest.max_tokens).toBe(1024);\r\n      expect(sdkRequest.temperature).toBe(0.7);\r\n      expect(sdkRequest.top_p).toBe(0.9);\r\n      expect(sdkRequest.top_k).toBe(5);\r\n      expect(sdkRequest.system).toBe(legacyRequest.system);\r\n      expect(sdkRequest.stop_sequences).toEqual(['STOP']);\r\n    });\r\n\r\n    it('should convert SDK responses to legacy format', () => {\r\n      const sdkResponse = {\r\n        id: 'msg-123',\r\n        type: 'message' as const,\r\n        role: 'assistant' as const,\r\n        content: [{ type: 'text' as const, text: 'Response text' }],\r\n        model: 'claude-3-sonnet-20240229',\r\n        stop_reason: 'end_turn' as const,\r\n        stop_sequence: null,\r\n        usage: { input_tokens: 10, output_tokens: 20 },\r\n      };\r\n\r\n      const legacyResponse = compatibility.mapSDKResponse(sdkResponse as any);\r\n\r\n      expect(legacyResponse.id).toBe('msg-123');\r\n      expect(legacyResponse.type).toBe('message');\r\n      expect(legacyResponse.role).toBe('assistant');\r\n      expect(legacyResponse.content[0].text).toBe('Response text');\r\n      expect(legacyResponse.usage.input_tokens).toBe(10);\r\n    });\r\n\r\n    it('should support deprecated executeWithRetry method', async () => {\r\n      let callCount = 0;\r\n      const fn = async () => {\r\n        callCount++;\r\n        return 'success';\r\n      };\r\n\r\n      const result = await compatibility.executeWithRetry(fn, {\r\n        maxRetries: 3,\r\n      });\r\n\r\n      expect(result).toBe('success');\r\n      expect(callCount).toBe(1);\r\n    });\r\n\r\n    it('should log deprecation warnings only once', () => {\r\n      compatibility.calculateBackoff(1);\r\n      compatibility.calculateBackoff(2);\r\n      compatibility.calculateBackoff(3);\r\n\r\n      const warnings = compatibility.getDeprecationReport();\r\n      expect(warnings).toContain('calculateBackoff');\r\n      expect(warnings.filter((w) => w === 'calculateBackoff').length).toBe(1);\r\n    });\r\n  });\r\n\r\n  describe('Legacy Configuration Options', () => {\r\n    it('should support ANTHROPIC_API_KEY environment variable', () => {\r\n      process.env.ANTHROPIC_API_KEY = 'env-api-key';\r\n\r\n      const newAdapter = new ClaudeFlowSDKAdapter({});\r\n      expect(newAdapter.getConfig().apiKey).toBe('env-api-key');\r\n\r\n      delete process.env.ANTHROPIC_API_KEY;\r\n    });\r\n\r\n    it('should support CLAUDE_API_KEY environment variable', () => {\r\n      process.env.CLAUDE_API_KEY = 'claude-api-key';\r\n      delete process.env.ANTHROPIC_API_KEY;\r\n\r\n      const newAdapter = new ClaudeFlowSDKAdapter({});\r\n      expect(newAdapter.getConfig().apiKey).toBe('claude-api-key');\r\n\r\n      delete process.env.CLAUDE_API_KEY;\r\n    });\r\n\r\n    it('should maintain default configuration values', () => {\r\n      const defaultAdapter = new ClaudeFlowSDKAdapter({\r\n        apiKey: 'test-key',\r\n      });\r\n\r\n      const config = defaultAdapter.getConfig();\r\n\r\n      expect(config.maxRetries).toBe(3);\r\n      expect(config.timeout).toBe(60000);\r\n      expect(config.swarmMode).toBe(true);\r\n      expect(config.persistenceEnabled).toBe(true);\r\n      expect(config.checkpointInterval).toBe(60000);\r\n    });\r\n\r\n    it('should allow custom configuration overrides', () => {\r\n      const customAdapter = new ClaudeFlowSDKAdapter({\r\n        apiKey: 'test-key',\r\n        maxRetries: 5,\r\n        timeout: 120000,\r\n        swarmMode: false,\r\n        persistenceEnabled: false,\r\n        checkpointInterval: 90000,\r\n      });\r\n\r\n      const config = customAdapter.getConfig();\r\n\r\n      expect(config.maxRetries).toBe(5);\r\n      expect(config.timeout).toBe(120000);\r\n      expect(config.swarmMode).toBe(false);\r\n      expect(config.persistenceEnabled).toBe(false);\r\n      expect(config.checkpointInterval).toBe(90000);\r\n    });\r\n  });\r\n\r\n  describe('Legacy Task Execution', () => {\r\n    it('should maintain task structure compatibility', () => {\r\n      const legacyTask = {\r\n        id: 'task-123',\r\n        type: 'code_generation',\r\n        description: 'Generate code',\r\n        priority: 'high' as const,\r\n        status: 'pending' as const,\r\n        dependencies: ['task-100'],\r\n      };\r\n\r\n      // Task structure should remain unchanged\r\n      expect(legacyTask.id).toBe('task-123');\r\n      expect(legacyTask.type).toBe('code_generation');\r\n      expect(legacyTask.dependencies).toEqual(['task-100']);\r\n    });\r\n\r\n    it('should maintain agent state compatibility', () => {\r\n      const legacyAgent = {\r\n        id: 'agent-123',\r\n        type: 'coder',\r\n        status: 'idle' as const,\r\n        capabilities: ['code_generation', 'testing'],\r\n        currentTask: null,\r\n        taskHistory: [],\r\n        metrics: {\r\n          tasksCompleted: 0,\r\n          averageExecutionTime: 0,\r\n          successRate: 0,\r\n        },\r\n      };\r\n\r\n      // Agent structure should remain unchanged\r\n      expect(legacyAgent.type).toBe('coder');\r\n      expect(legacyAgent.capabilities).toContain('code_generation');\r\n      expect(legacyAgent.metrics).toBeDefined();\r\n    });\r\n\r\n    it('should maintain execution result format', () => {\r\n      const legacyResult = {\r\n        success: true,\r\n        output: 'Task completed',\r\n        errors: [],\r\n        executionTime: 1500,\r\n        tokensUsed: 250,\r\n        retryCount: 0,\r\n        checkpointId: 'checkpoint-123',\r\n      };\r\n\r\n      // Result format should remain unchanged\r\n      expect(legacyResult.success).toBe(true);\r\n      expect(legacyResult.output).toBe('Task completed');\r\n      expect(legacyResult.errors).toHaveLength(0);\r\n      expect(legacyResult.tokensUsed).toBe(250);\r\n    });\r\n  });\r\n\r\n  describe('Legacy Error Handling', () => {\r\n    it('should maintain error type compatibility', () => {\r\n      const errorTypes = [\r\n        'ClaudeAPIError',\r\n        'ClaudeAuthenticationError',\r\n        'ClaudeRateLimitError',\r\n        'ClaudeValidationError',\r\n      ];\r\n\r\n      errorTypes.forEach((errorType) => {\r\n        expect(errorType).toMatch(/Claude.*Error/);\r\n      });\r\n    });\r\n\r\n    it('should preserve error message format', () => {\r\n      const legacyError = {\r\n        name: 'ClaudeAPIError',\r\n        message: 'API request failed',\r\n        status: 500,\r\n        details: { retries: 3 },\r\n      };\r\n\r\n      expect(legacyError.name).toContain('Error');\r\n      expect(legacyError.message).toBeDefined();\r\n      expect(legacyError.status).toBe(500);\r\n    });\r\n\r\n    it('should maintain retry behavior on rate limits', async () => {\r\n      let attempts = 0;\r\n      const maxRetries = 3;\r\n\r\n      const retryFunction = async () => {\r\n        attempts++;\r\n        if (attempts < maxRetries) {\r\n          throw new Error('Rate limit');\r\n        }\r\n        return 'success';\r\n      };\r\n\r\n      try {\r\n        const result = await compatibility.executeWithRetry(retryFunction, {\r\n          maxRetries,\r\n        });\r\n        expect(result).toBe('success');\r\n        expect(attempts).toBe(maxRetries);\r\n      } catch (error) {\r\n        // Should not reach here\r\n        expect(true).toBe(false);\r\n      }\r\n    });\r\n  });\r\n\r\n  describe('Legacy Event Emission', () => {\r\n    it('should maintain event names and payloads', () => {\r\n      const legacyEvents = [\r\n        { name: 'request:start', payload: { requestId: 'req-123' } },\r\n        { name: 'request:success', payload: { response: {} } },\r\n        { name: 'request:error', payload: { error: {} } },\r\n        { name: 'task:start', payload: { taskId: 'task-123' } },\r\n        { name: 'task:complete', payload: { result: {} } },\r\n        { name: 'task:error', payload: { error: {} } },\r\n      ];\r\n\r\n      legacyEvents.forEach((event) => {\r\n        expect(event.name).toMatch(/^(request|task):/);\r\n        expect(event.payload).toBeDefined();\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('Legacy CLI Integration', () => {\r\n    it('should maintain CLI command structure', () => {\r\n      const legacyCommands = {\r\n        'swarm init': { topology: 'mesh', maxAgents: 5 },\r\n        'agent spawn': { type: 'coder', capabilities: [] },\r\n        'task orchestrate': { task: 'test', strategy: 'parallel' },\r\n        'swarm status': {},\r\n      };\r\n\r\n      Object.keys(legacyCommands).forEach((command) => {\r\n        expect(command).toMatch(/^(swarm|agent|task)/);\r\n      });\r\n    });\r\n\r\n    it('should maintain CLI output format', () => {\r\n      const legacyOutput = {\r\n        status: 'success',\r\n        data: { swarmId: 'swarm-123' },\r\n        timestamp: Date.now(),\r\n      };\r\n\r\n      expect(legacyOutput.status).toBe('success');\r\n      expect(legacyOutput.data).toBeDefined();\r\n      expect(legacyOutput.timestamp).toBeGreaterThan(0);\r\n    });\r\n  });\r\n\r\n  describe('Legacy Memory Operations', () => {\r\n    it('should maintain memory key format', () => {\r\n      const legacyKeys = [\r\n        'swarm/status',\r\n        'swarm/agents',\r\n        'swarm/tasks',\r\n        'coordination/state',\r\n        'metrics/performance',\r\n      ];\r\n\r\n      legacyKeys.forEach((key) => {\r\n        expect(key).toMatch(/^[a-z]+\\/[a-z]+$/);\r\n      });\r\n    });\r\n\r\n    it('should maintain memory namespace structure', () => {\r\n      const legacyNamespaces = ['default', 'coordination', 'metrics', 'cache'];\r\n\r\n      legacyNamespaces.forEach((namespace) => {\r\n        expect(namespace).toMatch(/^[a-z]+$/);\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('Legacy Hook System', () => {\r\n    it('should maintain hook event names', () => {\r\n      const legacyHooks = [\r\n        'pre-task',\r\n        'post-task',\r\n        'pre-edit',\r\n        'post-edit',\r\n        'session-start',\r\n        'session-end',\r\n        'session-restore',\r\n      ];\r\n\r\n      legacyHooks.forEach((hook) => {\r\n        expect(hook).toMatch(/^(pre|post|session)-/);\r\n      });\r\n    });\r\n\r\n    it('should maintain hook payload structure', () => {\r\n      const legacyHookPayload = {\r\n        hookName: 'pre-task',\r\n        timestamp: Date.now(),\r\n        metadata: { taskId: 'task-123' },\r\n      };\r\n\r\n      expect(legacyHookPayload.hookName).toBeDefined();\r\n      expect(legacyHookPayload.timestamp).toBeGreaterThan(0);\r\n      expect(legacyHookPayload.metadata).toBeDefined();\r\n    });\r\n  });\r\n\r\n  describe('Legacy Metrics System', () => {\r\n    it('should maintain metrics structure', () => {\r\n      const legacyMetrics = {\r\n        taskMetrics: {\r\n          totalTasks: 10,\r\n          completedTasks: 8,\r\n          failedTasks: 2,\r\n        },\r\n        performanceMetrics: {\r\n          averageExecutionTime: 1500,\r\n          totalExecutionTime: 15000,\r\n        },\r\n        systemMetrics: {\r\n          memoryUsage: 0.5,\r\n          cpuUsage: 0.3,\r\n        },\r\n      };\r\n\r\n      expect(legacyMetrics.taskMetrics).toBeDefined();\r\n      expect(legacyMetrics.performanceMetrics).toBeDefined();\r\n      expect(legacyMetrics.systemMetrics).toBeDefined();\r\n    });\r\n\r\n    it('should maintain usage statistics format', () => {\r\n      const stats = adapter.getUsageStats();\r\n\r\n      expect(stats).toHaveProperty('totalTokens');\r\n      expect(stats).toHaveProperty('messageCount');\r\n      expect(typeof stats.totalTokens).toBe('number');\r\n      expect(typeof stats.messageCount).toBe('number');\r\n    });\r\n  });\r\n\r\n  describe('Legacy Swarm Coordination', () => {\r\n    it('should maintain swarm topology types', () => {\r\n      const legacyTopologies = ['mesh', 'hierarchical', 'ring', 'star'];\r\n\r\n      legacyTopologies.forEach((topology) => {\r\n        expect(['mesh', 'hierarchical', 'ring', 'star']).toContain(topology);\r\n      });\r\n    });\r\n\r\n    it('should maintain agent types', () => {\r\n      const legacyAgentTypes = [\r\n        'researcher',\r\n        'coder',\r\n        'analyst',\r\n        'optimizer',\r\n        'coordinator',\r\n      ];\r\n\r\n      legacyAgentTypes.forEach((type) => {\r\n        expect([\r\n          'researcher',\r\n          'coder',\r\n          'analyst',\r\n          'optimizer',\r\n          'coordinator',\r\n        ]).toContain(type);\r\n      });\r\n    });\r\n\r\n    it('should maintain coordination strategy types', () => {\r\n      const legacyStrategies = ['balanced', 'specialized', 'adaptive'];\r\n\r\n      legacyStrategies.forEach((strategy) => {\r\n        expect(['balanced', 'specialized', 'adaptive']).toContain(strategy);\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('Version Migration', () => {\r\n    it('should handle v2.0.0 to v2.5.0 migration', () => {\r\n      // v2.0.0 format\r\n      const v2Config = {\r\n        apiKey: 'test-key',\r\n        customRetryLogic: true, // deprecated\r\n        customErrorHandling: true, // deprecated\r\n      };\r\n\r\n      // v2.5.0 should ignore deprecated fields\r\n      const newAdapter = new ClaudeFlowSDKAdapter({\r\n        apiKey: v2Config.apiKey,\r\n      });\r\n\r\n      expect(newAdapter.getConfig().apiKey).toBe('test-key');\r\n    });\r\n\r\n    it('should provide migration warnings for deprecated features', () => {\r\n      const deprecatedFeatures = [\r\n        'calculateBackoff',\r\n        'persistToDisk',\r\n        'executeValidations',\r\n      ];\r\n\r\n      deprecatedFeatures.forEach((feature) => {\r\n        if (feature === 'calculateBackoff') {\r\n          compatibility.calculateBackoff(1);\r\n        }\r\n      });\r\n\r\n      const warnings = compatibility.getDeprecationReport();\r\n      expect(warnings.length).toBeGreaterThan(0);\r\n    });\r\n  });\r\n\r\n  describe('Integration with Existing Codebase', () => {\r\n    it('should work with existing executor instances', () => {\r\n      const executor = new TaskExecutorSDK({\r\n        apiKey: 'test-key',\r\n        swarmMode: true,\r\n      });\r\n\r\n      expect(executor).toBeDefined();\r\n      expect(executor.getExecutionStats).toBeDefined();\r\n      expect(executor.executeTask).toBeDefined();\r\n    });\r\n\r\n    it('should work with existing client instances', () => {\r\n      const client = new ClaudeClientV25(\r\n        {\r\n          apiKey: 'test-key',\r\n          enableSwarmMode: true,\r\n        },\r\n        undefined\r\n      );\r\n\r\n      expect(client).toBeDefined();\r\n      expect(client.makeRequest).toBeDefined();\r\n      expect(client.validateConfiguration).toBeDefined();\r\n    });\r\n\r\n    it('should preserve all existing public APIs', () => {\r\n      // Verify SDK Adapter APIs\r\n      expect(adapter.getSDK).toBeDefined();\r\n      expect(adapter.getConfig).toBeDefined();\r\n      expect(adapter.createMessage).toBeDefined();\r\n      expect(adapter.validateConfiguration).toBeDefined();\r\n      expect(adapter.getUsageStats).toBeDefined();\r\n\r\n      // Verify Compatibility Layer APIs\r\n      expect(compatibility.executeWithRetry).toBeDefined();\r\n      expect(compatibility.mapLegacyRequest).toBeDefined();\r\n      expect(compatibility.mapSDKResponse).toBeDefined();\r\n      expect(compatibility.getDeprecationReport).toBeDefined();\r\n    });\r\n  });\r\n});"],"names":["describe","it","expect","beforeEach","ClaudeFlowSDKAdapter","SDKCompatibilityLayer","TaskExecutorSDK","ClaudeClientV25","adapter","compatibility","apiKey","swarmMode","legacyModels","forEach","model","request","mapLegacyRequest","messages","role","content","max_tokens","toBeDefined","toHaveLength","legacyRequest","temperature","top_p","top_k","system","metadata","user_id","stop_sequences","sdkRequest","toBe","toEqual","sdkResponse","id","type","text","stop_reason","stop_sequence","usage","input_tokens","output_tokens","legacyResponse","mapSDKResponse","callCount","fn","result","executeWithRetry","maxRetries","calculateBackoff","warnings","getDeprecationReport","toContain","filter","w","length","process","env","ANTHROPIC_API_KEY","newAdapter","getConfig","CLAUDE_API_KEY","defaultAdapter","config","timeout","persistenceEnabled","checkpointInterval","customAdapter","legacyTask","description","priority","status","dependencies","legacyAgent","capabilities","currentTask","taskHistory","metrics","tasksCompleted","averageExecutionTime","successRate","legacyResult","success","output","errors","executionTime","tokensUsed","retryCount","checkpointId","errorTypes","errorType","toMatch","legacyError","name","message","details","retries","attempts","retryFunction","Error","error","legacyEvents","payload","requestId","response","taskId","event","legacyCommands","topology","maxAgents","task","strategy","Object","keys","command","legacyOutput","data","swarmId","timestamp","Date","now","toBeGreaterThan","legacyKeys","key","legacyNamespaces","namespace","legacyHooks","hook","legacyHookPayload","hookName","legacyMetrics","taskMetrics","totalTasks","completedTasks","failedTasks","performanceMetrics","totalExecutionTime","systemMetrics","memoryUsage","cpuUsage","stats","getUsageStats","toHaveProperty","totalTokens","messageCount","legacyTopologies","legacyAgentTypes","legacyStrategies","v2Config","customRetryLogic","customErrorHandling","deprecatedFeatures","feature","executor","getExecutionStats","executeTask","client","enableSwarmMode","undefined","makeRequest","validateConfiguration","getSDK","createMessage"],"mappings":"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"}