{"version":3,"sources":["../../../src/task/commands.ts"],"sourcesContent":["// Task command creators\r\nimport type { TaskCommandContext } from './types.js';\r\n\r\nexport function createTaskCreateCommand(context: TaskCommandContext) {\r\n  return {\r\n    name: 'create',\r\n    description: 'Create a new task',\r\n    execute: async (args: any) => {\r\n      try {\r\n        const task = await context.taskEngine.createTask(args);\r\n        context.logger?.info('Task created successfully', { taskId: task.id });\r\n        return task;\r\n      } catch (error) {\r\n        context.logger?.error('Failed to create task', error);\r\n        throw error;\r\n      }\r\n    },\r\n  };\r\n}\r\n\r\nexport function createTaskListCommand(context: TaskCommandContext) {\r\n  return {\r\n    name: 'list',\r\n    description: 'List all tasks',\r\n    execute: async (filter?: any, sort?: any, limit?: number, offset?: number) => {\r\n      try {\r\n        const result = await context.taskEngine.listTasks(filter, sort, limit, offset);\r\n        context.logger?.info('Tasks listed successfully', { count: result.tasks.length });\r\n        return result;\r\n      } catch (error) {\r\n        context.logger?.error('Failed to list tasks', error);\r\n        throw error;\r\n      }\r\n    },\r\n  };\r\n}\r\n\r\nexport function createTaskStatusCommand(context: TaskCommandContext) {\r\n  return {\r\n    name: 'status',\r\n    description: 'Get task status',\r\n    execute: async (taskId: string) => {\r\n      try {\r\n        const status = await context.taskEngine.getTaskStatus(taskId);\r\n        if (!status) {\r\n          throw new Error(`Task ${taskId} not found`);\r\n        }\r\n        context.logger?.info('Task status retrieved', { taskId });\r\n        return status;\r\n      } catch (error) {\r\n        context.logger?.error('Failed to get task status', error);\r\n        throw error;\r\n      }\r\n    },\r\n  };\r\n}\r\n\r\nexport function createTaskCancelCommand(context: TaskCommandContext) {\r\n  return {\r\n    name: 'cancel',\r\n    description: 'Cancel a task',\r\n    execute: async (\r\n      taskId: string,\r\n      reason: string = 'User requested',\r\n      rollback: boolean = true,\r\n    ) => {\r\n      try {\r\n        await context.taskEngine.cancelTask(taskId, reason, rollback);\r\n        context.logger?.info('Task cancelled successfully', { taskId, reason });\r\n        return { success: true, taskId, reason };\r\n      } catch (error) {\r\n        context.logger?.error('Failed to cancel task', error);\r\n        throw error;\r\n      }\r\n    },\r\n  };\r\n}\r\n\r\nexport function createTaskWorkflowCommand(context: TaskCommandContext) {\r\n  return {\r\n    name: 'workflow',\r\n    description: 'Manage task workflows',\r\n    execute: async (action: 'create' | 'execute' | 'list' | 'get', ...args: any[]) => {\r\n      try {\r\n        switch (action) {\r\n          case 'create':\r\n            const [workflowData] = args;\r\n            const createdWorkflow = await context.taskEngine.createWorkflow(workflowData);\r\n            context.logger?.info('Workflow created successfully', {\r\n              workflowId: createdWorkflow.id,\r\n            });\r\n            return createdWorkflow;\r\n          case 'execute':\r\n            const [workflowToExecute] = args;\r\n            await context.taskEngine.executeWorkflow(workflowToExecute);\r\n            context.logger?.info('Workflow execution started', {\r\n              workflowId: workflowToExecute.id,\r\n            });\r\n            return { success: true, workflowId: workflowToExecute.id };\r\n          case 'list':\r\n            context.logger?.info('Workflow list requested');\r\n            return { workflows: [] }; // Would need additional implementation\r\n          case 'get':\r\n            const [workflowId] = args;\r\n            context.logger?.info('Workflow details requested', { workflowId });\r\n            return { workflowId }; // Would need additional implementation\r\n          default:\r\n            throw new Error(`Unknown workflow action: ${action}`);\r\n        }\r\n      } catch (error) {\r\n        context.logger?.error('Workflow operation failed', error);\r\n        throw error;\r\n      }\r\n    },\r\n  };\r\n}\r\n"],"names":["createTaskCreateCommand","context","name","description","execute","args","task","taskEngine","createTask","logger","info","taskId","id","error","createTaskListCommand","filter","sort","limit","offset","result","listTasks","count","tasks","length","createTaskStatusCommand","status","getTaskStatus","Error","createTaskCancelCommand","reason","rollback","cancelTask","success","createTaskWorkflowCommand","action","workflowData","createdWorkflow","createWorkflow","workflowId","workflowToExecute","executeWorkflow","workflows"],"mappings":"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"}