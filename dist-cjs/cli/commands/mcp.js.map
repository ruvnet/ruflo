{
  "version": 3,
  "sources": ["../../../src/cli/commands/mcp.ts"],
  "sourcesContent": ["/**\n * MCP command for Claude-Flow\n */\n\nimport { Command } from '@cliffy/command';\nimport chalk from 'chalk';\nimport { logger } from '../../core/logger.js';\nimport { configManager } from '../../core/config.js';\nimport { MCPServer } from '../../mcp/server.js';\nimport { eventBus } from '../../core/event-bus.js';\n\nlet mcpServer: MCPServer | null = null;\n\nexport const mcpCommand = new Command()\n  .description('Manage MCP server and tools')\n  .action(() => {\n    console.log(chalk.yellow('Please specify a subcommand:'));\n    console.log('  start   - Start the MCP server');\n    console.log('  stop    - Stop the MCP server');\n    console.log('  status  - Show MCP server status');\n    console.log('  tools   - List available MCP tools');\n    console.log('  config  - Show MCP configuration');\n    console.log('  restart - Restart the MCP server');\n    console.log('  logs    - Show MCP server logs');\n  })\n  .command(\n    'start',\n    new Command()\n      .description('Start the MCP server')\n      .option('-p, --port <port:number>', 'Port for MCP server', { default: 3000 })\n      .option('-h, --host <host:string>', 'Host for MCP server', { default: 'localhost' })\n      .option('--transport <transport:string>', 'Transport type (stdio, http)', {\n        default: 'stdio',\n      })\n      .action(async (options: any) => {\n        try {\n          const config = await configManager.load();\n\n          // Override with CLI options\n          const mcpConfig = {\n            ...config.mcp,\n            port: options.port,\n            host: options.host,\n            transport: options.transport,\n          };\n\n          mcpServer = new MCPServer(mcpConfig, eventBus, logger);\n          await mcpServer.start();\n\n          console.log(chalk.green(`\u2705 MCP server started on ${options.host}:${options.port}`));\n          console.log(chalk.cyan(`\uD83D\uDCE1 Server URL: http://${options.host}:${options.port}`));\n          console.log(chalk.cyan(`\uD83D\uDD27 Available tools: Research, Code, Terminal, Memory`));\n          console.log(\n            chalk.cyan(`\uD83D\uDCDA API documentation: http://${options.host}:${options.port}/docs`),\n          );\n        } catch (error) {\n          console.error(chalk.red(`\u274C Failed to start MCP server: ${(error as Error).message}`));\n          process.exit(1);\n        }\n      }),\n  )\n  .command(\n    'stop',\n    new Command().description('Stop the MCP server').action(async () => {\n      try {\n        if (mcpServer) {\n          await mcpServer.stop();\n          mcpServer = null;\n          console.log(chalk.green('\u2705 MCP server stopped'));\n        } else {\n          console.log(chalk.yellow('\u26A0\uFE0F  MCP server is not running'));\n        }\n      } catch (error) {\n        console.error(chalk.red(`\u274C Failed to stop MCP server: ${(error as Error).message}`));\n        process.exit(1);\n      }\n    }),\n  )\n  .command(\n    'status',\n    new Command().description('Show MCP server status').action(async () => {\n      try {\n        const config = await configManager.load();\n        const isRunning = mcpServer !== null;\n\n        console.log(chalk.cyan('MCP Server Status:'));\n        console.log(`\uD83C\uDF10 Status: ${isRunning ? chalk.green('Running') : chalk.red('Stopped')}`);\n\n        if (isRunning) {\n          console.log(`\uD83D\uDCCD Address: ${config.mcp.host}:${config.mcp.port}`);\n          console.log(\n            `\uD83D\uDD10 Authentication: ${config.mcp.auth ? chalk.green('Enabled') : chalk.yellow('Disabled')}`,\n          );\n          console.log(`\uD83D\uDD27 Tools: ${chalk.green('Available')}`);\n          console.log(`\uD83D\uDCCA Metrics: ${chalk.green('Collecting')}`);\n        } else {\n          console.log(chalk.gray('Use \"claude-flow mcp start\" to start the server'));\n        }\n      } catch (error) {\n        console.error(chalk.red(`\u274C Failed to get MCP status: ${(error as Error).message}`));\n      }\n    }),\n  )\n  .command(\n    'tools',\n    new Command().description('List available MCP tools').action(() => {\n      console.log(chalk.cyan('Available MCP Tools:'));\n\n      console.log('\\n\uD83D\uDCCA Research Tools:');\n      console.log('  \u2022 web_search - Search the web for information');\n      console.log('  \u2022 web_fetch - Fetch content from URLs');\n      console.log('  \u2022 knowledge_query - Query knowledge base');\n\n      console.log('\\n\uD83D\uDCBB Code Tools:');\n      console.log('  \u2022 code_edit - Edit code files');\n      console.log('  \u2022 code_search - Search through codebase');\n      console.log('  \u2022 code_analyze - Analyze code quality');\n\n      console.log('\\n\uD83D\uDDA5\uFE0F  Terminal Tools:');\n      console.log('  \u2022 terminal_execute - Execute shell commands');\n      console.log('  \u2022 terminal_session - Manage terminal sessions');\n      console.log('  \u2022 file_operations - File system operations');\n\n      console.log('\\n\uD83D\uDCBE Memory Tools:');\n      console.log('  \u2022 memory_store - Store information');\n      console.log('  \u2022 memory_query - Query stored information');\n      console.log('  \u2022 memory_index - Index and search content');\n    }),\n  )\n  .command(\n    'config',\n    new Command().description('Show MCP configuration').action(async () => {\n      try {\n        const config = await configManager.load();\n\n        console.log(chalk.cyan('MCP Configuration:'));\n        console.log(JSON.stringify(config.mcp, null, 2));\n      } catch (error) {\n        console.error(chalk.red(`\u274C Failed to show MCP config: ${(error as Error).message}`));\n      }\n    }),\n  )\n  .command(\n    'restart',\n    new Command().description('Restart the MCP server').action(async () => {\n      try {\n        console.log(chalk.yellow('\uD83D\uDD04 Stopping MCP server...'));\n        if (mcpServer) {\n          await mcpServer.stop();\n        }\n\n        console.log(chalk.yellow('\uD83D\uDD04 Starting MCP server...'));\n        const config = await configManager.load();\n        mcpServer = new MCPServer(config.mcp, eventBus, logger);\n        await mcpServer.start();\n\n        console.log(\n          chalk.green(`\u2705 MCP server restarted on ${config.mcp.host}:${config.mcp.port}`),\n        );\n      } catch (error) {\n        console.error(chalk.red(`\u274C Failed to restart MCP server: ${(error as Error).message}`));\n        process.exit(1);\n      }\n    }),\n  )\n  .command(\n    'logs',\n    new Command()\n      .description('Show MCP server logs')\n      .option('-n, --lines <lines:number>', 'Number of log lines to show', { default: 50 })\n      .action((options: any) => {\n        console.log(chalk.cyan(`MCP Server Logs (last ${options.lines} lines):`));\n\n        // Mock logs since logging system might not be fully implemented\n        const logEntries = [\n          '2024-01-10 10:00:00 [INFO] MCP server started on localhost:3000',\n          '2024-01-10 10:00:01 [INFO] Tools registered: 12',\n          '2024-01-10 10:00:02 [INFO] Authentication disabled',\n          '2024-01-10 10:01:00 [INFO] Client connected: claude-desktop',\n          '2024-01-10 10:01:05 [INFO] Tool called: web_search',\n          '2024-01-10 10:01:10 [INFO] Tool response sent successfully',\n          '2024-01-10 10:02:00 [INFO] Tool called: terminal_execute',\n          '2024-01-10 10:02:05 [INFO] Command executed successfully',\n          '2024-01-10 10:03:00 [INFO] Memory operation: store',\n          '2024-01-10 10:03:01 [INFO] Data stored in namespace: default',\n        ];\n\n        const startIndex = Math.max(0, logEntries.length - options.lines);\n        const displayLogs = logEntries.slice(startIndex);\n\n        for (const entry of displayLogs) {\n          if (entry.includes('[ERROR]')) {\n            console.log(chalk.red(entry));\n          } else if (entry.includes('[WARN]')) {\n            console.log(chalk.yellow(entry));\n          } else if (entry.includes('[INFO]')) {\n            console.log(chalk.green(entry));\n          } else {\n            console.log(chalk.gray(entry));\n          }\n        }\n      }),\n  );\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA,qBAAwB;AACxB,mBAAkB;AAClB,oBAAuB;AACvB,oBAA8B;AAC9B,oBAA0B;AAC1B,uBAAyB;AAEzB,IAAI,YAA8B;AAE3B,MAAM,aAAa,IAAI,uBAAQ,EACnC,YAAY,6BAA6B,EACzC,OAAO,MAAM;AACZ,UAAQ,IAAI,aAAAA,QAAM,OAAO,8BAA8B,CAAC;AACxD,UAAQ,IAAI,kCAAkC;AAC9C,UAAQ,IAAI,iCAAiC;AAC7C,UAAQ,IAAI,oCAAoC;AAChD,UAAQ,IAAI,sCAAsC;AAClD,UAAQ,IAAI,oCAAoC;AAChD,UAAQ,IAAI,oCAAoC;AAChD,UAAQ,IAAI,kCAAkC;AAChD,CAAC,EACA;AAAA,EACC;AAAA,EACA,IAAI,uBAAQ,EACT,YAAY,sBAAsB,EAClC,OAAO,4BAA4B,uBAAuB,EAAE,SAAS,IAAK,CAAC,EAC3E,OAAO,4BAA4B,uBAAuB,EAAE,SAAS,YAAY,CAAC,EAClF,OAAO,kCAAkC,gCAAgC;AAAA,IACxE,SAAS;AAAA,EACX,CAAC,EACA,OAAO,OAAO,YAAiB;AAC9B,QAAI;AACF,YAAM,SAAS,MAAM,4BAAc,KAAK;AAGxC,YAAM,YAAY;AAAA,QAChB,GAAG,OAAO;AAAA,QACV,MAAM,QAAQ;AAAA,QACd,MAAM,QAAQ;AAAA,QACd,WAAW,QAAQ;AAAA,MACrB;AAEA,kBAAY,IAAI,wBAAU,WAAW,2BAAU,oBAAM;AACrD,YAAM,UAAU,MAAM;AAEtB,cAAQ,IAAI,aAAAA,QAAM,MAAM,gCAA2B,QAAQ,IAAI,IAAI,QAAQ,IAAI,EAAE,CAAC;AAClF,cAAQ,IAAI,aAAAA,QAAM,KAAK,gCAAyB,QAAQ,IAAI,IAAI,QAAQ,IAAI,EAAE,CAAC;AAC/E,cAAQ,IAAI,aAAAA,QAAM,KAAK,6DAAsD,CAAC;AAC9E,cAAQ;AAAA,QACN,aAAAA,QAAM,KAAK,uCAAgC,QAAQ,IAAI,IAAI,QAAQ,IAAI,OAAO;AAAA,MAChF;AAAA,IACF,SAAS,OAAO;AACd,cAAQ,MAAM,aAAAA,QAAM,IAAI,sCAAkC,MAAgB,OAAO,EAAE,CAAC;AACpF,cAAQ,KAAK,CAAC;AAAA,IAChB;AAAA,EACF,CAAC;AACL,EACC;AAAA,EACC;AAAA,EACA,IAAI,uBAAQ,EAAE,YAAY,qBAAqB,EAAE,OAAO,YAAY;AAClE,QAAI;AACF,UAAI,WAAW;AACb,cAAM,UAAU,KAAK;AACrB,oBAAY;AACZ,gBAAQ,IAAI,aAAAA,QAAM,MAAM,2BAAsB,CAAC;AAAA,MACjD,OAAO;AACL,gBAAQ,IAAI,aAAAA,QAAM,OAAO,yCAA+B,CAAC;AAAA,MAC3D;AAAA,IACF,SAAS,OAAO;AACd,cAAQ,MAAM,aAAAA,QAAM,IAAI,qCAAiC,MAAgB,OAAO,EAAE,CAAC;AACnF,cAAQ,KAAK,CAAC;AAAA,IAChB;AAAA,EACF,CAAC;AACH,EACC;AAAA,EACC;AAAA,EACA,IAAI,uBAAQ,EAAE,YAAY,wBAAwB,EAAE,OAAO,YAAY;AACrE,QAAI;AACF,YAAM,SAAS,MAAM,4BAAc,KAAK;AACxC,YAAM,YAAY,cAAc;AAEhC,cAAQ,IAAI,aAAAA,QAAM,KAAK,oBAAoB,CAAC;AAC5C,cAAQ,IAAI,qBAAc,YAAY,aAAAA,QAAM,MAAM,SAAS,IAAI,aAAAA,QAAM,IAAI,SAAS,CAAC,EAAE;AAErF,UAAI,WAAW;AACb,gBAAQ,IAAI,sBAAe,OAAO,IAAI,IAAI,IAAI,OAAO,IAAI,IAAI,EAAE;AAC/D,gBAAQ;AAAA,UACN,6BAAsB,OAAO,IAAI,OAAO,aAAAA,QAAM,MAAM,SAAS,IAAI,aAAAA,QAAM,OAAO,UAAU,CAAC;AAAA,QAC3F;AACA,gBAAQ,IAAI,oBAAa,aAAAA,QAAM,MAAM,WAAW,CAAC,EAAE;AACnD,gBAAQ,IAAI,sBAAe,aAAAA,QAAM,MAAM,YAAY,CAAC,EAAE;AAAA,MACxD,OAAO;AACL,gBAAQ,IAAI,aAAAA,QAAM,KAAK,iDAAiD,CAAC;AAAA,MAC3E;AAAA,IACF,SAAS,OAAO;AACd,cAAQ,MAAM,aAAAA,QAAM,IAAI,oCAAgC,MAAgB,OAAO,EAAE,CAAC;AAAA,IACpF;AAAA,EACF,CAAC;AACH,EACC;AAAA,EACC;AAAA,EACA,IAAI,uBAAQ,EAAE,YAAY,0BAA0B,EAAE,OAAO,MAAM;AACjE,YAAQ,IAAI,aAAAA,QAAM,KAAK,sBAAsB,CAAC;AAE9C,YAAQ,IAAI,6BAAsB;AAClC,YAAQ,IAAI,sDAAiD;AAC7D,YAAQ,IAAI,8CAAyC;AACrD,YAAQ,IAAI,iDAA4C;AAExD,YAAQ,IAAI,yBAAkB;AAC9B,YAAQ,IAAI,sCAAiC;AAC7C,YAAQ,IAAI,gDAA2C;AACvD,YAAQ,IAAI,8CAAyC;AAErD,YAAQ,IAAI,oCAAwB;AACpC,YAAQ,IAAI,oDAA+C;AAC3D,YAAQ,IAAI,sDAAiD;AAC7D,YAAQ,IAAI,mDAA8C;AAE1D,YAAQ,IAAI,2BAAoB;AAChC,YAAQ,IAAI,2CAAsC;AAClD,YAAQ,IAAI,kDAA6C;AACzD,YAAQ,IAAI,kDAA6C;AAAA,EAC3D,CAAC;AACH,EACC;AAAA,EACC;AAAA,EACA,IAAI,uBAAQ,EAAE,YAAY,wBAAwB,EAAE,OAAO,YAAY;AACrE,QAAI;AACF,YAAM,SAAS,MAAM,4BAAc,KAAK;AAExC,cAAQ,IAAI,aAAAA,QAAM,KAAK,oBAAoB,CAAC;AAC5C,cAAQ,IAAI,KAAK,UAAU,OAAO,KAAK,MAAM,CAAC,CAAC;AAAA,IACjD,SAAS,OAAO;AACd,cAAQ,MAAM,aAAAA,QAAM,IAAI,qCAAiC,MAAgB,OAAO,EAAE,CAAC;AAAA,IACrF;AAAA,EACF,CAAC;AACH,EACC;AAAA,EACC;AAAA,EACA,IAAI,uBAAQ,EAAE,YAAY,wBAAwB,EAAE,OAAO,YAAY;AACrE,QAAI;AACF,cAAQ,IAAI,aAAAA,QAAM,OAAO,kCAA2B,CAAC;AACrD,UAAI,WAAW;AACb,cAAM,UAAU,KAAK;AAAA,MACvB;AAEA,cAAQ,IAAI,aAAAA,QAAM,OAAO,kCAA2B,CAAC;AACrD,YAAM,SAAS,MAAM,4BAAc,KAAK;AACxC,kBAAY,IAAI,wBAAU,OAAO,KAAK,2BAAU,oBAAM;AACtD,YAAM,UAAU,MAAM;AAEtB,cAAQ;AAAA,QACN,aAAAA,QAAM,MAAM,kCAA6B,OAAO,IAAI,IAAI,IAAI,OAAO,IAAI,IAAI,EAAE;AAAA,MAC/E;AAAA,IACF,SAAS,OAAO;AACd,cAAQ,MAAM,aAAAA,QAAM,IAAI,wCAAoC,MAAgB,OAAO,EAAE,CAAC;AACtF,cAAQ,KAAK,CAAC;AAAA,IAChB;AAAA,EACF,CAAC;AACH,EACC;AAAA,EACC;AAAA,EACA,IAAI,uBAAQ,EACT,YAAY,sBAAsB,EAClC,OAAO,8BAA8B,+BAA+B,EAAE,SAAS,GAAG,CAAC,EACnF,OAAO,CAAC,YAAiB;AACxB,YAAQ,IAAI,aAAAA,QAAM,KAAK,yBAAyB,QAAQ,KAAK,UAAU,CAAC;AAGxE,UAAM,aAAa;AAAA,MACjB;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAEA,UAAM,aAAa,KAAK,IAAI,GAAG,WAAW,SAAS,QAAQ,KAAK;AAChE,UAAM,cAAc,WAAW,MAAM,UAAU;AAE/C,eAAW,SAAS,aAAa;AAC/B,UAAI,MAAM,SAAS,SAAS,GAAG;AAC7B,gBAAQ,IAAI,aAAAA,QAAM,IAAI,KAAK,CAAC;AAAA,MAC9B,WAAW,MAAM,SAAS,QAAQ,GAAG;AACnC,gBAAQ,IAAI,aAAAA,QAAM,OAAO,KAAK,CAAC;AAAA,MACjC,WAAW,MAAM,SAAS,QAAQ,GAAG;AACnC,gBAAQ,IAAI,aAAAA,QAAM,MAAM,KAAK,CAAC;AAAA,MAChC,OAAO;AACL,gBAAQ,IAAI,aAAAA,QAAM,KAAK,KAAK,CAAC;AAAA,MAC/B;AAAA,IACF;AAAA,EACF,CAAC;AACL;",
  "names": ["chalk"]
}
